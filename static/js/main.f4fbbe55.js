/*! For license information please see main.f4fbbe55.js.LICENSE.txt */
!function(){"use strict";var e={110:function(e,t,n){var r=n(309),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},u={};function s(e){return r.isMemo(e)?o:u[e.$$typeof]||i}u[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},u[r.Memo]=o;var c=Object.defineProperty,l=Object.getOwnPropertyNames,f=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,d=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(p){var i=d(n);i&&i!==p&&e(t,i,r)}var o=l(n);f&&(o=o.concat(f(n)));for(var u=s(t),v=s(n),y=0;y<o.length;++y){var m=o[y];if(!a[m]&&(!r||!r[m])&&(!v||!v[m])&&(!u||!u[m])){var g=h(n,m);try{c(t,m,g)}catch(k){}}}}return t}},746:function(e,t){var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,u=n?Symbol.for("react.profiler"):60114,s=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,l=n?Symbol.for("react.async_mode"):60111,f=n?Symbol.for("react.concurrent_mode"):60111,h=n?Symbol.for("react.forward_ref"):60112,d=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,v=n?Symbol.for("react.memo"):60115,y=n?Symbol.for("react.lazy"):60116,m=n?Symbol.for("react.block"):60121,g=n?Symbol.for("react.fundamental"):60117,k=n?Symbol.for("react.responder"):60118,b=n?Symbol.for("react.scope"):60119;function w(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case l:case f:case a:case u:case o:case d:return e;default:switch(e=e&&e.$$typeof){case c:case h:case y:case v:case s:return e;default:return t}}case i:return t}}}function _(e){return w(e)===f}t.AsyncMode=l,t.ConcurrentMode=f,t.ContextConsumer=c,t.ContextProvider=s,t.Element=r,t.ForwardRef=h,t.Fragment=a,t.Lazy=y,t.Memo=v,t.Portal=i,t.Profiler=u,t.StrictMode=o,t.Suspense=d,t.isAsyncMode=function(e){return _(e)||w(e)===l},t.isConcurrentMode=_,t.isContextConsumer=function(e){return w(e)===c},t.isContextProvider=function(e){return w(e)===s},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return w(e)===h},t.isFragment=function(e){return w(e)===a},t.isLazy=function(e){return w(e)===y},t.isMemo=function(e){return w(e)===v},t.isPortal=function(e){return w(e)===i},t.isProfiler=function(e){return w(e)===u},t.isStrictMode=function(e){return w(e)===o},t.isSuspense=function(e){return w(e)===d},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===a||e===f||e===u||e===o||e===d||e===p||"object"===typeof e&&null!==e&&(e.$$typeof===y||e.$$typeof===v||e.$$typeof===s||e.$$typeof===c||e.$$typeof===h||e.$$typeof===g||e.$$typeof===k||e.$$typeof===b||e.$$typeof===m)},t.typeOf=w},309:function(e,t,n){e.exports=n(746)},463:function(e,t,n){var r=n(791),i=n(296);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,u={};function s(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(u[e]=t,e=0;e<t.length;e++)o.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),f=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},p={};function v(e,t,n,r,i,a,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){y[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];y[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){y[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){y[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){y[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){y[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){y[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){y[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){y[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function g(e){return e[1].toUpperCase()}function k(e,t,n,r){var i=y.hasOwnProperty(t)?y[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!f.call(p,e)||!f.call(d,e)&&(h.test(e)?p[e]=!0:(d[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,g);y[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,g);y[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,g);y[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){y[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),y.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){y[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),_=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),E=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var M,F=Object.assign;function U(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var j=!1;function V(e,t){if(!e||j)return"";j=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),a=r.stack.split("\n"),o=i.length-1,u=a.length-1;1<=o&&0<=u&&i[o]!==a[u];)u--;for(;1<=o&&0<=u;o--,u--)if(i[o]!==a[u]){if(1!==o||1!==u)do{if(o--,0>--u||i[o]!==a[u]){var s="\n"+i[o].replace(" at new "," at ");return e.displayName&&s.includes("<anonymous>")&&(s=s.replace("<anonymous>",e.displayName)),s}}while(1<=o&&0<=u);break}}}finally{j=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?U(e):""}function q(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case x:return"Fragment";case _:return"Portal";case S:return"Profiler";case I:return"StrictMode";case N:return"Suspense";case R:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function z(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function K(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=K(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function G(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=K(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&k(e,"checked",t,!1)}function J(e,t){X(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function ae(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ue(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function se(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ue(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,le,fe=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var de={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||de.hasOwnProperty(e)&&de[e]?(""+t).trim():t+"px"}function ye(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(de).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),de[t]=de[e]}))}));var me=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ge(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function ke(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _e=null,xe=null,Ie=null;function Se(e){if(e=ki(e)){if("function"!==typeof _e)throw Error(a(280));var t=e.stateNode;t&&(t=wi(t),_e(e.stateNode,e.type,t))}}function Te(e){xe?Ie?Ie.push(e):Ie=[e]:xe=e}function Ee(){if(xe){var e=xe,t=Ie;if(Ie=xe=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Ce(e,t){return e(t)}function Ne(){}var Re=!1;function Ae(e,t,n){if(Re)return e(t,n);Re=!0;try{return Ce(e,t,n)}finally{Re=!1,(null!==xe||null!==Ie)&&(Ne(),Ee())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var r=wi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var De=!1;if(l)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){De=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(le){De=!1}function Le(e,t,n,r,i,a,o,u,s){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var Me=!1,Fe=null,Ue=!1,je=null,Ve={onError:function(e){Me=!0,Fe=e}};function qe(e,t,n,r,i,a,o,u,s){Me=!1,Fe=null,Le.apply(Ve,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function ze(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Be(e)!==e)throw Error(a(188))}function Ke(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return We(i),e;if(o===r)return We(i),t;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var u=!1,s=i.child;s;){if(s===n){u=!0,n=i,r=o;break}if(s===r){u=!0,r=i,n=o;break}s=s.sibling}if(!u){for(s=o.child;s;){if(s===n){u=!0,n=o,r=i;break}if(s===r){u=!0,r=o,n=i;break}s=s.sibling}if(!u)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Ge=i.unstable_scheduleCallback,Qe=i.unstable_cancelCallback,$e=i.unstable_shouldYield,Ye=i.unstable_requestPaint,Xe=i.unstable_now,Je=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,at=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ut(e)/st|0)|0},ut=Math.log,st=Math.LN2;var ct=64,lt=4194304;function ft(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=268435455&n;if(0!==o){var u=o&~i;0!==u?r=ft(u):0!==(a&=o)&&(r=ft(a))}else 0!==(o=n&~i)?r=ft(o):0!==a&&(r=ft(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(a=t&-t)||16===i&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function dt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function yt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function gt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var kt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,_t,xt,It,St,Tt=!1,Et=[],Ct=null,Nt=null,Rt=null,At=new Map,Pt=new Map,Dt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function Mt(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=ki(t))&&_t(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ft(e){var t=gi(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=ze(n)))return e.blockedOn=t,void St(e.priority,(function(){xt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ki(n))&&_t(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function jt(e,t,n){Ut(e)&&n.delete(t)}function Vt(){Tt=!1,null!==Ct&&Ut(Ct)&&(Ct=null),null!==Nt&&Ut(Nt)&&(Nt=null),null!==Rt&&Ut(Rt)&&(Rt=null),At.forEach(jt),Pt.forEach(jt)}function qt(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Vt)))}function Bt(e){function t(t){return qt(t,e)}if(0<Et.length){qt(Et[0],e);for(var n=1;n<Et.length;n++){var r=Et[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Ct&&qt(Ct,e),null!==Nt&&qt(Nt,e),null!==Rt&&qt(Rt,e),At.forEach(t),Pt.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Dt.shift()}var zt=b.ReactCurrentBatchConfig,Wt=!0;function Kt(e,t,n,r){var i=kt,a=zt.transition;zt.transition=null;try{kt=1,Gt(e,t,n,r)}finally{kt=i,zt.transition=a}}function Ht(e,t,n,r){var i=kt,a=zt.transition;zt.transition=null;try{kt=4,Gt(e,t,n,r)}finally{kt=i,zt.transition=a}}function Gt(e,t,n,r){if(Wt){var i=$t(e,t,n,r);if(null===i)Wr(e,t,r,Qt,n),Lt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Ct=Mt(Ct,e,t,n,r,i),!0;case"dragenter":return Nt=Mt(Nt,e,t,n,r,i),!0;case"mouseover":return Rt=Mt(Rt,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return At.set(a,Mt(At.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Pt.set(a,Mt(Pt.get(a)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Lt(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==i;){var a=ki(i);if(null!==a&&wt(a),null===(a=$t(e,t,n,r))&&Wr(e,t,r,Qt,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var Qt=null;function $t(e,t,n,r){if(Qt=null,null!==(e=gi(e=we(r))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=ze(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Xt=null,Jt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Jt,r=n.length,i="value"in Xt?Xt.value:Xt.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[a-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,i,a){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,un,sn,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=an(cn),fn=F({},cn,{view:0,detail:0}),hn=an(fn),dn=F({},fn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sn&&(sn&&"mousemove"===e.type?(on=e.screenX-sn.screenX,un=e.screenY-sn.screenY):un=on=0,sn=e),on)},movementY:function(e){return"movementY"in e?e.movementY:un}}),pn=an(dn),vn=an(F({},dn,{dataTransfer:0})),yn=an(F({},fn,{relatedTarget:0})),mn=an(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),gn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),kn=an(gn),bn=an(F({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_n={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function In(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=xn[e])&&!!t[e]}function Sn(){return In}var Tn=F({},fn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?_n[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),En=an(Tn),Cn=an(F({},dn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=an(F({},fn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sn})),Rn=an(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=F({},dn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=an(An),Dn=[9,13,27,32],On=l&&"CompositionEvent"in window,Ln=null;l&&"documentMode"in document&&(Ln=document.documentMode);var Mn=l&&"TextEvent"in window&&!Ln,Fn=l&&(!On||Ln&&8<Ln&&11>=Ln),Un=String.fromCharCode(32),jn=!1;function Vn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var zn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!zn[e.type]:"textarea"===t}function Kn(e,t,n,r){Te(r),0<(t=Hr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,Gn=null;function Qn(e){Ur(e,0)}function $n(e){if(G(bi(e)))return e}function Yn(e,t){if("change"===e)return t}var Xn=!1;if(l){var Jn;if(l){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Jn=Zn}else Jn=!1;Xn=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){Hn&&(Hn.detachEvent("onpropertychange",nr),Gn=Hn=null)}function nr(e){if("value"===e.propertyName&&$n(Gn)){var t=[];Kn(t,Gn,e,we(e)),Ae(Qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Gn=n,(Hn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return $n(Gn)}function ar(e,t){if("click"===e)return $n(t)}function or(e,t){if("input"===e||"change"===e)return $n(t)}var ur="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function sr(e,t){if(ur(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!f.call(t,i)||!ur(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function fr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?fr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function dr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&fr(n.ownerDocument.documentElement,n)){if(null!==r&&dr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=void 0===r.end?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=lr(n,a);var o=lr(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=l&&"documentMode"in document&&11>=document.documentMode,yr=null,mr=null,gr=null,kr=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;kr||null==yr||yr!==Q(r)||("selectionStart"in(r=yr)&&dr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},gr&&sr(gr,r)||(gr=r,0<(r=Hr(mr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=yr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var _r={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},xr={},Ir={};function Sr(e){if(xr[e])return xr[e];if(!_r[e])return e;var t,n=_r[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ir)return xr[e]=n[t];return e}l&&(Ir=document.createElement("div").style,"AnimationEvent"in window||(delete _r.animationend.animation,delete _r.animationiteration.animation,delete _r.animationstart.animation),"TransitionEvent"in window||delete _r.transitionend.transition);var Tr=Sr("animationend"),Er=Sr("animationiteration"),Cr=Sr("animationstart"),Nr=Sr("transitionend"),Rr=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pr(e,t){Rr.set(e,t),s(t,[e])}for(var Dr=0;Dr<Ar.length;Dr++){var Or=Ar[Dr];Pr(Or.toLowerCase(),"on"+(Or[0].toUpperCase()+Or.slice(1)))}Pr(Tr,"onAnimationEnd"),Pr(Er,"onAnimationIteration"),Pr(Cr,"onAnimationStart"),Pr("dblclick","onDoubleClick"),Pr("focusin","onFocus"),Pr("focusout","onBlur"),Pr(Nr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Fr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,u,s,c){if(qe.apply(this,arguments),Me){if(!Me)throw Error(a(198));var l=Fe;Me=!1,Fe=null,Ue||(Ue=!0,je=l)}}(r,t,void 0,e),e.currentTarget=null}function Ur(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var u=r[o],s=u.instance,c=u.currentTarget;if(u=u.listener,s!==a&&i.isPropagationStopped())break e;Fr(i,u,c),a=s}else for(o=0;o<r.length;o++){if(s=(u=r[o]).instance,c=u.currentTarget,u=u.listener,s!==a&&i.isPropagationStopped())break e;Fr(i,u,c),a=s}}}if(Ue)throw e=je,Ue=!1,je=null,e}function jr(e,t){var n=t[vi];void 0===n&&(n=t[vi]=new Set);var r=e+"__bubble";n.has(r)||(zr(t,e,2,!1),n.add(r))}function Vr(e,t,n){var r=0;t&&(r|=4),zr(n,e,r,t)}var qr="_reactListening"+Math.random().toString(36).slice(2);function Br(e){if(!e[qr]){e[qr]=!0,o.forEach((function(t){"selectionchange"!==t&&(Mr.has(t)||Vr(t,!1,e),Vr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[qr]||(t[qr]=!0,Vr("selectionchange",!1,t))}}function zr(e,t,n,r){switch(Yt(t)){case 1:var i=Kt;break;case 4:i=Ht;break;default:i=Gt}n=i.bind(null,t,n,e),i=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var u=r.stateNode.containerInfo;if(u===i||8===u.nodeType&&u.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var s=o.tag;if((3===s||4===s)&&((s=o.stateNode.containerInfo)===i||8===s.nodeType&&s.parentNode===i))return;o=o.return}for(;null!==u;){if(null===(o=gi(u)))return;if(5===(s=o.tag)||6===s){r=a=o;continue e}u=u.parentNode}}r=r.return}Ae((function(){var r=a,i=we(n),o=[];e:{var u=Rr.get(e);if(void 0!==u){var s=ln,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":s=En;break;case"focusin":c="focus",s=yn;break;case"focusout":c="blur",s=yn;break;case"beforeblur":case"afterblur":s=yn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":s=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":s=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":s=Nn;break;case Tr:case Er:case Cr:s=mn;break;case Nr:s=Rn;break;case"scroll":s=hn;break;case"wheel":s=Pn;break;case"copy":case"cut":case"paste":s=kn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":s=Cn}var l=0!==(4&t),f=!l&&"scroll"===e,h=l?null!==u?u+"Capture":null:u;l=[];for(var d,p=r;null!==p;){var v=(d=p).stateNode;if(5===d.tag&&null!==v&&(d=v,null!==h&&(null!=(v=Pe(p,h))&&l.push(Kr(p,v,d)))),f)break;p=p.return}0<l.length&&(u=new s(u,c,null,n,i),o.push({event:u,listeners:l}))}}if(0===(7&t)){if(s="mouseout"===e||"pointerout"===e,(!(u="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!gi(c)&&!c[pi])&&(s||u)&&(u=i.window===i?i:(u=i.ownerDocument)?u.defaultView||u.parentWindow:window,s?(s=r,null!==(c=(c=n.relatedTarget||n.toElement)?gi(c):null)&&(c!==(f=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(s=null,c=r),s!==c)){if(l=pn,v="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(l=Cn,v="onPointerLeave",h="onPointerEnter",p="pointer"),f=null==s?u:bi(s),d=null==c?u:bi(c),(u=new l(v,p+"leave",s,n,i)).target=f,u.relatedTarget=d,v=null,gi(i)===r&&((l=new l(h,p+"enter",c,n,i)).target=d,l.relatedTarget=f,v=l),f=v,s&&c)e:{for(h=c,p=0,d=l=s;d;d=Gr(d))p++;for(d=0,v=h;v;v=Gr(v))d++;for(;0<p-d;)l=Gr(l),p--;for(;0<d-p;)h=Gr(h),d--;for(;p--;){if(l===h||null!==h&&l===h.alternate)break e;l=Gr(l),h=Gr(h)}l=null}else l=null;null!==s&&Qr(o,u,s,l,!1),null!==c&&null!==f&&Qr(o,f,c,l,!0)}if("select"===(s=(u=r?bi(r):window).nodeName&&u.nodeName.toLowerCase())||"input"===s&&"file"===u.type)var y=Yn;else if(Wn(u))if(Xn)y=or;else{y=ir;var m=rr}else(s=u.nodeName)&&"input"===s.toLowerCase()&&("checkbox"===u.type||"radio"===u.type)&&(y=ar);switch(y&&(y=y(e,r))?Kn(o,y,n,i):(m&&m(e,u,r),"focusout"===e&&(m=u._wrapperState)&&m.controlled&&"number"===u.type&&ee(u,"number",u.value)),m=r?bi(r):window,e){case"focusin":(Wn(m)||"true"===m.contentEditable)&&(yr=m,mr=r,gr=null);break;case"focusout":gr=mr=yr=null;break;case"mousedown":kr=!0;break;case"contextmenu":case"mouseup":case"dragend":kr=!1,br(o,n,i);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":br(o,n,i)}var g;if(On)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Bn?Vn(e,n)&&(k="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(k="onCompositionStart");k&&(Fn&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==k?"onCompositionEnd"===k&&Bn&&(g=en()):(Jt="value"in(Xt=i)?Xt.value:Xt.textContent,Bn=!0)),0<(m=Hr(r,k)).length&&(k=new bn(k,e,null,n,i),o.push({event:k,listeners:m}),g?k.data=g:null!==(g=qn(n))&&(k.data=g))),(g=Mn?function(e,t){switch(e){case"compositionend":return qn(t);case"keypress":return 32!==t.which?null:(jn=!0,Un);case"textInput":return(e=t.data)===Un&&jn?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!On&&Vn(e,t)?(e=en(),Zt=Jt=Xt=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Hr(r,"onBeforeInput")).length&&(i=new bn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=g))}Ur(o,t)}))}function Kr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Pe(e,n))&&r.unshift(Kr(e,a,i)),null!=(a=Pe(e,t))&&r.push(Kr(e,a,i))),e=e.return}return r}function Gr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,i){for(var a=t._reactName,o=[];null!==n&&n!==r;){var u=n,s=u.alternate,c=u.stateNode;if(null!==s&&s===r)break;5===u.tag&&null!==c&&(u=c,i?null!=(s=Pe(n,a))&&o.unshift(Kr(n,s,u)):i||null!=(s=Pe(n,a))&&o.push(Kr(n,s,u))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var $r=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function Xr(e){return("string"===typeof e?e:""+e).replace($r,"\n").replace(Yr,"")}function Jr(e,t,n){if(t=Xr(t),Xr(e)!==t&&n)throw Error(a(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,ai="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ai?function(e){return ai.resolve(null).then(e).catch(ui)}:ri;function ui(e){setTimeout((function(){throw e}))}function si(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Bt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Bt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function li(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var fi=Math.random().toString(36).slice(2),hi="__reactFiber$"+fi,di="__reactProps$"+fi,pi="__reactContainer$"+fi,vi="__reactEvents$"+fi,yi="__reactListeners$"+fi,mi="__reactHandles$"+fi;function gi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=li(e);null!==e;){if(n=e[hi])return n;e=li(e)}return t}n=(e=n).parentNode}return null}function ki(e){return!(e=e[hi]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function bi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function wi(e){return e[di]||null}var _i=[],xi=-1;function Ii(e){return{current:e}}function Si(e){0>xi||(e.current=_i[xi],_i[xi]=null,xi--)}function Ti(e,t){xi++,_i[xi]=e.current,e.current=t}var Ei={},Ci=Ii(Ei),Ni=Ii(!1),Ri=Ei;function Ai(e,t){var n=e.type.contextTypes;if(!n)return Ei;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Pi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Di(){Si(Ni),Si(Ci)}function Oi(e,t,n){if(Ci.current!==Ei)throw Error(a(168));Ti(Ci,t),Ti(Ni,n)}function Li(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(a(108,z(e)||"Unknown",i));return F({},n,r)}function Mi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ei,Ri=Ci.current,Ti(Ci,e),Ti(Ni,Ni.current),!0}function Fi(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Li(e,t,Ri),r.__reactInternalMemoizedMergedChildContext=e,Si(Ni),Si(Ci),Ti(Ci,e)):Si(Ni),Ti(Ni,n)}var Ui=null,ji=!1,Vi=!1;function qi(e){null===Ui?Ui=[e]:Ui.push(e)}function Bi(){if(!Vi&&null!==Ui){Vi=!0;var e=0,t=kt;try{var n=Ui;for(kt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ui=null,ji=!1}catch(i){throw null!==Ui&&(Ui=Ui.slice(e+1)),Ge(Ze,Bi),i}finally{kt=t,Vi=!1}}return null}var zi=[],Wi=0,Ki=null,Hi=0,Gi=[],Qi=0,$i=null,Yi=1,Xi="";function Ji(e,t){zi[Wi++]=Hi,zi[Wi++]=Ki,Ki=e,Hi=t}function Zi(e,t,n){Gi[Qi++]=Yi,Gi[Qi++]=Xi,Gi[Qi++]=$i,$i=e;var r=Yi;e=Xi;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var a=32-ot(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Yi=1<<32-ot(t)+i|n<<i|r,Xi=a+e}else Yi=1<<a|n<<i|r,Xi=e}function ea(e){null!==e.return&&(Ji(e,1),Zi(e,1,0))}function ta(e){for(;e===Ki;)Ki=zi[--Wi],zi[Wi]=null,Hi=zi[--Wi],zi[Wi]=null;for(;e===$i;)$i=Gi[--Qi],Gi[Qi]=null,Xi=Gi[--Qi],Gi[Qi]=null,Yi=Gi[--Qi],Gi[Qi]=null}var na=null,ra=null,ia=!1,aa=null;function oa(e,t){var n=Ac(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ua(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,ra=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,ra=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==$i?{id:Yi,overflow:Xi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ac(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,ra=null,!0);default:return!1}}function sa(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ca(e){if(ia){var t=ra;if(t){var n=t;if(!ua(e,t)){if(sa(e))throw Error(a(418));t=ci(n.nextSibling);var r=na;t&&ua(e,t)?oa(r,n):(e.flags=-4097&e.flags|2,ia=!1,na=e)}}else{if(sa(e))throw Error(a(418));e.flags=-4097&e.flags|2,ia=!1,na=e}}}function la(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function fa(e){if(e!==na)return!1;if(!ia)return la(e),ia=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ra)){if(sa(e))throw ha(),Error(a(418));for(;t;)oa(e,t),t=ci(t.nextSibling)}if(la(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ra=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ra=null}}else ra=na?ci(e.stateNode.nextSibling):null;return!0}function ha(){for(var e=ra;e;)e=ci(e.nextSibling)}function da(){ra=na=null,ia=!1}function pa(e){null===aa?aa=[e]:aa.push(e)}var va=b.ReactCurrentBatchConfig;function ya(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var ma=Ii(null),ga=null,ka=null,ba=null;function wa(){ba=ka=ga=null}function _a(e){var t=ma.current;Si(ma),e._currentValue=t}function xa(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ia(e,t){ga=e,ba=ka=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bu=!0),e.firstContext=null)}function Sa(e){var t=e._currentValue;if(ba!==e)if(e={context:e,memoizedValue:t,next:null},null===ka){if(null===ga)throw Error(a(308));ka=e,ga.dependencies={lanes:0,firstContext:e}}else ka=ka.next=e;return t}var Ta=null;function Ea(e){null===Ta?Ta=[e]:Ta.push(e)}function Ca(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Ea(t)):(n.next=i.next,i.next=n),t.interleaved=n,Na(e,r)}function Na(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ra=!1;function Aa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Pa(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Da(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Oa(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Cs)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Na(e,n)}return null===(i=r.interleaved)?(t.next=t,Ea(r)):(t.next=i.next,i.next=t),r.interleaved=t,Na(e,n)}function La(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}function Ma(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Fa(e,t,n,r){var i=e.updateQueue;Ra=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,u=i.shared.pending;if(null!==u){i.shared.pending=null;var s=u,c=s.next;s.next=null,null===o?a=c:o.next=c,o=s;var l=e.alternate;null!==l&&((u=(l=l.updateQueue).lastBaseUpdate)!==o&&(null===u?l.firstBaseUpdate=c:u.next=c,l.lastBaseUpdate=s))}if(null!==a){var f=i.baseState;for(o=0,l=c=s=null,u=a;;){var h=u.lane,d=u.eventTime;if((r&h)===h){null!==l&&(l=l.next={eventTime:d,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var p=e,v=u;switch(h=t,d=n,v.tag){case 1:if("function"===typeof(p=v.payload)){f=p.call(d,f,h);break e}f=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=v.payload)?p.call(d,f,h):p)||void 0===h)break e;f=F({},f,h);break e;case 2:Ra=!0}}null!==u.callback&&0!==u.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[u]:h.push(u))}else d={eventTime:d,lane:h,tag:u.tag,payload:u.payload,callback:u.callback,next:null},null===l?(c=l=d,s=f):l=l.next=d,o|=h;if(null===(u=u.next)){if(null===(u=i.shared.pending))break;u=(h=u).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===l&&(s=f),i.baseState=s,i.firstBaseUpdate=c,i.lastBaseUpdate=l,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Ms|=o,e.lanes=o,e.memoizedState=f}}function Ua(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(a(191,i));i.call(r)}}}var ja=(new r.Component).refs;function Va(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var qa={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),a=Da(r,i);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Oa(e,a,i))&&(nc(t,e,i,r),La(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),a=Da(r,i);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Oa(e,a,i))&&(nc(t,e,i,r),La(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),i=Da(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Oa(e,i,r))&&(nc(t,e,r,n),La(t,e,r))}};function Ba(e,t,n,r,i,a,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!sr(n,r)||!sr(i,a))}function za(e,t,n){var r=!1,i=Ei,a=t.contextType;return"object"===typeof a&&null!==a?a=Sa(a):(i=Pi(t)?Ri:Ci.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ai(e,i):Ei),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=qa,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Wa(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&qa.enqueueReplaceState(t,t.state,null)}function Ka(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=ja,Aa(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=Sa(a):(a=Pi(t)?Ri:Ci.current,i.context=Ai(e,a)),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(Va(e,t,a,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&qa.enqueueReplaceState(i,i.state,null),Fa(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function Ha(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;t===ja&&(t=i.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function Ga(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Qa(e){return(0,e._init)(e._payload)}function $a(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Dc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function u(t){return e&&null===t.alternate&&(t.flags|=2),t}function s(e,t,n,r){return null===t||6!==t.tag?((t=Fc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===x?f(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===P&&Qa(a)===t.type)?((r=i(t,n.props)).ref=Ha(e,t,n),r.return=e,r):((r=Oc(n.type,n.key,n.props,null,e.mode,r)).ref=Ha(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Uc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function f(e,t,n,r,a){return null===t||7!==t.tag?((t=Lc(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=Ha(e,null,t),n.return=e,n;case _:return(t=Uc(t,e.mode,n)).return=e,t;case P:return h(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=Lc(t,e.mode,n,null)).return=e,t;Ga(e,t)}return null}function d(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:s(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===i?c(e,t,n,r):null;case _:return n.key===i?l(e,t,n,r):null;case P:return d(e,t,(i=n._init)(n._payload),r)}if(te(n)||L(n))return null!==i?null:f(e,t,n,r,null);Ga(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return s(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case _:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i);case P:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||L(r))return f(t,e=e.get(n)||null,r,i,null);Ga(t,r)}return null}function v(i,a,u,s){for(var c=null,l=null,f=a,v=a=0,y=null;null!==f&&v<u.length;v++){f.index>v?(y=f,f=null):y=f.sibling;var m=d(i,f,u[v],s);if(null===m){null===f&&(f=y);break}e&&f&&null===m.alternate&&t(i,f),a=o(m,a,v),null===l?c=m:l.sibling=m,l=m,f=y}if(v===u.length)return n(i,f),ia&&Ji(i,v),c;if(null===f){for(;v<u.length;v++)null!==(f=h(i,u[v],s))&&(a=o(f,a,v),null===l?c=f:l.sibling=f,l=f);return ia&&Ji(i,v),c}for(f=r(i,f);v<u.length;v++)null!==(y=p(f,i,v,u[v],s))&&(e&&null!==y.alternate&&f.delete(null===y.key?v:y.key),a=o(y,a,v),null===l?c=y:l.sibling=y,l=y);return e&&f.forEach((function(e){return t(i,e)})),ia&&Ji(i,v),c}function y(i,u,s,c){var l=L(s);if("function"!==typeof l)throw Error(a(150));if(null==(s=l.call(s)))throw Error(a(151));for(var f=l=null,v=u,y=u=0,m=null,g=s.next();null!==v&&!g.done;y++,g=s.next()){v.index>y?(m=v,v=null):m=v.sibling;var k=d(i,v,g.value,c);if(null===k){null===v&&(v=m);break}e&&v&&null===k.alternate&&t(i,v),u=o(k,u,y),null===f?l=k:f.sibling=k,f=k,v=m}if(g.done)return n(i,v),ia&&Ji(i,y),l;if(null===v){for(;!g.done;y++,g=s.next())null!==(g=h(i,g.value,c))&&(u=o(g,u,y),null===f?l=g:f.sibling=g,f=g);return ia&&Ji(i,y),l}for(v=r(i,v);!g.done;y++,g=s.next())null!==(g=p(v,i,y,g.value,c))&&(e&&null!==g.alternate&&v.delete(null===g.key?y:g.key),u=o(g,u,y),null===f?l=g:f.sibling=g,f=g);return e&&v.forEach((function(e){return t(i,e)})),ia&&Ji(i,y),l}return function e(r,a,o,s){if("object"===typeof o&&null!==o&&o.type===x&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var c=o.key,l=a;null!==l;){if(l.key===c){if((c=o.type)===x){if(7===l.tag){n(r,l.sibling),(a=i(l,o.props.children)).return=r,r=a;break e}}else if(l.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&Qa(c)===l.type){n(r,l.sibling),(a=i(l,o.props)).ref=Ha(r,l,o),a.return=r,r=a;break e}n(r,l);break}t(r,l),l=l.sibling}o.type===x?((a=Lc(o.props.children,r.mode,s,o.key)).return=r,r=a):((s=Oc(o.type,o.key,o.props,null,r.mode,s)).ref=Ha(r,a,o),s.return=r,r=s)}return u(r);case _:e:{for(l=o.key;null!==a;){if(a.key===l){if(4===a.tag&&a.stateNode.containerInfo===o.containerInfo&&a.stateNode.implementation===o.implementation){n(r,a.sibling),(a=i(a,o.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=Uc(o,r.mode,s)).return=r,r=a}return u(r);case P:return e(r,a,(l=o._init)(o._payload),s)}if(te(o))return v(r,a,o,s);if(L(o))return y(r,a,o,s);Ga(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==a&&6===a.tag?(n(r,a.sibling),(a=i(a,o)).return=r,r=a):(n(r,a),(a=Fc(o,r.mode,s)).return=r,r=a),u(r)):n(r,a)}}var Ya=$a(!0),Xa=$a(!1),Ja={},Za=Ii(Ja),eo=Ii(Ja),to=Ii(Ja);function no(e){if(e===Ja)throw Error(a(174));return e}function ro(e,t){switch(Ti(to,t),Ti(eo,e),Ti(Za,Ja),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:se(null,"");break;default:t=se(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Si(Za),Ti(Za,t)}function io(){Si(Za),Si(eo),Si(to)}function ao(e){no(to.current);var t=no(Za.current),n=se(t,e.type);t!==n&&(Ti(eo,e),Ti(Za,n))}function oo(e){eo.current===e&&(Si(Za),Si(eo))}var uo=Ii(0);function so(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var co=[];function lo(){for(var e=0;e<co.length;e++)co[e]._workInProgressVersionPrimary=null;co.length=0}var fo=b.ReactCurrentDispatcher,ho=b.ReactCurrentBatchConfig,po=0,vo=null,yo=null,mo=null,go=!1,ko=!1,bo=0,wo=0;function _o(){throw Error(a(321))}function xo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ur(e[n],t[n]))return!1;return!0}function Io(e,t,n,r,i,o){if(po=o,vo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fo.current=null===e||null===e.memoizedState?uu:su,e=n(r,i),ko){o=0;do{if(ko=!1,bo=0,25<=o)throw Error(a(301));o+=1,mo=yo=null,t.updateQueue=null,fo.current=cu,e=n(r,i)}while(ko)}if(fo.current=ou,t=null!==yo&&null!==yo.next,po=0,mo=yo=vo=null,go=!1,t)throw Error(a(300));return e}function So(){var e=0!==bo;return bo=0,e}function To(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===mo?vo.memoizedState=mo=e:mo=mo.next=e,mo}function Eo(){if(null===yo){var e=vo.alternate;e=null!==e?e.memoizedState:null}else e=yo.next;var t=null===mo?vo.memoizedState:mo.next;if(null!==t)mo=t,yo=e;else{if(null===e)throw Error(a(310));e={memoizedState:(yo=e).memoizedState,baseState:yo.baseState,baseQueue:yo.baseQueue,queue:yo.queue,next:null},null===mo?vo.memoizedState=mo=e:mo=mo.next=e}return mo}function Co(e,t){return"function"===typeof t?t(e):t}function No(e){var t=Eo(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=yo,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var u=i.next;i.next=o.next,o.next=u}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var s=u=null,c=null,l=o;do{var f=l.lane;if((po&f)===f)null!==c&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var h={lane:f,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===c?(s=c=h,u=r):c=c.next=h,vo.lanes|=f,Ms|=f}l=l.next}while(null!==l&&l!==o);null===c?u=r:c.next=s,ur(r,t.memoizedState)||(bu=!0),t.memoizedState=r,t.baseState=u,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,vo.lanes|=o,Ms|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ro(e){var t=Eo(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var u=i=i.next;do{o=e(o,u.action),u=u.next}while(u!==i);ur(o,t.memoizedState)||(bu=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Ao(){}function Po(e,t){var n=vo,r=Eo(),i=t(),o=!ur(r.memoizedState,i);if(o&&(r.memoizedState=i,bu=!0),r=r.queue,Wo(Lo.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==mo&&1&mo.memoizedState.tag){if(n.flags|=2048,jo(9,Oo.bind(null,n,r,i,t),void 0,null),null===Ns)throw Error(a(349));0!==(30&po)||Do(n,t,i)}return i}function Do(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Oo(e,t,n,r){t.value=n,t.getSnapshot=r,Mo(t)&&Fo(e)}function Lo(e,t,n){return n((function(){Mo(t)&&Fo(e)}))}function Mo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ur(e,n)}catch(r){return!0}}function Fo(e){var t=Na(e,1);null!==t&&nc(t,e,1,-1)}function Uo(e){var t=To();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:e},t.queue=e,e=e.dispatch=nu.bind(null,vo,e),[t.memoizedState,e]}function jo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Vo(){return Eo().memoizedState}function qo(e,t,n,r){var i=To();vo.flags|=e,i.memoizedState=jo(1|t,n,void 0,void 0===r?null:r)}function Bo(e,t,n,r){var i=Eo();r=void 0===r?null:r;var a=void 0;if(null!==yo){var o=yo.memoizedState;if(a=o.destroy,null!==r&&xo(r,o.deps))return void(i.memoizedState=jo(t,n,a,r))}vo.flags|=e,i.memoizedState=jo(1|t,n,a,r)}function zo(e,t){return qo(8390656,8,e,t)}function Wo(e,t){return Bo(2048,8,e,t)}function Ko(e,t){return Bo(4,2,e,t)}function Ho(e,t){return Bo(4,4,e,t)}function Go(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Qo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Bo(4,4,Go.bind(null,t,e),n)}function $o(){}function Yo(e,t){var n=Eo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&xo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Xo(e,t){var n=Eo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&xo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Jo(e,t,n){return 0===(21&po)?(e.baseState&&(e.baseState=!1,bu=!0),e.memoizedState=n):(ur(n,t)||(n=vt(),vo.lanes|=n,Ms|=n,e.baseState=!0),t)}function Zo(e,t){var n=kt;kt=0!==n&&4>n?n:4,e(!0);var r=ho.transition;ho.transition={};try{e(!1),t()}finally{kt=n,ho.transition=r}}function eu(){return Eo().memoizedState}function tu(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ru(e))iu(t,n);else if(null!==(n=Ca(e,t,n,r))){nc(n,e,r,ec()),au(n,t,r)}}function nu(e,t,n){var r=tc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ru(e))iu(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,u=a(o,n);if(i.hasEagerState=!0,i.eagerState=u,ur(u,o)){var s=t.interleaved;return null===s?(i.next=i,Ea(t)):(i.next=s.next,s.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Ca(e,t,i,r))&&(nc(n,e,r,i=ec()),au(n,t,r))}}function ru(e){var t=e.alternate;return e===vo||null!==t&&t===vo}function iu(e,t){ko=go=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function au(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}var ou={readContext:Sa,useCallback:_o,useContext:_o,useEffect:_o,useImperativeHandle:_o,useInsertionEffect:_o,useLayoutEffect:_o,useMemo:_o,useReducer:_o,useRef:_o,useState:_o,useDebugValue:_o,useDeferredValue:_o,useTransition:_o,useMutableSource:_o,useSyncExternalStore:_o,useId:_o,unstable_isNewReconciler:!1},uu={readContext:Sa,useCallback:function(e,t){return To().memoizedState=[e,void 0===t?null:t],e},useContext:Sa,useEffect:zo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,qo(4194308,4,Go.bind(null,t,e),n)},useLayoutEffect:function(e,t){return qo(4194308,4,e,t)},useInsertionEffect:function(e,t){return qo(4,2,e,t)},useMemo:function(e,t){var n=To();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=To();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=tu.bind(null,vo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},To().memoizedState=e},useState:Uo,useDebugValue:$o,useDeferredValue:function(e){return To().memoizedState=e},useTransition:function(){var e=Uo(!1),t=e[0];return e=Zo.bind(null,e[1]),To().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=vo,i=To();if(ia){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Ns)throw Error(a(349));0!==(30&po)||Do(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,zo(Lo.bind(null,r,o,e),[e]),r.flags|=2048,jo(9,Oo.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=To(),t=Ns.identifierPrefix;if(ia){var n=Xi;t=":"+t+"R"+(n=(Yi&~(1<<32-ot(Yi)-1)).toString(32)+n),0<(n=bo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=wo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},su={readContext:Sa,useCallback:Yo,useContext:Sa,useEffect:Wo,useImperativeHandle:Qo,useInsertionEffect:Ko,useLayoutEffect:Ho,useMemo:Xo,useReducer:No,useRef:Vo,useState:function(){return No(Co)},useDebugValue:$o,useDeferredValue:function(e){return Jo(Eo(),yo.memoizedState,e)},useTransition:function(){return[No(Co)[0],Eo().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Po,useId:eu,unstable_isNewReconciler:!1},cu={readContext:Sa,useCallback:Yo,useContext:Sa,useEffect:Wo,useImperativeHandle:Qo,useInsertionEffect:Ko,useLayoutEffect:Ho,useMemo:Xo,useReducer:Ro,useRef:Vo,useState:function(){return Ro(Co)},useDebugValue:$o,useDeferredValue:function(e){var t=Eo();return null===yo?t.memoizedState=e:Jo(t,yo.memoizedState,e)},useTransition:function(){return[Ro(Co)[0],Eo().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Po,useId:eu,unstable_isNewReconciler:!1};function lu(e,t){try{var n="",r=t;do{n+=q(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i,digest:null}}function fu(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function hu(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var du="function"===typeof WeakMap?WeakMap:Map;function pu(e,t,n){(n=Da(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ws||(Ws=!0,Ks=r),hu(0,t)},n}function vu(e,t,n){(n=Da(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){hu(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){hu(0,t),"function"!==typeof r&&(null===Hs?Hs=new Set([this]):Hs.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function yu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new du;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Sc.bind(null,e,t,n),t.then(e,e))}function mu(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function gu(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Da(-1,1)).tag=2,Oa(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ku=b.ReactCurrentOwner,bu=!1;function wu(e,t,n,r){t.child=null===e?Xa(t,null,n,r):Ya(t,e.child,n,r)}function _u(e,t,n,r,i){n=n.render;var a=t.ref;return Ia(t,i),r=Io(e,t,n,r,a,i),n=So(),null===e||bu?(ia&&n&&ea(t),t.flags|=1,wu(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wu(e,t,i))}function xu(e,t,n,r,i){if(null===e){var a=n.type;return"function"!==typeof a||Pc(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Iu(e,t,a,r,i))}if(a=e.child,0===(e.lanes&i)){var o=a.memoizedProps;if((n=null!==(n=n.compare)?n:sr)(o,r)&&e.ref===t.ref)return Wu(e,t,i)}return t.flags|=1,(e=Dc(a,r)).ref=t.ref,e.return=t,t.child=e}function Iu(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if(sr(a,r)&&e.ref===t.ref){if(bu=!1,t.pendingProps=r=a,0===(e.lanes&i))return t.lanes=e.lanes,Wu(e,t,i);0!==(131072&e.flags)&&(bu=!0)}}return Eu(e,t,n,r,i)}function Su(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ti(Ds,Ps),Ps|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ti(Ds,Ps),Ps|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Ti(Ds,Ps),Ps|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Ti(Ds,Ps),Ps|=r;return wu(e,t,i,n),t.child}function Tu(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Eu(e,t,n,r,i){var a=Pi(n)?Ri:Ci.current;return a=Ai(t,a),Ia(t,i),n=Io(e,t,n,r,a,i),r=So(),null===e||bu?(ia&&r&&ea(t),t.flags|=1,wu(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wu(e,t,i))}function Cu(e,t,n,r,i){if(Pi(n)){var a=!0;Mi(t)}else a=!1;if(Ia(t,i),null===t.stateNode)zu(e,t),za(t,n,r),Ka(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,u=t.memoizedProps;o.props=u;var s=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Sa(c):c=Ai(t,c=Pi(n)?Ri:Ci.current);var l=n.getDerivedStateFromProps,f="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;f||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(u!==r||s!==c)&&Wa(t,o,r,c),Ra=!1;var h=t.memoizedState;o.state=h,Fa(t,r,o,i),s=t.memoizedState,u!==r||h!==s||Ni.current||Ra?("function"===typeof l&&(Va(t,n,l,r),s=t.memoizedState),(u=Ra||Ba(t,n,u,r,h,s,c))?(f||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=s),o.props=r,o.state=s,o.context=c,r=u):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Pa(e,t),u=t.memoizedProps,c=t.type===t.elementType?u:ya(t.type,u),o.props=c,f=t.pendingProps,h=o.context,"object"===typeof(s=n.contextType)&&null!==s?s=Sa(s):s=Ai(t,s=Pi(n)?Ri:Ci.current);var d=n.getDerivedStateFromProps;(l="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(u!==f||h!==s)&&Wa(t,o,r,s),Ra=!1,h=t.memoizedState,o.state=h,Fa(t,r,o,i);var p=t.memoizedState;u!==f||h!==p||Ni.current||Ra?("function"===typeof d&&(Va(t,n,d,r),p=t.memoizedState),(c=Ra||Ba(t,n,c,r,h,p,s)||!1)?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,s),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,s)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||u===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||u===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=s,r=c):("function"!==typeof o.componentDidUpdate||u===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||u===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Nu(e,t,n,r,a,i)}function Nu(e,t,n,r,i,a){Tu(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Fi(t,n,!1),Wu(e,t,a);r=t.stateNode,ku.current=t;var u=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Ya(t,e.child,null,a),t.child=Ya(t,null,u,a)):wu(e,t,u,a),t.memoizedState=r.state,i&&Fi(t,n,!0),t.child}function Ru(e){var t=e.stateNode;t.pendingContext?Oi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Oi(0,t.context,!1),ro(e,t.containerInfo)}function Au(e,t,n,r,i){return da(),pa(i),t.flags|=256,wu(e,t,n,r),t.child}var Pu,Du,Ou,Lu={dehydrated:null,treeContext:null,retryLane:0};function Mu(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fu(e,t,n){var r,i=t.pendingProps,o=uo.current,u=!1,s=0!==(128&t.flags);if((r=s)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(u=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ti(uo,1&o),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(s=i.children,e=i.fallback,u?(i=t.mode,u=t.child,s={mode:"hidden",children:s},0===(1&i)&&null!==u?(u.childLanes=0,u.pendingProps=s):u=Mc(s,i,0,null),e=Lc(e,i,n,null),u.return=t,e.return=t,u.sibling=e,t.child=u,t.child.memoizedState=Mu(n),t.memoizedState=Lu,e):Uu(t,s));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,u){if(n)return 256&t.flags?(t.flags&=-257,ju(e,t,u,r=fu(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Mc({mode:"visible",children:r.children},i,0,null),(o=Lc(o,i,u,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&Ya(t,e.child,null,u),t.child.memoizedState=Mu(u),t.memoizedState=Lu,o);if(0===(1&t.mode))return ju(e,t,u,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var s=r.dgst;return r=s,ju(e,t,u,r=fu(o=Error(a(419)),r,void 0))}if(s=0!==(u&e.childLanes),bu||s){if(null!==(r=Ns)){switch(u&-u){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|u))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Na(e,i),nc(r,e,i,-1))}return vc(),ju(e,t,u,r=fu(Error(a(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Ec.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,ra=ci(i.nextSibling),na=t,ia=!0,aa=null,null!==e&&(Gi[Qi++]=Yi,Gi[Qi++]=Xi,Gi[Qi++]=$i,Yi=e.id,Xi=e.overflow,$i=t),t=Uu(t,r.children),t.flags|=4096,t)}(e,t,s,i,r,o,n);if(u){u=i.fallback,s=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&s)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Dc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?u=Dc(r,u):(u=Lc(u,s,n,null)).flags|=2,u.return=t,i.return=t,i.sibling=u,t.child=i,i=u,u=t.child,s=null===(s=e.child.memoizedState)?Mu(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},u.memoizedState=s,u.childLanes=e.childLanes&~n,t.memoizedState=Lu,i}return e=(u=e.child).sibling,i=Dc(u,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Uu(e,t){return(t=Mc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function ju(e,t,n,r){return null!==r&&pa(r),Ya(t,e.child,null,n),(e=Uu(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Vu(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),xa(e.return,t,n)}function qu(e,t,n,r,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Bu(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(wu(e,t,r.children,n),0!==(2&(r=uo.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Vu(e,n,t);else if(19===e.tag)Vu(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ti(uo,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===so(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),qu(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===so(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}qu(t,!0,n,null,a);break;case"together":qu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function zu(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wu(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ms|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Dc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Dc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ku(e,t){if(!ia)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Hu(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Gu(e,t,n){var r=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hu(t),null;case 1:case 17:return Pi(t.type)&&Di(),Hu(t),null;case 3:return r=t.stateNode,io(),Si(Ni),Si(Ci),lo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(fa(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(oc(aa),aa=null))),Hu(t),null;case 5:oo(t);var i=no(to.current);if(n=t.type,null!==e&&null!=t.stateNode)Du(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Hu(t),null}if(e=no(Za.current),fa(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[hi]=t,r[di]=o,e=0!==(1&t.mode),n){case"dialog":jr("cancel",r),jr("close",r);break;case"iframe":case"object":case"embed":jr("load",r);break;case"video":case"audio":for(i=0;i<Lr.length;i++)jr(Lr[i],r);break;case"source":jr("error",r);break;case"img":case"image":case"link":jr("error",r),jr("load",r);break;case"details":jr("toggle",r);break;case"input":Y(r,o),jr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},jr("invalid",r);break;case"textarea":ie(r,o),jr("invalid",r)}for(var s in ge(n,o),i=null,o)if(o.hasOwnProperty(s)){var c=o[s];"children"===s?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,c,e),i=["children",""+c]):u.hasOwnProperty(s)&&null!=c&&"onScroll"===s&&jr("scroll",r)}switch(n){case"input":H(r),Z(r,o,!0);break;case"textarea":H(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{s=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ue(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=s.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),"select"===n&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[hi]=t,e[di]=r,Pu(e,t),t.stateNode=e;e:{switch(s=ke(n,r),n){case"dialog":jr("cancel",e),jr("close",e),i=r;break;case"iframe":case"object":case"embed":jr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Lr.length;i++)jr(Lr[i],e);i=r;break;case"source":jr("error",e),i=r;break;case"img":case"image":case"link":jr("error",e),jr("load",e),i=r;break;case"details":jr("toggle",e),i=r;break;case"input":Y(e,r),i=$(e,r),jr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=F({},r,{value:void 0}),jr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),jr("invalid",e)}for(o in ge(n,i),c=i)if(c.hasOwnProperty(o)){var l=c[o];"style"===o?ye(e,l):"dangerouslySetInnerHTML"===o?null!=(l=l?l.__html:void 0)&&fe(e,l):"children"===o?"string"===typeof l?("textarea"!==n||""!==l)&&he(e,l):"number"===typeof l&&he(e,""+l):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(u.hasOwnProperty(o)?null!=l&&"onScroll"===o&&jr("scroll",e):null!=l&&k(e,o,l,s))}switch(n){case"input":H(e),Z(e,r,!1);break;case"textarea":H(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Hu(t),null;case 6:if(e&&null!=t.stateNode)Ou(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=no(to.current),no(Za.current),fa(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(o=r.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return Hu(t),null;case 13:if(Si(uo),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ia&&null!==ra&&0!==(1&t.mode)&&0===(128&t.flags))ha(),da(),t.flags|=98560,o=!1;else if(o=fa(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(a(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(a(317));o[hi]=t}else da(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Hu(t),o=!1}else null!==aa&&(oc(aa),aa=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&uo.current)?0===Os&&(Os=3):vc())),null!==t.updateQueue&&(t.flags|=4),Hu(t),null);case 4:return io(),null===e&&Br(t.stateNode.containerInfo),Hu(t),null;case 10:return _a(t.type._context),Hu(t),null;case 19:if(Si(uo),null===(o=t.memoizedState))return Hu(t),null;if(r=0!==(128&t.flags),null===(s=o.rendering))if(r)Ku(o,!1);else{if(0!==Os||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=so(e))){for(t.flags|=128,Ku(o,!1),null!==(r=s.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(s=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ti(uo,1&uo.current|2),t.child}e=e.sibling}null!==o.tail&&Xe()>Bs&&(t.flags|=128,r=!0,Ku(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=so(s))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ku(o,!0),null===o.tail&&"hidden"===o.tailMode&&!s.alternate&&!ia)return Hu(t),null}else 2*Xe()-o.renderingStartTime>Bs&&1073741824!==n&&(t.flags|=128,r=!0,Ku(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(null!==(n=o.last)?n.sibling=s:t.child=s,o.last=s)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Xe(),t.sibling=null,n=uo.current,Ti(uo,r?1&n|2:1&n),t):(Hu(t),null);case 22:case 23:return fc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Ps)&&(Hu(t),6&t.subtreeFlags&&(t.flags|=8192)):Hu(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Qu(e,t){switch(ta(t),t.tag){case 1:return Pi(t.type)&&Di(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return io(),Si(Ni),Si(Ci),lo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(Si(uo),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));da()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Si(uo),null;case 4:return io(),null;case 10:return _a(t.type._context),null;case 22:case 23:return fc(),null;default:return null}}Pu=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Du=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,no(Za.current);var a,o=null;switch(n){case"input":i=$(e,i),r=$(e,r),o=[];break;case"select":i=F({},i,{value:void 0}),r=F({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(l in ge(n,r),n=null,i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&null!=i[l])if("style"===l){var s=i[l];for(a in s)s.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(u.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var c=r[l];if(s=null!=i?i[l]:void 0,r.hasOwnProperty(l)&&c!==s&&(null!=c||null!=s))if("style"===l)if(s){for(a in s)!s.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&s[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(o||(o=[]),o.push(l,n)),n=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,s=s?s.__html:void 0,null!=c&&s!==c&&(o=o||[]).push(l,c)):"children"===l?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(u.hasOwnProperty(l)?(null!=c&&"onScroll"===l&&jr("scroll",e),o||s===c||(o=[])):(o=o||[]).push(l,c))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}},Ou=function(e,t,n,r){n!==r&&(t.flags|=4)};var $u=!1,Yu=!1,Xu="function"===typeof WeakSet?WeakSet:Set,Ju=null;function Zu(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Ic(e,t,r)}else n.current=null}function es(e,t,n){try{n()}catch(r){Ic(e,t,r)}}var ts=!1;function ns(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&es(t,n,a)}i=i.next}while(i!==r)}}function rs(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function is(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function as(e){var t=e.alternate;null!==t&&(e.alternate=null,as(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[di],delete t[vi],delete t[yi],delete t[mi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function os(e){return 5===e.tag||3===e.tag||4===e.tag}function us(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||os(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ss(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ss(e,t,n),e=e.sibling;null!==e;)ss(e,t,n),e=e.sibling}function cs(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cs(e,t,n),e=e.sibling;null!==e;)cs(e,t,n),e=e.sibling}var ls=null,fs=!1;function hs(e,t,n){for(n=n.child;null!==n;)ds(e,t,n),n=n.sibling}function ds(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(it,n)}catch(u){}switch(n.tag){case 5:Yu||Zu(n,t);case 6:var r=ls,i=fs;ls=null,hs(e,t,n),fs=i,null!==(ls=r)&&(fs?(e=ls,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ls.removeChild(n.stateNode));break;case 18:null!==ls&&(fs?(e=ls,n=n.stateNode,8===e.nodeType?si(e.parentNode,n):1===e.nodeType&&si(e,n),Bt(e)):si(ls,n.stateNode));break;case 4:r=ls,i=fs,ls=n.stateNode.containerInfo,fs=!0,hs(e,t,n),ls=r,fs=i;break;case 0:case 11:case 14:case 15:if(!Yu&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,void 0!==o&&(0!==(2&a)||0!==(4&a))&&es(n,t,o),i=i.next}while(i!==r)}hs(e,t,n);break;case 1:if(!Yu&&(Zu(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){Ic(n,t,u)}hs(e,t,n);break;case 21:hs(e,t,n);break;case 22:1&n.mode?(Yu=(r=Yu)||null!==n.memoizedState,hs(e,t,n),Yu=r):hs(e,t,n);break;default:hs(e,t,n)}}function ps(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xu),t.forEach((function(t){var r=Cc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function vs(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,u=t,s=u;e:for(;null!==s;){switch(s.tag){case 5:ls=s.stateNode,fs=!1;break e;case 3:case 4:ls=s.stateNode.containerInfo,fs=!0;break e}s=s.return}if(null===ls)throw Error(a(160));ds(o,u,i),ls=null,fs=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(l){Ic(i,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ys(t,e),t=t.sibling}function ys(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(vs(t,e),ms(e),4&r){try{ns(3,e,e.return),rs(3,e)}catch(y){Ic(e,e.return,y)}try{ns(5,e,e.return)}catch(y){Ic(e,e.return,y)}}break;case 1:vs(t,e),ms(e),512&r&&null!==n&&Zu(n,n.return);break;case 5:if(vs(t,e),ms(e),512&r&&null!==n&&Zu(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(y){Ic(e,e.return,y)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,u=null!==n?n.memoizedProps:o,s=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===s&&"radio"===o.type&&null!=o.name&&X(i,o),ke(s,u);var l=ke(s,o);for(u=0;u<c.length;u+=2){var f=c[u],h=c[u+1];"style"===f?ye(i,h):"dangerouslySetInnerHTML"===f?fe(i,h):"children"===f?he(i,h):k(i,f,h,l)}switch(s){case"input":J(i,o);break;case"textarea":ae(i,o);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(i,!!o.multiple,p,!1):d!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[di]=o}catch(y){Ic(e,e.return,y)}}break;case 6:if(vs(t,e),ms(e),4&r){if(null===e.stateNode)throw Error(a(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(y){Ic(e,e.return,y)}}break;case 3:if(vs(t,e),ms(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(y){Ic(e,e.return,y)}break;case 4:default:vs(t,e),ms(e);break;case 13:vs(t,e),ms(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(qs=Xe())),4&r&&ps(e);break;case 22:if(f=null!==n&&null!==n.memoizedState,1&e.mode?(Yu=(l=Yu)||f,vs(t,e),Yu=l):vs(t,e),ms(e),8192&r){if(l=null!==e.memoizedState,(e.stateNode.isHidden=l)&&!f&&0!==(1&e.mode))for(Ju=e,f=e.child;null!==f;){for(h=Ju=f;null!==Ju;){switch(p=(d=Ju).child,d.tag){case 0:case 11:case 14:case 15:ns(4,d,d.return);break;case 1:Zu(d,d.return);var v=d.stateNode;if("function"===typeof v.componentWillUnmount){r=d,n=d.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(y){Ic(r,n,y)}}break;case 5:Zu(d,d.return);break;case 22:if(null!==d.memoizedState){ws(h);continue}}null!==p?(p.return=d,Ju=p):ws(h)}f=f.sibling}e:for(f=null,h=e;;){if(5===h.tag){if(null===f){f=h;try{i=h.stateNode,l?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(s=h.stateNode,u=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,s.style.display=ve("display",u))}catch(y){Ic(e,e.return,y)}}}else if(6===h.tag){if(null===f)try{h.stateNode.nodeValue=l?"":h.memoizedProps}catch(y){Ic(e,e.return,y)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:vs(t,e),ms(e),4&r&&ps(e);case 21:}}function ms(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(os(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),cs(e,us(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;ss(e,us(e),o);break;default:throw Error(a(161))}}catch(u){Ic(e,e.return,u)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function gs(e,t,n){Ju=e,ks(e,t,n)}function ks(e,t,n){for(var r=0!==(1&e.mode);null!==Ju;){var i=Ju,a=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||$u;if(!o){var u=i.alternate,s=null!==u&&null!==u.memoizedState||Yu;u=$u;var c=Yu;if($u=o,(Yu=s)&&!c)for(Ju=i;null!==Ju;)s=(o=Ju).child,22===o.tag&&null!==o.memoizedState?_s(i):null!==s?(s.return=o,Ju=s):_s(i);for(;null!==a;)Ju=a,ks(a,t,n),a=a.sibling;Ju=i,$u=u,Yu=c}bs(e)}else 0!==(8772&i.subtreeFlags)&&null!==a?(a.return=i,Ju=a):bs(e)}}function bs(e){for(;null!==Ju;){var t=Ju;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Yu||rs(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Yu)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:ya(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Ua(t,o,r);break;case 3:var u=t.updateQueue;if(null!==u){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ua(t,u,n)}break;case 5:var s=t.stateNode;if(null===n&&4&t.flags){n=s;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var f=l.memoizedState;if(null!==f){var h=f.dehydrated;null!==h&&Bt(h)}}}break;default:throw Error(a(163))}Yu||512&t.flags&&is(t)}catch(d){Ic(t,t.return,d)}}if(t===e){Ju=null;break}if(null!==(n=t.sibling)){n.return=t.return,Ju=n;break}Ju=t.return}}function ws(e){for(;null!==Ju;){var t=Ju;if(t===e){Ju=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Ju=n;break}Ju=t.return}}function _s(e){for(;null!==Ju;){var t=Ju;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rs(4,t)}catch(s){Ic(t,n,s)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(s){Ic(t,i,s)}}var a=t.return;try{is(t)}catch(s){Ic(t,a,s)}break;case 5:var o=t.return;try{is(t)}catch(s){Ic(t,o,s)}}}catch(s){Ic(t,t.return,s)}if(t===e){Ju=null;break}var u=t.sibling;if(null!==u){u.return=t.return,Ju=u;break}Ju=t.return}}var xs,Is=Math.ceil,Ss=b.ReactCurrentDispatcher,Ts=b.ReactCurrentOwner,Es=b.ReactCurrentBatchConfig,Cs=0,Ns=null,Rs=null,As=0,Ps=0,Ds=Ii(0),Os=0,Ls=null,Ms=0,Fs=0,Us=0,js=null,Vs=null,qs=0,Bs=1/0,zs=null,Ws=!1,Ks=null,Hs=null,Gs=!1,Qs=null,$s=0,Ys=0,Xs=null,Js=-1,Zs=0;function ec(){return 0!==(6&Cs)?Xe():-1!==Js?Js:Js=Xe()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Cs)&&0!==As?As&-As:null!==va.transition?(0===Zs&&(Zs=vt()),Zs):0!==(e=kt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function nc(e,t,n,r){if(50<Ys)throw Ys=0,Xs=null,Error(a(185));mt(e,n,r),0!==(2&Cs)&&e===Ns||(e===Ns&&(0===(2&Cs)&&(Fs|=n),4===Os&&uc(e,As)),rc(e,r),1===n&&0===Cs&&0===(1&t.mode)&&(Bs=Xe()+500,ji&&Bi()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-ot(a),u=1<<o,s=i[o];-1===s?0!==(u&n)&&0===(u&r)||(i[o]=dt(u,t)):s<=t&&(e.expiredLanes|=u),a&=~u}}(e,t);var r=ht(e,e===Ns?As:0);if(0===r)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){ji=!0,qi(e)}(sc.bind(null,e)):qi(sc.bind(null,e)),oi((function(){0===(6&Cs)&&Bi()})),n=null;else{switch(bt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Nc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if(Js=-1,Zs=0,0!==(6&Cs))throw Error(a(327));var n=e.callbackNode;if(_c()&&e.callbackNode!==n)return null;var r=ht(e,e===Ns?As:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=yc(e,r);else{t=r;var i=Cs;Cs|=2;var o=pc();for(Ns===e&&As===t||(zs=null,Bs=Xe()+500,hc(e,t));;)try{gc();break}catch(s){dc(e,s)}wa(),Ss.current=o,Cs=i,null!==Rs?t=0:(Ns=null,As=0,t=Os)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=ac(e,i))),1===t)throw n=Ls,hc(e,0),uc(e,r),rc(e,Xe()),n;if(6===t)uc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!ur(a(),i))return!1}catch(u){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=yc(e,r))&&(0!==(o=pt(e))&&(r=o,t=ac(e,o))),1===t))throw n=Ls,hc(e,0),uc(e,r),rc(e,Xe()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:wc(e,Vs,zs);break;case 3:if(uc(e,r),(130023424&r)===r&&10<(t=qs+500-Xe())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(wc.bind(null,e,Vs,zs),t);break}wc(e,Vs,zs);break;case 4:if(uc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var u=31-ot(r);o=1<<u,(u=t[u])>i&&(i=u),r&=~o}if(r=i,10<(r=(120>(r=Xe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Is(r/1960))-r)){e.timeoutHandle=ri(wc.bind(null,e,Vs,zs),r);break}wc(e,Vs,zs);break;default:throw Error(a(329))}}}return rc(e,Xe()),e.callbackNode===n?ic.bind(null,e):null}function ac(e,t){var n=js;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=yc(e,t))&&(t=Vs,Vs=n,null!==t&&oc(t)),e}function oc(e){null===Vs?Vs=e:Vs.push.apply(Vs,e)}function uc(e,t){for(t&=~Us,t&=~Fs,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function sc(e){if(0!==(6&Cs))throw Error(a(327));_c();var t=ht(e,0);if(0===(1&t))return rc(e,Xe()),null;var n=yc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=ac(e,r))}if(1===n)throw n=Ls,hc(e,0),uc(e,t),rc(e,Xe()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Vs,zs),rc(e,Xe()),null}function cc(e,t){var n=Cs;Cs|=1;try{return e(t)}finally{0===(Cs=n)&&(Bs=Xe()+500,ji&&Bi())}}function lc(e){null!==Qs&&0===Qs.tag&&0===(6&Cs)&&_c();var t=Cs;Cs|=1;var n=Es.transition,r=kt;try{if(Es.transition=null,kt=1,e)return e()}finally{kt=r,Es.transition=n,0===(6&(Cs=t))&&Bi()}}function fc(){Ps=Ds.current,Si(Ds)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Rs)for(n=Rs.return;null!==n;){var r=n;switch(ta(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Di();break;case 3:io(),Si(Ni),Si(Ci),lo();break;case 5:oo(r);break;case 4:io();break;case 13:case 19:Si(uo);break;case 10:_a(r.type._context);break;case 22:case 23:fc()}n=n.return}if(Ns=e,Rs=e=Dc(e.current,null),As=Ps=t,Os=0,Ls=null,Us=Fs=Ms=0,Vs=js=null,null!==Ta){for(t=0;t<Ta.length;t++)if(null!==(r=(n=Ta[t]).interleaved)){n.interleaved=null;var i=r.next,a=n.pending;if(null!==a){var o=a.next;a.next=i,r.next=o}n.pending=r}Ta=null}return e}function dc(e,t){for(;;){var n=Rs;try{if(wa(),fo.current=ou,go){for(var r=vo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}go=!1}if(po=0,mo=yo=vo=null,ko=!1,bo=0,Ts.current=null,null===n||null===n.return){Os=1,Ls=t,Rs=null;break}e:{var o=e,u=n.return,s=n,c=t;if(t=As,s.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c,f=s,h=f.tag;if(0===(1&f.mode)&&(0===h||11===h||15===h)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=mu(u);if(null!==p){p.flags&=-257,gu(p,u,s,0,t),1&p.mode&&yu(o,l,t),c=l;var v=(t=p).updateQueue;if(null===v){var y=new Set;y.add(c),t.updateQueue=y}else v.add(c);break e}if(0===(1&t)){yu(o,l,t),vc();break e}c=Error(a(426))}else if(ia&&1&s.mode){var m=mu(u);if(null!==m){0===(65536&m.flags)&&(m.flags|=256),gu(m,u,s,0,t),pa(lu(c,s));break e}}o=c=lu(c,s),4!==Os&&(Os=2),null===js?js=[o]:js.push(o),o=u;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Ma(o,pu(0,c,t));break e;case 1:s=c;var g=o.type,k=o.stateNode;if(0===(128&o.flags)&&("function"===typeof g.getDerivedStateFromError||null!==k&&"function"===typeof k.componentDidCatch&&(null===Hs||!Hs.has(k)))){o.flags|=65536,t&=-t,o.lanes|=t,Ma(o,vu(o,s,t));break e}}o=o.return}while(null!==o)}bc(n)}catch(b){t=b,Rs===n&&null!==n&&(Rs=n=n.return);continue}break}}function pc(){var e=Ss.current;return Ss.current=ou,null===e?ou:e}function vc(){0!==Os&&3!==Os&&2!==Os||(Os=4),null===Ns||0===(268435455&Ms)&&0===(268435455&Fs)||uc(Ns,As)}function yc(e,t){var n=Cs;Cs|=2;var r=pc();for(Ns===e&&As===t||(zs=null,hc(e,t));;)try{mc();break}catch(i){dc(e,i)}if(wa(),Cs=n,Ss.current=r,null!==Rs)throw Error(a(261));return Ns=null,As=0,Os}function mc(){for(;null!==Rs;)kc(Rs)}function gc(){for(;null!==Rs&&!$e();)kc(Rs)}function kc(e){var t=xs(e.alternate,e,Ps);e.memoizedProps=e.pendingProps,null===t?bc(e):Rs=t,Ts.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Gu(n,t,Ps)))return void(Rs=n)}else{if(null!==(n=Qu(n,t)))return n.flags&=32767,void(Rs=n);if(null===e)return Os=6,void(Rs=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Rs=t);Rs=t=e}while(null!==t);0===Os&&(Os=5)}function wc(e,t,n){var r=kt,i=Es.transition;try{Es.transition=null,kt=1,function(e,t,n,r){do{_c()}while(null!==Qs);if(0!==(6&Cs))throw Error(a(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}(e,o),e===Ns&&(Rs=Ns=null,As=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Gs||(Gs=!0,Nc(tt,(function(){return _c(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Es.transition,Es.transition=null;var u=kt;kt=1;var s=Cs;Cs|=4,Ts.current=null,function(e,t){if(ei=Wt,dr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(w){n=null;break e}var u=0,s=-1,c=-1,l=0,f=0,h=e,d=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(s=u+i),h!==o||0!==r&&3!==h.nodeType||(c=u+r),3===h.nodeType&&(u+=h.nodeValue.length),null!==(p=h.firstChild);)d=h,h=p;for(;;){if(h===e)break t;if(d===n&&++l===i&&(s=u),d===o&&++f===r&&(c=u),null!==(p=h.nextSibling))break;d=(h=d).parentNode}h=p}n=-1===s||-1===c?null:{start:s,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Wt=!1,Ju=t;null!==Ju;)if(e=(t=Ju).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ju=e;else for(;null!==Ju;){t=Ju;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var y=v.memoizedProps,m=v.memoizedState,g=t.stateNode,k=g.getSnapshotBeforeUpdate(t.elementType===t.type?y:ya(t.type,y),m);g.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(a(163))}}catch(w){Ic(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Ju=e;break}Ju=t.return}v=ts,ts=!1}(e,n),ys(n,e),pr(ti),Wt=!!ei,ti=ei=null,e.current=n,gs(n,e,i),Ye(),Cs=s,kt=u,Es.transition=o}else e.current=n;if(Gs&&(Gs=!1,Qs=e,$s=i),o=e.pendingLanes,0===o&&(Hs=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Xe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Ws)throw Ws=!1,e=Ks,Ks=null,e;0!==(1&$s)&&0!==e.tag&&_c(),o=e.pendingLanes,0!==(1&o)?e===Xs?Ys++:(Ys=0,Xs=e):Ys=0,Bi()}(e,t,n,r)}finally{Es.transition=i,kt=r}return null}function _c(){if(null!==Qs){var e=bt($s),t=Es.transition,n=kt;try{if(Es.transition=null,kt=16>e?16:e,null===Qs)var r=!1;else{if(e=Qs,Qs=null,$s=0,0!==(6&Cs))throw Error(a(331));var i=Cs;for(Cs|=4,Ju=e.current;null!==Ju;){var o=Ju,u=o.child;if(0!==(16&Ju.flags)){var s=o.deletions;if(null!==s){for(var c=0;c<s.length;c++){var l=s[c];for(Ju=l;null!==Ju;){var f=Ju;switch(f.tag){case 0:case 11:case 15:ns(8,f,o)}var h=f.child;if(null!==h)h.return=f,Ju=h;else for(;null!==Ju;){var d=(f=Ju).sibling,p=f.return;if(as(f),f===l){Ju=null;break}if(null!==d){d.return=p,Ju=d;break}Ju=p}}}var v=o.alternate;if(null!==v){var y=v.child;if(null!==y){v.child=null;do{var m=y.sibling;y.sibling=null,y=m}while(null!==y)}}Ju=o}}if(0!==(2064&o.subtreeFlags)&&null!==u)u.return=o,Ju=u;else e:for(;null!==Ju;){if(0!==(2048&(o=Ju).flags))switch(o.tag){case 0:case 11:case 15:ns(9,o,o.return)}var g=o.sibling;if(null!==g){g.return=o.return,Ju=g;break e}Ju=o.return}}var k=e.current;for(Ju=k;null!==Ju;){var b=(u=Ju).child;if(0!==(2064&u.subtreeFlags)&&null!==b)b.return=u,Ju=b;else e:for(u=k;null!==Ju;){if(0!==(2048&(s=Ju).flags))try{switch(s.tag){case 0:case 11:case 15:rs(9,s)}}catch(_){Ic(s,s.return,_)}if(s===u){Ju=null;break e}var w=s.sibling;if(null!==w){w.return=s.return,Ju=w;break e}Ju=s.return}}if(Cs=i,Bi(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(it,e)}catch(_){}r=!0}return r}finally{kt=n,Es.transition=t}}return!1}function xc(e,t,n){e=Oa(e,t=pu(0,t=lu(n,t),1),1),t=ec(),null!==e&&(mt(e,1,t),rc(e,t))}function Ic(e,t,n){if(3===e.tag)xc(e,e,n);else for(;null!==t;){if(3===t.tag){xc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Hs||!Hs.has(r))){t=Oa(t,e=vu(t,e=lu(n,e),1),1),e=ec(),null!==t&&(mt(t,1,e),rc(t,e));break}}t=t.return}}function Sc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Ns===e&&(As&n)===n&&(4===Os||3===Os&&(130023424&As)===As&&500>Xe()-qs?hc(e,0):Us|=n),rc(e,t)}function Tc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=ec();null!==(e=Na(e,t))&&(mt(e,t,n),rc(e,n))}function Ec(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Tc(e,n)}function Cc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Tc(e,n)}function Nc(e,t){return Ge(e,t)}function Rc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ac(e,t,n,r){return new Rc(e,t,n,r)}function Pc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dc(e,t){var n=e.alternate;return null===n?((n=Ac(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,r,i,o){var u=2;if(r=e,"function"===typeof e)Pc(e)&&(u=1);else if("string"===typeof e)u=5;else e:switch(e){case x:return Lc(n.children,i,o,t);case I:u=8,i|=8;break;case S:return(e=Ac(12,n,t,2|i)).elementType=S,e.lanes=o,e;case N:return(e=Ac(13,n,t,i)).elementType=N,e.lanes=o,e;case R:return(e=Ac(19,n,t,i)).elementType=R,e.lanes=o,e;case D:return Mc(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:u=10;break e;case E:u=9;break e;case C:u=11;break e;case A:u=14;break e;case P:u=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Ac(u,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Lc(e,t,n,r){return(e=Ac(7,e,r,t)).lanes=n,e}function Mc(e,t,n,r){return(e=Ac(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Fc(e,t,n){return(e=Ac(6,e,null,t)).lanes=n,e}function Uc(e,t,n){return(t=Ac(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function jc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yt(0),this.expirationTimes=yt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Vc(e,t,n,r,i,a,o,u,s){return e=new jc(e,t,n,u,s),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Ac(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Aa(a),e}function qc(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Bc(e){if(!e)return Ei;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Pi(n))return Li(e,n,t)}return t}function zc(e,t,n,r,i,a,o,u,s){return(e=Vc(n,r,!0,e,0,a,0,u,s)).context=Bc(null),n=e.current,(a=Da(r=ec(),i=tc(n))).callback=void 0!==t&&null!==t?t:null,Oa(n,a,i),e.current.lanes=i,mt(e,i,r),rc(e,r),e}function Wc(e,t,n,r){var i=t.current,a=ec(),o=tc(i);return n=Bc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Da(a,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Oa(i,t,o))&&(nc(e,i,o,a),La(e,i,o)),o}function Kc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Gc(e,t){Hc(e,t),(e=e.alternate)&&Hc(e,t)}xs=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ni.current)bu=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bu=!1,function(e,t,n){switch(t.tag){case 3:Ru(t),da();break;case 5:ao(t);break;case 1:Pi(t.type)&&Mi(t);break;case 4:ro(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ti(ma,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ti(uo,1&uo.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Fu(e,t,n):(Ti(uo,1&uo.current),null!==(e=Wu(e,t,n))?e.sibling:null);Ti(uo,1&uo.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Bu(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ti(uo,uo.current),r)break;return null;case 22:case 23:return t.lanes=0,Su(e,t,n)}return Wu(e,t,n)}(e,t,n);bu=0!==(131072&e.flags)}else bu=!1,ia&&0!==(1048576&t.flags)&&Zi(t,Hi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;zu(e,t),e=t.pendingProps;var i=Ai(t,Ci.current);Ia(t,n),i=Io(null,t,r,e,i,n);var o=So();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pi(r)?(o=!0,Mi(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Aa(t),i.updater=qa,t.stateNode=i,i._reactInternals=t,Ka(t,r,e,n),t=Nu(null,t,r,!0,o,n)):(t.tag=0,ia&&o&&ea(t),wu(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(zu(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Pc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===A)return 14}return 2}(r),e=ya(r,e),i){case 0:t=Eu(null,t,r,e,n);break e;case 1:t=Cu(null,t,r,e,n);break e;case 11:t=_u(null,t,r,e,n);break e;case 14:t=xu(null,t,r,ya(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Eu(e,t,r,i=t.elementType===r?i:ya(r,i),n);case 1:return r=t.type,i=t.pendingProps,Cu(e,t,r,i=t.elementType===r?i:ya(r,i),n);case 3:e:{if(Ru(t),null===e)throw Error(a(387));r=t.pendingProps,i=(o=t.memoizedState).element,Pa(e,t),Fa(t,r,null,n);var u=t.memoizedState;if(r=u.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:u.cache,pendingSuspenseBoundaries:u.pendingSuspenseBoundaries,transitions:u.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Au(e,t,r,n,i=lu(Error(a(423)),t));break e}if(r!==i){t=Au(e,t,r,n,i=lu(Error(a(424)),t));break e}for(ra=ci(t.stateNode.containerInfo.firstChild),na=t,ia=!0,aa=null,n=Xa(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(da(),r===i){t=Wu(e,t,n);break e}wu(e,t,r,n)}t=t.child}return t;case 5:return ao(t),null===e&&ca(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,u=i.children,ni(r,i)?u=null:null!==o&&ni(r,o)&&(t.flags|=32),Tu(e,t),wu(e,t,u,n),t.child;case 6:return null===e&&ca(t),null;case 13:return Fu(e,t,n);case 4:return ro(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ya(t,null,r,n):wu(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,_u(e,t,r,i=t.elementType===r?i:ya(r,i),n);case 7:return wu(e,t,t.pendingProps,n),t.child;case 8:case 12:return wu(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,u=i.value,Ti(ma,r._currentValue),r._currentValue=u,null!==o)if(ur(o.value,u)){if(o.children===i.children&&!Ni.current){t=Wu(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var s=o.dependencies;if(null!==s){u=o.child;for(var c=s.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Da(-1,n&-n)).tag=2;var l=o.updateQueue;if(null!==l){var f=(l=l.shared).pending;null===f?c.next=c:(c.next=f.next,f.next=c),l.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),xa(o.return,n,t),s.lanes|=n;break}c=c.next}}else if(10===o.tag)u=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(u=o.return))throw Error(a(341));u.lanes|=n,null!==(s=u.alternate)&&(s.lanes|=n),xa(u,n,t),u=o.sibling}else u=o.child;if(null!==u)u.return=o;else for(u=o;null!==u;){if(u===t){u=null;break}if(null!==(o=u.sibling)){o.return=u.return,u=o;break}u=u.return}o=u}wu(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ia(t,n),r=r(i=Sa(i)),t.flags|=1,wu(e,t,r,n),t.child;case 14:return i=ya(r=t.type,t.pendingProps),xu(e,t,r,i=ya(r.type,i),n);case 15:return Iu(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ya(r,i),zu(e,t),t.tag=1,Pi(r)?(e=!0,Mi(t)):e=!1,Ia(t,n),za(t,r,i),Ka(t,r,i,n),Nu(null,t,r,!0,e,n);case 19:return Bu(e,t,n);case 22:return Su(e,t,n)}throw Error(a(156,t.tag))};var Qc="function"===typeof reportError?reportError:function(e){console.error(e)};function $c(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function el(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if("function"===typeof i){var u=i;i=function(){var e=Kc(o);u.call(e)}}Wc(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var a=r;r=function(){var e=Kc(o);a.call(e)}}var o=zc(t,r,e,0,null,!1,0,"",Zc);return e._reactRootContainer=o,e[pi]=o.current,Br(8===e.nodeType?e.parentNode:e),lc(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var u=r;r=function(){var e=Kc(s);u.call(e)}}var s=Vc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=s,e[pi]=s.current,Br(8===e.nodeType?e.parentNode:e),lc((function(){Wc(t,s,n,r)})),s}(n,t,e,i,r);return Kc(o)}Yc.prototype.render=$c.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Wc(e,t,null,null)},Yc.prototype.unmount=$c.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;lc((function(){Wc(null,e,null,null)})),t[pi]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=It();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Ft(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ft(t.pendingLanes);0!==n&&(gt(t,1|n),rc(t,Xe()),0===(6&Cs)&&(Bs=Xe()+500,Bi()))}break;case 13:lc((function(){var t=Na(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),Gc(e,1)}},_t=function(e){if(13===e.tag){var t=Na(e,134217728);if(null!==t)nc(t,e,134217728,ec());Gc(e,134217728)}},xt=function(e){if(13===e.tag){var t=tc(e),n=Na(e,t);if(null!==n)nc(n,e,t,ec());Gc(e,t)}},It=function(){return kt},St=function(e,t){var n=kt;try{return kt=e,t()}finally{kt=n}},_e=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=wi(r);if(!i)throw Error(a(90));G(r),J(r,i)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ce=cc,Ne=lc;var tl={usingClientEntryPoint:!1,Events:[ki,bi,wi,Te,Ee,cc]},nl={findFiberByHostInstance:gi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rl={bundleType:nl.bundleType,version:nl.version,rendererPackageName:nl.rendererPackageName,rendererConfig:nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ke(e))?null:e.stateNode},findFiberByHostInstance:nl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var il=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!il.isDisabled&&il.supportsFiber)try{it=il.inject(rl),at=il}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(t))throw Error(a(200));return qc(e,t,null,n)},t.createRoot=function(e,t){if(!Xc(e))throw Error(a(299));var n=!1,r="",i=Qc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Vc(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,Br(8===e.nodeType?e.parentNode:e),new $c(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=Ke(t))?null:e.stateNode},t.flushSync=function(e){return lc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(a(200));return el(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Xc(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",u=Qc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(u=n.onRecoverableError)),t=zc(t,null,e,1,null!=n?n:null,i,0,o,u),e[pi]=t.current,Br(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Yc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(a(200));return el(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(a(40));return!!e._reactRootContainer&&(lc((function(){el(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return el(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},250:function(e,t,n){var r=n(164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},164:function(e,t,n){!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(463)},459:function(e,t){var n,r=Symbol.for("react.element"),i=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.server_context"),f=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),p=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),y=Symbol.for("react.offscreen");function m(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case a:case u:case o:case h:case d:return e;default:switch(e=e&&e.$$typeof){case l:case c:case f:case v:case p:case s:return e;default:return t}}case i:return t}}}n=Symbol.for("react.module.reference")},900:function(e,t,n){n(459)},374:function(e,t,n){var r=n(791),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,u=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)o.call(t,r)&&!s.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:l,props:a,_owner:u.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},117:function(e,t){var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),s=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),d=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,y={};function m(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||p}function g(){}function k(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||p}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},g.prototype=m.prototype;var b=k.prototype=new g;b.constructor=k,v(b,m.prototype),b.isPureReactComponent=!0;var w=Array.isArray,_=Object.prototype.hasOwnProperty,x={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,r){var i,a={},o=null,u=null;if(null!=t)for(i in void 0!==t.ref&&(u=t.ref),void 0!==t.key&&(o=""+t.key),t)_.call(t,i)&&!I.hasOwnProperty(i)&&(a[i]=t[i]);var s=arguments.length-2;if(1===s)a.children=r;else if(1<s){for(var c=Array(s),l=0;l<s;l++)c[l]=arguments[l+2];a.children=c}if(e&&e.defaultProps)for(i in s=e.defaultProps)void 0===a[i]&&(a[i]=s[i]);return{$$typeof:n,type:e,key:o,ref:u,props:a,_owner:x.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,i,a,o){var u=typeof e;"undefined"!==u&&"boolean"!==u||(e=null);var s=!1;if(null===e)s=!0;else switch(u){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case n:case r:s=!0}}if(s)return o=o(s=e),e=""===a?"."+C(s,0):a,w(o)?(i="",null!=e&&(i=e.replace(E,"$&/")+"/"),N(o,t,i,"",(function(e){return e}))):null!=o&&(T(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||s&&s.key===o.key?"":(""+o.key).replace(E,"$&/")+"/")+e)),t.push(o)),1;if(s=0,a=""===a?".":a+":",w(e))for(var c=0;c<e.length;c++){var l=a+C(u=e[c],c);s+=N(u,t,i,l,o)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(u=e.next()).done;)s+=N(u=u.value,t,i,l=a+C(u,c++),o);else if("object"===u)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function R(e,t,n){if(null==e)return e;var r=[],i=0;return N(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},D={transition:null},O={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:D,ReactCurrentOwner:x};t.Children={map:R,forEach:function(e,t,n){R(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=i,t.Profiler=o,t.PureComponent=k,t.StrictMode=a,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=v({},e.props),a=e.key,o=e.ref,u=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,u=x.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(c in t)_.call(t,c)&&!I.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==s?s[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){s=Array(c);for(var l=0;l<c;l++)s[l]=arguments[l+2];i.children=s}return{$$typeof:n,type:e.type,key:a,ref:o,props:i,_owner:u}},t.createContext=function(e){return(e={$$typeof:s,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:u,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:f,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.2.0"},791:function(e,t,n){e.exports=n(117)},184:function(e,t,n){e.exports=n(374)},813:function(e,t){function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var u=2*(r+1)-1,s=e[u],c=u+1,l=e[c];if(0>a(s,n))c<i&&0>a(l,s)?(e[r]=l,e[c]=n,r=c):(e[r]=s,e[u]=n,r=u);else{if(!(c<i&&0>a(l,n)))break e;e[r]=l,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var u=Date,s=u.now();t.unstable_now=function(){return u.now()-s}}var c=[],l=[],f=1,h=null,d=3,p=!1,v=!1,y=!1,m="function"===typeof setTimeout?setTimeout:null,g="function"===typeof clearTimeout?clearTimeout:null,k="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(l);null!==t;){if(null===t.callback)i(l);else{if(!(t.startTime<=e))break;i(l),t.sortIndex=t.expirationTime,n(c,t)}t=r(l)}}function w(e){if(y=!1,b(e),!v)if(null!==r(c))v=!0,D(_);else{var t=r(l);null!==t&&O(w,t.startTime-e)}}function _(e,n){v=!1,y&&(y=!1,g(T),T=-1),p=!0;var a=d;try{for(b(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!N());){var o=h.callback;if("function"===typeof o){h.callback=null,d=h.priorityLevel;var u=o(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof u?h.callback=u:h===r(c)&&i(c),b(n)}else i(c);h=r(c)}if(null!==h)var s=!0;else{var f=r(l);null!==f&&O(w,f.startTime-n),s=!1}return s}finally{h=null,d=a,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var x,I=!1,S=null,T=-1,E=5,C=-1;function N(){return!(t.unstable_now()-C<E)}function R(){if(null!==S){var e=t.unstable_now();C=e;var n=!0;try{n=S(!0,e)}finally{n?x():(I=!1,S=null)}}else I=!1}if("function"===typeof k)x=function(){k(R)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,P=A.port2;A.port1.onmessage=R,x=function(){P.postMessage(null)}}else x=function(){m(R,0)};function D(e){S=e,I||(I=!0,x())}function O(e,n){T=m((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,D(_))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},t.unstable_scheduleCallback=function(e,i,a){var o=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?o+a:o:a=o,e){case 1:var u=-1;break;case 2:u=250;break;case 5:u=1073741823;break;case 4:u=1e4;break;default:u=5e3}return e={id:f++,callback:i,priorityLevel:e,startTime:a,expirationTime:u=a+u,sortIndex:-1},a>o?(e.sortIndex=a,n(l,e),null===r(c)&&e===r(l)&&(y?(g(T),T=-1):y=!0,O(w,a-o))):(e.sortIndex=u,n(c,e),v||p||(v=!0,D(_))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}},296:function(e,t,n){e.exports=n(813)},561:function(e,t,n){var r=n(791);var i="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},a=r.useState,o=r.useEffect,u=r.useLayoutEffect,s=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!i(e,n)}catch(r){return!0}}var l="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=a({inst:{value:n,getSnapshot:t}}),i=r[0].inst,l=r[1];return u((function(){i.value=n,i.getSnapshot=t,c(i)&&l({inst:i})}),[e,n,t]),o((function(){return c(i)&&l({inst:i}),e((function(){c(i)&&l({inst:i})}))}),[e]),s(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:l},595:function(e,t,n){var r=n(791),i=n(248);var a="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},o=i.useSyncExternalStore,u=r.useRef,s=r.useEffect,c=r.useMemo,l=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var f=u(null);if(null===f.current){var h={hasValue:!1,value:null};f.current=h}else h=f.current;f=c((function(){function e(e){if(!s){if(s=!0,o=e,e=r(e),void 0!==i&&h.hasValue){var t=h.value;if(i(t,e))return u=t}return u=e}if(t=u,a(o,e))return t;var n=r(e);return void 0!==i&&i(t,n)?t:(o=e,u=n)}var o,u,s=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]}),[t,n,r,i]);var d=o(e,f[0],f[1]);return s((function(){h.hasValue=!0,h.value=d}),[d]),l(d),d}},248:function(e,t,n){e.exports=n(561)},327:function(e,t,n){e.exports=n(595)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}!function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var a=Object.create(null);n.r(a);var o={};e=e||[null,t({}),t([]),t(t)];for(var u=2&i&&r;"object"==typeof u&&!~e.indexOf(u);u=t(u))Object.getOwnPropertyNames(u).forEach((function(e){o[e]=function(){return r[e]}}));return o.default=function(){return r},n.d(a,o),a}}(),n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/messanger/",function(){var e={};n.r(e),n.d(e,{FirebaseError:function(){return ne},SDK_VERSION:function(){return _t},_DEFAULT_ENTRY_NAME:function(){return ct},_addComponent:function(){return dt},_addOrOverwriteComponent:function(){return pt},_apps:function(){return ft},_clearComponents:function(){return gt},_components:function(){return ht},_getProvider:function(){return yt},_registerComponent:function(){return vt},_removeServiceInstance:function(){return mt},deleteApp:function(){return Tt},getApp:function(){return It},getApps:function(){return St},initializeApp:function(){return xt},onLog:function(){return Nt},registerVersion:function(){return Ct},setLogLevel:function(){return Rt}});var t=n(791),r=n.t(t,2),i=n(250);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function o(){o=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},u=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(R){l=function(e,t,n){return e[t]=n}}function f(e,t,n,i){var a=t&&t.prototype instanceof p?t:p,o=Object.create(a.prototype),u=new E(i||[]);return r(o,"_invoke",{value:x(e,n,u)}),o}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(R){return{type:"throw",arg:R}}}e.wrap=f;var d={};function p(){}function v(){}function y(){}var m={};l(m,u,(function(){return this}));var g=Object.getPrototypeOf,k=g&&g(g(C([])));k&&k!==t&&n.call(k,u)&&(m=k);var b=y.prototype=p.prototype=Object.create(m);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function i(r,o,u,s){var c=h(e[r],e,o);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==a(f)&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){i("next",e,u,s)}),(function(e){i("throw",e,u,s)})):t.resolve(f).then((function(e){l.value=e,u(l)}),(function(e){return i("throw",e,u,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function x(e,t,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return N()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var u=I(o,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=h(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}function I(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,I(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=h(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function C(e){if(e){var t=e[u];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:N}}function N(){return{value:void 0,done:!0}}return v.prototype=y,r(b,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:v,configurable:!0}),v.displayName=l(y,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,c,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},w(_.prototype),l(_.prototype,s,(function(){return this})),e.AsyncIterator=_,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new _(f(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},w(b),l(b,c,"Generator"),l(b,u,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=C,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:C(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e){var t=function(e,t){if("object"!==a(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===a(t)?t:String(t)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function l(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(VR){return void n(VR)}u.done?t(s):Promise.resolve(s).then(r,i)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){f(a,r,i,o,u,"next",e)}function u(e){f(a,r,i,o,u,"throw",e)}o(void 0)}))}}function d(e,t,n){return(t=s(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e,t){if(e){if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function y(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=v(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function m(e){if(Array.isArray(e))return e}function g(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function k(e,t){return m(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,u=[],s=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(u.push(r.value),u.length!==t);s=!0);}catch(l){c=!0,i=l}finally{try{if(!s&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw i}}return u}}(e,t)||v(e,t)||g()}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e,t){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},w(e,t)}function _(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}function x(e){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},x(e)}function I(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function S(e,t){if(t&&("object"===a(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return b(e)}function T(e){var t=I();return function(){var n,r=x(e);if(t){var i=x(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S(this,n)}}function E(e,t,n){return E=I()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&w(i,n.prototype),i},E.apply(null,arguments)}function C(e){var t="function"===typeof Map?new Map:void 0;return C=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return E(e,arguments,x(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),w(n,e)},C(e)}var N=!1,R=!1,A="${JSCORE_VERSION}",P=function(e,t){if(!e)throw D(t)},D=function(e){return new Error("Firebase Database ("+A+") INTERNAL ASSERT FAILED: "+e)},O=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},L={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,u=o?e[i+1]:0,s=i+2<e.length,c=s?e[i+2]:0,l=a>>2,f=(3&a)<<4|u>>4,h=(15&u)<<2|c>>6,d=63&c;s||(d=64,o||(h=64)),r.push(n[l],n[f],n[h],n[d])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(O(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var u=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&u)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,u=++i<e.length?n[e.charAt(i)]:64,s=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==u||null==s)throw Error();var c=a<<2|o>>4;if(r.push(c),64!==u){var l=o<<4&240|u>>2;if(r.push(l),64!==s){var f=u<<6&192|s;r.push(f)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},M=function(e){var t=O(e);return L.encodeByteArray(t,!0)},F=function(e){return M(e).replace(/\./g,"")},U=function(e){try{return L.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function j(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=j(e[n],t[n]));return e}function V(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function q(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(V())}function B(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(e){return!1}}function z(){var e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function W(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function K(){var e=V();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function H(){return!0===N||!0===R}function G(){try{return"object"===typeof indexedDB}catch(e){return!1}}var Q=function(){return function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__},$=function(){try{return Q()||function(){if("undefined"!==typeof process){var e={NODE_ENV:"production",PUBLIC_URL:"/messanger",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0}}()||function(){if("undefined"!==typeof document){var e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}var t=e&&U(e[1]);return t&&JSON.parse(t)}}()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},Y=function(e){var t,n;return null===(n=null===(t=$())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},X=function(e){var t=Y(e);if(t){var n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));var r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]}},J=function(){var e;return null===(e=$())||void 0===e?void 0:e.config},Z=function(e){var t;return null===(t=$())||void 0===t?void 0:t["_".concat(e)]},ee=function(){function e(){var t=this;u(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return l(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"===typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}}}]),e}();function te(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[F(JSON.stringify({alg:"none",type:"JWT"})),F(JSON.stringify(a)),""].join(".")}var ne=function(e){_(n,e);var t=T(n);function n(e,r,i){var a;return u(this,n),(a=t.call(this,r)).code=e,a.customData=i,a.name="FirebaseError",Object.setPrototypeOf(b(a),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(b(a),re.prototype.create),a}return l(n)}(C(Error)),re=function(){function e(t,n,r){u(this,e),this.service=t,this.serviceName=n,this.errors=r}return l(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?ie(r,t):"Error",a="".concat(this.serviceName,": ").concat(i," (").concat(n,")."),o=new ne(n,a,t);return o}}]),e}();function ie(e,t){return e.replace(ae,(function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}var ae=/\{\$([^}]+)}/g;function oe(e){return JSON.parse(e)}function ue(e){return JSON.stringify(e)}var se=function(e){var t={},n={},r={},i="";try{var a=e.split(".");t=oe(U(a[0])||""),n=oe(U(a[1])||""),i=a[2],r=n.d||{},delete n.d}catch(o){}return{header:t,claims:n,data:r,signature:i}};function ce(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function le(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function fe(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function he(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function de(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),i=0,a=n;i<a.length;i++){var o=a[i];if(!r.includes(o))return!1;var u=e[o],s=t[o];if(pe(u)&&pe(s)){if(!de(u,s))return!1}else if(u!==s)return!1}for(var c=0,l=r;c<l.length;c++){var f=l[c];if(!n.includes(f))return!1}return!0}function pe(e){return null!==e&&"object"===typeof e}function ve(e){for(var t=[],n=function(){var e=k(i[r],2),n=e[0],a=e[1];Array.isArray(a)?a.forEach((function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))},r=0,i=Object.entries(e);r<i.length;r++)n();return t.length?"&"+t.join("&"):""}function ye(e){var t={};return e.replace(/^\?/,"").split("&").forEach((function(e){if(e){var n=k(e.split("="),2),r=n[0],i=n[1];t[decodeURIComponent(r)]=decodeURIComponent(i)}})),t}function me(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}var ge=function(){function e(){u(this,e),this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return l(e,[{key:"reset",value:function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}},{key:"compress_",value:function(e,t){t||(t=0);var n=this.W_;if("string"===typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(var i=0;i<16;i++)n[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(var a=16;a<80;a++){var o=n[a-3]^n[a-8]^n[a-14]^n[a-16];n[a]=4294967295&(o<<1|o>>>31)}for(var u,s,c=this.chain_[0],l=this.chain_[1],f=this.chain_[2],h=this.chain_[3],d=this.chain_[4],p=0;p<80;p++){p<40?p<20?(u=h^l&(f^h),s=1518500249):(u=l^f^h,s=1859775393):p<60?(u=l&f|h&(l|f),s=2400959708):(u=l^f^h,s=3395469782);var v=(c<<5|c>>>27)+u+d+s+n[p]&4294967295;d=h,h=f,f=4294967295&(l<<30|l>>>2),l=c,c=v}this.chain_[0]=this.chain_[0]+c&4294967295,this.chain_[1]=this.chain_[1]+l&4294967295,this.chain_[2]=this.chain_[2]+f&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295}},{key:"update",value:function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,a=this.inbuf_;r<t;){if(0===a)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"===typeof e){for(;r<t;)if(i[a]=e.charCodeAt(r),++r,++a===this.blockSize){this.compress_(i),a=0;break}}else for(;r<t;)if(i[a]=e[r],++r,++a===this.blockSize){this.compress_(i),a=0;break}}this.inbuf_=a,this.total_+=t}}},{key:"digest",value:function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);for(var r=0,i=0;i<5;i++)for(var a=24;a>=0;a-=8)e[r]=this.chain_[i]>>a&255,++r;return e}}]),e}();function ke(e,t){var n=new be(e,t);return n.subscribe.bind(n)}var be=function(){function e(t,n){var r=this;u(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then((function(){t(r)})).catch((function(e){r.error(e)}))}return l(e,[{key:"next",value:function(e){this.forEachObserver((function(t){t.next(e)}))}},{key:"error",value:function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)}},{key:"complete",value:function(){this.forEachObserver((function(e){e.complete()})),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!==typeof e||null===e)return!1;var n,r=y(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i in e&&"function"===typeof e[i])return!0}}catch(a){r.e(a)}finally{r.f()}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=we),void 0===r.error&&(r.error=we),void 0===r.complete&&(r.complete=we);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}}))}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))}}]),e}();function we(){}function _e(e,t){return"".concat(e," failed: ").concat(t," argument ")}var xe=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function Ie(e){return e&&e._delegate?e._delegate:e}function Se(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Te(e){return function(e){if(Array.isArray(e))return p(e)}(e)||Se(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Ee=function(){function e(t,n,r){u(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return l(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),Ce="[DEFAULT]",Ne=function(){function e(t,n){u(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return l(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new ee;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Ce})}catch(s){}var t,n=y(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=k(t.value,2),i=r[0],a=r[1],o=this.normalizeInstanceIdentifier(i);try{var u=this.getOrInitializeService({instanceIdentifier:o});a.resolve(u)}catch(s){}}}catch(c){n.e(c)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ce;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=h(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Array.from(this.instances.values()),e.next=3,Promise.all([].concat(Te(t.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))),Te(t.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ce;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ce;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i,a=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=y(this.instancesDeferred.entries());try{for(o.s();!(i=o.n()).done;){var u=k(i.value,2),s=u[0],c=u[1],l=this.normalizeInstanceIdentifier(s);r===l&&c.resolve(a)}}catch(f){o.e(f)}finally{o.f()}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,i=y(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;try{a(e,t)}catch(Wx){}}}catch(o){i.e(o)}finally{i.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===Ce?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(Wx){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ce;return this.component?this.component.multipleInstances?e:Ce:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}();var Re,Ae,Pe=function(){function e(t){u(this,e),this.name=t,this.providers=new Map}return l(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new Ne(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),De=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(Ae||(Ae={}));var Oe={debug:Ae.DEBUG,verbose:Ae.VERBOSE,info:Ae.INFO,warn:Ae.WARN,error:Ae.ERROR,silent:Ae.SILENT},Le=Ae.INFO,Me=(d(Re={},Ae.DEBUG,"log"),d(Re,Ae.VERBOSE,"log"),d(Re,Ae.INFO,"info"),d(Re,Ae.WARN,"warn"),d(Re,Ae.ERROR,"error"),Re),Fe=function(e,t){if(!(t<e.logLevel)){var n=(new Date).toISOString(),r=Me[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i,a=arguments.length,o=new Array(a>2?a-2:0),u=2;u<a;u++)o[u-2]=arguments[u];(i=console)[r].apply(i,["[".concat(n,"]  ").concat(e.name,":")].concat(o))}},Ue=function(){function e(t){u(this,e),this.name=t,this._logLevel=Le,this._logHandler=Fe,this._userLogHandler=null,De.push(this)}return l(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in Ae))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"===typeof e?Oe[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ae.DEBUG].concat(t)),this._logHandler.apply(this,[this,Ae.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ae.VERBOSE].concat(t)),this._logHandler.apply(this,[this,Ae.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ae.INFO].concat(t)),this._logHandler.apply(this,[this,Ae.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ae.WARN].concat(t)),this._logHandler.apply(this,[this,Ae.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ae.ERROR].concat(t)),this._logHandler.apply(this,[this,Ae.ERROR].concat(t))}}]),e}();function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qe,Be;var ze=new WeakMap,We=new WeakMap,Ke=new WeakMap,He=new WeakMap,Ge=new WeakMap;var Qe={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return We.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Ke.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Xe(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function $e(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Be||(Be=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Je(this),n),Xe(ze.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Xe(e.apply(Je(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=e.call.apply(e,[Je(this),t].concat(r));return Ke.set(a,t.sort?t.sort():[t]),Xe(a)}}function Ye(e){return"function"===typeof e?$e(e):(e instanceof IDBTransaction&&function(e){if(!We.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=function(){t(),r()},a=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)}));We.set(e,t)}}(e),t=e,(qe||(qe=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((function(e){return t instanceof e}))?new Proxy(e,Qe):e);var t}function Xe(e){if(e instanceof IDBRequest)return function(e){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("success",i),e.removeEventListener("error",a)},i=function(){t(Xe(e.result)),r()},a=function(){n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",a)}));return t.then((function(t){t instanceof IDBCursor&&ze.set(t,e)})).catch((function(){})),Ge.set(t,e),t}(e);if(He.has(e))return He.get(e);var t=Ye(e);return t!==e&&(He.set(e,t),Ge.set(t,e)),t}var Je=function(e){return Ge.get(e)};var Ze,et,tt=["get","getKey","getAll","getAllKeys","count"],nt=["put","add","delete","clear"],rt=new Map;function it(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"===typeof t){if(rt.get(t))return rt.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,i=nt.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(i||tt.includes(n))){var a=function(){var e=h(o().mark((function e(t){var a,u,s,c,l,f,h=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(u=this.transaction(t,i?"readwrite":"readonly"),s=u.store,c=h.length,l=new Array(c>1?c-1:0),f=1;f<c;f++)l[f-1]=h[f];return r&&(s=s.index(l.shift())),e.next=6,Promise.all([(a=s)[n].apply(a,l),i&&u.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();return rt.set(t,a),a}}}Qe=function(e){return Ve(Ve({},e),{},{get:function(t,n,r){return it(t,n)||e.get(t,n,r)},has:function(t,n){return!!it(t,n)||e.has(t,n)}})}(Qe);var at=function(){function e(t){u(this,e),this.container=t}return l(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")}}]),e}();var ot="@firebase/app",ut="0.9.0",st=new Ue("@firebase/app"),ct="[DEFAULT]",lt=(d(Ze={},ot,"fire-core"),d(Ze,"@firebase/app-compat","fire-core-compat"),d(Ze,"@firebase/analytics","fire-analytics"),d(Ze,"@firebase/analytics-compat","fire-analytics-compat"),d(Ze,"@firebase/app-check","fire-app-check"),d(Ze,"@firebase/app-check-compat","fire-app-check-compat"),d(Ze,"@firebase/auth","fire-auth"),d(Ze,"@firebase/auth-compat","fire-auth-compat"),d(Ze,"@firebase/database","fire-rtdb"),d(Ze,"@firebase/database-compat","fire-rtdb-compat"),d(Ze,"@firebase/functions","fire-fn"),d(Ze,"@firebase/functions-compat","fire-fn-compat"),d(Ze,"@firebase/installations","fire-iid"),d(Ze,"@firebase/installations-compat","fire-iid-compat"),d(Ze,"@firebase/messaging","fire-fcm"),d(Ze,"@firebase/messaging-compat","fire-fcm-compat"),d(Ze,"@firebase/performance","fire-perf"),d(Ze,"@firebase/performance-compat","fire-perf-compat"),d(Ze,"@firebase/remote-config","fire-rc"),d(Ze,"@firebase/remote-config-compat","fire-rc-compat"),d(Ze,"@firebase/storage","fire-gcs"),d(Ze,"@firebase/storage-compat","fire-gcs-compat"),d(Ze,"@firebase/firestore","fire-fst"),d(Ze,"@firebase/firestore-compat","fire-fst-compat"),d(Ze,"fire-js","fire-js"),d(Ze,"firebase","fire-js-all"),Ze),ft=new Map,ht=new Map;function dt(e,t){try{e.container.addComponent(t)}catch(n){st.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function pt(e,t){e.container.addOrOverwriteComponent(t)}function vt(e){var t=e.name;if(ht.has(t))return st.debug("There were multiple attempts to register component ".concat(t,".")),!1;ht.set(t,e);var n,r=y(ft.values());try{for(r.s();!(n=r.n()).done;){dt(n.value,e)}}catch(i){r.e(i)}finally{r.f()}return!0}function yt(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function mt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ct;yt(e,t).clearInstance(n)}function gt(){ht.clear()}var kt=(d(et={},"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),d(et,"bad-app-name","Illegal App name: '{$appName}"),d(et,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),d(et,"app-deleted","Firebase App named '{$appName}' already deleted"),d(et,"no-options","Need to provide options, when not being deployed to hosting via source."),d(et,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),d(et,"invalid-log-argument","First argument to `onLog` must be null or a function."),d(et,"idb-open","Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}."),d(et,"idb-get","Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}."),d(et,"idb-set","Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}."),d(et,"idb-delete","Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."),et),bt=new re("app","Firebase",kt),wt=function(){function e(t,n,r){var i=this;u(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ee("app",(function(){return i}),"PUBLIC"))}return l(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw bt.create("app-deleted",{appName:this._name})}}]),e}(),_t="9.15.0";function xt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){var r=t;t={name:r}}var i=Object.assign({name:ct,automaticDataCollectionEnabled:!1},t),a=i.name;if("string"!==typeof a||!a)throw bt.create("bad-app-name",{appName:String(a)});if(n||(n=J()),!n)throw bt.create("no-options");var o=ft.get(a);if(o){if(de(n,o.options)&&de(i,o.config))return o;throw bt.create("duplicate-app",{appName:a})}var u,s=new Pe(a),c=y(ht.values());try{for(c.s();!(u=c.n()).done;){var l=u.value;s.addComponent(l)}}catch(h){c.e(h)}finally{c.f()}var f=new wt(n,i,s);return ft.set(a,f),f}function It(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct,t=ft.get(e);if(!t&&e===ct)return xt();if(!t)throw bt.create("no-app",{appName:e});return t}function St(){return Array.from(ft.values())}function Tt(e){return Et.apply(this,arguments)}function Et(){return Et=h(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.name,!ft.has(n)){e.next=6;break}return ft.delete(n),e.next=5,Promise.all(t.container.getProviders().map((function(e){return e.delete()})));case 5:t.isDeleted=!0;case 6:case"end":return e.stop()}}),e)}))),Et.apply(this,arguments)}function Ct(e,t,n){var r,i=null!==(r=lt[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var u=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&u.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&u.push("and"),o&&u.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void st.warn(u.join(" "))}vt(new Ee("".concat(i,"-version"),(function(){return{library:i,version:t}}),"VERSION"))}function Nt(e,t){if(null!==e&&"function"!==typeof e)throw bt.create("invalid-log-argument");!function(e,t){var n,r=y(De);try{var i=function(){var r=n.value,i=null;t&&t.level&&(i=Oe[t.level]),r.userLogHandler=null===e?null:function(t,n){for(var r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];var u=a.map((function(e){if(null==e)return null;if("string"===typeof e)return e;if("number"===typeof e||"boolean"===typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}})).filter((function(e){return e})).join(" ");n>=(null!==i&&void 0!==i?i:t.logLevel)&&e({level:Ae[n].toLowerCase(),message:u,args:a,type:t.name})}};for(r.s();!(n=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}}(e,t)}function Rt(e){var t;t=e,De.forEach((function(e){e.setLogLevel(t)}))}var At="firebase-heartbeat-store",Pt=null;function Dt(){return Pt||(Pt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,a=n.blocking,o=n.terminated,u=indexedDB.open(e,t),s=Xe(u);return i&&u.addEventListener("upgradeneeded",(function(e){i(Xe(u.result),e.oldVersion,e.newVersion,Xe(u.transaction))})),r&&u.addEventListener("blocked",(function(){return r()})),s.then((function(e){o&&e.addEventListener("close",(function(){return o()})),a&&e.addEventListener("versionchange",(function(){return a()}))})).catch((function(){})),s}("firebase-heartbeat-database",1,{upgrade:function(e,t){if(0===t)e.createObjectStore(At)}}).catch((function(e){throw bt.create("idb-open",{originalErrorMessage:e.message})}))),Pt}function Ot(e){return Lt.apply(this,arguments)}function Lt(){return Lt=h(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Dt();case 3:return n=e.sent,e.abrupt("return",n.transaction(At).objectStore(At).get(Ut(t)));case 7:e.prev=7,e.t0=e.catch(0),e.t0 instanceof ne?st.warn(e.t0.message):(r=bt.create("idb-get",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),st.warn(r.message));case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),Lt.apply(this,arguments)}function Mt(e,t){return Ft.apply(this,arguments)}function Ft(){return Ft=h(o().mark((function e(t,n){var r,i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Dt();case 3:return r=e.sent,i=r.transaction(At,"readwrite"),a=i.objectStore(At),e.next=8,a.put(n,Ut(t));case 8:return e.abrupt("return",i.done);case 11:e.prev=11,e.t0=e.catch(0),e.t0 instanceof ne?st.warn(e.t0.message):(u=bt.create("idb-set",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),st.warn(u.message));case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),Ft.apply(this,arguments)}function Ut(e){return"".concat(e.name,"!").concat(e.options.appId)}var jt=function(){function e(t){var n=this;u(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new Wt(r),this._heartbeatsCachePromise=this._storage.read().then((function(e){return n._heartbeatsCache=e,e}))}return l(e,[{key:"triggerHeartbeat",value:function(){var e=h(o().mark((function e(){var t,n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.container.getProvider("platform-logger").getImmediate(),n=t.getPlatformInfoString(),r=Vt(),null!==this._heartbeatsCache){e.next=7;break}return e.next=6,this._heartbeatsCachePromise;case 6:this._heartbeatsCache=e.sent;case 7:if(this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((function(e){return e.date===r}))){e.next=11;break}return e.abrupt("return");case 11:this._heartbeatsCache.heartbeats.push({date:r,agent:n});case 12:return this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),e.abrupt("return",this._storage.overwrite(this._heartbeatsCache));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeartbeatsHeader",value:function(){var e=h(o().mark((function e(){var t,n,r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._heartbeatsCache){e.next=3;break}return e.next=3,this._heartbeatsCachePromise;case 3:if(null!==this._heartbeatsCache&&0!==this._heartbeatsCache.heartbeats.length){e.next=5;break}return e.abrupt("return","");case 5:if(t=Vt(),n=qt(this._heartbeatsCache.heartbeats),r=n.heartbeatsToSend,i=n.unsentEntries,a=F(JSON.stringify({version:2,heartbeats:r})),this._heartbeatsCache.lastSentHeartbeatDate=t,!(i.length>0)){e.next=15;break}return this._heartbeatsCache.heartbeats=i,e.next=13,this._storage.overwrite(this._heartbeatsCache);case 13:e.next=17;break;case 15:this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache);case 17:return e.abrupt("return",a);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function Vt(){return(new Date).toISOString().substring(0,10)}function qt(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=[],i=e.slice(),a=y(e);try{var o=function(){var e=t.value,a=r.find((function(t){return t.agent===e.agent}));if(a){if(a.dates.push(e.date),Kt(r)>n)return a.dates.pop(),"break"}else if(r.push({agent:e.agent,dates:[e.date]}),Kt(r)>n)return r.pop(),"break";i=i.slice(1)};for(a.s();!(t=a.n()).done;){var u=o();if("break"===u)break}}catch(s){a.e(s)}finally{a.f()}return{heartbeatsToSend:r,unsentEntries:i}}var Bt,zt,Wt=function(){function e(t){u(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return l(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){var e=h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(G()){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(VR){t(VR)}})).then((function(){return!0})).catch((function(){return!1})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"read",value:function(){var e=h(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return",{heartbeats:[]});case 7:return e.next=9,Ot(this.app);case 9:return t=e.sent,e.abrupt("return",t||{heartbeats:[]});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"overwrite",value:function(){var e=h(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",Mt(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:t.heartbeats}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=h(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",Mt(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:[].concat(Te(r.heartbeats),Te(t.heartbeats))}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Kt(e){return F(JSON.stringify({version:2,heartbeats:e})).length}Bt="",vt(new Ee("platform-logger",(function(e){return new at(e)}),"PRIVATE")),vt(new Ee("heartbeat",(function(e){return new jt(e)}),"PRIVATE")),Ct(ot,ut,Bt),Ct(ot,ut,"esm2017"),Ct("fire-js","");var Ht=function(){function e(t,n){var r=this;u(this,e),this._delegate=t,this.firebase=n,dt(t,new Ee("app-compat",(function(){return r}),"PUBLIC")),this.container=t.container}return l(e,[{key:"automaticDataCollectionEnabled",get:function(){return this._delegate.automaticDataCollectionEnabled},set:function(e){this._delegate.automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this._delegate.name}},{key:"options",get:function(){return this._delegate.options}},{key:"delete",value:function(){var e=this;return new Promise((function(t){e._delegate.checkDestroyed(),t()})).then((function(){return e.firebase.INTERNAL.removeApp(e.name),Tt(e._delegate)}))}},{key:"_getService",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ct;this._delegate.checkDestroyed();var r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(t=r.getComponent())||void 0===t?void 0:t.instantiationMode)||r.initialize(),r.getImmediate({identifier:n})}},{key:"_removeServiceInstance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ct;this._delegate.container.getProvider(e).clearInstance(t)}},{key:"_addComponent",value:function(e){dt(this._delegate,e)}},{key:"_addOrOverwriteComponent",value:function(e){pt(this._delegate,e)}},{key:"toJSON",value:function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}]),e}(),Gt=(d(zt={},"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),d(zt,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),zt),Qt=new re("app-compat","Firebase",Gt);var $t=function t(){var n=function(t){var n={},r={__esModule:!0,initializeApp:function(e){var i=xt(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});if(ce(n,i.name))return n[i.name];var a=new t(i,r);return n[i.name]=a,a},app:i,registerVersion:Ct,setLogLevel:Rt,onLog:Nt,apps:null,SDK_VERSION:_t,INTERNAL:{registerComponent:function(e){var n=e.name,a=n.replace("-compat","");if(vt(e)&&"PUBLIC"===e.type){var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i();if("function"!==typeof e[a])throw Qt.create("invalid-app-argument",{appName:n});return e[a]()};void 0!==e.serviceProps&&j(o,e.serviceProps),r[a]=o,t.prototype[a]=function(){for(var t=this._getService.bind(this,n),r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t.apply(this,e.multipleInstances?i:[])}}return"PUBLIC"===e.type?r[a]:null},removeApp:function(e){delete n[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:e}};function i(e){if(!ce(n,e=e||ct))throw Qt.create("no-app",{appName:e});return n[e]}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(n).map((function(e){return n[e]}))}}),i.App=t,r}(Ht);return n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(e){j(n,e)},createSubscribe:ke,ErrorFactory:re,deepExtend:j}),n}(),Yt=new Ue("@firebase/app-compat");if("object"===typeof self&&self.self===self&&void 0!==self.firebase){Yt.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Xt=self.firebase.SDK_VERSION;Xt&&Xt.indexOf("LITE")>=0&&Yt.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Jt=$t;function Zt(e){return m(e)||Se(e)||v(e)||g()}function en(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=x(e)););return e}function tn(){return tn="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=en(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},tn.apply(this,arguments)}!function(e){Ct("@firebase/app-compat","0.2.0",e)}();function nn(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;var rn;Object.create;var an="facebook.com",on="github.com",un="google.com",sn="password",cn="twitter.com",ln="EMAIL_SIGNIN",fn="PASSWORD_RESET",hn="RECOVER_EMAIL",dn="REVERT_SECOND_FACTOR_ADDITION",pn="VERIFY_AND_CHANGE_EMAIL",vn="VERIFY_EMAIL";function yn(){return d({},"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.")}var mn=function(){var e;return d(e={},"admin-restricted-operation","This operation is restricted to administrators only."),d(e,"argument-error",""),d(e,"app-not-authorized","This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console."),d(e,"app-not-installed","The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device."),d(e,"captcha-check-failed","The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains."),d(e,"code-expired","The SMS code has expired. Please re-send the verification code to try again."),d(e,"cordova-not-ready","Cordova framework is not ready."),d(e,"cors-unsupported","This browser is not supported."),d(e,"credential-already-in-use","This credential is already associated with a different user account."),d(e,"custom-token-mismatch","The custom token corresponds to a different audience."),d(e,"requires-recent-login","This operation is sensitive and requires recent authentication. Log in again before retrying this request."),d(e,"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."),d(e,"dynamic-link-not-activated","Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions."),d(e,"email-change-needs-verification","Multi-factor users must always have a verified email."),d(e,"email-already-in-use","The email address is already in use by another account."),d(e,"emulator-config-failed",'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.'),d(e,"expired-action-code","The action code has expired."),d(e,"cancelled-popup-request","This operation has been cancelled due to another conflicting popup being opened."),d(e,"internal-error","An internal AuthError has occurred."),d(e,"invalid-app-credential","The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired."),d(e,"invalid-app-id","The mobile app identifier is not registed for the current project."),d(e,"invalid-user-token","This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key."),d(e,"invalid-auth-event","An internal AuthError has occurred."),d(e,"invalid-verification-code","The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user."),d(e,"invalid-continue-uri","The continue URL provided in the request is invalid."),d(e,"invalid-cordova-configuration","The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme."),d(e,"invalid-custom-token","The custom token format is incorrect. Please check the documentation."),d(e,"invalid-dynamic-link-domain","The provided dynamic link domain is not configured or authorized for the current project."),d(e,"invalid-email","The email address is badly formatted."),d(e,"invalid-emulator-scheme","Emulator URL must start with a valid scheme (http:// or https://)."),d(e,"invalid-api-key","Your API key is invalid, please check you have copied it correctly."),d(e,"invalid-cert-hash","The SHA-1 certificate hash provided is invalid."),d(e,"invalid-credential","The supplied auth credential is malformed or has expired."),d(e,"invalid-message-payload","The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console."),d(e,"invalid-multi-factor-session","The request does not contain a valid proof of first factor successful sign-in."),d(e,"invalid-oauth-provider","EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers."),d(e,"invalid-oauth-client-id","The OAuth client ID provided is either invalid or does not match the specified API key."),d(e,"unauthorized-domain","This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console."),d(e,"invalid-action-code","The action code is invalid. This can happen if the code is malformed, expired, or has already been used."),d(e,"wrong-password","The password is invalid or the user does not have a password."),d(e,"invalid-persistence-type","The specified persistence type is invalid. It can only be local, session or none."),d(e,"invalid-phone-number","The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code]."),d(e,"invalid-provider-id","The specified provider ID is invalid."),d(e,"invalid-recipient-email","The email corresponding to this action failed to send as the provided recipient email address is invalid."),d(e,"invalid-sender","The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console."),d(e,"invalid-verification-id","The verification ID used to create the phone auth credential is invalid."),d(e,"invalid-tenant-id","The Auth instance's tenant ID is invalid."),d(e,"login-blocked","Login blocked by user-provided method: {$originalMessage}"),d(e,"missing-android-pkg-name","An Android Package Name must be provided if the Android App is required to be installed."),d(e,"auth-domain-config-required","Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console."),d(e,"missing-app-credential","The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided."),d(e,"missing-verification-code","The phone auth credential was created with an empty SMS verification code."),d(e,"missing-continue-uri","A continue URL must be provided in the request."),d(e,"missing-iframe-start","An internal AuthError has occurred."),d(e,"missing-ios-bundle-id","An iOS Bundle ID must be provided if an App Store ID is provided."),d(e,"missing-or-invalid-nonce","The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload."),d(e,"missing-multi-factor-info","No second factor identifier is provided."),d(e,"missing-multi-factor-session","The request is missing proof of first factor successful sign-in."),d(e,"missing-phone-number","To send verification codes, provide a phone number for the recipient."),d(e,"missing-verification-id","The phone auth credential was created with an empty verification ID."),d(e,"app-deleted","This instance of FirebaseApp has been deleted."),d(e,"multi-factor-info-not-found","The user does not have a second factor matching the identifier provided."),d(e,"multi-factor-auth-required","Proof of ownership of a second factor is required to complete sign-in."),d(e,"account-exists-with-different-credential","An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address."),d(e,"network-request-failed","A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred."),d(e,"no-auth-event","An internal AuthError has occurred."),d(e,"no-such-provider","User was not linked to an account with the given provider."),d(e,"null-user","A null user object was provided as the argument for an operation which requires a non-null user object."),d(e,"operation-not-allowed","The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section."),d(e,"operation-not-supported-in-this-environment",'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.'),d(e,"popup-blocked","Unable to establish a connection with the popup. It may have been blocked by the browser."),d(e,"popup-closed-by-user","The popup has been closed by the user before finalizing the operation."),d(e,"provider-already-linked","User can only be linked to one identity for the given provider."),d(e,"quota-exceeded","The project's quota for this operation has been exceeded."),d(e,"redirect-cancelled-by-user","The redirect operation has been cancelled by the user before finalizing."),d(e,"redirect-operation-pending","A redirect sign-in operation is already pending."),d(e,"rejected-credential","The request contains malformed or mismatching credentials."),d(e,"second-factor-already-in-use","The second factor is already enrolled on this account."),d(e,"maximum-second-factor-count-exceeded","The maximum allowed number of second factors on a user has been exceeded."),d(e,"tenant-id-mismatch","The provided tenant ID does not match the Auth instance's tenant ID"),d(e,"timeout","The operation has timed out."),d(e,"user-token-expired","The user's credential is no longer valid. The user must sign in again."),d(e,"too-many-requests","We have blocked all requests from this device due to unusual activity. Try again later."),d(e,"unauthorized-continue-uri","The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console."),d(e,"unsupported-first-factor","Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor."),d(e,"unsupported-persistence-type","The current environment does not support the specified persistence type."),d(e,"unsupported-tenant-operation","This operation is not supported in a multi-tenant context."),d(e,"unverified-email","The operation requires a verified email."),d(e,"user-cancelled","The user did not grant your application the permissions it requested."),d(e,"user-not-found","There is no user record corresponding to this identifier. The user may have been deleted."),d(e,"user-disabled","The user account has been disabled by an administrator."),d(e,"user-mismatch","The supplied credentials do not correspond to the previously signed in user."),d(e,"user-signed-out",""),d(e,"weak-password","The password must be 6 characters long or more."),d(e,"web-storage-unsupported","This browser is not supported or 3rd party cookies and data may be disabled."),d(e,"already-initialized","initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."),e},gn=yn,kn=new re("auth","Firebase",yn()),bn=new Ue("@firebase/auth");function wn(e){if(bn.logLevel<=Ae.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];bn.error.apply(bn,["Auth (".concat(_t,"): ").concat(e)].concat(n))}}function _n(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Tn.apply(void 0,[e].concat(n))}function xn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Tn.apply(void 0,[e].concat(n))}function In(e,t,n){var r=Object.assign(Object.assign({},gn()),d({},t,n));return new re("auth","Firebase",r).create(t,{appName:e.name})}function Sn(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&_n(e,"argument-error"),In(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function Tn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){var i,a=n[0],o=Te(n.slice(1));return o[0]&&(o[0].appName=e.name),(i=e._errorFactory).create.apply(i,[a].concat(Te(o)))}return kn.create.apply(kn,[e].concat(n))}function En(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw Tn.apply(void 0,[t].concat(r))}}function Cn(e){var t="INTERNAL ASSERTION FAILED: "+e;throw wn(t),new Error(t)}function Nn(e,t){e||Cn(t)}var Rn=new Map;function An(e){Nn(e instanceof Function,"Expected a class definition");var t=Rn.get(e);return t?(Nn(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Rn.set(e,t),t)}function Pn(e,t){var n=yt(e,"auth");if(n.isInitialized()){var r=n.getImmediate();if(de(n.getOptions(),null!==t&&void 0!==t?t:{}))return r;_n(r,"already-initialized")}return n.initialize({options:t})}function Dn(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function On(){return"http:"===Ln()||"https:"===Ln()}function Ln(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}var Mn=function(){function e(t,n){u(this,e),this.shortDelay=t,this.longDelay=n,Nn(n>t,"Short delay should be less than long delay!"),this.isMobile=q()||W()}return l(e,[{key:"get",value:function(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(On()||z()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),e}();function Fn(e,t){Nn(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var Un=function(){function e(){u(this,e)}return l(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:void Cn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:void Cn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:void Cn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),jn=(d(rn={},"CREDENTIAL_MISMATCH","custom-token-mismatch"),d(rn,"MISSING_CUSTOM_TOKEN","internal-error"),d(rn,"INVALID_IDENTIFIER","invalid-email"),d(rn,"MISSING_CONTINUE_URI","internal-error"),d(rn,"INVALID_PASSWORD","wrong-password"),d(rn,"MISSING_PASSWORD","internal-error"),d(rn,"EMAIL_EXISTS","email-already-in-use"),d(rn,"PASSWORD_LOGIN_DISABLED","operation-not-allowed"),d(rn,"INVALID_IDP_RESPONSE","invalid-credential"),d(rn,"INVALID_PENDING_TOKEN","invalid-credential"),d(rn,"FEDERATED_USER_ID_ALREADY_LINKED","credential-already-in-use"),d(rn,"MISSING_REQ_TYPE","internal-error"),d(rn,"EMAIL_NOT_FOUND","user-not-found"),d(rn,"RESET_PASSWORD_EXCEED_LIMIT","too-many-requests"),d(rn,"EXPIRED_OOB_CODE","expired-action-code"),d(rn,"INVALID_OOB_CODE","invalid-action-code"),d(rn,"MISSING_OOB_CODE","internal-error"),d(rn,"CREDENTIAL_TOO_OLD_LOGIN_AGAIN","requires-recent-login"),d(rn,"INVALID_ID_TOKEN","invalid-user-token"),d(rn,"TOKEN_EXPIRED","user-token-expired"),d(rn,"USER_NOT_FOUND","user-token-expired"),d(rn,"TOO_MANY_ATTEMPTS_TRY_LATER","too-many-requests"),d(rn,"INVALID_CODE","invalid-verification-code"),d(rn,"INVALID_SESSION_INFO","invalid-verification-id"),d(rn,"INVALID_TEMPORARY_PROOF","invalid-credential"),d(rn,"MISSING_SESSION_INFO","missing-verification-id"),d(rn,"SESSION_EXPIRED","code-expired"),d(rn,"MISSING_ANDROID_PACKAGE_NAME","missing-android-pkg-name"),d(rn,"UNAUTHORIZED_DOMAIN","unauthorized-continue-uri"),d(rn,"INVALID_OAUTH_CLIENT_ID","invalid-oauth-client-id"),d(rn,"ADMIN_ONLY_OPERATION","admin-restricted-operation"),d(rn,"INVALID_MFA_PENDING_CREDENTIAL","invalid-multi-factor-session"),d(rn,"MFA_ENROLLMENT_NOT_FOUND","multi-factor-info-not-found"),d(rn,"MISSING_MFA_ENROLLMENT_ID","missing-multi-factor-info"),d(rn,"MISSING_MFA_PENDING_CREDENTIAL","missing-multi-factor-session"),d(rn,"SECOND_FACTOR_EXISTS","second-factor-already-in-use"),d(rn,"SECOND_FACTOR_LIMIT_EXCEEDED","maximum-second-factor-count-exceeded"),d(rn,"BLOCKING_FUNCTION_ERROR_RESPONSE","internal-error"),rn),Vn=new Mn(3e4,6e4);function qn(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function Bn(e,t,n,r){return zn.apply(this,arguments)}function zn(){return zn=h(o().mark((function e(t,n,r,i){var a,u=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=u.length>4&&void 0!==u[4]?u[4]:{},e.abrupt("return",Wn(t,a,h(o().mark((function e(){var a,u,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={},u={},i&&("GET"===n?u=i:a={body:JSON.stringify(i)}),s=ve(Object.assign({key:t.config.apiKey},u)).slice(1),e.next=6,t._getAdditionalHeaders();case 6:return(c=e.sent)["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode),e.abrupt("return",Un.fetch()(Qn(t,t.config.apiHost,r,s),Object.assign({method:n,headers:c,referrerPolicy:"no-referrer"},a)));case 10:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e)}))),zn.apply(this,arguments)}function Wn(e,t,n){return Kn.apply(this,arguments)}function Kn(){return Kn=h(o().mark((function e(t,n,r){var i,a,u,s,c,l,f,h,d,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,i=Object.assign(Object.assign({},jn),n),e.prev=2,a=new $n(t),e.next=6,Promise.race([r(),a.promise]);case 6:return u=e.sent,a.clearNetworkTimeout(),e.next=10,u.json();case 10:if(!("needConfirmation"in(s=e.sent))){e.next=13;break}throw Yn(t,"account-exists-with-different-credential",s);case 13:if(!u.ok||"errorMessage"in s){e.next=17;break}return e.abrupt("return",s);case 17:if(c=u.ok?s.errorMessage:s.error.message,l=c.split(" : "),f=k(l,2),h=f[0],d=f[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==h){e.next=23;break}throw Yn(t,"credential-already-in-use",s);case 23:if("EMAIL_EXISTS"!==h){e.next=27;break}throw Yn(t,"email-already-in-use",s);case 27:if("USER_DISABLED"!==h){e.next=29;break}throw Yn(t,"user-disabled",s);case 29:if(p=i[h]||h.toLowerCase().replace(/[_\s]+/g,"-"),!d){e.next=34;break}throw In(t,p,d);case 34:_n(t,p);case 35:e.next=42;break;case 37:if(e.prev=37,e.t0=e.catch(2),!(e.t0 instanceof ne)){e.next=41;break}throw e.t0;case 41:_n(t,"network-request-failed");case 42:case"end":return e.stop()}}),e,null,[[2,37]])}))),Kn.apply(this,arguments)}function Hn(e,t,n,r){return Gn.apply(this,arguments)}function Gn(){return Gn=h(o().mark((function e(t,n,r,i){var a,u,s=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>4&&void 0!==s[4]?s[4]:{},e.next=3,Bn(t,n,r,i,a);case 3:return"mfaPendingCredential"in(u=e.sent)&&_n(t,"multi-factor-auth-required",{_serverResponse:u}),e.abrupt("return",u);case 6:case"end":return e.stop()}}),e)}))),Gn.apply(this,arguments)}function Qn(e,t,n,r){var i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?Fn(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}var $n=function(){function e(t){var n=this;u(this,e),this.auth=t,this.timer=null,this.promise=new Promise((function(e,t){n.timer=setTimeout((function(){return t(xn(n.auth,"network-request-failed"))}),Vn.get())}))}return l(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function Yn(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=xn(e,t,r);return i.customData._tokenResponse=n,i}function Xn(e,t){return Jn.apply(this,arguments)}function Jn(){return Jn=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Bn(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}}),e)}))),Jn.apply(this,arguments)}function Zn(e,t){return er.apply(this,arguments)}function er(){return er=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Bn(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)}))),er.apply(this,arguments)}function tr(e,t){return nr.apply(this,arguments)}function nr(){return nr=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Bn(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}}),e)}))),nr.apply(this,arguments)}function rr(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(n){}}function ir(){return ir=h(o().mark((function e(t){var n,r,i,a,u,s,c=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]&&c[1],r=Ie(t),e.next=4,r.getIdToken(n);case 4:return i=e.sent,En((a=or(i))&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error"),u="object"===typeof a.firebase?a.firebase:void 0,s=null===u||void 0===u?void 0:u.sign_in_provider,e.abrupt("return",{claims:a,token:i,authTime:rr(ar(a.auth_time)),issuedAtTime:rr(ar(a.iat)),expirationTime:rr(ar(a.exp)),signInProvider:s||null,signInSecondFactor:(null===u||void 0===u?void 0:u.sign_in_second_factor)||null});case 10:case"end":return e.stop()}}),e)}))),ir.apply(this,arguments)}function ar(e){return 1e3*Number(e)}function or(e){var t=k(e.split("."),3),n=t[0],r=t[1],i=t[2];if(void 0===n||void 0===r||void 0===i)return wn("JWT malformed, contained fewer than 3 sections"),null;try{var a=U(r);return a?JSON.parse(a):(wn("Failed to decode base64 JWT payload"),null)}catch(o){return wn("Caught error parsing JWT payload as JSON",null===o||void 0===o?void 0:o.toString()),null}}function ur(e,t){return sr.apply(this,arguments)}function sr(){return sr=h(o().mark((function e(t,n){var r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),!(e.t0 instanceof ne&&cr(e.t0))){e.next=15;break}if(t.auth.currentUser!==t){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[3,9]])}))),sr.apply(this,arguments)}function cr(e){var t=e.code;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}var lr=function(){function e(t){u(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return l(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isRunning){var n=this.getInterval(t);this.timerId=setTimeout(h(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.iteration();case 2:case"end":return t.stop()}}),t)}))),n)}}},{key:"iteration",value:function(){var e=h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.user.getIdToken(!0);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("network-request-failed")&&this.schedule(!0),e.abrupt("return");case 9:this.schedule();case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),fr=function(){function e(t,n){u(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return l(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=rr(this.lastLoginAt),this.creationTime=rr(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function hr(e){return dr.apply(this,arguments)}function dr(){return dr=h(o().mark((function e(t){var n,r,i,a,u,s,c,l,f,h,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return i=e.sent,e.next=6,ur(t,tr(r,{idToken:i}));case 6:En(null===(a=e.sent)||void 0===a?void 0:a.users.length,r,"internal-error"),u=a.users[0],t._notifyReloadListener(u),s=(null===(n=u.providerUserInfo)||void 0===n?void 0:n.length)?yr(u.providerUserInfo):[],c=vr(t.providerData,s),l=t.isAnonymous,f=!(t.email&&u.passwordHash)&&!(null===c||void 0===c?void 0:c.length),h=!!l&&f,d={uid:u.localId,displayName:u.displayName||null,photoURL:u.photoUrl||null,email:u.email||null,emailVerified:u.emailVerified||!1,phoneNumber:u.phoneNumber||null,tenantId:u.tenantId||null,providerData:c,metadata:new fr(u.createdAt,u.lastLoginAt),isAnonymous:h},Object.assign(t,d);case 17:case"end":return e.stop()}}),e)}))),dr.apply(this,arguments)}function pr(){return(pr=h(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Ie(t),e.next=3,hr(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vr(e,t){var n=e.filter((function(e){return!t.some((function(t){return t.providerId===e.providerId}))}));return[].concat(Te(n),Te(t))}function yr(e){return e.map((function(e){var t=e.providerId,n=nn(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}function mr(e,t){return gr.apply(this,arguments)}function gr(){return gr=h(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wn(t,{},h(o().mark((function e(){var r,i,a,u,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ve({grant_type:"refresh_token",refresh_token:n}).slice(1),i=t.config,a=i.tokenApiHost,u=i.apiKey,s=Qn(t,a,"/v1/token","key=".concat(u)),e.next=5,t._getAdditionalHeaders();case 5:return(c=e.sent)["Content-Type"]="application/x-www-form-urlencoded",e.abrupt("return",Un.fetch()(s,{method:"POST",headers:c,body:r}));case 8:case"end":return e.stop()}}),e)}))));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}}),e)}))),gr.apply(this,arguments)}var kr=function(){function e(){u(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return l(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){En(e.idToken,"internal-error"),En("undefined"!==typeof e.idToken,"internal-error"),En("undefined"!==typeof e.refreshToken,"internal-error");var t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):function(e){var t=or(e);return En(t,"internal-error"),En("undefined"!==typeof t.exp,"internal-error"),En("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"getToken",value:function(){var e=h(o().mark((function e(t){var n,r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]&&r[1],En(!this.accessToken||this.refreshToken,t,"user-token-expired"),n||!this.accessToken||this.isExpired){e.next=4;break}return e.abrupt("return",this.accessToken);case 4:if(!this.refreshToken){e.next=8;break}return e.next=7,this.refresh(t,this.refreshToken);case 7:return e.abrupt("return",this.accessToken);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(){var e=h(o().mark((function e(t,n){var r,i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mr(t,n);case 2:r=e.sent,i=r.accessToken,a=r.refreshToken,u=r.expiresIn,this.updateTokensAndExpiration(i,a,Number(u));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return Cn("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,i=n.accessToken,a=n.expirationTime,o=new e;return r&&(En("string"===typeof r,"internal-error",{appName:t}),o.refreshToken=r),i&&(En("string"===typeof i,"internal-error",{appName:t}),o.accessToken=i),a&&(En("number"===typeof a,"internal-error",{appName:t}),o.expirationTime=a),o}}]),e}();function br(e,t){En("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}var wr=function(){function e(t){u(this,e);var n=t.uid,r=t.auth,i=t.stsTokenManager,a=nn(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new lr(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?Te(a.providerData):[],this.metadata=new fr(a.createdAt||void 0,a.lastLoginAt||void 0)}return l(e,[{key:"getIdToken",value:function(){var e=h(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ur(this,this.stsTokenManager.getToken(this.auth,t));case 2:if(En(n=e.sent,this.auth,"internal-error"),this.accessToken===n){e.next=9;break}return this.accessToken=n,e.next=8,this.auth._persistUserIfCurrent(this);case 8:this.auth._notifyListenersIfCurrent(this);case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getIdTokenResult",value:function(e){return function(e){return ir.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return pr.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(En(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((function(e){return Object.assign({},e)})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){return new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(e){En(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(){var e=h(o().mark((function e(t){var n,r,i=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]&&i[1],r=!1,t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),r=!0),!n){e.next=6;break}return e.next=6,hr(this);case 6:return e.next=8,this.auth._persistUserIfCurrent(this);case 8:r&&this.auth._notifyListenersIfCurrent(this);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=h(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIdToken();case 2:return t=e.sent,e.next=5,ur(this,Xn(this.auth,{idToken:t}));case 5:return this.stsTokenManager.clearRefreshToken(),e.abrupt("return",this.auth.signOut());case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((function(e){return Object.assign({},e)})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,i,a,o,u,s,c,l,f=null!==(r=n.displayName)&&void 0!==r?r:void 0,h=null!==(i=n.email)&&void 0!==i?i:void 0,d=null!==(a=n.phoneNumber)&&void 0!==a?a:void 0,p=null!==(o=n.photoURL)&&void 0!==o?o:void 0,v=null!==(u=n.tenantId)&&void 0!==u?u:void 0,y=null!==(s=n._redirectEventId)&&void 0!==s?s:void 0,m=null!==(c=n.createdAt)&&void 0!==c?c:void 0,g=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,k=n.uid,b=n.emailVerified,w=n.isAnonymous,_=n.providerData,x=n.stsTokenManager;En(k&&x,t,"internal-error");var I=kr.fromJSON(this.name,x);En("string"===typeof k,t,"internal-error"),br(f,t.name),br(h,t.name),En("boolean"===typeof b,t,"internal-error"),En("boolean"===typeof w,t,"internal-error"),br(d,t.name),br(p,t.name),br(v,t.name),br(y,t.name),br(m,t.name),br(g,t.name);var S=new e({uid:k,auth:t,email:h,emailVerified:b,displayName:f,isAnonymous:w,photoURL:p,phoneNumber:d,tenantId:v,stsTokenManager:I,createdAt:m,lastLoginAt:g});return _&&Array.isArray(_)&&(S.providerData=_.map((function(e){return Object.assign({},e)}))),y&&(S._redirectEventId=y),S}},{key:"_fromIdTokenResponse",value:function(){var t=h(o().mark((function t(n,r){var i,a,u,s=arguments;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=s.length>2&&void 0!==s[2]&&s[2],(a=new kr).updateFromServerResponse(r),u=new e({uid:r.localId,auth:n,stsTokenManager:a,isAnonymous:i}),t.next=6,hr(u);case 6:return t.abrupt("return",u);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}(),_r=function(){function e(){u(this,e),this.type="NONE",this.storage={}}return l(e,[{key:"_isAvailable",value:function(){var e=h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.storage[t]=n;case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=h(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.storage[t],e.abrupt("return",void 0===n?null:n);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:delete this.storage[t];case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();_r.type="NONE";var xr=_r;function Ir(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}var Sr=function(){function e(t,n,r){u(this,e),this.persistence=t,this.auth=n,this.userKey=r;var i=this.auth,a=i.config,o=i.name;this.fullUserKey=Ir(this.userKey,a.apiKey,o),this.fullPersistenceKey=Ir("persistence",a.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return l(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=h(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.persistence._get(this.fullUserKey);case 2:return t=e.sent,e.abrupt("return",t?wr._fromJSON(this.auth,t):null);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(){var e=h(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.persistence!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getCurrentUser();case 4:return n=e.sent,e.next=7,this.removeCurrentUser();case 7:if(this.persistence=t,!n){e.next=10;break}return e.abrupt("return",this.setCurrentUser(n));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(){var t=h(o().mark((function t(n,r){var i,a,u,s,c,l,f,d,p,v,m,g=arguments;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=g.length>2&&void 0!==g[2]?g[2]:"authUser",r.length){t.next=3;break}return t.abrupt("return",new e(An(xr),n,i));case 3:return t.next=5,Promise.all(r.map(function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:return e.abrupt("return",void 0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:a=t.sent.filter((function(e){return e})),u=a[0]||An(xr),s=Ir(i,n.config.apiKey,n.name),c=null,l=y(r),t.prev=10,l.s();case 12:if((f=l.n()).done){t.next=29;break}return d=f.value,t.prev=14,t.next=17,d._get(s);case 17:if(!(p=t.sent)){t.next=23;break}return v=wr._fromJSON(n,p),d!==u&&(c=v),u=d,t.abrupt("break",29);case 23:t.next=27;break;case 25:t.prev=25,t.t0=t.catch(14);case 27:t.next=12;break;case 29:t.next=34;break;case 31:t.prev=31,t.t1=t.catch(10),l.e(t.t1);case 34:return t.prev=34,l.f(),t.finish(34);case 37:if(m=a.filter((function(e){return e._shouldAllowMigration})),u._shouldAllowMigration&&m.length){t.next=40;break}return t.abrupt("return",new e(u,n,i));case 40:if(u=m[0],!c){t.next=44;break}return t.next=44,u._set(s,c.toJSON());case 44:return t.next=46,Promise.all(r.map(function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===u){e.next=8;break}return e.prev=1,e.next=4,t._remove(s);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()));case 46:return t.abrupt("return",new e(u,n,i));case 47:case"end":return t.stop()}}),t,null,[[10,31,34,37],[14,25]])})));return function(e,n){return t.apply(this,arguments)}}()}]),e}();function Tr(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Rr(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Er(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Pr(t))return"Blackberry";if(Dr(t))return"Webos";if(Cr(t))return"Safari";if((t.includes("chrome/")||Nr(t))&&!t.includes("edge/"))return"Chrome";if(Ar(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null===n||void 0===n?void 0:n.length)?n[1]:"Other"}function Er(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V();return/firefox\//i.test(e)}function Cr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V(),t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Nr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V();return/crios\//i.test(e)}function Rr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V();return/iemobile/i.test(e)}function Ar(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V();return/android/i.test(e)}function Pr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V();return/blackberry/i.test(e)}function Dr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V();return/webos/i.test(e)}function Or(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Lr(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V();return Or(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}function Mr(){return K()&&10===document.documentMode}function Fr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V();return Or(e)||Ar(e)||Dr(e)||Pr(e)||/windows phone/i.test(e)||Rr(e)}function Ur(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Tr(V());break;case"Worker":t="".concat(Tr(V()),"-").concat(e);break;default:t=e}var r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(_t,"/").concat(r)}var jr=function(){function e(t){u(this,e),this.auth=t,this.queue=[]}return l(e,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise((function(n,r){try{n(e(t))}catch(i){r(i)}}))};r.onAbort=t,this.queue.push(r);var i=this.queue.length-1;return function(){n.queue[i]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(){var e=h(o().mark((function e(t){var n,r,i,a,u,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.auth.currentUser!==t){e.next=2;break}return e.abrupt("return");case 2:n=[],e.prev=3,r=y(this.queue),e.prev=5,r.s();case 7:if((i=r.n()).done){e.next=14;break}return a=i.value,e.next=11,a(t);case 11:a.onAbort&&n.push(a.onAbort);case 12:e.next=7;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:e.next=30;break;case 24:e.prev=24,e.t1=e.catch(3),n.reverse(),u=y(n);try{for(u.s();!(s=u.n()).done;){c=s.value;try{c()}catch(qC){}}}catch(o){u.e(o)}finally{u.f()}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===e.t1||void 0===e.t1?void 0:e.t1.message});case 30:case"end":return e.stop()}}),e,this,[[3,24],[5,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Vr=function(){function e(t,n,r){u(this,e),this.app=t,this.heartbeatServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Br(this),this.idTokenSubscription=new Br(this),this.beforeStateQueue=new jr(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=kn,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}return l(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=An(t)),this._initializationPromise=this.queue(h(o().mark((function r(){var i,a;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n._deleted){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,Sr.create(n,e);case 4:if(n.persistenceManager=r.sent,!n._deleted){r.next=7;break}return r.abrupt("return");case 7:if(!(null===(i=n._popupRedirectResolver)||void 0===i?void 0:i._shouldInitProactively)){r.next=15;break}return r.prev=8,r.next=11,n._popupRedirectResolver._initialize(n);case 11:r.next=15;break;case 13:r.prev=13,r.t0=r.catch(8);case 15:return r.next=17,n.initializeCurrentUser(t);case 17:if(n.lastNotifiedUid=(null===(a=n.currentUser)||void 0===a?void 0:a.uid)||null,!n._deleted){r.next=20;break}return r.abrupt("return");case 20:n._isInitialized=!0;case 21:case"end":return r.stop()}}),r,null,[[8,13]])})))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=h(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._deleted){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.assertedPersistence.getCurrentUser();case 4:if(t=e.sent,this.currentUser||t){e.next=7;break}return e.abrupt("return");case 7:if(!this.currentUser||!t||this.currentUser.uid!==t.uid){e.next=12;break}return this._currentUser._assign(t),e.next=11,this.currentUser.getIdToken();case 11:return e.abrupt("return");case 12:return e.next=14,this._updateCurrentUser(t,!0);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeCurrentUser",value:function(){var e=h(o().mark((function e(t){var n,r,i,a,u,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.assertedPersistence.getCurrentUser();case 2:if(r=e.sent,i=r,a=!1,!t||!this.config.authDomain){e.next=14;break}return e.next=8,this.getOrInitRedirectPersistenceManager();case 8:return u=null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId,s=null===i||void 0===i?void 0:i._redirectEventId,e.next=12,this.tryRedirectSignIn(t);case 12:c=e.sent,u&&u!==s||!(null===c||void 0===c?void 0:c.user)||(i=c.user,a=!0);case 14:if(i){e.next=16;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 16:if(i._redirectEventId){e.next=32;break}if(!a){e.next=27;break}return e.prev=18,e.next=21,this.beforeStateQueue.runMiddleware(i);case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(18),i=r,this._popupRedirectResolver._overrideRedirectResult(this,(function(){return Promise.reject(e.t0)}));case 27:if(!i){e.next=31;break}return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(i));case 31:return e.abrupt("return",this.directlySetCurrentUser(null));case 32:return En(this._popupRedirectResolver,this,"argument-error"),e.next=35,this.getOrInitRedirectPersistenceManager();case 35:if(!this.redirectUser||this.redirectUser._redirectEventId!==i._redirectEventId){e.next=37;break}return e.abrupt("return",this.directlySetCurrentUser(i));case 37:return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(i));case 38:case"end":return e.stop()}}),e,this,[[18,23]])})));return function(t){return e.apply(this,arguments)}}()},{key:"tryRedirectSignIn",value:function(){var e=h(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.prev=1,e.next=4,this._popupRedirectResolver._completeRedirectFn(this,t,!0);case 4:n=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),e.next=11,this._setRedirectUser(null);case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"reloadAndSetCurrentUserOrClear",value:function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,hr(t);case 3:e.next=9;break;case 5:if(e.prev=5,e.t0=e.catch(0),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("network-request-failed")){e.next=9;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 9:return e.abrupt("return",this.directlySetCurrentUser(t));case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"===typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._deleted=!0;case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateCurrentUser",value:function(){var e=h(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t?Ie(t):null)&&En(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),e.abrupt("return",this._updateCurrentUser(n&&n._clone(this)));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateCurrentUser",value:function(){var e=h(o().mark((function e(t){var n,r=this,i=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]&&i[1],!this._deleted){e.next=3;break}return e.abrupt("return");case 3:if(t&&En(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),n){e.next=7;break}return e.next=7,this.beforeStateQueue.runMiddleware(t);case 7:return e.abrupt("return",this.queue(h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.directlySetCurrentUser(t);case 2:r.notifyAuthListeners();case 3:case"end":return e.stop()}}),e)})))));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signOut",value:function(){var e=h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.beforeStateQueue.runMiddleware(null);case 2:if(!this.redirectPersistenceManager&&!this._popupRedirectResolver){e.next=5;break}return e.next=5,this._setRedirectUser(null);case 5:return e.abrupt("return",this._updateCurrentUser(null,!0));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPersistence",value:function(e){var t=this;return this.queue(h(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(An(e));case 2:case"end":return n.stop()}}),n)}))))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new re("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(){var e=h(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getOrInitRedirectPersistenceManager(n);case 2:return r=e.sent,e.abrupt("return",null===t?r.removeCurrentUser():r.setCurrentUser(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getOrInitRedirectPersistenceManager",value:function(){var e=h(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.redirectPersistenceManager){e.next=9;break}return En(n=t&&An(t)||this._popupRedirectResolver,this,"argument-error"),e.next=5,Sr.create(this,[An(n._redirectPersistence)],"redirectUser");case 5:return this.redirectPersistenceManager=e.sent,e.next=8,this.redirectPersistenceManager.getCurrentUser();case 8:this.redirectUser=e.sent;case 9:return e.abrupt("return",this.redirectPersistenceManager);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_redirectUserForId",value:function(){var e=h(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isInitialized){e.next=3;break}return e.next=3,this.queue(h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))));case 3:if((null===(n=this._currentUser)||void 0===n?void 0:n._redirectEventId)!==t){e.next=5;break}return e.abrupt("return",this._currentUser);case 5:if((null===(r=this.redirectUser)||void 0===r?void 0:r._redirectEventId)!==t){e.next=7;break}return e.abrupt("return",this.redirectUser);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_persistUserIfCurrent",value:function(){var e=h(o().mark((function e(t){var n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==this.currentUser){e.next=2;break}return e.abrupt("return",this.queue(h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.directlySetCurrentUser(t));case 1:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var i=this;if(this._deleted)return function(){};var a="function"===typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return En(o,this,"internal-error"),o.then((function(){return a(i.currentUser)})),"function"===typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,!t){e.next=8;break}return e.next=6,this.assertedPersistence.setCurrentUser(t);case 6:e.next=10;break;case 8:return e.next=10,this.assertedPersistence.removeCurrentUser();case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return En(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ur(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=h(o().mark((function e(){var t,n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d({},"X-Client-Version",this.clientVersion),this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId),e.next=4,null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();case 4:return(r=e.sent)&&(n["X-Firebase-Client"]=r),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function qr(e){return Ie(e)}var Br=function(){function e(t){var n=this;u(this,e),this.auth=t,this.observer=null,this.addObserver=ke((function(e){return n.observer=e}))}return l(e,[{key:"next",get:function(){return En(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}();function zr(e,t,n){var r=qr(e);En(r._canInitEmulator,r,"emulator-config-failed"),En(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");var i=!!(null===n||void 0===n?void 0:n.disableWarnings),a=Wr(t),o=function(e){var t=Wr(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};var r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){var a=i[1];return{host:a,port:Kr(r.substr(a.length+1))}}var o=k(r.split(":"),2);return{host:o[0],port:Kr(o[1])}}(t),u=o.host,s=o.port,c=null===s?"":":".concat(s);r.config.emulator={url:"".concat(a,"//").concat(u).concat(c,"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:u,port:s,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){var e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Wr(e){var t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Kr(e){if(!e)return null;var t=Number(e);return isNaN(t)?null:t}var Hr=function(){function e(t,n){u(this,e),this.providerId=t,this.signInMethod=n}return l(e,[{key:"toJSON",value:function(){return Cn("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return Cn("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return Cn("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return Cn("not implemented")}}]),e}();function Gr(e,t){return Qr.apply(this,arguments)}function Qr(){return Qr=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Bn(t,"POST","/v1/accounts:resetPassword",qn(t,n)));case 1:case"end":return e.stop()}}),e)}))),Qr.apply(this,arguments)}function $r(e,t){return Yr.apply(this,arguments)}function Yr(){return Yr=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Bn(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)}))),Yr.apply(this,arguments)}function Xr(e,t){return Jr.apply(this,arguments)}function Jr(){return Jr=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Bn(t,"POST","/v1/accounts:update",qn(t,n)));case 1:case"end":return e.stop()}}),e)}))),Jr.apply(this,arguments)}function Zr(e,t){return ei.apply(this,arguments)}function ei(){return ei=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hn(t,"POST","/v1/accounts:signInWithPassword",qn(t,n)));case 1:case"end":return e.stop()}}),e)}))),ei.apply(this,arguments)}function ti(e,t){return ni.apply(this,arguments)}function ni(){return ni=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Bn(t,"POST","/v1/accounts:sendOobCode",qn(t,n)));case 1:case"end":return e.stop()}}),e)}))),ni.apply(this,arguments)}function ri(e,t){return ii.apply(this,arguments)}function ii(){return ii=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ti(t,n));case 1:case"end":return e.stop()}}),e)}))),ii.apply(this,arguments)}function ai(e,t){return oi.apply(this,arguments)}function oi(){return oi=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ti(t,n));case 1:case"end":return e.stop()}}),e)}))),oi.apply(this,arguments)}function ui(e,t){return si.apply(this,arguments)}function si(){return si=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ti(t,n));case 1:case"end":return e.stop()}}),e)}))),si.apply(this,arguments)}function ci(e,t){return li.apply(this,arguments)}function li(){return li=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ti(t,n));case 1:case"end":return e.stop()}}),e)}))),li.apply(this,arguments)}function fi(e,t){return hi.apply(this,arguments)}function hi(){return hi=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hn(t,"POST","/v1/accounts:signInWithEmailLink",qn(t,n)));case 1:case"end":return e.stop()}}),e)}))),hi.apply(this,arguments)}function di(e,t){return pi.apply(this,arguments)}function pi(){return pi=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hn(t,"POST","/v1/accounts:signInWithEmailLink",qn(t,n)));case 1:case"end":return e.stop()}}),e)}))),pi.apply(this,arguments)}var vi=function(e){_(n,e);var t=T(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return u(this,n),(a=t.call(this,"password",i))._email=e,a._password=r,a._tenantId=o,a}return l(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",Zr(t,{returnSecureToken:!0,email:this._email,password:this._password}));case 4:return e.abrupt("return",fi(t,{email:this._email,oobCode:this._password}));case 5:_n(t,"internal-error");case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_linkToIdToken",value:function(){var e=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",$r(t,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password}));case 4:return e.abrupt("return",di(t,{idToken:n,email:this._email,oobCode:this._password}));case 5:_n(t,"internal-error");case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new n(e,t,"emailLink",r)}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(Hr);function yi(e,t){return mi.apply(this,arguments)}function mi(){return mi=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hn(t,"POST","/v1/accounts:signInWithIdp",qn(t,n)));case 1:case"end":return e.stop()}}),e)}))),mi.apply(this,arguments)}var gi=function(e){_(n,e);var t=T(n);function n(){var e;return u(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return l(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return yi(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,yi(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,yi(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ve(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):_n("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e,r=t.providerId,i=t.signInMethod,a=nn(t,["providerId","signInMethod"]);if(!r||!i)return null;var o=new n(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}}]),n}(Hr);function ki(e,t){return bi.apply(this,arguments)}function bi(){return bi=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Bn(t,"POST","/v1/accounts:sendVerificationCode",qn(t,n)));case 1:case"end":return e.stop()}}),e)}))),bi.apply(this,arguments)}function wi(){return wi=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hn(t,"POST","/v1/accounts:signInWithPhoneNumber",qn(t,n)));case 1:case"end":return e.stop()}}),e)}))),wi.apply(this,arguments)}function _i(){return _i=h(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Hn(t,"POST","/v1/accounts:signInWithPhoneNumber",qn(t,n));case 2:if(!(r=e.sent).temporaryProof){e.next=5;break}throw Yn(t,"account-exists-with-different-credential",r);case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)}))),_i.apply(this,arguments)}var xi=d({},"USER_NOT_FOUND","user-not-found");function Ii(){return Ii=h(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object.assign(Object.assign({},n),{operation:"REAUTH"}),e.abrupt("return",Hn(t,"POST","/v1/accounts:signInWithPhoneNumber",qn(t,r),xi));case 2:case"end":return e.stop()}}),e)}))),Ii.apply(this,arguments)}var Si=function(e){_(n,e);var t=T(n);function n(e){var r;return u(this,n),(r=t.call(this,"phone","phone")).params=e,r}return l(n,[{key:"_getIdTokenResponse",value:function(e){return function(e,t){return wi.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_linkToIdToken",value:function(e,t){return function(e,t){return _i.apply(this,arguments)}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}},{key:"_getReauthenticationResolver",value:function(e){return function(e,t){return Ii.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_makeVerificationRequest",value:function(){var e=this.params,t=e.temporaryProof,n=e.phoneNumber,r=e.verificationId,i=e.verificationCode;return t&&n?{temporaryProof:t,phoneNumber:n}:{sessionInfo:r,code:i}}},{key:"toJSON",value:function(){var e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}}],[{key:"_fromVerification",value:function(e,t){return new n({verificationId:e,verificationCode:t})}},{key:"_fromTokenResponse",value:function(e,t){return new n({phoneNumber:e,temporaryProof:t})}},{key:"fromJSON",value:function(e){"string"===typeof e&&(e=JSON.parse(e));var t=e,r=t.verificationId,i=t.verificationCode,a=t.phoneNumber,o=t.temporaryProof;return i||r||a||o?new n({verificationId:r,verificationCode:i,phoneNumber:a,temporaryProof:o}):null}}]),n}(Hr);var Ti=function(){function e(t){var n,r,i,a,o,s;u(this,e);var c=ye(me(t)),l=null!==(n=c.apiKey)&&void 0!==n?n:null,f=null!==(r=c.oobCode)&&void 0!==r?r:null,h=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=c.mode)&&void 0!==i?i:null);En(l&&f&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=f,this.continueUrl=null!==(a=c.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(o=c.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=c.tenantId)&&void 0!==s?s:null}return l(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=ye(me(e)).link,n=t?ye(me(t)).deep_link_id:null,r=ye(me(e)).deep_link_id;return(r?ye(me(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(Wx){return null}}}]),e}();var Ei=function(){function e(){u(this,e),this.providerId=e.PROVIDER_ID}return l(e,null,[{key:"credential",value:function(e,t){return vi._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=Ti.parseLink(t);return En(n,"argument-error"),vi._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();Ei.PROVIDER_ID="password",Ei.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Ei.EMAIL_LINK_SIGN_IN_METHOD="emailLink";var Ci=function(){function e(t){u(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return l(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),Ni=function(e){_(n,e);var t=T(n);function n(){var e;return u(this,n),(e=t.apply(this,arguments)).scopes=[],e}return l(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return Te(this.scopes)}}]),n}(Ci),Ri=function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.apply(this,arguments)}return l(n,[{key:"credential",value:function(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}},{key:"_credential",value:function(e){return En(e.idToken||e.accessToken,"argument-error"),gi._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}}],[{key:"credentialFromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e;return En("providerId"in t&&"signInMethod"in t,"argument-error"),gi._fromParams(t)}},{key:"credentialFromResult",value:function(e){return n.oauthCredentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.oauthCredentialFromTaggedObject(e.customData||{})}},{key:"oauthCredentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,i=t.oauthAccessToken,a=t.oauthTokenSecret,o=t.pendingToken,u=t.nonce,s=t.providerId;if(!i&&!a&&!r&&!o)return null;if(!s)return null;try{return new n(s)._credential({idToken:r,accessToken:i,nonce:u,pendingToken:o})}catch(c){return null}}}]),n}(Ni),Ai=function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.call(this,"facebook.com")}return l(n,null,[{key:"credential",value:function(e){return gi._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(Wx){return null}}}]),n}(Ni);Ai.FACEBOOK_SIGN_IN_METHOD="facebook.com",Ai.PROVIDER_ID="facebook.com";var Pi=function(e){_(n,e);var t=T(n);function n(){var e;return u(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return l(n,null,[{key:"credential",value:function(e,t){return gi._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,i=t.oauthAccessToken;if(!r&&!i)return null;try{return n.credential(r,i)}catch(Wx){return null}}}]),n}(Ni);Pi.GOOGLE_SIGN_IN_METHOD="google.com",Pi.PROVIDER_ID="google.com";var Di=function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.call(this,"github.com")}return l(n,null,[{key:"credential",value:function(e){return gi._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(Wx){return null}}}]),n}(Ni);Di.GITHUB_SIGN_IN_METHOD="github.com",Di.PROVIDER_ID="github.com";var Oi=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this,e,e)).pendingToken=r,i}return l(n,[{key:"_getIdTokenResponse",value:function(e){return yi(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,yi(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,yi(e,t)}},{key:"toJSON",value:function(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}},{key:"buildRequest",value:function(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}],[{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e,r=t.providerId,i=t.signInMethod,a=t.pendingToken;return r&&i&&a&&r===i?new n(r,a):null}},{key:"_create",value:function(e,t){return new n(e,t)}}]),n}(Hr),Li=function(e){_(n,e);var t=T(n);function n(e){return u(this,n),En(e.startsWith("saml."),"argument-error"),t.call(this,e)}return l(n,null,[{key:"credentialFromResult",value:function(e){return n.samlCredentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.samlCredentialFromTaggedObject(e.customData||{})}},{key:"credentialFromJSON",value:function(e){var t=Oi.fromJSON(e);return En(t,"argument-error"),t}},{key:"samlCredentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.pendingToken,r=t.providerId;if(!n||!r)return null;try{return Oi._create(r,n)}catch(i){return null}}}]),n}(Ci),Mi=function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.call(this,"twitter.com")}return l(n,null,[{key:"credential",value:function(e,t){return gi._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthAccessToken,i=t.oauthTokenSecret;if(!r||!i)return null;try{return n.credential(r,i)}catch(Wx){return null}}}]),n}(Ni);function Fi(e,t){return Ui.apply(this,arguments)}function Ui(){return Ui=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hn(t,"POST","/v1/accounts:signUp",qn(t,n)));case 1:case"end":return e.stop()}}),e)}))),Ui.apply(this,arguments)}Mi.TWITTER_SIGN_IN_METHOD="twitter.com",Mi.PROVIDER_ID="twitter.com";var ji=function(){function e(t){u(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return l(e,null,[{key:"_fromIdTokenResponse",value:function(){var t=h(o().mark((function t(n,r,i){var a,u,s,c,l=arguments;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>3&&void 0!==l[3]&&l[3],t.next=3,wr._fromIdTokenResponse(n,i,a);case 3:return u=t.sent,s=Vi(i),c=new e({user:u,providerId:s,_tokenResponse:i,operationType:r}),t.abrupt("return",c);case 7:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"_forOperation",value:function(){var t=h(o().mark((function t(n,r,i){var a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n._updateTokensIfNecessary(i,!0);case 2:return a=Vi(i),t.abrupt("return",new e({user:n,providerId:a,_tokenResponse:i,operationType:r}));case 4:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()}]),e}();function Vi(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}function qi(){return qi=h(o().mark((function e(t){var n,r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=qr(t),e.next=3,r._initializationPromise;case 3:if(!(null===(n=r.currentUser)||void 0===n?void 0:n.isAnonymous)){e.next=5;break}return e.abrupt("return",new ji({user:r.currentUser,providerId:null,operationType:"signIn"}));case 5:return e.next=7,Fi(r,{returnSecureToken:!0});case 7:return i=e.sent,e.next=10,ji._fromIdTokenResponse(r,"signIn",i,!0);case 10:return a=e.sent,e.next=13,r._updateCurrentUser(a.user);case 13:return e.abrupt("return",a);case 14:case"end":return e.stop()}}),e)}))),qi.apply(this,arguments)}var Bi=function(e){_(n,e);var t=T(n);function n(e,r,i,a){var o,s;return u(this,n),(o=t.call(this,r.code,r.message)).operationType=i,o.user=a,Object.setPrototypeOf(b(o),n.prototype),o.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:r.customData._serverResponse,operationType:i},o}return l(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,i){return new n(e,t,r,i)}}]),n}(ne);function zi(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((function(n){if(n.code==="auth/".concat("multi-factor-auth-required"))throw Bi._fromErrorAndOperation(e,n,t,r);throw n}))}function Wi(e){return new Set(e.map((function(e){return e.providerId})).filter((function(e){return!!e})))}function Ki(e,t){return Hi.apply(this,arguments)}function Hi(){return Hi=h(o().mark((function e(t,n){var r,i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ie(t),e.next=3,$i(!0,r,n);case 3:return e.t0=Zn,e.t1=r.auth,e.next=7,r.getIdToken();case 7:return e.t2=e.sent,e.t3=[n],e.t4={idToken:e.t2,deleteProvider:e.t3},e.next=12,(0,e.t0)(e.t1,e.t4);case 12:return i=e.sent,a=i.providerUserInfo,u=Wi(a||[]),r.providerData=r.providerData.filter((function(e){return u.has(e.providerId)})),u.has("phone")||(r.phoneNumber=null),e.next=19,r.auth._persistUserIfCurrent(r);case 19:return e.abrupt("return",r);case 20:case"end":return e.stop()}}),e)}))),Hi.apply(this,arguments)}function Gi(e,t){return Qi.apply(this,arguments)}function Qi(){return Qi=h(o().mark((function e(t,n){var r,i,a=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]&&a[2],e.t0=ur,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return i=e.sent,e.abrupt("return",ji._forOperation(t,"link",i));case 14:case"end":return e.stop()}}),e)}))),Qi.apply(this,arguments)}function $i(e,t,n){return Yi.apply(this,arguments)}function Yi(){return(Yi=h(o().mark((function e(t,n,r){var i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hr(n);case 2:i=Wi(n.providerData),a=!1===t?"provider-already-linked":"no-such-provider",En(i.has(r)===t,n.auth,a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xi(e,t){return Ji.apply(this,arguments)}function Ji(){return Ji=h(o().mark((function e(t,n){var r,i,a,u,s,c,l=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>2&&void 0!==l[2]&&l[2],i=t.auth,a="reauthenticate",e.prev=3,e.next=6,ur(t,zi(i,a,n,t),r);case 6:return En((u=e.sent).idToken,i,"internal-error"),En(s=or(u.idToken),i,"internal-error"),c=s.sub,En(t.uid===c,i,"user-mismatch"),e.abrupt("return",ji._forOperation(t,a,u));case 15:throw e.prev=15,e.t0=e.catch(3),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("user-not-found")&&_n(i,"user-mismatch"),e.t0;case 19:case"end":return e.stop()}}),e,null,[[3,15]])}))),Ji.apply(this,arguments)}function Zi(e,t){return ea.apply(this,arguments)}function ea(){return ea=h(o().mark((function e(t,n){var r,i,a,u,s=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i="signIn",e.next=4,zi(t,i,n);case 4:return a=e.sent,e.next=7,ji._fromIdTokenResponse(t,i,a);case 7:if(u=e.sent,r){e.next=11;break}return e.next=11,t._updateCurrentUser(u.user);case 11:return e.abrupt("return",u);case 12:case"end":return e.stop()}}),e)}))),ea.apply(this,arguments)}function ta(e,t){return na.apply(this,arguments)}function na(){return na=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Zi(qr(t),n));case 1:case"end":return e.stop()}}),e)}))),na.apply(this,arguments)}function ra(e,t){return ia.apply(this,arguments)}function ia(){return(ia=h(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ie(t),e.next=3,$i(!1,r,n.providerId);case 3:return e.abrupt("return",Gi(r,n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function aa(e,t){return oa.apply(this,arguments)}function oa(){return(oa=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Xi(Ie(t),n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ua(e,t){return sa.apply(this,arguments)}function sa(){return sa=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hn(t,"POST","/v1/accounts:signInWithCustomToken",qn(t,n)));case 1:case"end":return e.stop()}}),e)}))),sa.apply(this,arguments)}function ca(){return ca=h(o().mark((function e(t,n){var r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=qr(t),e.next=3,ua(r,{token:n,returnSecureToken:!0});case 3:return i=e.sent,e.next=6,ji._fromIdTokenResponse(r,"signIn",i);case 6:return a=e.sent,e.next=9,r._updateCurrentUser(a.user);case 9:return e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)}))),ca.apply(this,arguments)}var la=function(){function e(t,n){u(this,e),this.factorId=t,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}return l(e,null,[{key:"_fromServerResponse",value:function(e,t){return"phoneInfo"in t?fa._fromServerResponse(e,t):_n(e,"internal-error")}}]),e}(),fa=function(e){_(n,e);var t=T(n);function n(e){var r;return u(this,n),(r=t.call(this,"phone",e)).phoneNumber=e.phoneInfo,r}return l(n,null,[{key:"_fromServerResponse",value:function(e,t){return new n(t)}}]),n}(la);function ha(e,t,n){var r;En((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),En("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(En(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(En(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function da(){return da=h(o().mark((function e(t,n,r){var i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Ie(t),a={requestType:"PASSWORD_RESET",email:n},r&&ha(i,a,r),e.next=5,ai(i,a);case 5:case"end":return e.stop()}}),e)}))),da.apply(this,arguments)}function pa(){return pa=h(o().mark((function e(t,n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gr(Ie(t),{oobCode:n,newPassword:r});case 2:case"end":return e.stop()}}),e)}))),pa.apply(this,arguments)}function va(){return va=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xr(Ie(t),{oobCode:n});case 2:case"end":return e.stop()}}),e)}))),va.apply(this,arguments)}function ya(e,t){return ma.apply(this,arguments)}function ma(){return ma=h(o().mark((function e(t,n){var r,i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ie(t),e.next=3,Gr(r,{oobCode:n});case 3:i=e.sent,En(a=i.requestType,r,"internal-error"),e.t0=a,e.next="EMAIL_SIGNIN"===e.t0?9:"VERIFY_AND_CHANGE_EMAIL"===e.t0?10:"REVERT_SECOND_FACTOR_ADDITION"===e.t0?12:13;break;case 9:return e.abrupt("break",14);case 10:return En(i.newEmail,r,"internal-error"),e.abrupt("break",14);case 12:En(i.mfaInfo,r,"internal-error");case 13:En(i.email,r,"internal-error");case 14:return u=null,i.mfaInfo&&(u=la._fromServerResponse(qr(r),i.mfaInfo)),e.abrupt("return",{data:{email:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.newEmail:i.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.email:i.newEmail)||null,multiFactorInfo:u},operation:a});case 17:case"end":return e.stop()}}),e)}))),ma.apply(this,arguments)}function ga(){return ga=h(o().mark((function e(t,n){var r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ya(Ie(t),n);case 2:return r=e.sent,i=r.data,e.abrupt("return",i.email);case 5:case"end":return e.stop()}}),e)}))),ga.apply(this,arguments)}function ka(e,t,n){return ba.apply(this,arguments)}function ba(){return ba=h(o().mark((function e(t,n,r){var i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=qr(t),e.next=3,Fi(i,{returnSecureToken:!0,email:n,password:r});case 3:return a=e.sent,e.next=6,ji._fromIdTokenResponse(i,"signIn",a);case 6:return u=e.sent,e.next=9,i._updateCurrentUser(u.user);case 9:return e.abrupt("return",u);case 10:case"end":return e.stop()}}),e)}))),ba.apply(this,arguments)}function wa(e,t,n){return ta(Ie(e),Ei.credential(t,n))}function _a(){return _a=h(o().mark((function e(t,n,r){var i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Ie(t),a={requestType:"EMAIL_SIGNIN",email:n},En(r.handleCodeInApp,i,"argument-error"),r&&ha(i,a,r),e.next=6,ui(i,a);case 6:case"end":return e.stop()}}),e)}))),_a.apply(this,arguments)}function xa(){return xa=h(o().mark((function e(t,n,r){var i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Ie(t),En((a=Ei.credentialWithLink(n,r||Dn()))._tenantId===(i.tenantId||null),i,"tenant-id-mismatch"),e.abrupt("return",ta(i,a));case 4:case"end":return e.stop()}}),e)}))),xa.apply(this,arguments)}function Ia(e,t){return Sa.apply(this,arguments)}function Sa(){return Sa=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Bn(t,"POST","/v1/accounts:createAuthUri",qn(t,n)));case 1:case"end":return e.stop()}}),e)}))),Sa.apply(this,arguments)}function Ta(){return Ta=h(o().mark((function e(t,n){var r,i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=On()?Dn():"http://localhost",i={identifier:n,continueUri:r},e.next=4,Ia(Ie(t),i);case 4:return a=e.sent,u=a.signinMethods,e.abrupt("return",u||[]);case 7:case"end":return e.stop()}}),e)}))),Ta.apply(this,arguments)}function Ea(){return(Ea=h(o().mark((function e(t,n){var r,i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ie(t),e.next=3,t.getIdToken();case 3:return i=e.sent,a={requestType:"VERIFY_EMAIL",idToken:i},n&&ha(r.auth,a,n),e.next=8,ri(r.auth,a);case 8:if(u=e.sent,u.email===t.email){e.next=13;break}return e.next=13,t.reload();case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ca(){return(Ca=h(o().mark((function e(t,n,r){var i,a,u,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Ie(t),e.next=3,t.getIdToken();case 3:return a=e.sent,u={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:a,newEmail:n},r&&ha(i.auth,u,r),e.next=8,ci(i.auth,u);case 8:if(s=e.sent,s.email===t.email){e.next=13;break}return e.next=13,t.reload();case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Na(e,t){return Ra.apply(this,arguments)}function Ra(){return Ra=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Bn(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)}))),Ra.apply(this,arguments)}function Aa(e,t){return Pa.apply(this,arguments)}function Pa(){return(Pa=h(o().mark((function e(t,n){var r,i,a,u,s,c,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.displayName,i=n.photoURL,void 0!==r||void 0!==i){e.next=3;break}return e.abrupt("return");case 3:return a=Ie(t),e.next=6,a.getIdToken();case 6:return u=e.sent,s={idToken:u,displayName:r,photoUrl:i,returnSecureToken:!0},e.next=10,ur(a,Na(a.auth,s));case 10:return c=e.sent,a.displayName=c.displayName||null,a.photoURL=c.photoUrl||null,(l=a.providerData.find((function(e){return"password"===e.providerId})))&&(l.displayName=a.displayName,l.photoURL=a.photoURL),e.next=17,a._updateTokensIfNecessary(c);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Da(e,t,n){return Oa.apply(this,arguments)}function Oa(){return Oa=h(o().mark((function e(t,n,r){var i,a,u,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.auth,e.next=3,t.getIdToken();case 3:return a=e.sent,u={idToken:a,returnSecureToken:!0},n&&(u.email=n),r&&(u.password=r),e.next=9,ur(t,$r(i,u));case 9:return s=e.sent,e.next=12,t._updateTokensIfNecessary(s,!0);case 12:case"end":return e.stop()}}),e)}))),Oa.apply(this,arguments)}var La=l((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};u(this,e),this.isNewUser=t,this.providerId=n,this.profile=r})),Ma=function(e){_(n,e);var t=T(n);function n(e,r,i,a){var o;return u(this,n),(o=t.call(this,e,r,i)).username=a,o}return l(n)}(La),Fa=function(e){_(n,e);var t=T(n);function n(e,r){return u(this,n),t.call(this,e,"facebook.com",r)}return l(n)}(La),Ua=function(e){_(n,e);var t=T(n);function n(e,r){return u(this,n),t.call(this,e,"github.com",r,"string"===typeof(null===r||void 0===r?void 0:r.login)?null===r||void 0===r?void 0:r.login:null)}return l(n)}(Ma),ja=function(e){_(n,e);var t=T(n);function n(e,r){return u(this,n),t.call(this,e,"google.com",r)}return l(n)}(La),Va=function(e){_(n,e);var t=T(n);function n(e,r,i){return u(this,n),t.call(this,e,"twitter.com",r,i)}return l(n)}(Ma);function qa(e){var t=e.user,n=e._tokenResponse;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;var r=e.providerId,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},a=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null===e||void 0===e?void 0:e.idToken)){var o=null===(n=null===(t=or(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(o)return new La(a,"anonymous"!==o&&"custom"!==o?o:null)}if(!r)return null;switch(r){case"facebook.com":return new Fa(a,i);case"github.com":return new Ua(a,i);case"google.com":return new ja(a,i);case"twitter.com":return new Va(a,i,e.screenName||null);case"custom":case"anonymous":return new La(a,null);default:return new La(a,r,i)}}(n)}function Ba(e,t,n,r){return Ie(e).onIdTokenChanged(t,n,r)}function za(e,t,n){return Ie(e).beforeAuthStateChanged(t,n)}var Wa=function(){function e(t,n,r){u(this,e),this.type=t,this.credential=n,this.auth=r}return l(e,[{key:"toJSON",value:function(){return{multiFactorSession:d({},"enroll"===this.type?"idToken":"pendingCredential",this.credential)}}}],[{key:"_fromIdtoken",value:function(t,n){return new e("enroll",t,n)}},{key:"_fromMfaPendingCredential",value:function(t){return new e("signin",t)}},{key:"fromJSON",value:function(t){var n,r;if(null===t||void 0===t?void 0:t.multiFactorSession){if(null===(n=t.multiFactorSession)||void 0===n?void 0:n.pendingCredential)return e._fromMfaPendingCredential(t.multiFactorSession.pendingCredential);if(null===(r=t.multiFactorSession)||void 0===r?void 0:r.idToken)return e._fromIdtoken(t.multiFactorSession.idToken)}return null}}]),e}(),Ka=function(){function e(t,n,r){u(this,e),this.session=t,this.hints=n,this.signInResolver=r}return l(e,[{key:"resolveSignIn",value:function(){var e=h(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,e.abrupt("return",this.signInResolver(n));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"_fromError",value:function(t,n){var r=qr(t),i=n.customData._serverResponse,a=(i.mfaInfo||[]).map((function(e){return la._fromServerResponse(r,e)}));En(i.mfaPendingCredential,r,"internal-error");var u=Wa._fromMfaPendingCredential(i.mfaPendingCredential);return new e(u,a,function(){var e=h(o().mark((function e(t){var a,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._process(r,u);case 2:a=e.sent,delete i.mfaInfo,delete i.mfaPendingCredential,s=Object.assign(Object.assign({},i),{idToken:a.idToken,refreshToken:a.refreshToken}),e.t0=n.operationType,e.next="signIn"===e.t0?9:"reauthenticate"===e.t0?15:17;break;case 9:return e.next=11,ji._fromIdTokenResponse(r,n.operationType,s);case 11:return c=e.sent,e.next=14,r._updateCurrentUser(c.user);case 14:return e.abrupt("return",c);case 15:return En(n.user,r,"internal-error"),e.abrupt("return",ji._forOperation(n.user,n.operationType,s));case 17:_n(r,"internal-error");case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}]),e}();function Ha(e,t){return Bn(e,"POST","/v2/accounts/mfaEnrollment:start",qn(e,t))}function Ga(e,t){return Bn(e,"POST","/v2/accounts/mfaEnrollment:withdraw",qn(e,t))}var Qa=function(){function e(t){var n=this;u(this,e),this.user=t,this.enrolledFactors=[],t._onReload((function(e){e.mfaInfo&&(n.enrolledFactors=e.mfaInfo.map((function(e){return la._fromServerResponse(t.auth,e)})))}))}return l(e,[{key:"getSession",value:function(){var e=h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Wa,e.next=3,this.user.getIdToken();case 3:return e.t1=e.sent,e.t2=this.user.auth,e.abrupt("return",e.t0._fromIdtoken.call(e.t0,e.t1,e.t2));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"enroll",value:function(){var e=h(o().mark((function e(t,n){var r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t,e.next=3,this.getSession();case 3:return i=e.sent,e.next=6,ur(this.user,r._process(this.user.auth,i,n));case 6:return a=e.sent,e.next=9,this.user._updateTokensIfNecessary(a);case 9:return e.abrupt("return",this.user.reload());case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"unenroll",value:function(){var e=h(o().mark((function e(t){var n,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="string"===typeof t?t:t.uid,e.next=3,this.user.getIdToken();case 3:return r=e.sent,e.next=6,ur(this.user,Ga(this.user.auth,{idToken:r,mfaEnrollmentId:n}));case 6:return i=e.sent,this.enrolledFactors=this.enrolledFactors.filter((function(e){return e.uid!==n})),e.next=10,this.user._updateTokensIfNecessary(i);case 10:return e.prev=10,e.next=13,this.user.reload();case 13:e.next=19;break;case 15:if(e.prev=15,e.t0=e.catch(10),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("user-token-expired")){e.next=19;break}throw e.t0;case 19:case"end":return e.stop()}}),e,this,[[10,15]])})));return function(t){return e.apply(this,arguments)}}()}],[{key:"_fromUser",value:function(t){return new e(t)}}]),e}(),$a=new WeakMap;var Ya="__sak",Xa=function(){function e(t,n){u(this,e),this.storageRetriever=t,this.type=n}return l(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(Ya,"1"),this.storage.removeItem(Ya),Promise.resolve(!0)):Promise.resolve(!1)}catch(Wx){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}();var Ja=function(e){_(n,e);var t=T(n);function n(){var e;return u(this,n),(e=t.call(this,(function(){return window.localStorage}),"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.safariLocalStorageNotSynced=function(){var e=V();return Cr(e)||Or(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),e.fallbackToPolling=Fr(),e._shouldAllowMigration=!0,e}return l(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],i=this.storage.getItem(r),a=this.localCache[r];i!==a&&e(r,a,i)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}var a=function(){var e=t.storage.getItem(r);(n||t.localCache[r]!==e)&&t.notifyListeners(r,e)},o=this.storage.getItem(r);Mr()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,10):a()}else this.forAllChangedKeys((function(e,n,r){t.notifyListeners(e,r)}))}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t?JSON.parse(t):t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval((function(){e.forAllChangedKeys((function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)}))}),1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(){var e=h(o().mark((function e(t,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tn(x(n.prototype),"_set",this).call(this,t,r);case 2:this.localCache[t]=JSON.stringify(r);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=h(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tn(x(n.prototype),"_get",this).call(this,t);case 2:return r=e.sent,this.localCache[t]=JSON.stringify(r),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tn(x(n.prototype),"_remove",this).call(this,t);case 2:delete this.localCache[t];case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Xa);Ja.type="LOCAL";var Za=Ja,eo=function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.call(this,(function(){return window.sessionStorage}),"SESSION")}return l(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(Xa);eo.type="SESSION";var to=eo;function no(e){return Promise.all(e.map(function(){var e=h(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t;case 3:return n=e.sent,e.abrupt("return",{fulfilled:!0,value:n});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t0});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()))}var ro=function(){function e(t){u(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return l(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(){var e=h(o().mark((function e(t){var n,r,i,a,u,s,c,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=t).data,i=r.eventId,a=r.eventType,u=r.data,null===(s=this.handlersMap[a])||void 0===s?void 0:s.size){e.next=5;break}return e.abrupt("return");case 5:return n.ports[0].postMessage({status:"ack",eventId:i,eventType:a}),c=Array.from(s).map(function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(n.origin,u));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=9,no(c);case 9:l=e.sent,n.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:l});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find((function(e){return e.isListeningto(t)}));if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();function io(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}ro.receivers=[];var ao=function(){function e(t){u(this,e),this.target=t,this.handlers=new Set}return l(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(){var e=h(o().mark((function e(t,n){var r,i,a,u,s=this,c=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.length>2&&void 0!==c[2]?c[2]:50,i="undefined"!==typeof MessageChannel?new MessageChannel:null){e.next=4;break}throw new Error("connection_unavailable");case 4:return e.abrupt("return",new Promise((function(e,o){var c=io("",20);i.port1.start();var l=setTimeout((function(){o(new Error("unsupported_event"))}),r);u={messageChannel:i,onMessage:function(t){var n=t;if(n.data.eventId===c)switch(n.data.status){case"ack":clearTimeout(l),a=setTimeout((function(){o(new Error("timeout"))}),3e3);break;case"done":clearTimeout(a),e(n.data.response);break;default:clearTimeout(l),clearTimeout(a),o(new Error("invalid_response"))}}},s.handlers.add(u),i.port1.addEventListener("message",u.onMessage),s.target.postMessage({eventType:t,eventId:c,data:n},[i.port2])})).finally((function(){u&&s.removeMessageHandler(u)})));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function oo(){return window}function uo(){return"undefined"!==typeof oo().WorkerGlobalScope&&"function"===typeof oo().importScripts}function so(){return co.apply(this,arguments)}function co(){return(co=h(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===navigator||void 0===navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return t=e.sent,e.abrupt("return",t.active);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function lo(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}var fo="firebaseLocalStorageDb",ho="firebaseLocalStorage",po="fbase_key",vo=function(){function e(t){u(this,e),this.request=t}return l(e,[{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.request.addEventListener("success",(function(){t(e.request.result)})),e.request.addEventListener("error",(function(){n(e.request.error)}))}))}}]),e}();function yo(e,t){return e.transaction([ho],t?"readwrite":"readonly").objectStore(ho)}function mo(){var e=indexedDB.deleteDatabase(fo);return new vo(e).toPromise()}function go(){var e=indexedDB.open(fo,1);return new Promise((function(t,n){e.addEventListener("error",(function(){n(e.error)})),e.addEventListener("upgradeneeded",(function(){var t=e.result;try{t.createObjectStore(ho,{keyPath:po})}catch(r){n(r)}})),e.addEventListener("success",h(o().mark((function n(){var r;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((r=e.result).objectStoreNames.contains(ho)){n.next=12;break}return r.close(),n.next=5,mo();case 5:return n.t0=t,n.next=8,go();case 8:n.t1=n.sent,(0,n.t0)(n.t1),n.next=13;break;case 12:t(r);case 13:case"end":return n.stop()}}),n)}))))}))}function ko(e,t,n){return bo.apply(this,arguments)}function bo(){return bo=h(o().mark((function e(t,n,r){var i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=yo(t,!0).put((d(i={},po,n),d(i,"value",r),i)),e.abrupt("return",new vo(a).toPromise());case 2:case"end":return e.stop()}}),e)}))),bo.apply(this,arguments)}function wo(e,t){return _o.apply(this,arguments)}function _o(){return _o=h(o().mark((function e(t,n){var r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=yo(t,!1).get(n),e.next=3,new vo(r).toPromise();case 3:return i=e.sent,e.abrupt("return",void 0===i?null:i.value);case 5:case"end":return e.stop()}}),e)}))),_o.apply(this,arguments)}function xo(e,t){var n=yo(e,!0).delete(t);return new vo(n).toPromise()}var Io=function(){function e(){u(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((function(){}),(function(){}))}return l(e,[{key:"_openDb",value:function(){var e=h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.db){e.next=2;break}return e.abrupt("return",this.db);case 2:return e.next=4,go();case 4:return this.db=e.sent,e.abrupt("return",this.db);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_withRetries",value:function(){var e=h(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:return e.prev=2,e.next=5,this._openDb();case 5:return r=e.sent,e.next=8,t(r);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!(n++>3)){e.next=15;break}throw e.t0;case 15:this.db&&(this.db.close(),this.db=void 0);case 16:e.next=1;break;case 18:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"initializeServiceWorkerMessaging",value:function(){var e=h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",uo()?this.initializeReceiver():this.initializeSender());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeReceiver",value:function(){var e=h(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.receiver=ro._getInstance(uo()?self:null),this.receiver._subscribe("keyChanged",function(){var e=h(o().mark((function e(n,r){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._poll();case 2:return i=e.sent,e.abrupt("return",{keyProcessed:i.includes(r.key)});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),this.receiver._subscribe("ping",function(){var e=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeSender",value:function(){var e=h(o().mark((function e(){var t,n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,so();case 2:if(this.activeServiceWorker=e.sent,this.activeServiceWorker){e.next=5;break}return e.abrupt("return");case 5:return this.sender=new ao(this.activeServiceWorker),e.next=8,this.sender._send("ping",{},800);case 8:if(r=e.sent){e.next=11;break}return e.abrupt("return");case 11:(null===(t=r[0])||void 0===t?void 0:t.fulfilled)&&(null===(n=r[0])||void 0===n?void 0:n.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyServiceWorker",value:function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sender&&this.activeServiceWorker&&lo()===this.activeServiceWorker){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:case"end":return e.stop()}}),e,this,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_isAvailable",value:function(){var e=h(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,go();case 5:return t=e.sent,e.next=8,ko(t,Ya,"1");case 8:return e.next=10,xo(t,Ya);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"_withPendingWrite",value:function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pendingWrites++,e.prev=1,e.next=4,t();case 4:return e.prev=4,this.pendingWrites--,e.finish(4);case 7:case"end":return e.stop()}}),e,this,[[1,,4,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=h(o().mark((function e(t,n){var r=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite(h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._withRetries((function(e){return ko(e,t,n)}));case 2:return r.localCache[t]=n,e.abrupt("return",r.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=h(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){return wo(e,t)}));case 2:return n=e.sent,this.localCache[t]=n,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=h(o().mark((function e(t){var n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite(h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._withRetries((function(e){return xo(e,t)}));case 2:return delete n.localCache[t],e.abrupt("return",n.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_poll",value:function(){var e=h(o().mark((function e(){var t,n,r,i,a,u,s,c,l,f,h;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){var t=yo(e,!1).getAll();return new vo(t).toPromise()}));case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:if(0===this.pendingWrites){e.next=7;break}return e.abrupt("return",[]);case 7:n=[],r=new Set,i=y(t);try{for(i.s();!(a=i.n()).done;)u=a.value,s=u.fbase_key,c=u.value,r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(c)&&(this.notifyListeners(s,c),n.push(s))}catch(o){i.e(o)}finally{i.f()}for(l=0,f=Object.keys(this.localCache);l<f.length;l++)h=f[l],this.localCache[h]&&!r.has(h)&&(this.notifyListeners(h,null),n.push(h));return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(h(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}}),t)}))),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();Io.type="LOCAL";var So=Io;function To(e,t){return Bn(e,"POST","/v2/accounts/mfaSignIn:start",qn(e,t))}function Eo(e){return Co.apply(this,arguments)}function Co(){return Co=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bn(t,"GET","/v1/recaptchaParams");case 2:if(e.t0=e.sent.recaptchaSiteKey,e.t0){e.next=5;break}e.t0="";case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),e)}))),Co.apply(this,arguments)}function No(e){return new Promise((function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=xn("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}))}function Ro(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}var Ao=1e12,Po=function(){function e(t){u(this,e),this.auth=t,this.counter=Ao,this._widgets=new Map}return l(e,[{key:"render",value:function(e,t){var n=this.counter;return this._widgets.set(n,new Do(e,this.auth.name,t||{})),this.counter++,n}},{key:"reset",value:function(e){var t,n=e||Ao;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}},{key:"getResponse",value:function(e){var t,n=e||Ao;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}},{key:"execute",value:function(){var e=h(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t||Ao,null===(n=this._widgets.get(r))||void 0===n||n.execute(),e.abrupt("return","");case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Do=function(){function e(t,n,r){var i=this;u(this,e),this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=function(){i.execute()};var a="string"===typeof t?document.getElementById(t):t;En(a,"argument-error",{appName:n}),this.container=a,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}return l(e,[{key:"getResponse",value:function(){return this.checkIfDeleted(),this.responseToken}},{key:"delete",value:function(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}},{key:"execute",value:function(){var e=this;this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((function(){e.responseToken=function(e){for(var t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}(50);var t=e.params,n=t.callback,r=t["expired-callback"];if(n)try{n(e.responseToken)}catch(i){}e.timerId=window.setTimeout((function(){if(e.timerId=null,e.responseToken=null,r)try{r()}catch(i){}e.isVisible&&e.execute()}),6e4)}),500))}},{key:"checkIfDeleted",value:function(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}]),e}();var Oo=Ro("rcb"),Lo=new Mn(3e4,6e4),Mo="https://www.google.com/recaptcha/api.js?",Fo=function(){function e(){var t;u(this,e),this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(t=oo().grecaptcha)||void 0===t?void 0:t.render)}return l(e,[{key:"load",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return En(Uo(n),e,"argument-error"),this.shouldResolveImmediately(n)?Promise.resolve(oo().grecaptcha):new Promise((function(r,i){var a=oo().setTimeout((function(){i(xn(e,"network-request-failed"))}),Lo.get());oo()[Oo]=function(){oo().clearTimeout(a),delete oo()[Oo];var o=oo().grecaptcha;if(o){var u=o.render;o.render=function(e,n){var r=u(e,n);return t.counter++,r},t.hostLanguage=n,r(o)}else i(xn(e,"internal-error"))},No("".concat(Mo,"?").concat(ve({onload:Oo,render:"explicit",hl:n}))).catch((function(){clearTimeout(a),i(xn(e,"internal-error"))}))}))}},{key:"clearedOneInstance",value:function(){this.counter--}},{key:"shouldResolveImmediately",value:function(e){var t;return!!(null===(t=oo().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}]),e}();function Uo(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}var jo=function(){function e(){u(this,e)}return l(e,[{key:"load",value:function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Po(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearedOneInstance",value:function(){}}]),e}(),Vo="recaptcha",qo={theme:"light",type:"image"},Bo=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.assign({},qo),r=arguments.length>2?arguments[2]:void 0;u(this,e),this.parameters=n,this.type=Vo,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=qr(r),this.isInvisible="invisible"===this.parameters.size,En("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment");var i="string"===typeof t?document.getElementById(t):t;En(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new jo:new Fo,this.validateStartingState()}return l(e,[{key:"verify",value:function(){var e=h(o().mark((function e(){var t,n,r,i=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertNotDestroyed(),e.next=3,this.render();case 3:if(t=e.sent,n=this.getAssertedRecaptcha(),!(r=n.getResponse(t))){e.next=8;break}return e.abrupt("return",r);case 8:return e.abrupt("return",new Promise((function(e){i.tokenChangeListeners.add((function t(n){n&&(i.tokenChangeListeners.delete(t),e(n))})),i.isInvisible&&n.execute(t)})));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;try{this.assertNotDestroyed()}catch(t){return Promise.reject(t)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((function(t){throw e.renderPromise=null,t}))),this.renderPromise}},{key:"_reset",value:function(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}},{key:"clear",value:function(){var e=this;this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((function(t){e.container.removeChild(t)}))}},{key:"validateStartingState",value:function(){En(!this.parameters.sitekey,this.auth,"argument-error"),En(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),En("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment")}},{key:"makeTokenCallback",value:function(e){var t=this;return function(n){if(t.tokenChangeListeners.forEach((function(e){return e(n)})),"function"===typeof e)e(n);else if("string"===typeof e){var r=oo()[e];"function"===typeof r&&r(n)}}}},{key:"assertNotDestroyed",value:function(){En(!this.destroyed,this.auth,"internal-error")}},{key:"makeRenderPromise",value:function(){var e=h(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return this.widgetId||(t=this.container,this.isInvisible||(n=document.createElement("div"),t.appendChild(n),t=n),this.widgetId=this.getAssertedRecaptcha().render(t,this.parameters)),e.abrupt("return",this.widgetId);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(){var e=h(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return En(On()&&!uo(),this.auth,"internal-error"),e.next=3,zo();case 3:return e.next=5,this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);case 5:return this.recaptcha=e.sent,e.next=8,Eo(this.auth);case 8:En(t=e.sent,this.auth,"internal-error"),this.parameters.sitekey=t;case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAssertedRecaptcha",value:function(){return En(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}]),e}();function zo(){var e=null;return new Promise((function(t){"complete"!==document.readyState?(e=function(){return t()},window.addEventListener("load",e)):t()})).catch((function(t){throw e&&window.removeEventListener("load",e),t}))}var Wo=function(){function e(t,n){u(this,e),this.verificationId=t,this.onConfirmation=n}return l(e,[{key:"confirm",value:function(e){var t=Si._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}]),e}();function Ko(){return Ko=h(o().mark((function e(t,n,r){var i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=qr(t),e.next=3,$o(i,n,Ie(r));case 3:return a=e.sent,e.abrupt("return",new Wo(a,(function(e){return ta(i,e)})));case 5:case"end":return e.stop()}}),e)}))),Ko.apply(this,arguments)}function Ho(e,t,n){return Go.apply(this,arguments)}function Go(){return(Go=h(o().mark((function e(t,n,r){var i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Ie(t),e.next=3,$i(!1,i,"phone");case 3:return e.next=5,$o(i.auth,n,Ie(r));case 5:return a=e.sent,e.abrupt("return",new Wo(a,(function(e){return ra(i,e)})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qo(){return(Qo=h(o().mark((function e(t,n,r){var i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Ie(t),e.next=3,$o(i.auth,n,Ie(r));case 3:return a=e.sent,e.abrupt("return",new Wo(a,(function(e){return aa(i,e)})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $o(e,t,n){return Yo.apply(this,arguments)}function Yo(){return Yo=h(o().mark((function e(t,n,r){var i,a,u,s,c,l,f,h,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.verify();case 2:if(a=e.sent,e.prev=3,En("string"===typeof a,t,"argument-error"),En(r.type===Vo,t,"argument-error"),!("session"in(u="string"===typeof n?{phoneNumber:n}:n))){e.next=26;break}if(s=u.session,!("phoneNumber"in u)){e.next=17;break}return En("enroll"===s.type,t,"internal-error"),e.next=13,Ha(t,{idToken:s.credential,phoneEnrollmentInfo:{phoneNumber:u.phoneNumber,recaptchaToken:a}});case 13:return c=e.sent,e.abrupt("return",c.phoneSessionInfo.sessionInfo);case 17:return En("signin"===s.type,t,"internal-error"),En(l=(null===(i=u.multiFactorHint)||void 0===i?void 0:i.uid)||u.multiFactorUid,t,"missing-multi-factor-info"),e.next=22,To(t,{mfaPendingCredential:s.credential,mfaEnrollmentId:l,phoneSignInInfo:{recaptchaToken:a}});case 22:return f=e.sent,e.abrupt("return",f.phoneResponseInfo.sessionInfo);case 24:e.next=31;break;case 26:return e.next=28,ki(t,{phoneNumber:u.phoneNumber,recaptchaToken:a});case 28:return h=e.sent,d=h.sessionInfo,e.abrupt("return",d);case 31:return e.prev=31,r._reset(),e.finish(31);case 34:case"end":return e.stop()}}),e,null,[[3,,31,34]])}))),Yo.apply(this,arguments)}function Xo(){return(Xo=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gi(Ie(t),n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Jo=function(){function e(t){u(this,e),this.providerId=e.PROVIDER_ID,this.auth=qr(t)}return l(e,[{key:"verifyPhoneNumber",value:function(e,t){return $o(this.auth,e,Ie(t))}}],[{key:"credential",value:function(e,t){return Si._fromVerification(e,t)}},{key:"credentialFromResult",value:function(t){var n=t;return e.credentialFromTaggedObject(n)}},{key:"credentialFromError",value:function(t){return e.credentialFromTaggedObject(t.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.phoneNumber,r=t.temporaryProof;return n&&r?Si._fromTokenResponse(n,r):null}}]),e}();function Zo(e,t){return t?An(t):(En(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Jo.PROVIDER_ID="phone",Jo.PHONE_SIGN_IN_METHOD="phone";var eu=function(e){_(n,e);var t=T(n);function n(e){var r;return u(this,n),(r=t.call(this,"custom","custom")).params=e,r}return l(n,[{key:"_getIdTokenResponse",value:function(e){return yi(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return yi(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return yi(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(Hr);function tu(e){return Zi(e.auth,new eu(e),e.bypassAuthState)}function nu(e){var t=e.auth,n=e.user;return En(n,t,"internal-error"),Xi(n,new eu(e),e.bypassAuthState)}function ru(e){return iu.apply(this,arguments)}function iu(){return iu=h(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,En(r=t.user,n,"internal-error"),e.abrupt("return",Gi(r,new eu(t),t.bypassAuthState));case 3:case"end":return e.stop()}}),e)}))),iu.apply(this,arguments)}var au=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];u(this,e),this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return l(e,[{key:"execute",value:function(){var e=this;return new Promise(function(){var t=h(o().mark((function t(n,r){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.pendingPromise={resolve:n,reject:r},t.prev=1,t.next=4,e.resolver._initialize(e.auth);case 4:return e.eventManager=t.sent,t.next=7,e.onExecution();case 7:e.eventManager.registerConsumer(e),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),e.reject(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"onAuthEvent",value:function(){var e=h(o().mark((function e(t){var n,r,i,a,u,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.urlResponse,r=t.sessionId,i=t.postBody,a=t.tenantId,u=t.error,s=t.type,!u){e.next=4;break}return this.reject(u),e.abrupt("return");case 4:return c={auth:this.auth,requestUri:n,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState},e.prev=5,e.t0=this,e.next=9,this.getIdpTask(s)(c);case 9:e.t1=e.sent,e.t0.resolve.call(e.t0,e.t1),e.next=16;break;case 13:e.prev=13,e.t2=e.catch(5),this.reject(e.t2);case 16:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return tu;case"linkViaPopup":case"linkViaRedirect":return ru;case"reauthViaPopup":case"reauthViaRedirect":return nu;default:_n(this.auth,"internal-error")}}},{key:"resolve",value:function(e){Nn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){Nn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),ou=new Mn(2e3,1e4);function uu(e,t,n){return su.apply(this,arguments)}function su(){return su=h(o().mark((function e(t,n,r){var i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=qr(t),Sn(t,n,Ci),a=Zo(i,r),u=new hu(i,"signInViaPopup",n,a),e.abrupt("return",u.executeNotNull());case 5:case"end":return e.stop()}}),e)}))),su.apply(this,arguments)}function cu(){return(cu=h(o().mark((function e(t,n,r){var i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Sn((i=Ie(t)).auth,n,Ci),a=Zo(i.auth,r),u=new hu(i.auth,"reauthViaPopup",n,a,i),e.abrupt("return",u.executeNotNull());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lu(e,t,n){return fu.apply(this,arguments)}function fu(){return(fu=h(o().mark((function e(t,n,r){var i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Sn((i=Ie(t)).auth,n,Ci),a=Zo(i.auth,r),u=new hu(i.auth,"linkViaPopup",n,a,i),e.abrupt("return",u.executeNotNull());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var hu=function(e){_(n,e);var t=T(n);function n(e,r,i,a,o){var s;return u(this,n),(s=t.call(this,e,r,a,o)).provider=i,s.authWindow=null,s.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=b(s),s}return l(n,[{key:"executeNotNull",value:function(){var e=h(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.execute();case 2:return En(t=e.sent,this.auth,"internal-error"),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=h(o().mark((function e(){var t,n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Nn(1===this.filter.length,"Popup operations only handle one event"),t=io(),e.next=4,this.resolver._openPopup(this.auth,this.provider,this.filter[0],t);case 4:this.authWindow=e.sent,this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((function(e){n.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(function(e){e||n.reject(xn(n.auth,"web-storage-unsupported"))})),this.pollUserCancellation();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(xn(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?e.pollId=window.setTimeout((function(){e.pollId=null,e.reject(xn(e.auth,"popup-closed-by-user"))}),2e3):e.pollId=window.setTimeout(t,ou.get())}()}}]),n}(au);hu.currentPopupAction=null;var du=new Map,pu=function(e){_(n,e);var t=T(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return u(this,n),(i=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,a)).eventId=null,i}return l(n,[{key:"execute",value:function(){var e=h(o().mark((function e(){var t,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=du.get(this.auth._key())){e.next=21;break}return e.prev=2,e.next=5,vu(this.resolver,this.auth);case 5:if(!e.sent){e.next=12;break}return e.next=9,tn(x(n.prototype),"execute",this).call(this);case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=null;case 13:r=e.t0,t=function(){return Promise.resolve(r)},e.next=20;break;case 17:e.prev=17,e.t1=e.catch(2),t=function(){return Promise.reject(e.t1)};case 20:du.set(this.auth._key(),t);case 21:return this.bypassAuthState||du.set(this.auth._key(),(function(){return Promise.resolve(null)})),e.abrupt("return",t());case 23:case"end":return e.stop()}}),e,this,[[2,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"onAuthEvent",value:function(){var e=h(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("signInViaRedirect"!==t.type){e.next=4;break}return e.abrupt("return",tn(x(n.prototype),"onAuthEvent",this).call(this,t));case 4:if("unknown"!==t.type){e.next=7;break}return this.resolve(null),e.abrupt("return");case 7:if(!t.eventId){e.next=17;break}return e.next=10,this.auth._redirectUserForId(t.eventId);case 10:if(!(r=e.sent)){e.next=16;break}return this.user=r,e.abrupt("return",tn(x(n.prototype),"onAuthEvent",this).call(this,t));case 16:this.resolve(null);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"cleanUp",value:function(){}}]),n}(au);function vu(e,t){return yu.apply(this,arguments)}function yu(){return yu=h(o().mark((function e(t,n){var r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=wu(n),i=bu(t),e.next=4,i._isAvailable();case 4:if(e.sent){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,i._get(r);case 8:return e.t0=e.sent,a="true"===e.t0,e.next=12,i._remove(r);case 12:return e.abrupt("return",a);case 13:case"end":return e.stop()}}),e)}))),yu.apply(this,arguments)}function mu(e,t){return gu.apply(this,arguments)}function gu(){return gu=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",bu(t)._set(wu(n),"true"));case 1:case"end":return e.stop()}}),e)}))),gu.apply(this,arguments)}function ku(e,t){du.set(e._key(),t)}function bu(e){return An(e._redirectPersistence)}function wu(e){return Ir("pendingRedirect",e.config.apiKey,e.name)}function _u(e,t,n){return function(e,t,n){return xu.apply(this,arguments)}(e,t,n)}function xu(){return xu=h(o().mark((function e(t,n,r){var i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=qr(t),Sn(t,n,Ci),a=Zo(i,r),e.next=5,mu(a,i);case 5:return e.abrupt("return",a._openRedirect(i,n,"signInViaRedirect"));case 6:case"end":return e.stop()}}),e)}))),xu.apply(this,arguments)}function Iu(e,t,n){return function(e,t,n){return Su.apply(this,arguments)}(e,t,n)}function Su(){return(Su=h(o().mark((function e(t,n,r){var i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Sn((i=Ie(t)).auth,n,Ci),a=Zo(i.auth,r),e.next=5,mu(a,i.auth);case 5:return e.next=7,Pu(i);case 7:return u=e.sent,e.abrupt("return",a._openRedirect(i.auth,n,"reauthViaRedirect",u));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Tu(e,t,n){return function(e,t,n){return Eu.apply(this,arguments)}(e,t,n)}function Eu(){return(Eu=h(o().mark((function e(t,n,r){var i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Sn((i=Ie(t)).auth,n,Ci),a=Zo(i.auth,r),e.next=5,$i(!1,i,n.providerId);case 5:return e.next=7,mu(a,i.auth);case 7:return e.next=9,Pu(i);case 9:return u=e.sent,e.abrupt("return",a._openRedirect(i.auth,n,"linkViaRedirect",u));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Cu(e,t){return Nu.apply(this,arguments)}function Nu(){return Nu=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qr(t)._initializationPromise;case 2:return e.abrupt("return",Ru(t,n,!1));case 3:case"end":return e.stop()}}),e)}))),Nu.apply(this,arguments)}function Ru(e,t){return Au.apply(this,arguments)}function Au(){return Au=h(o().mark((function e(t,n){var r,i,a,u,s,c=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>2&&void 0!==c[2]&&c[2],i=qr(t),a=Zo(i,n),u=new pu(i,a,r),e.next=6,u.execute();case 6:if(!(s=e.sent)||r){e.next=13;break}return delete s.user._redirectEventId,e.next=11,i._persistUserIfCurrent(s.user);case 11:return e.next=13,i._setRedirectUser(null,n);case 13:return e.abrupt("return",s);case 14:case"end":return e.stop()}}),e)}))),Au.apply(this,arguments)}function Pu(e){return Du.apply(this,arguments)}function Du(){return(Du=h(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=io("".concat(t.uid,":::")),t._redirectEventId=n,e.next=4,t.auth._setRedirectUser(t);case 4:return e.next=6,t.auth._persistUserIfCurrent(t);case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ou=function(){function e(t){u(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return l(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach((function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Mu(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!Mu(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(xn(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Lu(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(Lu(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function Lu(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((function(e){return e})).join("-")}function Mu(e){var t=e.type,n=e.error;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}function Fu(e){return Uu.apply(this,arguments)}function Uu(){return Uu=h(o().mark((function e(t){var n,r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",Bn(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}}),e)}))),Uu.apply(this,arguments)}var ju=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Vu=/^https?/;function qu(){return qu=h(o().mark((function e(t){var n,r,i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Fu(t);case 4:n=e.sent,r=n.authorizedDomains,i=y(r),e.prev=7,i.s();case 9:if((a=i.n()).done){e.next=20;break}if(u=a.value,e.prev=11,!Bu(u)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),i.e(e.t1);case 25:return e.prev=25,i.f(),e.finish(25);case 28:_n(t,"unauthorized-domain");case 29:case"end":return e.stop()}}),e,null,[[7,22,25,28],[11,16]])}))),qu.apply(this,arguments)}function Bu(e){var t=Dn(),n=new URL(t),r=n.protocol,i=n.hostname;if(e.startsWith("chrome-extension://")){var a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===i}if(!Vu.test(r))return!1;if(ju.test(e))return i===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}var zu=new Mn(3e4,6e4);function Wu(){var e=oo().___jsl;if(null===e||void 0===e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=Te(e.H[r].L),e.CP)for(var i=0;i<e.CP.length;i++)e.CP[i]=null}}var Ku=null;function Hu(e){return Ku=Ku||function(e){return new Promise((function(t,n){var r,i,a;function o(){Wu(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){Wu(),n(xn(e,"network-request-failed"))},timeout:zu.get()})}if(null===(i=null===(r=oo().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=oo().gapi)||void 0===a?void 0:a.load)){var u=Ro("iframefcb");return oo()[u]=function(){gapi.load?o():n(xn(e,"network-request-failed"))},No("https://apis.google.com/js/api.js?onload=".concat(u)).catch((function(e){return n(e)}))}o()}})).catch((function(e){throw Ku=null,e}))}(e),Ku}var Gu=new Mn(5e3,15e3),Qu={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},$u=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Yu(e){var t=e.config;En(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?Fn(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:_t},i=$u.get(e.config.apiHost);i&&(r.eid=i);var a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(ve(r).slice(1))}function Xu(e){return Ju.apply(this,arguments)}function Ju(){return Ju=h(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Hu(t);case 2:return n=e.sent,En(r=oo().gapi,t,"internal-error"),e.abrupt("return",n.open({where:document.body,url:Yu(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Qu,dontclear:!0},(function(e){return new Promise(function(){var n=h(o().mark((function n(r,i){var a,u,s;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=function(){oo().clearTimeout(u),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:a=xn(t,"network-request-failed"),u=oo().setTimeout((function(){i(a)}),Gu.get()),e.ping(s).then(s,(function(){i(a)}));case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())})));case 6:case"end":return e.stop()}}),e)}))),Ju.apply(this,arguments)}var Zu={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},es="_blank",ts="http://localhost",ns=function(){function e(t){u(this,e),this.window=t,this.associatedEvent=null}return l(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),e}();function rs(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",s=Object.assign(Object.assign({},Zu),{width:r.toString(),height:i.toString(),top:a,left:o}),c=V().toLowerCase();n&&(u=Nr(c)?es:n),Er(c)&&(t=t||ts,s.scrollbars="yes");var l=Object.entries(s).reduce((function(e,t){var n=k(t,2),r=n[0],i=n[1];return"".concat(e).concat(r,"=").concat(i,",")}),"");if(Lr(c)&&"_self"!==u)return is(t||"",u),new ns(null);var f=window.open(t||"",u,l);En(f,e,"popup-blocked");try{f.focus()}catch(h){}return new ns(f)}function is(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}var as="__/auth/handler",os="emulator/auth/handler";function us(e,t,n,r,i,a){En(e.config.authDomain,e,"auth-domain-config-required"),En(e.config.apiKey,e,"invalid-api-key");var o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:_t,eventId:i};if(t instanceof Ci){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",fe(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(var u=0,s=Object.entries(a||{});u<s.length;u++){var c=k(s[u],2),l=c[0],f=c[1];o[l]=f}}if(t instanceof Ni){var h=t.getScopes().filter((function(e){return""!==e}));h.length>0&&(o.scopes=h.join(","))}e.tenantId&&(o.tid=e.tenantId);for(var d=o,p=0,v=Object.keys(d);p<v.length;p++){var y=v[p];void 0===d[y]&&delete d[y]}return"".concat(function(e){var t=e.config;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(as);return Fn(t,os)}(e),"?").concat(ve(d).slice(1))}var ss="webStorageSupport",cs=function(){function e(){u(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=to,this._completeRedirectFn=Ru,this._overrideRedirectResult=ku}return l(e,[{key:"_openPopup",value:function(){var e=h(o().mark((function e(t,n,r,i){var a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Nn(null===(a=this.eventManagers[t._key()])||void 0===a?void 0:a.manager,"_initialize() not called before _openPopup()"),u=us(t,n,r,Dn(),i),e.abrupt("return",rs(t,u,io()));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_openRedirect",value:function(){var e=h(o().mark((function e(t,n,r,i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._originValidation(t);case 2:return a=us(t,n,r,Dn(),i),oo().location.href=a,e.abrupt("return",new Promise((function(){})));case 4:case"end":return e.stop()}var a}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],i=r.manager,a=r.promise;return i?Promise.resolve(i):(Nn(a,"If manager is not set, promise should be"),a)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch((function(){delete t.eventManagers[n]})),o}},{key:"initAndGetManager",value:function(){var e=h(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xu(t);case 2:return n=e.sent,r=new Ou(t),n.register("authEvent",(function(e){return En(null===e||void 0===e?void 0:e.authEvent,t,"invalid-auth-event"),{status:r.onEvent(e.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:r},this.iframes[t._key()]=n,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(ss,{type:ss},(function(n){var r,i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[ss];void 0!==i&&t(!!i),_n(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return qu.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return Fr()||Cr()||Or()}}]),e}(),ls=cs,fs=function(){function e(t){u(this,e),this.factorId=t}return l(e,[{key:"_process",value:function(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return Cn("unexpected MultiFactorSessionType")}}}]),e}(),hs=function(e){_(n,e);var t=T(n);function n(e){var r;return u(this,n),(r=t.call(this,"phone")).credential=e,r}return l(n,[{key:"_finalizeEnroll",value:function(e,t,n){return function(e,t){return Bn(e,"POST","/v2/accounts/mfaEnrollment:finalize",qn(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},{key:"_finalizeSignIn",value:function(e,t){return function(e,t){return Bn(e,"POST","/v2/accounts/mfaSignIn:finalize",qn(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}],[{key:"_fromCredential",value:function(e){return new n(e)}}]),n}(fs),ds=function(){function e(){u(this,e)}return l(e,null,[{key:"assertion",value:function(e){return hs._fromCredential(e)}}]),e}();ds.FACTOR_ID="phone";var ps="@firebase/auth",vs="0.21.0",ys=function(){function e(t){u(this,e),this.auth=t,this.internalListeners=new Map}return l(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(){var e=h(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertAuthConfigured(),e.next=3,this.auth._initializationPromise;case 3:if(this.auth.currentUser){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,this.auth.currentUser.getIdToken(t);case 7:return n=e.sent,e.abrupt("return",{accessToken:n});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged((function(t){e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){En(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();var ms,gs=Z("authIdTokenMaxAge")||300,ks=null,bs=function(e){return function(){var t=h(o().mark((function t(n){var r,i,a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=n,!t.t0){t.next=5;break}return t.next=4,n.getIdTokenResult();case 4:t.t0=t.sent;case 5:if(r=t.t0,!((i=r&&((new Date).getTime()-Date.parse(r.issuedAtTime))/1e3)&&i>gs)){t.next=9;break}return t.abrupt("return");case 9:if(a=null===r||void 0===r?void 0:r.token,ks!==a){t.next=12;break}return t.abrupt("return");case 12:return ks=a,t.next=15,fetch(e,{method:a?"POST":"DELETE",headers:a?{Authorization:"Bearer ".concat(a)}:{}});case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};function ws(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:It(),t=yt(e,"auth");if(t.isInitialized())return t.getImmediate();var n=Pn(e,{popupRedirectResolver:ls,persistence:[So,Za,to]}),r=Z("authTokenSyncURL");if(r){var i=bs(r);za(n,i,(function(){return i(n.currentUser)})),Ba(n,(function(e){return i(e)}))}var a=Y("auth");return a&&zr(n,"http://".concat(a)),n}function _s(){return window}ms="Browser",vt(new Ee("auth",(function(e,t){var n=t.options,r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=r.options,o=a.apiKey,u=a.authDomain;return function(e,t){En(o&&!o.includes(":"),"invalid-api-key",{appName:e.name}),En(!(null===u||void 0===u?void 0:u.includes(":")),"argument-error",{appName:e.name});var r={apiKey:o,authDomain:u,clientPlatform:ms,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ur(ms)},i=new Vr(e,t,r);return function(e,t){var n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(An);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(i,n),i}(r,i)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(e,t,n){e.getProvider("auth-internal").initialize()}))),vt(new Ee("auth-internal",(function(e){return function(e){return new ys(e)}(qr(e.getProvider("auth").getImmediate()))}),"PRIVATE").setInstantiationMode("EXPLICIT")),Ct(ps,vs,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(ms)),Ct(ps,vs,"esm2017");function xs(e,t,n){return Is.apply(this,arguments)}function Is(){return Is=h(o().mark((function e(t,n,r){var i,a,u,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_s(),u=a.BuildInfo,Nn(n.sessionId,"AuthEvent did not contain a session ID"),e.next=4,Rs(n.sessionId);case 4:return s=e.sent,c={},Or()?c.ibi=u.packageName:Ar()?c.apn=u.packageName:_n(t,"operation-not-supported-in-this-environment"),u.displayName&&(c.appDisplayName=u.displayName),c.sessionId=s,e.abrupt("return",us(t,r,n.type,void 0,null!==(i=n.eventId)&&void 0!==i?i:void 0,c));case 10:case"end":return e.stop()}}),e)}))),Is.apply(this,arguments)}function Ss(){return Ss=h(o().mark((function e(t){var n,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=_s(),r=n.BuildInfo,i={},Or()?i.iosBundleId=r.packageName:Ar()?i.androidPackageName=r.packageName:_n(t,"operation-not-supported-in-this-environment"),e.next=5,Fu(t,i);case 5:case"end":return e.stop()}}),e)}))),Ss.apply(this,arguments)}function Ts(e){var t=_s().cordova;return new Promise((function(n){t.plugins.browsertab.isAvailable((function(r){var i=null;r?t.plugins.browsertab.openUrl(e):i=t.InAppBrowser.open(e,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V();return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}()?"_blank":"_system","location=yes"),n(i)}))}))}function Es(e,t,n){return Cs.apply(this,arguments)}function Cs(){return Cs=h(o().mark((function e(t,n,r){var i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=_s(),a=i.cordova,u=function(){},e.prev=2,e.next=5,new Promise((function(e,i){var o=null;function s(){var t;e();var n=null===(t=a.plugins.browsertab)||void 0===t?void 0:t.close;"function"===typeof n&&n(),"function"===typeof(null===r||void 0===r?void 0:r.close)&&r.close()}function c(){o||(o=window.setTimeout((function(){i(xn(t,"redirect-cancelled-by-user"))}),2e3))}function l(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&c()}n.addPassiveListener(s),document.addEventListener("resume",c,!1),Ar()&&document.addEventListener("visibilitychange",l,!1),u=function(){n.removePassiveListener(s),document.removeEventListener("resume",c,!1),document.removeEventListener("visibilitychange",l,!1),o&&window.clearTimeout(o)}}));case 5:return e.prev=5,u(),e.finish(5);case 8:case"end":return e.stop()}}),e,null,[[2,,5,8]])}))),Cs.apply(this,arguments)}function Ns(e){var t,n,r,i,a,o,u,s,c,l,f=_s();En("function"===typeof(null===(t=null===f||void 0===f?void 0:f.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),En("undefined"!==typeof(null===(n=null===f||void 0===f?void 0:f.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),En("function"===typeof(null===(a=null===(i=null===(r=null===f||void 0===f?void 0:f.cordova)||void 0===r?void 0:r.plugins)||void 0===i?void 0:i.browsertab)||void 0===a?void 0:a.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),En("function"===typeof(null===(s=null===(u=null===(o=null===f||void 0===f?void 0:f.cordova)||void 0===o?void 0:o.plugins)||void 0===u?void 0:u.browsertab)||void 0===s?void 0:s.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),En("function"===typeof(null===(l=null===(c=null===f||void 0===f?void 0:f.cordova)||void 0===c?void 0:c.InAppBrowser)||void 0===l?void 0:l.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}function Rs(e){return As.apply(this,arguments)}function As(){return(As=h(o().mark((function e(t){var n,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Ps(t),e.next=3,crypto.subtle.digest("SHA-256",n);case 3:return r=e.sent,i=Array.from(new Uint8Array(r)),e.abrupt("return",i.map((function(e){return e.toString(16).padStart(2,"0")})).join(""));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ps(e){if(Nn(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!==typeof TextEncoder)return(new TextEncoder).encode(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}var Ds=function(e){_(n,e);var t=T(n);function n(){var e;return u(this,n),(e=t.apply(this,arguments)).passiveListeners=new Set,e.initPromise=new Promise((function(t){e.resolveInialized=t})),e}return l(n,[{key:"addPassiveListener",value:function(e){this.passiveListeners.add(e)}},{key:"removePassiveListener",value:function(e){this.passiveListeners.delete(e)}},{key:"resetRedirect",value:function(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}},{key:"onEvent",value:function(e){return this.resolveInialized(),this.passiveListeners.forEach((function(t){return t(e)})),tn(x(n.prototype),"onEvent",this).call(this,e)}},{key:"initialized",value:function(){var e=h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initPromise;case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Ou);function Os(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:t,eventId:n,urlResponse:null,sessionId:js(),postBody:null,tenantId:e.tenantId,error:xn(e,"no-auth-event")}}function Ls(e,t){return Vs()._set(qs(e),t)}function Ms(e){return Fs.apply(this,arguments)}function Fs(){return Fs=h(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Vs()._get(qs(t));case 2:if(!(n=e.sent)){e.next=6;break}return e.next=6,Vs()._remove(qs(t));case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)}))),Fs.apply(this,arguments)}function Us(e,t){var n,r,i=function(e){var t=Bs(e),n=t.link?decodeURIComponent(t.link):void 0,r=Bs(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return Bs(i).link||i||r||n||e}(t);if(i.includes("/__/auth/callback")){var a=Bs(i),o=a.firebaseError?function(e){try{return JSON.parse(e)}catch(t){return null}}(decodeURIComponent(a.firebaseError)):null,u=null===(r=null===(n=null===o||void 0===o?void 0:o.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],s=u?xn(u):null;return s?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:s,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:i,postBody:null}}return null}function js(){for(var e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",n=0;n<20;n++){var r=Math.floor(Math.random()*t.length);e.push(t.charAt(r))}return e.join("")}function Vs(){return An(Za)}function qs(e){return Ir("authEvent",e.config.apiKey,e.name)}function Bs(e){if(!(null===e||void 0===e?void 0:e.includes("?")))return{};var t=Zt(e.split("?"));t[0];return ye(t.slice(1).join("?"))}var zs=function(){function e(){u(this,e),this._redirectPersistence=to,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Ru,this._overrideRedirectResult=ku}return l(e,[{key:"_initialize",value:function(){var e=h(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t._key(),(r=this.eventManagers.get(n))||(r=new Ds(t),this.eventManagers.set(n,r),this.attachCallbackListeners(t,r)),e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_openPopup",value:function(e){_n(e,"operation-not-supported-in-this-environment")}},{key:"_openRedirect",value:function(){var e=h(o().mark((function e(t,n,r,i){var a,u,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ns(t),e.next=3,this._initialize(t);case 3:return a=e.sent,e.next=6,a.initialized();case 6:return a.resetRedirect(),du.clear(),e.next=10,this._originValidation(t);case 10:return u=Os(t,r,i),e.next=13,Ls(t,u);case 13:return e.next=15,xs(t,u,n);case 15:return s=e.sent,e.next=18,Ts(s);case 18:return c=e.sent,e.abrupt("return",Es(t,a,c));case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){throw new Error("Method not implemented.")}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return Ss.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"attachCallbackListeners",value:function(e,t){var n=_s(),r=n.universalLinks,i=n.handleOpenURL,a=n.BuildInfo,u=setTimeout(h(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ms(e);case 2:t.onEvent(Ks());case 3:case"end":return n.stop()}}),n)}))),500),s=function(){var n=h(o().mark((function n(r){var i,a;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return clearTimeout(u),n.next=3,Ms(e);case 3:i=n.sent,a=null,i&&(null===r||void 0===r?void 0:r.url)&&(a=Us(i,r.url)),t.onEvent(a||Ks());case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();"undefined"!==typeof r&&"function"===typeof r.subscribe&&r.subscribe(null,s);var c=i,l="".concat(a.packageName.toLowerCase(),"://");_s().handleOpenURL=function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.toLowerCase().startsWith(l)&&s({url:t}),"function"===typeof c)try{c(t)}catch(n){console.error(n)}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}]),e}(),Ws=zs;function Ks(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:xn("no-auth-event")}}function Hs(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function Gs(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V();return!("file:"!==Hs()&&"ionic:"!==Hs()&&"capacitor:"!==Hs()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function Qs(){return K()&&11===(null===document||void 0===document?void 0:document.documentMode)}function $s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V();return/Edge\/\d+/.test(e)}function Ys(){try{var e=self.localStorage,t=io();if(e)return e.setItem(t,"1"),e.removeItem(t),!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V();return Qs()||$s(e)}()||G()}catch(n){return Xs()&&G()}return!1}function Xs(){return"undefined"!==typeof n.g&&"WorkerGlobalScope"in n.g&&"importScripts"in n.g}function Js(){return("http:"===Hs()||"https:"===Hs()||z()||Gs())&&!(W()||B())&&Ys()&&!Xs()}function Zs(){return Gs()&&"undefined"!==typeof document}function ec(){return tc.apply(this,arguments)}function tc(){return(tc=h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Zs()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.abrupt("return",new Promise((function(e){var t=setTimeout((function(){e(!1)}),1e3);document.addEventListener("deviceready",(function(){clearTimeout(t),e(!0)}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var nc={LOCAL:"local",NONE:"none",SESSION:"session"},rc=En,ic="persistence";function ac(e,t){rc(Object.values(nc).includes(t),e,"invalid-persistence-type"),W()?rc(t!==nc.SESSION,e,"unsupported-persistence-type"):B()?rc(t===nc.NONE,e,"unsupported-persistence-type"):Xs()?rc(t===nc.NONE||t===nc.LOCAL&&G(),e,"unsupported-persistence-type"):rc(t===nc.NONE||Ys(),e,"unsupported-persistence-type")}function oc(e){return uc.apply(this,arguments)}function uc(){return uc=h(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._initializationPromise;case 2:n=sc(),r=Ir(ic,t.config.apiKey,t.name),n&&n.setItem(r,t._getPersistence());case 5:case"end":return e.stop()}}),e)}))),uc.apply(this,arguments)}function sc(){var e;try{return(null===(e="undefined"!==typeof window?window:null)||void 0===e?void 0:e.sessionStorage)||null}catch(t){return null}}var cc=En,lc=function(){function e(){u(this,e),this.browserResolver=An(ls),this.cordovaResolver=An(Ws),this.underlyingResolver=null,this._redirectPersistence=to,this._completeRedirectFn=Ru,this._overrideRedirectResult=ku}return l(e,[{key:"_initialize",value:function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.selectUnderlyingResolver();case 2:return e.abrupt("return",this.assertedUnderlyingResolver._initialize(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_openPopup",value:function(){var e=h(o().mark((function e(t,n,r,i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.selectUnderlyingResolver();case 2:return e.abrupt("return",this.assertedUnderlyingResolver._openPopup(t,n,r,i));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_openRedirect",value:function(){var e=h(o().mark((function e(t,n,r,i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.selectUnderlyingResolver();case 2:return e.abrupt("return",this.assertedUnderlyingResolver._openRedirect(t,n,r,i));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}},{key:"_originValidation",value:function(e){return this.assertedUnderlyingResolver._originValidation(e)}},{key:"_shouldInitProactively",get:function(){return Zs()||this.browserResolver._shouldInitProactively}},{key:"assertedUnderlyingResolver",get:function(){return cc(this.underlyingResolver,"internal-error"),this.underlyingResolver}},{key:"selectUnderlyingResolver",value:function(){var e=h(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.underlyingResolver){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,ec();case 4:t=e.sent,this.underlyingResolver=t?this.cordovaResolver:this.browserResolver;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function fc(e){return e.unwrap()}function hc(e,t){var n,r=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===(null===t||void 0===t?void 0:t.code))t.resolver=new mc(e,function(e,t){var n,r=Ie(e),i=t;return En(t.customData.operationType,r,"argument-error"),En(null===(n=i.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,r,"argument-error"),Ka._fromError(r,i)}(e,t));else if(r){var i=dc(t),a=t;i&&(a.credential=i,a.tenantId=r.tenantId||void 0,a.email=r.email||void 0,a.phoneNumber=r.phoneNumber||void 0)}}function dc(e){var t=(e instanceof ne?e.customData:e)._tokenResponse;if(!t)return null;if(!(e instanceof ne)&&"temporaryProof"in t&&"phoneNumber"in t)return Jo.credentialFromResult(e);var n,r=t.providerId;if(!r||r===sn)return null;switch(r){case un:n=Pi;break;case an:n=Ai;break;case on:n=Di;break;case cn:n=Mi;break;default:var i=t.oauthIdToken,a=t.oauthAccessToken,o=t.oauthTokenSecret,u=t.pendingToken,s=t.nonce;return a||o||i||u?u?r.startsWith("saml.")?Oi._create(r,u):gi._fromParams({providerId:r,signInMethod:r,pendingToken:u,idToken:i,accessToken:a}):new Ri(r).credential({idToken:i,accessToken:a,rawNonce:s}):null}return e instanceof ne?n.credentialFromError(e):n.credentialFromResult(e)}function pc(e,t){return t.catch((function(t){throw t instanceof ne&&hc(e,t),t})).then((function(e){var t,n=e.operationType,r=e.user;return{operationType:n,credential:(t=e,dc(t)),additionalUserInfo:qa(e),user:gc.getOrCreate(r)}}))}function vc(e,t){return yc.apply(this,arguments)}function yc(){return yc=h(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n;case 2:return r=e.sent,e.abrupt("return",{verificationId:r.verificationId,confirm:function(e){return pc(t,r.confirm(e))}});case 4:case"end":return e.stop()}}),e)}))),yc.apply(this,arguments)}var mc=function(){function e(t,n){u(this,e),this.resolver=n,this.auth=t.wrapped()}return l(e,[{key:"session",get:function(){return this.resolver.session}},{key:"hints",get:function(){return this.resolver.hints}},{key:"resolveSignIn",value:function(e){return pc(fc(this.auth),this.resolver.resolveSignIn(e))}}]),e}(),gc=function(){function e(t){u(this,e),this._delegate=t,this.multiFactor=function(e){var t=Ie(e);return $a.has(t)||$a.set(t,Qa._fromUser(t)),$a.get(t)}(t)}return l(e,[{key:"delete",value:function(){return this._delegate.delete()}},{key:"reload",value:function(){return this._delegate.reload()}},{key:"toJSON",value:function(){return this._delegate.toJSON()}},{key:"getIdTokenResult",value:function(e){return this._delegate.getIdTokenResult(e)}},{key:"getIdToken",value:function(e){return this._delegate.getIdToken(e)}},{key:"linkAndRetrieveDataWithCredential",value:function(e){return this.linkWithCredential(e)}},{key:"linkWithCredential",value:function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",pc(this.auth,ra(this._delegate,t)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"linkWithPhoneNumber",value:function(){var e=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",vc(this.auth,Ho(this._delegate,t,n)));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"linkWithPopup",value:function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",pc(this.auth,lu(this._delegate,t,lc)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"linkWithRedirect",value:function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oc(qr(this.auth));case 2:return e.abrupt("return",Tu(this._delegate,t,lc));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reauthenticateAndRetrieveDataWithCredential",value:function(e){return this.reauthenticateWithCredential(e)}},{key:"reauthenticateWithCredential",value:function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",pc(this.auth,aa(this._delegate,t)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reauthenticateWithPhoneNumber",value:function(e,t){return vc(this.auth,function(e,t,n){return Qo.apply(this,arguments)}(this._delegate,e,t))}},{key:"reauthenticateWithPopup",value:function(e){return pc(this.auth,function(e,t,n){return cu.apply(this,arguments)}(this._delegate,e,lc))}},{key:"reauthenticateWithRedirect",value:function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oc(qr(this.auth));case 2:return e.abrupt("return",Iu(this._delegate,t,lc));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendEmailVerification",value:function(e){return function(e,t){return Ea.apply(this,arguments)}(this._delegate,e)}},{key:"unlink",value:function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ki(this._delegate,t);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateEmail",value:function(e){return function(e,t){return Da(Ie(e),t,null)}(this._delegate,e)}},{key:"updatePassword",value:function(e){return function(e,t){return Da(Ie(e),null,t)}(this._delegate,e)}},{key:"updatePhoneNumber",value:function(e){return function(e,t){return Xo.apply(this,arguments)}(this._delegate,e)}},{key:"updateProfile",value:function(e){return Aa(this._delegate,e)}},{key:"verifyBeforeUpdateEmail",value:function(e,t){return function(e,t,n){return Ca.apply(this,arguments)}(this._delegate,e,t)}},{key:"emailVerified",get:function(){return this._delegate.emailVerified}},{key:"isAnonymous",get:function(){return this._delegate.isAnonymous}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"phoneNumber",get:function(){return this._delegate.phoneNumber}},{key:"providerData",get:function(){return this._delegate.providerData}},{key:"refreshToken",get:function(){return this._delegate.refreshToken}},{key:"tenantId",get:function(){return this._delegate.tenantId}},{key:"displayName",get:function(){return this._delegate.displayName}},{key:"email",get:function(){return this._delegate.email}},{key:"photoURL",get:function(){return this._delegate.photoURL}},{key:"providerId",get:function(){return this._delegate.providerId}},{key:"uid",get:function(){return this._delegate.uid}},{key:"auth",get:function(){return this._delegate.auth}}],[{key:"getOrCreate",value:function(t){return e.USER_MAP.has(t)||e.USER_MAP.set(t,new e(t)),e.USER_MAP.get(t)}}]),e}();gc.USER_MAP=new WeakMap;var kc=En,bc=function(){function e(t,n){if(u(this,e),this.app=t,n.isInitialized())return this._delegate=n.getImmediate(),void this.linkUnderlyingAuth();var r=t.options.apiKey;kc(r,"invalid-api-key",{appName:t.name}),kc(r,"invalid-api-key",{appName:t.name});var i="undefined"!==typeof window?lc:void 0;this._delegate=n.initialize({options:{persistence:_c(r,t.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(mn),this.linkUnderlyingAuth()}return l(e,[{key:"emulatorConfig",get:function(){return this._delegate.emulatorConfig}},{key:"currentUser",get:function(){return this._delegate.currentUser?gc.getOrCreate(this._delegate.currentUser):null}},{key:"languageCode",get:function(){return this._delegate.languageCode},set:function(e){this._delegate.languageCode=e}},{key:"settings",get:function(){return this._delegate.settings}},{key:"tenantId",get:function(){return this._delegate.tenantId},set:function(e){this._delegate.tenantId=e}},{key:"useDeviceLanguage",value:function(){this._delegate.useDeviceLanguage()}},{key:"signOut",value:function(){return this._delegate.signOut()}},{key:"useEmulator",value:function(e,t){zr(this._delegate,e,t)}},{key:"applyActionCode",value:function(e){return function(e,t){return va.apply(this,arguments)}(this._delegate,e)}},{key:"checkActionCode",value:function(e){return ya(this._delegate,e)}},{key:"confirmPasswordReset",value:function(e,t){return function(e,t,n){return pa.apply(this,arguments)}(this._delegate,e,t)}},{key:"createUserWithEmailAndPassword",value:function(){var e=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",pc(this._delegate,ka(this._delegate,t,n)));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fetchProvidersForEmail",value:function(e){return this.fetchSignInMethodsForEmail(e)}},{key:"fetchSignInMethodsForEmail",value:function(e){return function(e,t){return Ta.apply(this,arguments)}(this._delegate,e)}},{key:"isSignInWithEmailLink",value:function(e){return function(e,t){var n=Ti.parseLink(t);return"EMAIL_SIGNIN"===(null===n||void 0===n?void 0:n.operation)}(this._delegate,e)}},{key:"getRedirectResult",value:function(){var e=h(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return kc(Js(),this._delegate,"operation-not-supported-in-this-environment"),e.next=3,Cu(this._delegate,lc);case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return",{credential:null,user:null});case 6:return e.abrupt("return",pc(this._delegate,Promise.resolve(t)));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addFrameworkForLogging",value:function(e){!function(e,t){qr(e)._logFramework(t)}(this._delegate,e)}},{key:"onAuthStateChanged",value:function(e,t,n){var r=wc(e,t,n),i=r.next,a=r.error,o=r.complete;return this._delegate.onAuthStateChanged(i,a,o)}},{key:"onIdTokenChanged",value:function(e,t,n){var r=wc(e,t,n),i=r.next,a=r.error,o=r.complete;return this._delegate.onIdTokenChanged(i,a,o)}},{key:"sendSignInLinkToEmail",value:function(e,t){return function(e,t,n){return _a.apply(this,arguments)}(this._delegate,e,t)}},{key:"sendPasswordResetEmail",value:function(e,t){return function(e,t,n){return da.apply(this,arguments)}(this._delegate,e,t||void 0)}},{key:"setPersistence",value:function(){var e=h(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ac(this._delegate,t),e.t0=t,e.next=e.t0===nc.SESSION?4:e.t0===nc.LOCAL?6:e.t0===nc.NONE?11:13;break;case 4:return n=to,e.abrupt("break",14);case 6:return e.next=8,An(So)._isAvailable();case 8:return r=e.sent,n=r?So:Za,e.abrupt("break",14);case 11:return n=xr,e.abrupt("break",14);case 13:return e.abrupt("return",_n("argument-error",{appName:this._delegate.name}));case 14:return e.abrupt("return",this._delegate.setPersistence(n));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signInAndRetrieveDataWithCredential",value:function(e){return this.signInWithCredential(e)}},{key:"signInAnonymously",value:function(){return pc(this._delegate,function(e){return qi.apply(this,arguments)}(this._delegate))}},{key:"signInWithCredential",value:function(e){return pc(this._delegate,ta(this._delegate,e))}},{key:"signInWithCustomToken",value:function(e){return pc(this._delegate,function(e,t){return ca.apply(this,arguments)}(this._delegate,e))}},{key:"signInWithEmailAndPassword",value:function(e,t){return pc(this._delegate,wa(this._delegate,e,t))}},{key:"signInWithEmailLink",value:function(e,t){return pc(this._delegate,function(e,t,n){return xa.apply(this,arguments)}(this._delegate,e,t))}},{key:"signInWithPhoneNumber",value:function(e,t){return vc(this._delegate,function(e,t,n){return Ko.apply(this,arguments)}(this._delegate,e,t))}},{key:"signInWithPopup",value:function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return kc(Js(),this._delegate,"operation-not-supported-in-this-environment"),e.abrupt("return",pc(this._delegate,uu(this._delegate,t,lc)));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signInWithRedirect",value:function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return kc(Js(),this._delegate,"operation-not-supported-in-this-environment"),e.next=3,oc(this._delegate);case 3:return e.abrupt("return",_u(this._delegate,t,lc));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateCurrentUser",value:function(e){return this._delegate.updateCurrentUser(e)}},{key:"verifyPasswordResetCode",value:function(e){return function(e,t){return ga.apply(this,arguments)}(this._delegate,e)}},{key:"unwrap",value:function(){return this._delegate}},{key:"_delete",value:function(){return this._delegate._delete()}},{key:"linkUnderlyingAuth",value:function(){var e=this;this._delegate.wrapped=function(){return e}}}]),e}();function wc(e,t,n){var r=e;"function"!==typeof e&&(r=e.next,t=e.error,n=e.complete);var i=r;return{next:function(e){return i(e&&gc.getOrCreate(e))},error:t,complete:n}}function _c(e,t){var n=function(e,t){var n=sc();if(!n)return[];var r=Ir(ic,e,t);switch(n.getItem(r)){case nc.NONE:return[xr];case nc.LOCAL:return[So,to];case nc.SESSION:return[to];default:return[]}}(e,t);if("undefined"===typeof self||n.includes(So)||n.push(So),"undefined"!==typeof window)for(var r=0,i=[Za,to];r<i.length;r++){var a=i[r];n.includes(a)||n.push(a)}return n.includes(xr)||n.push(xr),n}bc.Persistence=nc;var xc=function(){function e(){u(this,e),this.providerId="phone",this._delegate=new Jo(fc(Jt.auth()))}return l(e,[{key:"verifyPhoneNumber",value:function(e,t){return this._delegate.verifyPhoneNumber(e,t)}},{key:"unwrap",value:function(){return this._delegate}}],[{key:"credential",value:function(e,t){return Jo.credential(e,t)}}]),e}();xc.PHONE_SIGN_IN_METHOD=Jo.PHONE_SIGN_IN_METHOD,xc.PROVIDER_ID=Jo.PROVIDER_ID;var Ic,Sc=En,Tc=function(){function e(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Jt.app();u(this,e),Sc(null===(r=i.options)||void 0===r?void 0:r.apiKey,"invalid-api-key",{appName:i.name}),this._delegate=new Bo(t,n,i.auth()),this.type=this._delegate.type}return l(e,[{key:"clear",value:function(){this._delegate.clear()}},{key:"render",value:function(){return this._delegate.render()}},{key:"verify",value:function(){return this._delegate.verify()}}]),e}();(Ic=Jt).INTERNAL.registerComponent(new Ee("auth-compat",(function(e){var t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new bc(t,n)}),"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:ln,PASSWORD_RESET:fn,RECOVER_EMAIL:hn,REVERT_SECOND_FACTOR_ADDITION:dn,VERIFY_AND_CHANGE_EMAIL:pn,VERIFY_EMAIL:vn}},EmailAuthProvider:Ei,FacebookAuthProvider:Ai,GithubAuthProvider:Di,GoogleAuthProvider:Pi,OAuthProvider:Ri,SAMLAuthProvider:Li,PhoneAuthProvider:xc,PhoneMultiFactorGenerator:ds,RecaptchaVerifier:Tc,TwitterAuthProvider:Mi,Auth:bc,AuthCredential:Hr,Error:ne}).setInstantiationMode("LAZY").setMultipleInstances(!1)),Ic.registerVersion("@firebase/auth-compat","0.3.0");var Ec,Cc="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},Nc={},Rc=Rc||{},Ac=Cc||self;function Pc(){}function Dc(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function Oc(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var Lc="closure_uid_"+(1e9*Math.random()>>>0),Mc=0;function Fc(e,t,n){return e.call.apply(e.bind,arguments)}function Uc(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function jc(e,t,n){return(jc=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Fc:Uc).apply(null,arguments)}function Vc(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function qc(e,t){function n(){}n.prototype=t.prototype,e.X=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Wb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function Bc(){this.s=this.s,this.o=this.o}Bc.prototype.s=!1,Bc.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function(e){Object.prototype.hasOwnProperty.call(e,Lc)&&e[Lc]||(e[Lc]=++Mc)}(this)},Bc.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var zc=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Wc(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function Kc(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(Dc(r)){var i=e.length||0,a=r.length||0;e.length=i+a;for(var o=0;o<a;o++)e[i+o]=r[o]}else e.push(r)}}function Hc(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Hc.prototype.h=function(){this.defaultPrevented=!0};var Gc=function(){if(!Ac.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Ac.addEventListener("test",Pc,t),Ac.removeEventListener("test",Pc,t)}catch(AC){}return e}();function Qc(e){return/^[\s\xa0]*$/.test(e)}var $c=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function Yc(e,t){return e<t?-1:e>t?1:0}function Xc(){var e=Ac.navigator;return e&&(e=e.userAgent)?e:""}function Jc(e){return-1!=Xc().indexOf(e)}function Zc(e){return Zc[" "](e),e}Zc[" "]=Pc;var el,tl=Jc("Opera"),nl=Jc("Trident")||Jc("MSIE"),rl=Jc("Edge"),il=rl||nl,al=Jc("Gecko")&&!(-1!=Xc().toLowerCase().indexOf("webkit")&&!Jc("Edge"))&&!(Jc("Trident")||Jc("MSIE"))&&!Jc("Edge"),ol=-1!=Xc().toLowerCase().indexOf("webkit")&&!Jc("Edge");function ul(){var e=Ac.document;return e?e.documentMode:void 0}e:{var sl="",cl=function(){var e=Xc();return al?/rv:([^\);]+)(\)|;)/.exec(e):rl?/Edge\/([\d\.]+)/.exec(e):nl?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):ol?/WebKit\/(\S+)/.exec(e):tl?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(cl&&(sl=cl?cl[1]:""),nl){var ll=ul();if(null!=ll&&ll>parseFloat(sl)){el=String(ll);break e}}el=sl}var fl,hl={};function dl(){return function(e){var t=hl;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}((function(){for(var e=0,t=$c(String(el)).split("."),n=$c("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var a=t[i]||"",o=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;e=Yc(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||Yc(0==a[2].length,0==o[2].length)||Yc(a[2],o[2]),a=a[3],o=o[3]}while(0==e)}return 0<=e}))}if(Ac.document&&nl){var pl=ul();fl=pl||(parseInt(el,10)||void 0)}else fl=void 0;var vl=fl;function yl(e,t){if(Hc.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(al){e:{try{Zc(t.nodeName);var i=!0;break e}catch(RC){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:ml[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&yl.X.h.call(this)}}qc(yl,Hc);var ml={2:"touch",3:"pen",4:"mouse"};yl.prototype.h=function(){yl.X.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var gl="closure_listenable_"+(1e6*Math.random()|0),kl=0;function bl(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++kl,this.ba=this.ea=!1}function wl(e){e.ba=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function _l(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function xl(e){var t={};for(var n in e)t[n]=e[n];return t}var Il="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Sl(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<Il.length;a++)n=Il[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Tl(e){this.src=e,this.g={},this.h=0}function El(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=zc(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(wl(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Cl(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.ba&&a.listener==t&&a.capture==!!n&&a.ha==r)return i}return-1}Tl.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=Cl(e,t,r,i);return-1<o?(t=e[o],n||(t.ea=!1)):((t=new bl(t,this.src,a,!!r,i)).ea=n,e.push(t)),t};var Nl="closure_lm_"+(1e6*Math.random()|0),Rl={};function Al(e,t,n,r,i){if(r&&r.once)return Dl(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)Al(e,t[a],n,r,i);return null}return n=Vl(n),e&&e[gl]?e.N(t,n,Oc(r)?!!r.capture:!!r,i):Pl(e,t,n,!1,r,i)}function Pl(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=Oc(i)?!!i.capture:!!i,u=Ul(e);if(u||(e[Nl]=u=new Tl(e)),(n=u.add(t,n,r,o,a)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=Fl;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Gc||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Ml(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function Dl(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)Dl(e,t[a],n,r,i);return null}return n=Vl(n),e&&e[gl]?e.O(t,n,Oc(r)?!!r.capture:!!r,i):Pl(e,t,n,!0,r,i)}function Ol(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)Ol(e,t[a],n,r,i);else r=Oc(r)?!!r.capture:!!r,n=Vl(n),e&&e[gl]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=Cl(a=e.g[t],n,r,i))&&(wl(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--)))):e&&(e=Ul(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Cl(t,n,r,i)),(n=-1<e?t[e]:null)&&Ll(n))}function Ll(e){if("number"!==typeof e&&e&&!e.ba){var t=e.src;if(t&&t[gl])El(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Ml(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Ul(t))?(El(n,e),0==n.h&&(n.src=null,t[Nl]=null)):wl(e)}}}function Ml(e){return e in Rl?Rl[e]:Rl[e]="on"+e}function Fl(e,t){if(e.ba)e=!0;else{t=new yl(t,this);var n=e.listener,r=e.ha||e.src;e.ea&&Ll(e),e=n.call(r,t)}return e}function Ul(e){return(e=e[Nl])instanceof Tl?e:null}var jl="__closure_events_fn_"+(1e9*Math.random()>>>0);function Vl(e){return"function"===typeof e?e:(e[jl]||(e[jl]=function(t){return e.handleEvent(t)}),e[jl])}function ql(){Bc.call(this),this.i=new Tl(this),this.P=this,this.I=null}function Bl(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"===typeof t)t=new Hc(t,e);else if(t instanceof Hc)t.target=t.target||e;else{var i=t;Sl(t=new Hc(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=zl(o,r,!0,t)&&i}if(i=zl(o=t.g=e,r,!0,t)&&i,i=zl(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=zl(o=t.g=n[a],r,!1,t)&&i}function zl(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.ba&&o.capture==n){var u=o.listener,s=o.ha||o.src;o.ea&&El(e.i,o),i=!1!==u.call(s,r)&&i}}return i&&!r.defaultPrevented}qc(ql,Bc),ql.prototype[gl]=!0,ql.prototype.removeEventListener=function(e,t,n,r){Ol(this,e,t,n,r)},ql.prototype.M=function(){if(ql.X.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)wl(n[r]);delete t.g[e],t.h--}}this.I=null},ql.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ql.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var Wl=Ac.JSON.stringify;function Kl(){var e=Zl,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Hl,Gl=function(){function e(){u(this,e),this.h=this.g=null}return l(e,[{key:"add",value:function(e,t){var n=Ql.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}(),Ql=new(function(){function e(t,n){u(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return l(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}())((function(){return new $l}),(function(e){return e.reset()})),$l=function(){function e(){u(this,e),this.next=this.g=this.h=null}return l(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function Yl(e){Ac.setTimeout((function(){throw e}),0)}function Xl(e,t){Hl||function(){var e=Ac.Promise.resolve(void 0);Hl=function(){e.then(ef)}}(),Jl||(Hl(),Jl=!0),Zl.add(e,t)}var Jl=!1,Zl=new Gl;function ef(){for(var e;e=Kl();){try{e.h.call(e.g)}catch(AC){Yl(AC)}var t=Ql;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Jl=!1}function tf(e,t){ql.call(this),this.h=e||1,this.g=t||Ac,this.j=jc(this.lb,this),this.l=Date.now()}function nf(e){e.ca=!1,e.R&&(e.g.clearTimeout(e.R),e.R=null)}function rf(e,t,n){if("function"===typeof e)n&&(e=jc(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=jc(e.handleEvent,e)}return 2147483647<Number(t)?-1:Ac.setTimeout(e,t||0)}function af(e){e.g=rf((function(){e.g=null,e.i&&(e.i=!1,af(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}qc(tf,ql),(Ec=tf.prototype).ca=!1,Ec.R=null,Ec.lb=function(){if(this.ca){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-e):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Bl(this,"tick"),this.ca&&(nf(this),this.start()))}},Ec.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Ec.M=function(){tf.X.M.call(this),nf(this),delete this.g};var of=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this)).m=e,i.j=r,i.h=null,i.i=!1,i.g=null,i}return l(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:af(this)}},{key:"M",value:function(){tn(x(n.prototype),"M",this).call(this),this.g&&(Ac.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(Bc);function uf(e){Bc.call(this),this.h=e,this.g={}}qc(uf,Bc);var sf=[];function cf(e,t,n,r){Array.isArray(n)||(n&&(sf[0]=n.toString()),n=sf);for(var i=0;i<n.length;i++){var a=Al(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function lf(e){_l(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Ll(e)}),e),e.g={}}function ff(){this.g=!0}function hf(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return Wl(n)}catch(xC){return t}}(e,n)+(r?" "+r:"")}))}uf.prototype.M=function(){uf.X.M.call(this),lf(this)},uf.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ff.prototype.Aa=function(){this.g=!1},ff.prototype.info=function(){};var df={},pf=null;function vf(){return pf=pf||new ql}function yf(e){Hc.call(this,df.Pa,e)}function mf(e){var t=vf();Bl(t,new yf(t))}function gf(e,t){Hc.call(this,df.STAT_EVENT,e),this.stat=t}function kf(e){var t=vf();Bl(t,new gf(t,e))}function bf(e,t){Hc.call(this,df.Qa,e),this.size=t}function wf(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return Ac.setTimeout((function(){e()}),t)}df.Pa="serverreachability",qc(yf,Hc),df.STAT_EVENT="statevent",qc(gf,Hc),df.Qa="timingevent",qc(bf,Hc);var _f={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},xf={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function If(){}function Sf(e){return e.h||(e.h=e.i())}function Tf(){}If.prototype.h=null;var Ef,Cf={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function Nf(){Hc.call(this,"d")}function Rf(){Hc.call(this,"c")}function Af(){}function Pf(e,t,n,r){this.l=e,this.j=t,this.m=n,this.U=r||1,this.S=new uf(this),this.O=Of,e=il?125:void 0,this.T=new tf(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new Df}function Df(){this.i=null,this.g="",this.h=!1}qc(Nf,Hc),qc(Rf,Hc),qc(Af,If),Af.prototype.g=function(){return new XMLHttpRequest},Af.prototype.i=function(){return{}},Ef=new Af;var Of=45e3,Lf={},Mf={};function Ff(e,t,n){e.K=1,e.v=nh(Xf(t)),e.s=n,e.P=!0,Uf(e,null)}function Uf(e,t){e.F=Date.now(),Bf(e),e.A=Xf(e.v);var n=e.A,r=e.U;Array.isArray(r)||(r=[String(r)]),vh(n.i,"t",r),e.C=0,n=e.l.H,e.h=new Df,e.g=vd(e.l,n?t:null,!e.s),0<e.N&&(e.L=new of(jc(e.La,e,e.g),e.N)),cf(e.S,e.g,"readystatechange",e.ib),t=e.H?xl(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.da(e.A,e.u,e.s,t)):(e.u="GET",e.g.da(e.A,e.u,null,t)),mf(),function(e,t,n,r,i,a){e.info((function(){if(e.g)if(a)for(var o="",u=a.split("&"),s=0;s<u.length;s++){var c=u[s].split("=");if(1<c.length){var l=c[0];c=c[1];var f=l.split("_");o=2<=f.length&&"type"==f[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.U,e.s)}function jf(e){return!!e.g&&("GET"==e.u&&2!=e.K&&e.l.Da)}function Vf(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=qf(e,n))==Mf){4==t&&(e.o=4,kf(14),i=!1),hf(e.j,e.m,null,"[Incomplete Response]");break}if(r==Lf){e.o=4,kf(15),hf(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}hf(e.j,e.m,r,null),Gf(e,r)}jf(e)&&r!=Mf&&r!=Lf&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,kf(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.$&&(e.$=!0,(t=e.l).g==e&&t.$&&!t.K&&(t.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),ud(t),t.K=!0,kf(11))):(hf(e.j,e.m,n,"[Invalid Chunked Response]"),Hf(e),Kf(e))}function qf(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Mf:(n=Number(t.substring(n,r)),isNaN(n)?Lf:(r+=1)+n>t.length?Mf:(t=t.substr(r,n),e.C=r+n,t))}function Bf(e){e.V=Date.now()+e.O,zf(e,e.O)}function zf(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=wf(jc(e.gb,e),t)}function Wf(e){e.B&&(Ac.clearTimeout(e.B),e.B=null)}function Kf(e){0==e.l.G||e.I||ld(e.l,e)}function Hf(e){Wf(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,nf(e.T),lf(e.S),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function Gf(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||_h(n.h,e)))if(!e.J&&_h(n.h,e)&&3==n.G){try{var r=n.Fa.g.parse(t)}catch(a){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;cd(n),Zh(n)}od(n),kf(18)}}else n.Ba=i[1],0<n.Ba-n.T&&37500>i[2]&&n.L&&0==n.A&&!n.v&&(n.v=wf(jc(n.cb,n),6e3));if(1>=wh(n.h)&&n.ja){try{n.ja()}catch(a){}n.ja=void 0}}else hd(n,11)}else if((e.J||n.g==e)&&cd(n),!Qc(t))for(i=n.Fa.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.T=a[0],a=a[1],2==n.G)if("c"==a[0]){n.I=a[1],n.ka=a[2];var o=a[3];null!=o&&(n.ma=o,n.j.info("VER="+n.ma));var u=a[4];null!=u&&(n.Ca=u,n.j.info("SVER="+n.Ca));var s=a[5];null!=s&&"number"===typeof s&&0<s&&(r=1.5*s,n.J=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var f=r.h;f.g||-1==l.indexOf("spdy")&&-1==l.indexOf("quic")&&-1==l.indexOf("h2")||(f.j=f.l,f.g=new Set,f.h&&(xh(f,f.h),f.h=null))}if(r.D){var h=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;h&&(r.za=h,th(r.F,r.D,h))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-e.F,n.j.info("Handshake RTT: "+n.P+"ms"));var d=e;if((r=n).sa=pd(r,r.H?r.ka:null,r.V),d.J){Ih(r.h,d);var p=d,v=r.J;v&&p.setTimeout(v),p.B&&(Wf(p),Bf(p)),r.g=d}else ad(r);0<n.i.length&&td(n)}else"stop"!=a[0]&&"close"!=a[0]||hd(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?hd(n,7):Jh(n):"noop"!=a[0]&&n.l&&n.l.wa(a),n.A=0)}mf()}catch(a){}}function Qf(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Dc(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.oa&&"function"==typeof e.oa)return e.oa();if(!e.W||"function"!=typeof e.W){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(Dc(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}}(e),r=function(e){if(e.W&&"function"==typeof e.W)return e.W();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(Dc(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}(Ec=Pf.prototype).setTimeout=function(e){this.O=e},Ec.ib=function(e){e=e.target;var t=this.L;t&&3==Hh(e)?t.l():this.La(e)},Ec.La=function(e){try{if(e==this.g)e:{var t=Hh(this.g),n=this.g.Ea();this.g.aa();if(!(3>t)&&(3!=t||il||this.g&&(this.h.h||this.g.fa()||Gh(this.g)))){this.I||4!=t||7==n||mf(),Wf(this);var r=this.g.aa();this.Y=r;t:if(jf(this)){var i=Gh(this.g);e="";var a=i.length,o=4==Hh(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Hf(this),Kf(this);var u="";break t}this.h.i=new Ac.TextDecoder}for(n=0;n<a;n++)this.h.h=!0,e+=this.h.i.decode(i[n],{stream:o&&n==a-1});i.splice(0,a),this.h.g+=e,this.C=0,u=this.h.g}else u=this.g.fa();if(this.i=200==r,function(e,t,n,r,i,a,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o}))}(this.j,this.u,this.A,this.m,this.U,t,r),this.i){if(this.Z&&!this.J){t:{if(this.g){var s,c=this.g;if((s=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Qc(s)){var l=s;break t}}l=null}if(!(r=l)){this.i=!1,this.o=3,kf(12),Hf(this),Kf(this);break e}hf(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Gf(this,r)}this.P?(Vf(this,t,u),il&&this.i&&3==t&&(cf(this.S,this.T,"tick",this.hb),this.T.start())):(hf(this.j,this.m,u,null),Gf(this,u)),4==t&&Hf(this),this.i&&!this.I&&(4==t?ld(this.l,this):(this.i=!1,Bf(this)))}else 400==r&&0<u.indexOf("Unknown SID")?(this.o=3,kf(12)):(this.o=0,kf(13)),Hf(this),Kf(this)}}}catch(t){}},Ec.hb=function(){if(this.g){var e=Hh(this.g),t=this.g.fa();this.C<t.length&&(Wf(this),Vf(this,e,t),this.i&&4!=e&&Bf(this))}},Ec.cancel=function(){this.I=!0,Hf(this)},Ec.gb=function(){this.B=null;var e=Date.now();0<=e-this.V?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(mf(),kf(17)),Hf(this),this.o=2,Kf(this)):zf(this,this.V-e)};var $f=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Yf(e,t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Yf){this.h=void 0!==t?t:e.h,Jf(this,e.j),this.s=e.s,this.g=e.g,Zf(this,e.m),this.l=e.l,t=e.i;var n=new fh;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),eh(this,n),this.o=e.o}else e&&(n=String(e).match($f))?(this.h=!!t,Jf(this,n[1]||"",!0),this.s=rh(n[2]||""),this.g=rh(n[3]||"",!0),Zf(this,n[4]),this.l=rh(n[5]||"",!0),eh(this,n[6]||"",!0),this.o=rh(n[7]||"")):(this.h=!!t,this.i=new fh(null,this.h))}function Xf(e){return new Yf(e)}function Jf(e,t,n){e.j=n?rh(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Zf(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function eh(e,t,n){t instanceof fh?(e.i=t,function(e,t){t&&!e.j&&(hh(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(dh(this,t),vh(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=ih(t,ch)),e.i=new fh(t,e.h))}function th(e,t,n){e.i.set(t,n)}function nh(e){return th(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function rh(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ih(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,ah),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ah(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Yf.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ih(t,oh,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(ih(t,oh,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ih(n,"/"==n.charAt(0)?sh:uh,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",ih(n,lh)),e.join("")};var oh=/[#\/\?@]/g,uh=/[#\?:]/g,sh=/[#\?]/g,ch=/[#\?@]/g,lh=/#/g;function fh(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function hh(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function dh(e,t){hh(e),t=yh(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function ph(e,t){return hh(e),t=yh(e,t),e.g.has(t)}function vh(e,t,n){dh(e,t),0<n.length&&(e.i=null,e.g.set(yh(e,t),Wc(n)),e.h+=n.length)}function yh(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(Ec=fh.prototype).add=function(e,t){hh(this),this.i=null,e=yh(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},Ec.forEach=function(e,t){hh(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},Ec.oa=function(){hh(this);for(var e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},Ec.W=function(e){hh(this);var t=[];if("string"===typeof e)ph(this,e)&&(t=t.concat(this.g.get(yh(this,e))));else{e=Array.from(this.g.values());for(var n=0;n<e.length;n++)t=t.concat(e[n])}return t},Ec.set=function(e,t){return hh(this),this.i=null,ph(this,e=yh(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},Ec.get=function(e,t){return e&&0<(e=this.W(e)).length?String(e[0]):t},Ec.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=Array.from(this.g.keys()),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r)),a=this.W(r);for(r=0;r<a.length;r++){var o=i;""!==a[r]&&(o+="="+encodeURIComponent(String(a[r]))),e.push(o)}}return this.i=e.join("&")};var mh=l((function e(t,n){u(this,e),this.h=t,this.g=n}));function gh(e){this.l=e||kh,Ac.PerformanceNavigationTiming?e=0<(e=Ac.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(Ac.g&&Ac.g.Ga&&Ac.g.Ga()&&Ac.g.Ga().$b),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var kh=10;function bh(e){return!!e.h||!!e.g&&e.g.size>=e.j}function wh(e){return e.h?1:e.g?e.g.size:0}function _h(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function xh(e,t){e.g?e.g.add(t):e.h=t}function Ih(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Sh(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=y(e.g.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;n=n.concat(i.D)}}catch(a){r.e(a)}finally{r.f()}return n}return Wc(e.i)}function Th(){}function Eh(){this.g=new Th}function Ch(e,t,n){var r=n||"";try{Qf(e,(function(e,n){var i=e;Oc(e)&&(i=Wl(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function Nh(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(RC){}}function Rh(e){this.l=e.ac||null,this.j=e.jb||!1}function Ah(e,t){ql.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=Ph,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}gh.prototype.cancel=function(){if(this.i=Sh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=y(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}},Th.prototype.stringify=function(e){return Ac.JSON.stringify(e,void 0)},Th.prototype.parse=function(e){return Ac.JSON.parse(e,void 0)},qc(Rh,If),Rh.prototype.g=function(){return new Ah(this.l,this.j)},Rh.prototype.i=function(e){return function(){return e}}({}),qc(Ah,ql);var Ph=0;function Dh(e){e.j.read().then(e.Ta.bind(e)).catch(e.ga.bind(e))}function Oh(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Lh(e)}function Lh(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(Ec=Ah.prototype).open=function(e,t){if(this.readyState!=Ph)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Lh(this)},Ec.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||Ac).fetch(new Request(this.B,t)).then(this.Wa.bind(this),this.ga.bind(this))},Ec.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((function(){})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Oh(this)),this.readyState=Ph},Ec.Wa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Lh(this)),this.g&&(this.readyState=3,Lh(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if("undefined"!==typeof Ac.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Dh(this)}else e.text().then(this.Va.bind(this),this.ga.bind(this))},Ec.Ta=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Oh(this):Lh(this),3==this.readyState&&Dh(this)}},Ec.Va=function(e){this.g&&(this.response=this.responseText=e,Oh(this))},Ec.Ua=function(e){this.g&&(this.response=e,Oh(this))},Ec.ga=function(){this.g&&Oh(this)},Ec.setRequestHeader=function(e,t){this.v.append(e,t)},Ec.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},Ec.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Ah.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Mh=Ac.JSON.parse;function Fh(e){ql.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Uh,this.K=this.L=!1}qc(Fh,ql);var Uh="",jh=/^https?$/i,Vh=["POST","PUT"];function qh(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Bh(e),Wh(e)}function Bh(e){e.D||(e.D=!0,Bl(e,"complete"),Bl(e,"error"))}function zh(e){if(e.h&&"undefined"!=typeof Rc&&(!e.C[1]||4!=Hh(e)||2!=e.aa()))if(e.v&&4==Hh(e))rf(e.Ha,0,e);else if(Bl(e,"readystatechange"),4==Hh(e)){e.h=!1;try{var t,n=e.aa();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.H).match($f)[1]||null;if(!a&&Ac.self&&Ac.self.location){var o=Ac.self.location.protocol;a=o.substr(0,o.length-1)}i=!jh.test(a?a.toLowerCase():"")}t=i}if(t)Bl(e,"complete"),Bl(e,"success");else{e.m=6;try{var u=2<Hh(e)?e.g.statusText:""}catch(CC){u=""}e.j=u+" ["+e.aa()+"]",Bh(e)}}finally{Wh(e)}}}function Wh(e,t){if(e.g){Kh(e);var n=e.g,r=e.C[0]?Pc:null;e.g=null,e.C=null,t||Bl(e,"ready");try{n.onreadystatechange=r}catch(i){}}}function Kh(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(Ac.clearTimeout(e.A),e.A=null)}function Hh(e){return e.g?e.g.readyState:0}function Gh(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case Uh:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(Ad){return null}}function Qh(e){var t="";return _l(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function $h(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Qh(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):th(e,t,n))}function Yh(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Xh(e){this.Ca=0,this.i=[],this.j=new ff,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=Yh("failFast",!1,e),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=Yh("baseRetryDelayMs",5e3,e),this.bb=Yh("retryDelaySeedMs",1e4,e),this.$a=Yh("forwardChannelMaxRetries",2,e),this.ta=Yh("forwardChannelRequestTimeoutMs",2e4,e),this.ra=e&&e.xmlHttpFactory||void 0,this.Da=e&&e.Zb||!1,this.J=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.I="",this.h=new gh(e&&e.concurrentRequestLimit),this.Fa=new Eh,this.O=e&&e.fastHandshake||!1,this.N=e&&e.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=e&&e.Xb||!1,e&&e.Aa&&this.j.Aa(),e&&e.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&e&&e.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function Jh(e){if(ed(e),3==e.G){var t=e.U++,n=Xf(e.F);th(n,"SID",e.I),th(n,"RID",t),th(n,"TYPE","terminate"),rd(e,n),(t=new Pf(e,e.j,t,void 0)).K=2,t.v=nh(Xf(n)),n=!1,Ac.navigator&&Ac.navigator.sendBeacon&&(n=Ac.navigator.sendBeacon(t.v.toString(),"")),!n&&Ac.Image&&((new Image).src=t.v,n=!0),n||(t.g=vd(t.l,null),t.g.da(t.v)),t.F=Date.now(),Bf(t)}dd(e)}function Zh(e){e.g&&(ud(e),e.g.cancel(),e.g=null)}function ed(e){Zh(e),e.u&&(Ac.clearTimeout(e.u),e.u=null),cd(e),e.h.cancel(),e.m&&("number"===typeof e.m&&Ac.clearTimeout(e.m),e.m=null)}function td(e){bh(e.h)||e.m||(e.m=!0,Xl(e.Ja,e),e.C=0)}function nd(e,t){var n;n=t?t.m:e.U++;var r=Xf(e.F);th(r,"SID",e.I),th(r,"RID",n),th(r,"AID",e.T),rd(e,r),e.o&&e.s&&$h(r,e.o,e.s),n=new Pf(e,e.j,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.i=t.D.concat(e.i)),t=id(e,n,1e3),n.setTimeout(Math.round(.5*e.ta)+Math.round(.5*e.ta*Math.random())),xh(e.h,n),Ff(n,r,t)}function rd(e,t){e.ia&&_l(e.ia,(function(e,n){th(t,n,e)})),e.l&&Qf({},(function(e,n){th(t,n,e)}))}function id(e,t,n){n=Math.min(e.i.length,n);var r=e.l?jc(e.l.Ra,e.l,e):null;e:for(var i=e.i,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].h,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var u=!0,s=0;s<n;s++){var c=i[s].h,l=i[s].g;if(0>(c-=a))a=Math.max(0,i[s].h-100),u=!1;else try{Ch(l,o,"req"+c+"_")}catch(f){r&&r(l)}}if(u){r=o.join("&");break e}}return e=e.i.splice(0,n),t.D=e,r}function ad(e){e.g||e.u||(e.Z=1,Xl(e.Ia,e),e.A=0)}function od(e){return!(e.g||e.u||3<=e.A)&&(e.Z++,e.u=wf(jc(e.Ia,e),fd(e,e.A)),e.A++,!0)}function ud(e){null!=e.B&&(Ac.clearTimeout(e.B),e.B=null)}function sd(e){e.g=new Pf(e,e.j,"rpc",e.Z),null===e.o&&(e.g.H=e.s),e.g.N=0;var t=Xf(e.sa);th(t,"RID","rpc"),th(t,"SID",e.I),th(t,"CI",e.L?"0":"1"),th(t,"AID",e.T),th(t,"TYPE","xmlhttp"),rd(e,t),e.o&&e.s&&$h(t,e.o,e.s),e.J&&e.g.setTimeout(e.J);var n=e.g;e=e.ka,n.K=1,n.v=nh(Xf(t)),n.s=null,n.P=!0,Uf(n,e)}function cd(e){null!=e.v&&(Ac.clearTimeout(e.v),e.v=null)}function ld(e,t){var n=null;if(e.g==t){cd(e),ud(e),e.g=null;var r=2}else{if(!_h(e.h,t))return;n=t.D,Ih(e.h,t),r=1}if(0!=e.G)if(e.pa=t.Y,t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;Bl(r=vf(),new bf(r,n)),td(e)}else ad(e);else if(3==(i=t.o)||0==i&&0<e.pa||!(1==r&&function(e,t){return!(wh(e.h)>=e.h.j-(e.m?1:0))&&(e.m?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.C>=(e.Za?0:e.$a))&&(e.m=wf(jc(e.Ja,e,t),fd(e,e.C)),e.C++,!0))}(e,t)||2==r&&od(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:hd(e,5);break;case 4:hd(e,10);break;case 3:hd(e,6);break;default:hd(e,2)}}function fd(e,t){var n=e.Xa+Math.floor(Math.random()*e.bb);return e.l||(n*=2),n*t}function hd(e,t){if(e.j.info("Error code "+t),2==t){var n=null;e.l&&(n=null);var r=jc(e.kb,e);n||(n=new Yf("//www.google.com/images/cleardot.gif"),Ac.location&&"http"==Ac.location.protocol||Jf(n,"https"),nh(n)),function(e,t){var n=new ff;if(Ac.Image){var r=new Image;r.onload=Vc(Nh,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Vc(Nh,n,r,"TestLoadImage: error",!1,t),r.onabort=Vc(Nh,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Vc(Nh,n,r,"TestLoadImage: timeout",!1,t),Ac.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else kf(2);e.G=0,e.l&&e.l.va(t),dd(e),ed(e)}function dd(e){if(e.G=0,e.la=[],e.l){var t=Sh(e.h);0==t.length&&0==e.i.length||(Kc(e.la,t),Kc(e.la,e.i),e.h.i.length=0,Wc(e.i),e.i.length=0),e.l.ua()}}function pd(e,t,n){var r=n instanceof Yf?Xf(n):new Yf(n,void 0);if(""!=r.g)t&&(r.g=t+"."+r.g),Zf(r,r.m);else{var i=Ac.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var a=new Yf(null,void 0);r&&Jf(a,r),t&&(a.g=t),i&&Zf(a,i),n&&(a.l=n),r=a}return n=e.D,t=e.za,n&&t&&th(r,n,t),th(r,"VER",e.ma),rd(e,r),r}function vd(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Da&&!e.ra?new Fh(new Rh({jb:!0})):new Fh(e.ra)).Ka(e.H),t}function yd(){}function md(){if(nl&&!(10<=Number(vl)))throw Error("Environmental error: no available transport.")}function gd(e,t){ql.call(this),this.g=new Xh(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.S=e,(e=t&&t.Yb)&&!Qc(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Qc(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new wd(this)}function kd(e){Nf.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function bd(){Rf.call(this),this.status=1}function wd(e){this.g=e}(Ec=Fh.prototype).Ka=function(e){this.L=e},Ec.da=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Ef.g(),this.C=this.u?Sf(this.u):Sf(Ef),this.g.onreadystatechange=jc(this.Ha,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(u){return void qh(this,u)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));var a,o=y(r.keys());try{for(o.s();!(a=o.n()).done;){var u=a.value;n.set(u,r.get(u))}}catch(d){o.e(d)}finally{o.f()}}r=Array.from(n.keys()).find((function(e){return"content-type"==e.toLowerCase()})),i=Ac.FormData&&e instanceof Ac.FormData,!(0<=zc(Vh,t))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");var s,c=y(n);try{for(c.s();!(s=c.n()).done;){var l=k(s.value,2),f=l[0],h=l[1];this.g.setRequestHeader(f,h)}}catch(d){c.e(d)}finally{c.f()}this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Kh(this),0<this.B&&((this.K=function(e){return nl&&dl()&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=jc(this.qa,this)):this.A=rf(this.qa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(u){qh(this,u)}},Ec.qa=function(){"undefined"!=typeof Rc&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Bl(this,"timeout"),this.abort(8))},Ec.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Bl(this,"complete"),Bl(this,"abort"),Wh(this))},Ec.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Wh(this,!0)),Fh.X.M.call(this)},Ec.Ha=function(){this.s||(this.F||this.v||this.l?zh(this):this.fb())},Ec.fb=function(){zh(this)},Ec.aa=function(){try{return 2<Hh(this)?this.g.status:-1}catch(NC){return-1}},Ec.fa=function(){try{return this.g?this.g.responseText:""}catch(NC){return""}},Ec.Sa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Mh(t)}},Ec.Ea=function(){return this.m},Ec.Oa=function(){return"string"===typeof this.j?this.j:String(this.j)},(Ec=Xh.prototype).ma=8,Ec.G=1,Ec.Ja=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;var t=new Pf(this,this.j,e,void 0),n=this.s;if(this.S&&(n?Sl(n=xl(n),this.S):n=this.S),null!==this.o||this.N||(t.H=n,n=null),this.O)e:{for(var r=0,i=0;i<this.i.length;i++){var a=this.i[i];if(void 0===(a="__data__"in a.g&&"string"===typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.i.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=id(this,t,r),th(i=Xf(this.F),"RID",e),th(i,"CVER",22),this.D&&th(i,"X-HTTP-Session-Id",this.D),rd(this,i),n&&(this.N?r="headers="+encodeURIComponent(String(Qh(n)))+"&"+r:this.o&&$h(i,this.o,n)),xh(this.h,t),this.Ya&&th(i,"TYPE","init"),this.O?(th(i,"$req",r),th(i,"SID","null"),t.Z=!0,Ff(t,i,null)):Ff(t,i,r),this.G=2}}else 3==this.G&&(e?nd(this,e):0==this.i.length||bh(this.h)||nd(this))},Ec.Ia=function(){if(this.u=null,sd(this),this.$&&!(this.K||null==this.g||0>=this.P)){var e=2*this.P;this.j.info("BP detection timer enabled: "+e),this.B=wf(jc(this.eb,this),e)}},Ec.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,kf(10),Zh(this),sd(this))},Ec.cb=function(){null!=this.v&&(this.v=null,Zh(this),od(this),kf(19))},Ec.kb=function(e){e?(this.j.info("Successfully pinged google.com"),kf(2)):(this.j.info("Failed to ping google.com"),kf(1))},(Ec=yd.prototype).xa=function(){},Ec.wa=function(){},Ec.va=function(){},Ec.ua=function(){},Ec.Ra=function(){},md.prototype.g=function(e,t){return new gd(e,t)},qc(gd,ql),gd.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;kf(0),e.V=t,e.ia=n||{},e.L=e.Y,e.F=pd(e,null,e.V),td(e)},gd.prototype.close=function(){Jh(this.g)},gd.prototype.u=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=Wl(e),e=n);t.i.push(new mh(t.ab++,e)),3==t.G&&td(t)},gd.prototype.M=function(){this.g.l=null,delete this.j,Jh(this.g),delete this.g,gd.X.M.call(this)},qc(kd,Nf),qc(bd,Rf),qc(wd,yd),wd.prototype.xa=function(){Bl(this.g,"a")},wd.prototype.wa=function(e){Bl(this.g,new kd(e))},wd.prototype.va=function(e){Bl(this.g,new bd)},wd.prototype.ua=function(){Bl(this.g,"b")},md.prototype.createWebChannel=md.prototype.g,gd.prototype.send=gd.prototype.u,gd.prototype.open=gd.prototype.m,gd.prototype.close=gd.prototype.close,_f.NO_ERROR=0,_f.TIMEOUT=8,_f.HTTP_ERROR=6,xf.COMPLETE="complete",Tf.EventType=Cf,Cf.OPEN="a",Cf.CLOSE="b",Cf.ERROR="c",Cf.MESSAGE="d",ql.prototype.listen=ql.prototype.N,Fh.prototype.listenOnce=Fh.prototype.O,Fh.prototype.getLastError=Fh.prototype.Oa,Fh.prototype.getLastErrorCode=Fh.prototype.Ea,Fh.prototype.getStatus=Fh.prototype.aa,Fh.prototype.getResponseJson=Fh.prototype.Sa,Fh.prototype.getResponseText=Fh.prototype.fa,Fh.prototype.send=Fh.prototype.da,Fh.prototype.setWithCredentials=Fh.prototype.Ka;var _d=Nc.createWebChannelTransport=function(){return new md},xd=Nc.getStatEventTarget=function(){return vf()},Id=Nc.ErrorCode=_f,Sd=Nc.EventType=xf,Td=Nc.Event=df,Ed=Nc.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},Cd=Nc.FetchXmlHttpFactory=Rh,Nd=Nc.WebChannel=Tf,Rd=Nc.XhrIo=Fh,Ad="@firebase/firestore",Pd=function(){function e(t){u(this,e),this.uid=t}return l(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();Pd.UNAUTHENTICATED=new Pd(null),Pd.GOOGLE_CREDENTIALS=new Pd("google-credentials-uid"),Pd.FIRST_PARTY=new Pd("first-party-uid"),Pd.MOCK_USER=new Pd("mock-user");var Dd="9.15.0",Od=new Ue("@firebase/firestore");function Ld(){return Od.logLevel}function Md(e){if(Od.logLevel<=Ae.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(jd);Od.debug.apply(Od,["Firestore (".concat(Dd,"): ").concat(e)].concat(Te(i)))}}function Fd(e){if(Od.logLevel<=Ae.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(jd);Od.error.apply(Od,["Firestore (".concat(Dd,"): ").concat(e)].concat(Te(i)))}}function Ud(e){if(Od.logLevel<=Ae.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(jd);Od.warn.apply(Od,["Firestore (".concat(Dd,"): ").concat(e)].concat(Te(i)))}}function jd(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function Vd(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(Dd,") INTERNAL ASSERTION FAILED: ")+e;throw Fd(t),new Error(t)}function qd(e,t){e||Vd()}function Bd(e,t){return e}var zd={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Wd=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this,e,r)).code=e,i.message=r,i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return l(n)}(ne),Kd=l((function e(){var t=this;u(this,e),this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))})),Hd=l((function e(t,n){u(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))})),Gd=function(){function e(){u(this,e)}return l(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(Pd.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),e}(),Qd=function(){function e(t){u(this,e),this.token=t,this.changeListener=null}return l(e,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable((function(){return t(n.token.user)}))}},{key:"shutdown",value:function(){this.changeListener=null}}]),e}(),$d=function(){function e(t){u(this,e),this.t=t,this.currentUser=Pd.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return l(e,[{key:"start",value:function(e,t){var n=this,r=this.i,i=function(e){return n.i!==r?(r=n.i,t(e)):Promise.resolve()},a=new Kd;this.o=function(){n.i++,n.currentUser=n.u(),a.resolve(),a=new Kd,e.enqueueRetryable((function(){return i(n.currentUser)}))};var u=function(){var t=a;e.enqueueRetryable(h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,i(n.currentUser);case 4:case"end":return e.stop()}}),e)}))))},s=function(e){Md("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),u()};this.t.onInit((function(e){return s(e)})),setTimeout((function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?s(e):(Md("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Kd)}}),0),u()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return e.i!==t?(Md("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(qd("string"==typeof n.accessToken),new Hd(n.accessToken,e.currentUser)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return qd(null===e||"string"==typeof e),new Pd(e)}}]),e}(),Yd=function(){function e(t,n,r,i){u(this,e),this.h=t,this.l=n,this.m=r,this.g=i,this.type="FirstParty",this.user=Pd.FIRST_PARTY,this.p=new Map}return l(e,[{key:"I",value:function(){return this.g?this.g():(qd(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}},{key:"headers",get:function(){this.p.set("X-Goog-AuthUser",this.l);var e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}]),e}(),Xd=function(){function e(t,n,r,i){u(this,e),this.h=t,this.l=n,this.m=r,this.g=i}return l(e,[{key:"getToken",value:function(){return Promise.resolve(new Yd(this.h,this.l,this.m,this.g))}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(Pd.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),Jd=l((function e(t){u(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)})),Zd=function(){function e(t){u(this,e),this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null}return l(e,[{key:"start",value:function(e,t){var n=this,r=function(e){null!=e.error&&Md("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.A;return n.A=e.token,Md("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()};this.o=function(t){e.enqueueRetryable((function(){return r(t)}))};var i=function(e){Md("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.T.onInit((function(e){return i(e)})),setTimeout((function(){if(!n.appCheck){var e=n.T.getImmediate({optional:!0});e?i(e):Md("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((function(t){return t?(qd("string"==typeof t.token),e.A=t.token,new Jd(t.token)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}();function ep(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var tp=function(){function e(){u(this,e)}return l(e,null,[{key:"R",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=ep(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),e}();function np(e,t){return e<t?-1:e>t?1:0}function rp(e,t,n){return e.length===t.length&&e.every((function(e,r){return n(e,t[r])}))}function ip(e){return e+"\0"}var ap=function(){function e(t,n){if(u(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new Wd(zd.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Wd(zd.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new Wd(zd.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Wd(zd.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return l(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?np(this.nanoseconds,e.nanoseconds):np(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),op=function(){function e(t){u(this,e),this.timestamp=t}return l(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new ap(0,0))}},{key:"max",value:function(){return new e(new ap(253402300799,999999999))}}]),e}(),up=function(){function e(t,n,r){u(this,e),void 0===n?n=0:n>t.length&&Vd(),void 0===r?r=t.length-n:r>t.length-n&&Vd(),this.segments=t,this.offset=n,this.len=r}return l(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((function(e){n.push(e)})):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),sp=function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.apply(this,arguments)}return l(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var a=0,o=r;a<o.length;a++){var u=o[a];if(u.indexOf("//")>=0)throw new Wd(zd.INVALID_ARGUMENT,"Invalid segment (".concat(u,"). Paths must not contain // in them."));e.push.apply(e,Te(u.split("/").filter((function(e){return e.length>0}))))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(up),cp=/^[_a-zA-Z][_a-zA-Z0-9]*$/,lp=function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.apply(this,arguments)}return l(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map((function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return cp.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",i=0,a=function(){if(0===r.length)throw new Wd(zd.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;i<e.length;){var u=e[i];if("\\"===u){if(i+1===e.length)throw new Wd(zd.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var s=e[i+1];if("\\"!==s&&"."!==s&&"`"!==s)throw new Wd(zd.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=s,i+=2}else"`"===u?(o=!o,i++):"."!==u||o?(r+=u,i++):(a(),i++)}if(a(),o)throw new Wd(zd.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(up),fp=function(){function e(t){u(this,e),this.path=t}return l(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===sp.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(sp.fromString(t))}},{key:"fromName",value:function(t){return new e(sp.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(sp.emptyPath())}},{key:"comparator",value:function(e,t){return sp.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new sp(t.slice()))}}]),e}(),hp=l((function e(t,n,r,i){u(this,e),this.indexId=t,this.collectionGroup=n,this.fields=r,this.indexState=i}));function dp(e){return e.fields.find((function(e){return 2===e.kind}))}function pp(e){return e.fields.filter((function(e){return 2!==e.kind}))}hp.UNKNOWN_ID=-1;var vp=l((function e(t,n){u(this,e),this.fieldPath=t,this.kind=n}));var yp=function(){function e(t,n){u(this,e),this.sequenceNumber=t,this.offset=n}return l(e,null,[{key:"empty",value:function(){return new e(0,kp.min())}}]),e}();function mp(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=op.fromTimestamp(1e9===r?new ap(n+1,0):new ap(n,r));return new kp(i,fp.empty(),t)}function gp(e){return new kp(e.readTime,e.key,-1)}var kp=function(){function e(t,n,r){u(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return l(e,null,[{key:"min",value:function(){return new e(op.min(),fp.empty(),-1)}},{key:"max",value:function(){return new e(op.max(),fp.empty(),-1)}}]),e}();function bp(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=fp.comparator(e.documentKey,t.documentKey))?n:np(e.largestBatchId,t.largestBatchId)}var wp="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",_p=function(){function e(){u(this,e),this.onCommittedListeners=[]}return l(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach((function(e){return e()}))}}]),e}();function xp(e){return Ip.apply(this,arguments)}function Ip(){return Ip=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===zd.FAILED_PRECONDITION&&t.message===wp){e.next=2;break}throw t;case 2:Md("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}}),e)}))),Ip.apply(this,arguments)}var Sp=function(){function e(t){var n=this;u(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)}),(function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)}))}return l(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&Vd(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e((function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}}))}},{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.reject(n)}}],[{key:"resolve",value:function(t){return new e((function(e,n){e(t)}))}},{key:"reject",value:function(t){return new e((function(e,n){n(t)}))}},{key:"waitFor",value:function(t){return new e((function(e,n){var r=0,i=0,a=!1;t.forEach((function(t){++r,t.next((function(){++i,a&&i===r&&e()}),(function(e){return n(e)}))})),a=!0,i===r&&e()}))}},{key:"or",value:function(t){var n,r=e.resolve(!1),i=y(t);try{var a=function(){var t=n.value;r=r.next((function(n){return n?e.resolve(n):t()}))};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach((function(e,i){r.push(t.call(n,e,i))})),this.waitFor(r)}},{key:"mapArray",value:function(t,n){return new e((function(e,r){for(var i=t.length,a=new Array(i),o=0,u=function(){var u=s;n(t[u]).next((function(t){a[u]=t,++o===i&&e(a)}),(function(e){return r(e)}))},s=0;s<i;s++)u()}))}},{key:"doWhile",value:function(t,n){return new e((function(e,r){!function i(){!0===t()?n().next((function(){i()}),r):e()}()}))}}]),e}(),Tp=function(){function e(t,n){var r=this;u(this,e),this.action=t,this.transaction=n,this.aborted=!1,this.P=new Kd,this.transaction.oncomplete=function(){r.P.resolve()},this.transaction.onabort=function(){n.error?r.P.reject(new Np(t,n.error)):r.P.resolve()},this.transaction.onerror=function(e){var n=Op(e.target.error);r.P.reject(new Np(t,n))}}return l(e,[{key:"v",get:function(){return this.P.promise}},{key:"abort",value:function(e){e&&this.P.reject(e),this.aborted||(Md("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}},{key:"V",value:function(){var e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}},{key:"store",value:function(e){var t=this.transaction.objectStore(e);return new Ap(t)}}],[{key:"open",value:function(t,n,r,i){try{return new e(n,t.transaction(i,r))}catch(t){throw new Np(n,t)}}}]),e}(),Ep=function(){function e(t,n,r){u(this,e),this.name=t,this.version=n,this.S=r,12.2===e.D(V())&&Fd("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return l(e,[{key:"F",value:function(){var e=h(o().mark((function e(t){var n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.db,e.t0){e.next=6;break}return Md("SimpleDb","Opening database:",this.name),e.next=5,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Np(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new Wd(zd.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===n.name?r(new Wd(zd.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n)):r(new Np(t,n))},i.onupgradeneeded=function(e){Md("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;n.S.$(t,i.transaction,e.oldVersion,n.version).next((function(){Md("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}));case 5:this.db=e.sent;case 6:return this.B&&(this.db.onversionchange=function(e){return n.B(e)}),e.abrupt("return",this.db);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"L",value:function(e){this.B=e,this.db&&(this.db.onversionchange=function(t){return e(t)})}},{key:"runTransaction",value:function(){var e=h(o().mark((function e(t,n,r,i){var a,u,s,c,l=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a="readonly"===n,u=0,s=o().mark((function e(){var n,s,c,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return++u,e.prev=1,e.next=4,l.F(t);case 4:return l.db=e.sent,n=Tp.open(l.db,t,a?"readonly":"readwrite",r),s=i(n).next((function(e){return n.V(),e})).catch((function(e){return n.abort(e),Sp.reject(e)})).toPromise(),s.catch((function(){})),e.next=9,n.v;case 9:return e.t0=s,e.abrupt("return",{v:e.t0});case 13:if(e.prev=13,e.t1=e.catch(1),c=e.t1,f="FirebaseError"!==c.name&&u<3,Md("SimpleDb","Transaction failed with error:",c.message,"Retrying:",f),l.close(),f){e.next=18;break}return e.abrupt("return",{v:Promise.reject(c)});case 18:case"end":return e.stop()}}),e,null,[[1,13]])}));case 3:return e.delegateYield(s(),"t0",4);case 4:if("object"!==typeof(c=e.t0)){e.next=7;break}return e.abrupt("return",c.v);case 7:e.next=3;break;case 9:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"close",value:function(){this.db&&this.db.close(),this.db=void 0}}],[{key:"delete",value:function(e){return Md("SimpleDb","Removing database:",e),Pp(window.indexedDB.deleteDatabase(e)).toPromise()}},{key:"C",value:function(){if(!G())return!1;if(e.N())return!0;var t=V(),n=e.D(t),r=0<n&&n<10,i=e.k(t),a=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||a)}},{key:"N",value:function(){var e;return"undefined"!=typeof process&&"YES"===(null===(e={NODE_ENV:"production",PUBLIC_URL:"/messanger",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})||void 0===e?void 0:e.O)}},{key:"M",value:function(e,t){return e.store(t)}},{key:"D",value:function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}},{key:"k",value:function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}}]),e}(),Cp=function(){function e(t){u(this,e),this.q=t,this.U=!1,this.K=null}return l(e,[{key:"isDone",get:function(){return this.U}},{key:"G",get:function(){return this.K}},{key:"cursor",set:function(e){this.q=e}},{key:"done",value:function(){this.U=!0}},{key:"j",value:function(e){this.K=e}},{key:"delete",value:function(){return Pp(this.q.delete())}}]),e}(),Np=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this,zd.UNAVAILABLE,"IndexedDB transaction '".concat(e,"' failed: ").concat(r))).name="IndexedDbTransactionError",i}return l(n)}(Wd);function Rp(e){return"IndexedDbTransactionError"===e.name}var Ap=function(){function e(t){u(this,e),this.store=t}return l(e,[{key:"put",value:function(e,t){var n;return void 0!==t?(Md("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(Md("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Pp(n)}},{key:"add",value:function(e){return Md("SimpleDb","ADD",this.store.name,e,e),Pp(this.store.add(e))}},{key:"get",value:function(e){var t=this;return Pp(this.store.get(e)).next((function(n){return void 0===n&&(n=null),Md("SimpleDb","GET",t.store.name,e,n),n}))}},{key:"delete",value:function(e){return Md("SimpleDb","DELETE",this.store.name,e),Pp(this.store.delete(e))}},{key:"count",value:function(){return Md("SimpleDb","COUNT",this.store.name),Pp(this.store.count())}},{key:"W",value:function(e,t){var n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){var r=this.cursor(n),i=[];return this.H(r,(function(e,t){i.push(t)})).next((function(){return i}))}var a=this.store.getAll(n.range);return new Sp((function(e,t){a.onerror=function(e){t(e.target.error)},a.onsuccess=function(t){e(t.target.result)}}))}},{key:"J",value:function(e,t){var n=this.store.getAll(e,null===t?void 0:t);return new Sp((function(e,t){n.onerror=function(e){t(e.target.error)},n.onsuccess=function(t){e(t.target.result)}}))}},{key:"Y",value:function(e,t){Md("SimpleDb","DELETE ALL",this.store.name);var n=this.options(e,t);n.X=!1;var r=this.cursor(n);return this.H(r,(function(e,t,n){return n.delete()}))}},{key:"Z",value:function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.H(r,t)}},{key:"tt",value:function(e){var t=this.cursor({});return new Sp((function(n,r){t.onerror=function(e){var t=Op(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next((function(e){e?r.continue():n()})):n()}}))}},{key:"H",value:function(e,t){var n=[];return new Sp((function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var a=new Cp(i),o=t(i.primaryKey,i.value,a);if(o instanceof Sp){var u=o.catch((function(e){return a.done(),Sp.reject(e)}));n.push(u)}a.isDone?r():null===a.G?i.continue():i.continue(a.G)}else r()}})).next((function(){return Sp.waitFor(n)}))}},{key:"options",value:function(e,t){var n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}},{key:"cursor",value:function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.X?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}]),e}();function Pp(e){return new Sp((function(t,n){e.onsuccess=function(e){var n=e.target.result;t(n)},e.onerror=function(e){var t=Op(e.target.error);n(t)}}))}var Dp=!1;function Op(e){var t=Ep.D(V());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new Wd("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(n,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return Dp||(Dp=!0,setTimeout((function(){throw r}),0)),r}}return e}var Lp=function(){function e(t,n){u(this,e),this.asyncQueue=t,this.et=n,this.task=null}return l(e,[{key:"start",value:function(){this.nt(15e3)}},{key:"stop",value:function(){this.task&&(this.task.cancel(),this.task=null)}},{key:"started",get:function(){return null!==this.task}},{key:"nt",value:function(e){var t=this;Md("IndexBackiller","Scheduled in ".concat(e,"ms")),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.task=null,e.prev=1,e.t0=Md,e.t1="Documents written: ",e.next=6,t.et.st();case 6:e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2),(0,e.t0)("IndexBackiller",e.t3),e.next=19;break;case 11:if(e.prev=11,e.t4=e.catch(1),!Rp(e.t4)){e.next=17;break}Md("IndexBackiller","Ignoring IndexedDB error during index backfill: ",e.t4),e.next=19;break;case 17:return e.next=19,xp(e.t4);case 19:return e.next=21,t.nt(6e4);case 21:case"end":return e.stop()}}),e,null,[[1,11]])}))))}}]),e}(),Mp=function(){function e(t,n){u(this,e),this.localStore=t,this.persistence=n}return l(e,[{key:"st",value:function(){var e=h(o().mark((function e(){var t,n=this,r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:50,e.abrupt("return",this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(function(e){return n.it(e,t)})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"it",value:function(e,t){var n=this,r=new Set,i=t,a=!0;return Sp.doWhile((function(){return!0===a&&i>0}),(function(){return n.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((function(t){if(null!==t&&!r.has(t))return Md("IndexBackiller","Processing collection: ".concat(t)),n.rt(e,t,i).next((function(e){i-=e,r.add(t)}));a=!1}))})).next((function(){return t-i}))}},{key:"rt",value:function(e,t,n){var r=this;return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((function(i){return r.localStore.localDocuments.getNextDocuments(e,t,i,n).next((function(n){var a=n.changes;return r.localStore.indexManager.updateIndexEntries(e,a).next((function(){return r.ot(i,n)})).next((function(n){return Md("IndexBackiller","Updating offset: ".concat(n)),r.localStore.indexManager.updateCollectionGroup(e,t,n)})).next((function(){return a.size}))}))}))}},{key:"ot",value:function(e,t){var n=e;return t.changes.forEach((function(e,t){var r=gp(t);bp(r,n)>0&&(n=r)})),new kp(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}]),e}(),Fp=function(){function e(t,n){var r=this;u(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.ut(e)},this.ct=function(e){return n.writeSequenceNumber(e)})}return l(e,[{key:"ut",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.ct&&this.ct(e),e}}]),e}();Fp.at=-1;var Up=l((function e(t,n,r,i,a,o,s,c){u(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=c})),jp=function(){function e(t,n){u(this,e),this.projectId=t,this.database=n||"(default)"}return l(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}();function Vp(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function qp(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Bp(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function zp(e){return null==e}function Wp(e){return 0===e&&1/e==-1/0}function Kp(e){return"number"==typeof e&&Number.isInteger(e)&&!Wp(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}var Hp=function(e){function t(e){u(this,t),this.binaryString=e}return l(t,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return e=this.binaryString,btoa(e);var e}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return np(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){var n=function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new t(n)}}]),t}();Hp.EMPTY_BYTE_STRING=new Hp("");var Gp=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qp(e){if(qd(!!e),"string"==typeof e){var t=0,n=Gp.exec(e);if(qd(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:$p(e.seconds),nanos:$p(e.nanos)}}function $p(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Yp(e){return"string"==typeof e?Hp.fromBase64String(e):Hp.fromUint8Array(e)}function Xp(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Jp(e){var t=e.mapValue.fields.__previous_value__;return Xp(t)?Jp(t):t}function Zp(e){var t=Qp(e.mapValue.fields.__local_write_time__.timestampValue);return new ap(t.seconds,t.nanos)}var ev={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},tv={nullValue:"NULL_VALUE"};function nv(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Xp(e)?4:yv(e)?9007199254740991:10:Vd()}function rv(e,t){if(e===t)return!0;var n=nv(e);if(n!==nv(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Zp(e).isEqual(Zp(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=Qp(e.timestampValue),r=Qp(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Yp(e.bytesValue).isEqual(Yp(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return $p(e.geoPointValue.latitude)===$p(t.geoPointValue.latitude)&&$p(e.geoPointValue.longitude)===$p(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return $p(e.integerValue)===$p(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=$p(e.doubleValue),r=$p(t.doubleValue);return n===r?Wp(n)===Wp(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return rp(e.arrayValue.values||[],t.arrayValue.values||[],rv);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Vp(n)!==Vp(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!rv(n[i],r[i])))return!1;return!0}(e,t);default:return Vd()}}function iv(e,t){return void 0!==(e.values||[]).find((function(e){return rv(e,t)}))}function av(e,t){if(e===t)return 0;var n=nv(e),r=nv(t);if(n!==r)return np(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return np(e.booleanValue,t.booleanValue);case 2:return function(e,t){var n=$p(e.integerValue||e.doubleValue),r=$p(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return ov(e.timestampValue,t.timestampValue);case 4:return ov(Zp(e),Zp(t));case 5:return np(e.stringValue,t.stringValue);case 6:return function(e,t){var n=Yp(e),r=Yp(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=np(n[i],r[i]);if(0!==a)return a}return np(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=np($p(e.latitude),$p(t.latitude));return 0!==n?n:np($p(e.longitude),$p(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=av(n[i],r[i]);if(a)return a}return np(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===ev.mapValue&&t===ev.mapValue)return 0;if(e===ev.mapValue)return 1;if(t===ev.mapValue)return-1;var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var u=np(r[o],a[o]);if(0!==u)return u;var s=av(n[r[o]],i[a[o]]);if(0!==s)return s}return np(r.length,a.length)}(e.mapValue,t.mapValue);default:throw Vd()}}function ov(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return np(e,t);var n=Qp(e),r=Qp(t),i=np(n.seconds,r.seconds);return 0!==i?i:np(n.nanos,r.nanos)}function uv(e){return sv(e)}function sv(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){var t=Qp(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Yp(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,fp.fromName(n).toString()):"geoPointValue"in e?"geo(".concat((t=e.geoPointValue).latitude,",").concat(t.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,i=y(e.values||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+=sv(a)}}catch(o){i.e(o)}finally{i.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,i=y(Object.keys(e.fields||{}).sort());try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+="".concat(a,":").concat(sv(e.fields[a]))}}catch(o){i.e(o)}finally{i.f()}return n+"}"}(e.mapValue):Vd();var t,n}function cv(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function lv(e){return!!e&&"integerValue"in e}function fv(e){return!!e&&"arrayValue"in e}function hv(e){return!!e&&"nullValue"in e}function dv(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function pv(e){return!!e&&"mapValue"in e}function vv(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return qp(e.mapValue.fields,(function(e,n){return t.mapValue.fields[e]=vv(n)})),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=vv(e.arrayValue.values[r]);return n}return Object.assign({},e)}function yv(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function mv(e){return"nullValue"in e?tv:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?cv(jp.empty(),fp.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:Vd()}function gv(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?cv(jp.empty(),fp.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?ev:Vd()}function kv(e,t){var n=av(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function bv(e,t){var n=av(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}var wv=l((function e(t,n){u(this,e),this.position=t,this.inclusive=n}));function _v(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?fp.comparator(fp.fromName(o.referenceValue),n.key):av(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function xv(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!rv(e.position[n],t.position[n]))return!1;return!0}var Iv=l((function e(){u(this,e)})),Sv=function(e){_(n,e);var t=T(n);function n(e,r,i){var a;return u(this,n),(a=t.call(this)).field=e,a.op=r,a.value=i,a}return l(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(av(t,this.value)):null!==t&&nv(this.value)===nv(t)&&this.matchesComparison(av(t,this.value))}},{key:"matchesComparison",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Vd()}}},{key:"isInequality",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}},{key:"getFlattenedFilters",value:function(){return[this]}},{key:"getFilters",value:function(){return[this]}},{key:"getFirstInequalityField",value:function(){return this.isInequality()?this.field:null}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new Lv(e,t,r):"array-contains"===t?new jv(e,r):"in"===t?new Vv(e,r):"not-in"===t?new qv(e,r):"array-contains-any"===t?new Bv(e,r):new n(e,t,r)}},{key:"createKeyFieldInFilter",value:function(e,t,n){return"in"===t?new Mv(e,n):new Fv(e,n)}}]),n}(Iv),Tv=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this)).filters=e,i.op=r,i.ht=null,i}return l(n,[{key:"matches",value:function(e){return Ev(this)?void 0===this.filters.find((function(t){return!t.matches(e)})):void 0!==this.filters.find((function(t){return t.matches(e)}))}},{key:"getFlattenedFilters",value:function(){return null!==this.ht||(this.ht=this.filters.reduce((function(e,t){return e.concat(t.getFlattenedFilters())}),[])),this.ht}},{key:"getFilters",value:function(){return Object.assign([],this.filters)}},{key:"getFirstInequalityField",value:function(){var e=this.lt((function(e){return e.isInequality()}));return null!==e?e.field:null}},{key:"lt",value:function(e){var t,n=y(this.getFlattenedFilters());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(e(r))return r}}catch(i){n.e(i)}finally{n.f()}return null}}],[{key:"create",value:function(e,t){return new n(e,t)}}]),n}(Iv);function Ev(e){return"and"===e.op}function Cv(e){return"or"===e.op}function Nv(e){return Rv(e)&&Ev(e)}function Rv(e){var t,n=y(e.filters);try{for(n.s();!(t=n.n()).done;){if(t.value instanceof Tv)return!1}}catch(r){n.e(r)}finally{n.f()}return!0}function Av(e){if(e instanceof Sv)return e.field.canonicalString()+e.op.toString()+uv(e.value);var t=e.filters.map((function(e){return Av(e)})).join(",");return"".concat(e.op,"(").concat(t,")")}function Pv(e,t){return e instanceof Sv?function(e,t){return t instanceof Sv&&e.op===t.op&&e.field.isEqual(t.field)&&rv(e.value,t.value)}(e,t):e instanceof Tv?function(e,t){return t instanceof Tv&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((function(e,n,r){return e&&Pv(n,t.filters[r])}),!0)}(e,t):void Vd()}function Dv(e,t){var n=e.filters.concat(t);return Tv.create(n,e.op)}function Ov(e){return e instanceof Sv?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(uv(e.value))}(e):e instanceof Tv?function(e){return e.op.toString()+" {"+e.getFilters().map(Ov).join(" ,")+"}"}(e):"Filter"}var Lv=function(e){_(n,e);var t=T(n);function n(e,r,i){var a;return u(this,n),(a=t.call(this,e,r,i)).key=fp.fromName(i.referenceValue),a}return l(n,[{key:"matches",value:function(e){var t=fp.comparator(e.key,this.key);return this.matchesComparison(t)}}]),n}(Sv),Mv=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this,e,"in",r)).keys=Uv("in",r),i}return l(n,[{key:"matches",value:function(e){return this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(Sv),Fv=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this,e,"not-in",r)).keys=Uv("not-in",r),i}return l(n,[{key:"matches",value:function(e){return!this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(Sv);function Uv(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(e){return fp.fromName(e.referenceValue)}))}var jv=function(e){_(n,e);var t=T(n);function n(e,r){return u(this,n),t.call(this,e,"array-contains",r)}return l(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return fv(t)&&iv(t.arrayValue,this.value)}}]),n}(Sv),Vv=function(e){_(n,e);var t=T(n);function n(e,r){return u(this,n),t.call(this,e,"in",r)}return l(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&iv(this.value.arrayValue,t)}}]),n}(Sv),qv=function(e){_(n,e);var t=T(n);function n(e,r){return u(this,n),t.call(this,e,"not-in",r)}return l(n,[{key:"matches",value:function(e){if(iv(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!iv(this.value.arrayValue,t)}}]),n}(Sv),Bv=function(e){_(n,e);var t=T(n);function n(e,r){return u(this,n),t.call(this,e,"array-contains-any",r)}return l(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!fv(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(e){return iv(t.value.arrayValue,e)}))}}]),n}(Sv),zv=l((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";u(this,e),this.field=t,this.dir=n}));function Wv(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}var Kv=function(){function e(t,n){u(this,e),this.comparator=t,this.root=n||Gv.EMPTY}return l(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Gv.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Gv.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))}},{key:"toString",value:function(){var e=[];return this.inorderTraversal((function(t,n){return e.push("".concat(t,":").concat(n)),!1})),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new Hv(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new Hv(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new Hv(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new Hv(this.root,e,this.comparator,!0)}}]),e}(),Hv=function(){function e(t,n,r,i){u(this,e),this.isReverse=i,this.nodeStack=[];for(var a=1;!t.isEmpty();)if(a=n?r(t.key,n):1,n&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return l(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),Gv=function(){function e(t,n,r,i,a){u(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=a?a:e.EMPTY,this.size=this.left.size+1+this.right.size}return l(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw Vd();if(this.right.isRed())throw Vd();var e=this.left.check();if(e!==this.right.check())throw Vd();return e+(this.isRed()?0:1)}}]),e}();Gv.EMPTY=null,Gv.RED=!0,Gv.BLACK=!1,Gv.EMPTY=new(function(){function e(){u(this,e),this.size=0}return l(e,[{key:"key",get:function(){throw Vd()}},{key:"value",get:function(){throw Vd()}},{key:"color",get:function(){throw Vd()}},{key:"left",get:function(){throw Vd()}},{key:"right",get:function(){throw Vd()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new Gv(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var Qv=function(){function e(t){u(this,e),this.comparator=t,this.data=new Kv(this.comparator)}return l(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new $v(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new $v(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach((function(e){t=t.add(e)})),t}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach((function(t){e.push(t)})),e}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),$v=function(){function e(t){u(this,e),this.iter=t}return l(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}();function Yv(e){return e.hasNext()?e.getNext():void 0}var Xv=function(){function e(t){u(this,e),this.fields=t,t.sort(lp.comparator)}return l(e,[{key:"unionWith",value:function(t){var n,r=new Qv(lp.comparator),i=y(this.fields);try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r.add(a)}}catch(c){i.e(c)}finally{i.f()}var o,u=y(t);try{for(u.s();!(o=u.n()).done;){var s=o.value;r=r.add(s)}}catch(c){u.e(c)}finally{u.f()}return new e(r.toArray())}},{key:"covers",value:function(e){var t,n=y(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return rp(this.fields,e.fields,(function(e,t){return e.isEqual(t)}))}}],[{key:"empty",value:function(){return new e([])}}]),e}(),Jv=function(){function e(t){u(this,e),this.value=t}return l(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!pv(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=vv(t)}},{key:"setAll",value:function(e){var t=this,n=lp.emptyPath(),r={},i=[];e.forEach((function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=vv(e):i.push(a.lastSegment())}));var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());pv(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return rv(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];pv(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){qp(t,(function(t,n){return e[t]=n}));var r,i=y(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete e[a]}}catch(o){i.e(o)}finally{i.f()}}},{key:"clone",value:function(){return new e(vv(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function Zv(e){var t=[];return qp(e.fields,(function(e,n){var r=new lp([e]);if(pv(n)){var i=Zv(n.mapValue).fields;if(0===i.length)t.push(r);else{var a,o=y(i);try{for(o.s();!(a=o.n()).done;){var u=a.value;t.push(r.child(u))}}catch(s){o.e(s)}finally{o.f()}}}else t.push(r)})),new Xv(t)}var ey=function(){function e(t,n,r,i,a,o,s){u(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.createTime=a,this.data=o,this.documentState=s}return l(e,[{key:"convertToFoundDocument",value:function(e,t){return!this.createTime.isEqual(op.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=Jv.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=Jv.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=op.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,op.min(),op.min(),op.min(),Jv.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r,i){return new e(t,1,n,op.min(),r,i,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,op.min(),op.min(),Jv.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,op.min(),op.min(),Jv.empty(),2)}}]),e}(),ty=l((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;u(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=s,this.ft=null}));function ny(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new ty(e,t,n,r,i,a,o)}function ry(e){var t=Bd(e);if(null===t.ft){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map((function(e){return Av(e)})).join(","),n+="|ob:",n+=t.orderBy.map((function(e){return function(e){return e.field.canonicalString()+e.dir}(e)})).join(","),zp(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return uv(e)})).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return uv(e)})).join(",")),t.ft=n}return t.ft}function iy(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!Wv(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(!Pv(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!xv(e.startAt,t.startAt)&&xv(e.endAt,t.endAt)}function ay(e){return fp.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function oy(e,t){return e.filters.filter((function(e){return e instanceof Sv&&e.field.isEqual(t)}))}function uy(e,t,n){var r,i=tv,a=!0,o=y(oy(e,t));try{for(o.s();!(r=o.n()).done;){var u=r.value,s=tv,c=!0;switch(u.op){case"<":case"<=":s=mv(u.value);break;case"==":case"in":case">=":s=u.value;break;case">":s=u.value,c=!1;break;case"!=":case"not-in":s=tv}kv({value:i,inclusive:a},{value:s,inclusive:c})<0&&(i=s,a=c)}}catch(h){o.e(h)}finally{o.f()}if(null!==n)for(var l=0;l<e.orderBy.length;++l)if(e.orderBy[l].field.isEqual(t)){var f=n.position[l];kv({value:i,inclusive:a},{value:f,inclusive:n.inclusive})<0&&(i=f,a=n.inclusive);break}return{value:i,inclusive:a}}function sy(e,t,n){var r,i=ev,a=!0,o=y(oy(e,t));try{for(o.s();!(r=o.n()).done;){var u=r.value,s=ev,c=!0;switch(u.op){case">=":case">":s=gv(u.value),c=!1;break;case"==":case"in":case"<=":s=u.value;break;case"<":s=u.value,c=!1;break;case"!=":case"not-in":s=ev}bv({value:i,inclusive:a},{value:s,inclusive:c})>0&&(i=s,a=c)}}catch(h){o.e(h)}finally{o.f()}if(null!==n)for(var l=0;l<e.orderBy.length;++l)if(e.orderBy[l].field.isEqual(t)){var f=n.position[l];bv({value:i,inclusive:a},{value:f,inclusive:n.inclusive})>0&&(i=f,a=n.inclusive);break}return{value:i,inclusive:a}}var cy=l((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;u(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=s,this.endAt=c,this.dt=null,this._t=null,this.startAt,this.endAt}));function ly(e,t,n,r,i,a,o,u){return new cy(e,t,n,r,i,a,o,u)}function fy(e){return new cy(e)}function hy(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function dy(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function py(e){var t,n=y(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value.getFirstInequalityField();if(null!==r)return r}}catch(i){n.e(i)}finally{n.f()}return null}function vy(e){return null!==e.collectionGroup}function yy(e){var t=Bd(e);if(null===t.dt){t.dt=[];var n=py(t),r=dy(t);if(null!==n&&null===r)n.isKeyField()||t.dt.push(new zv(n)),t.dt.push(new zv(lp.keyField(),"asc"));else{var i,a=!1,o=y(t.explicitOrderBy);try{for(o.s();!(i=o.n()).done;){var u=i.value;t.dt.push(u),u.field.isKeyField()&&(a=!0)}}catch(c){o.e(c)}finally{o.f()}if(!a){var s=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.dt.push(new zv(lp.keyField(),s))}}}return t.dt}function my(e){var t=Bd(e);if(!t._t)if("F"===t.limitType)t._t=ny(t.path,t.collectionGroup,yy(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],i=y(yy(t));try{for(i.s();!(n=i.n()).done;){var a=n.value,o="desc"===a.dir?"asc":"desc";r.push(new zv(a.field,o))}}catch(c){i.e(c)}finally{i.f()}var u=t.endAt?new wv(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new wv(t.startAt.position,t.startAt.inclusive):null;t._t=ny(t.path,t.collectionGroup,r,t.filters,t.limit,u,s)}return t._t}function gy(e,t){t.getFirstInequalityField(),py(e);var n=e.filters.concat([t]);return new cy(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function ky(e,t,n){return new cy(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function by(e,t){return iy(my(e),my(t))&&e.limitType===t.limitType}function wy(e){return"".concat(ry(my(e)),"|lt:").concat(e.limitType)}function _y(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map((function(e){return Ov(e)})).join(", "),"]")),zp(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map((function(e){return function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)})).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((function(e){return uv(e)})).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((function(e){return uv(e)})).join(",")),"Target(".concat(t,")")}(my(e)),"; limitType=").concat(e.limitType,")")}function xy(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):fp.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=y(yy(e));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=y(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){var r=_v(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,yy(e),t))&&!(e.endAt&&!function(e,t,n){var r=_v(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,yy(e),t))}(e,t)}function Iy(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Sy(e){return function(t,n){var r,i=!1,a=y(yy(e));try{for(a.s();!(r=a.n()).done;){var o=r.value,u=Ty(o,t,n);if(0!==u)return u;i=i||o.field.isKeyField()}}catch(s){a.e(s)}finally{a.f()}return 0}}function Ty(e,t,n){var r=e.field.isKeyField()?fp.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?av(r,i):Vd()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Vd()}}function Ey(e,t){if(e.wt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Wp(t)?"-0":t}}function Cy(e){return{integerValue:""+e}}function Ny(e,t){return Kp(t)?Cy(t):Ey(e,t)}var Ry=l((function e(){u(this,e),this._=void 0}));function Ay(e,t,n){return e instanceof Oy?function(e,t){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Ly?My(e,t):e instanceof Fy?Uy(e,t):function(e,t){var n=Dy(e,t),r=Vy(n)+Vy(e.gt);return lv(n)&&lv(e.gt)?Cy(r):Ey(e.yt,r)}(e,t)}function Py(e,t,n){return e instanceof Ly?My(e,t):e instanceof Fy?Uy(e,t):n}function Dy(e,t){return e instanceof jy?lv(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}var Oy=function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.apply(this,arguments)}return l(n)}(Ry),Ly=function(e){_(n,e);var t=T(n);function n(e){var r;return u(this,n),(r=t.call(this)).elements=e,r}return l(n)}(Ry);function My(e,t){var n,r=qy(t),i=y(e.elements);try{var a=function(){var e=n.value;r.some((function(t){return rv(t,e)}))||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var Fy=function(e){_(n,e);var t=T(n);function n(e){var r;return u(this,n),(r=t.call(this)).elements=e,r}return l(n)}(Ry);function Uy(e,t){var n,r=qy(t),i=y(e.elements);try{var a=function(){var e=n.value;r=r.filter((function(t){return!rv(t,e)}))};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var jy=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this)).yt=e,i.gt=r,i}return l(n)}(Ry);function Vy(e){return $p(e.integerValue||e.doubleValue)}function qy(e){return fv(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var By=l((function e(t,n){u(this,e),this.field=t,this.transform=n}));var zy=l((function e(t,n){u(this,e),this.version=t,this.transformResults=n})),Wy=function(){function e(t,n){u(this,e),this.updateTime=t,this.exists=n}return l(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function Ky(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var Hy=l((function e(){u(this,e)}));function Gy(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new am(e.key,Wy.none()):new Jy(e.key,e.data,Wy.none());var n,r=e.data,i=Jv.empty(),a=new Qv(lp.comparator),o=y(t.fields);try{for(o.s();!(n=o.n()).done;){var u=n.value;if(!a.has(u)){var s=r.field(u);null===s&&u.length>1&&(u=u.popLast(),s=r.field(u)),null===s?i.delete(u):i.set(u,s),a=a.add(u)}}}catch(c){o.e(c)}finally{o.f()}return new Zy(e.key,i,new Xv(a.toArray()),Wy.none())}function Qy(e,t,n){e instanceof Jy?function(e,t,n){var r=e.value.clone(),i=tm(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Zy?function(e,t,n){if(Ky(e.precondition,t)){var r=tm(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(em(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function $y(e,t,n,r){return e instanceof Jy?function(e,t,n,r){if(!Ky(e.precondition,t))return n;var i=e.value.clone(),a=nm(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Zy?function(e,t,n,r){if(!Ky(e.precondition,t))return n;var i=nm(e.fieldTransforms,r,t),a=t.data;return a.setAll(em(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((function(e){return e.field})))}(e,t,n,r):function(e,t,n){return Ky(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Yy(e,t){var n,r=null,i=y(e.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.field),u=Dy(a.transform,o||null);null!=u&&(null===r&&(r=Jv.empty()),r.set(a.field,u))}}catch(s){i.e(s)}finally{i.f()}return r||null}function Xy(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&rp(e,t,(function(e,t){return function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Ly&&t instanceof Ly||e instanceof Fy&&t instanceof Fy?rp(e.elements,t.elements,rv):e instanceof jy&&t instanceof jy?rv(e.gt,t.gt):e instanceof Oy&&t instanceof Oy}(e.transform,t.transform)}(e,t)}))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}var Jy=function(e){_(n,e);var t=T(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return u(this,n),(a=t.call(this)).key=e,a.value=r,a.precondition=i,a.fieldTransforms=o,a.type=0,a}return l(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Hy),Zy=function(e){_(n,e);var t=T(n);function n(e,r,i,a){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return u(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=i,o.precondition=a,o.fieldTransforms=s,o.type=1,o}return l(n,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),n}(Hy);function em(e){var t=new Map;return e.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}})),t}function tm(e,t,n){var r=new Map;qd(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,u=t.data.field(a.field);r.set(a.field,Py(o,u,n[i]))}return r}function nm(e,t,n){var r,i=new Map,a=y(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,u=o.transform,s=n.data.field(o.field);i.set(o.field,Ay(u,s,t))}}catch(c){a.e(c)}finally{a.f()}return i}var rm,im,am=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return l(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Hy),om=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return l(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Hy),um=l((function e(t){u(this,e),this.count=t}));function sm(e){switch(e){default:return Vd();case zd.CANCELLED:case zd.UNKNOWN:case zd.DEADLINE_EXCEEDED:case zd.RESOURCE_EXHAUSTED:case zd.INTERNAL:case zd.UNAVAILABLE:case zd.UNAUTHENTICATED:return!1;case zd.INVALID_ARGUMENT:case zd.NOT_FOUND:case zd.ALREADY_EXISTS:case zd.PERMISSION_DENIED:case zd.FAILED_PRECONDITION:case zd.ABORTED:case zd.OUT_OF_RANGE:case zd.UNIMPLEMENTED:case zd.DATA_LOSS:return!0}}function cm(e){if(void 0===e)return Fd("GRPC error has no .code"),zd.UNKNOWN;switch(e){case rm.OK:return zd.OK;case rm.CANCELLED:return zd.CANCELLED;case rm.UNKNOWN:return zd.UNKNOWN;case rm.DEADLINE_EXCEEDED:return zd.DEADLINE_EXCEEDED;case rm.RESOURCE_EXHAUSTED:return zd.RESOURCE_EXHAUSTED;case rm.INTERNAL:return zd.INTERNAL;case rm.UNAVAILABLE:return zd.UNAVAILABLE;case rm.UNAUTHENTICATED:return zd.UNAUTHENTICATED;case rm.INVALID_ARGUMENT:return zd.INVALID_ARGUMENT;case rm.NOT_FOUND:return zd.NOT_FOUND;case rm.ALREADY_EXISTS:return zd.ALREADY_EXISTS;case rm.PERMISSION_DENIED:return zd.PERMISSION_DENIED;case rm.FAILED_PRECONDITION:return zd.FAILED_PRECONDITION;case rm.ABORTED:return zd.ABORTED;case rm.OUT_OF_RANGE:return zd.OUT_OF_RANGE;case rm.UNIMPLEMENTED:return zd.UNIMPLEMENTED;case rm.DATA_LOSS:return zd.DATA_LOSS;default:return Vd()}}(im=rm||(rm={}))[im.OK=0]="OK",im[im.CANCELLED=1]="CANCELLED",im[im.UNKNOWN=2]="UNKNOWN",im[im.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",im[im.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",im[im.NOT_FOUND=5]="NOT_FOUND",im[im.ALREADY_EXISTS=6]="ALREADY_EXISTS",im[im.PERMISSION_DENIED=7]="PERMISSION_DENIED",im[im.UNAUTHENTICATED=16]="UNAUTHENTICATED",im[im.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",im[im.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",im[im.ABORTED=10]="ABORTED",im[im.OUT_OF_RANGE=11]="OUT_OF_RANGE",im[im.UNIMPLEMENTED=12]="UNIMPLEMENTED",im[im.INTERNAL=13]="INTERNAL",im[im.UNAVAILABLE=14]="UNAVAILABLE",im[im.DATA_LOSS=15]="DATA_LOSS";var lm=function(){function e(t,n){u(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}return l(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,i=y(n);try{for(i.s();!(r=i.n()).done;){var a=k(r.value,2),o=a[0],u=a[1];if(this.equalsFn(o,e))return u}}catch(s){i.e(s)}finally{i.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){qp(this.inner,(function(t,n){var r,i=y(n);try{for(i.s();!(r=i.n()).done;){var a=k(r.value,2),o=a[0],u=a[1];e(o,u)}}catch(s){i.e(s)}finally{i.f()}}))}},{key:"isEmpty",value:function(){return Bp(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),fm=new Kv(fp.comparator);function hm(){return fm}var dm=new Kv(fp.comparator);function pm(){for(var e=dm,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.insert(o.key,o)}return e}function vm(e){var t=dm;return e.forEach((function(e,n){return t=t.insert(e,n.overlayedDocument)})),t}function ym(){return gm()}function mm(){return gm()}function gm(){return new lm((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)}))}var km=new Kv(fp.comparator),bm=new Qv(fp.comparator);function wm(){for(var e=bm,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.add(o)}return e}var _m=new Qv(np);function xm(){return _m}var Im=function(){function e(t,n,r,i,a){u(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return l(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n,r){var i=new Map;return i.set(t,Sm.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new e(op.min(),i,xm(),hm(),wm())}}]),e}(),Sm=function(){function e(t,n,r,i,a){u(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return l(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n,r){return new e(r,n,wm(),wm(),wm())}}]),e}(),Tm=l((function e(t,n,r,i){u(this,e),this.It=t,this.removedTargetIds=n,this.key=r,this.Tt=i})),Em=l((function e(t,n){u(this,e),this.targetId=t,this.Et=n})),Cm=l((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Hp.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;u(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i})),Nm=function(){function e(){u(this,e),this.At=0,this.Rt=Pm(),this.bt=Hp.EMPTY_BYTE_STRING,this.Pt=!1,this.vt=!0}return l(e,[{key:"current",get:function(){return this.Pt}},{key:"resumeToken",get:function(){return this.bt}},{key:"Vt",get:function(){return 0!==this.At}},{key:"St",get:function(){return this.vt}},{key:"Dt",value:function(e){e.approximateByteSize()>0&&(this.vt=!0,this.bt=e)}},{key:"Ct",value:function(){var e=wm(),t=wm(),n=wm();return this.Rt.forEach((function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Vd()}})),new Sm(this.bt,this.Pt,e,t,n)}},{key:"xt",value:function(){this.vt=!1,this.Rt=Pm()}},{key:"Nt",value:function(e,t){this.vt=!0,this.Rt=this.Rt.insert(e,t)}},{key:"kt",value:function(e){this.vt=!0,this.Rt=this.Rt.remove(e)}},{key:"Ot",value:function(){this.At+=1}},{key:"Mt",value:function(){this.At-=1}},{key:"Ft",value:function(){this.vt=!0,this.Pt=!0}}]),e}(),Rm=function(){function e(t){u(this,e),this.$t=t,this.Bt=new Map,this.Lt=hm(),this.qt=Am(),this.Ut=new Qv(np)}return l(e,[{key:"Kt",value:function(e){var t,n=y(e.It);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.Tt&&e.Tt.isFoundDocument()?this.Gt(r,e.Tt):this.Qt(r,e.key,e.Tt)}}catch(u){n.e(u)}finally{n.f()}var i,a=y(e.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.Qt(o,e.key,e.Tt)}}catch(u){a.e(u)}finally{a.f()}}},{key:"jt",value:function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.Wt(n);switch(e.state){case 0:t.zt(n)&&r.Dt(e.resumeToken);break;case 1:r.Mt(),r.Vt||r.xt(),r.Dt(e.resumeToken);break;case 2:r.Mt(),r.Vt||t.removeTarget(n);break;case 3:t.zt(n)&&(r.Ft(),r.Dt(e.resumeToken));break;case 4:t.zt(n)&&(t.Ht(n),r.Dt(e.resumeToken));break;default:Vd()}}))}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Bt.forEach((function(e,r){n.zt(r)&&t(r)}))}},{key:"Jt",value:function(e){var t=e.targetId,n=e.Et.count,r=this.Yt(t);if(r){var i=r.target;if(ay(i))if(0===n){var a=new fp(i.path);this.Qt(t,a,ey.newNoDocument(a,op.min()))}else qd(1===n);else this.Xt(t)!==n&&(this.Ht(t),this.Ut=this.Ut.add(t))}}},{key:"Zt",value:function(e){var t=this,n=new Map;this.Bt.forEach((function(r,i){var a=t.Yt(i);if(a){if(r.current&&ay(a.target)){var o=new fp(a.target.path);null!==t.Lt.get(o)||t.te(i,o)||t.Qt(i,o,ey.newNoDocument(o,e))}r.St&&(n.set(i,r.Ct()),r.xt())}}));var r=wm();this.qt.forEach((function(e,n){var i=!0;n.forEachWhile((function(e){var n=t.Yt(e);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(e))})),this.Lt.forEach((function(t,n){return n.setReadTime(e)}));var i=new Im(e,n,this.Ut,this.Lt,r);return this.Lt=hm(),this.qt=Am(),this.Ut=new Qv(np),i}},{key:"Gt",value:function(e,t){if(this.zt(e)){var n=this.te(e,t.key)?2:0;this.Wt(e).Nt(t.key,n),this.Lt=this.Lt.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ee(t.key).add(e))}}},{key:"Qt",value:function(e,t,n){if(this.zt(e)){var r=this.Wt(e);this.te(e,t)?r.Nt(t,1):r.kt(t),this.qt=this.qt.insert(t,this.ee(t).delete(e)),n&&(this.Lt=this.Lt.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Bt.delete(e)}},{key:"Xt",value:function(e){var t=this.Wt(e).Ct();return this.$t.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Ot",value:function(e){this.Wt(e).Ot()}},{key:"Wt",value:function(e){var t=this.Bt.get(e);return t||(t=new Nm,this.Bt.set(e,t)),t}},{key:"ee",value:function(e){var t=this.qt.get(e);return t||(t=new Qv(np),this.qt=this.qt.insert(e,t)),t}},{key:"zt",value:function(e){var t=null!==this.Yt(e);return t||Md("WatchChangeAggregator","Detected inactive target",e),t}},{key:"Yt",value:function(e){var t=this.Bt.get(e);return t&&t.Vt?null:this.$t.ne(e)}},{key:"Ht",value:function(e){var t=this;this.Bt.set(e,new Nm),this.$t.getRemoteKeysForTarget(e).forEach((function(n){t.Qt(e,n,null)}))}},{key:"te",value:function(e,t){return this.$t.getRemoteKeysForTarget(e).has(t)}}]),e}();function Am(){return new Kv(fp.comparator)}function Pm(){return new Kv(fp.comparator)}var Dm={asc:"ASCENDING",desc:"DESCENDING"},Om={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Lm={and:"AND",or:"OR"},Mm=l((function e(t,n){u(this,e),this.databaseId=t,this.wt=n}));function Fm(e,t){return e.wt?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Um(e,t){return e.wt?t.toBase64():t.toUint8Array()}function jm(e,t){return Fm(e,t.toTimestamp())}function Vm(e){return qd(!!e),op.fromTimestamp(function(e){var t=Qp(e);return new ap(t.seconds,t.nanos)}(e))}function qm(e,t){return function(e){return new sp(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function Bm(e){var t=sp.fromString(e);return qd(fg(t)),t}function zm(e,t){return qm(e.databaseId,t.path)}function Wm(e,t){var n=Bm(t);if(n.get(1)!==e.databaseId.projectId)throw new Wd(zd.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Wd(zd.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new fp(Qm(n))}function Km(e,t){return qm(e.databaseId,t)}function Hm(e){var t=Bm(e);return 4===t.length?sp.emptyPath():Qm(t)}function Gm(e){return new sp(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Qm(e){return qd(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function $m(e,t,n){return{name:zm(e,t),fields:n.value.mapValue.fields}}function Ym(e,t,n){var r=Wm(e,t.name),i=Vm(t.updateTime),a=t.createTime?Vm(t.createTime):op.min(),o=new Jv({mapValue:{fields:t.fields}}),u=ey.newFoundDocument(r,i,a,o);return n&&u.setHasCommittedMutations(),n?u.setHasCommittedMutations():u}function Xm(e,t){return"found"in t?function(e,t){qd(!!t.found),t.found.name,t.found.updateTime;var n=Wm(e,t.found.name),r=Vm(t.found.updateTime),i=t.found.createTime?Vm(t.found.createTime):op.min(),a=new Jv({mapValue:{fields:t.found.fields}});return ey.newFoundDocument(n,r,i,a)}(e,t):"missing"in t?function(e,t){qd(!!t.missing),qd(!!t.readTime);var n=Wm(e,t.missing),r=Vm(t.readTime);return ey.newNoDocument(n,r)}(e,t):Vd()}function Jm(e,t){var n;if(t instanceof Jy)n={update:$m(e,t.key,t.value)};else if(t instanceof am)n={delete:zm(e,t.key)};else if(t instanceof Zy)n={update:$m(e,t.key,t.data),updateMask:lg(t.fieldMask)};else{if(!(t instanceof om))return Vd();n={verify:zm(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((function(e){return function(e,t){var n=t.transform;if(n instanceof Oy)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ly)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Fy)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof jy)return{fieldPath:t.field.canonicalString(),increment:n.gt};throw Vd()}(0,e)}))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:jm(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Vd()}(e,t.precondition)),n}function Zm(e,t){var n=t.currentDocument?function(e){return void 0!==e.updateTime?Wy.updateTime(Vm(e.updateTime)):void 0!==e.exists?Wy.exists(e.exists):Wy.none()}(t.currentDocument):Wy.none(),r=t.updateTransforms?t.updateTransforms.map((function(t){return function(e,t){var n=null;if("setToServerValue"in t)qd("REQUEST_TIME"===t.setToServerValue),n=new Oy;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new Ly(r)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];n=new Fy(i)}else"increment"in t?n=new jy(e,t.increment):Vd();var a=lp.fromServerFormat(t.fieldPath);return new By(a,n)}(e,t)})):[];if(t.update){t.update.name;var i=Wm(e,t.update.name),a=new Jv({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=function(e){var t=e.fieldPaths||[];return new Xv(t.map((function(e){return lp.fromServerFormat(e)})))}(t.updateMask);return new Zy(i,a,o,n,r)}return new Jy(i,a,n,r)}if(t.delete){var u=Wm(e,t.delete);return new am(u,n)}if(t.verify){var s=Wm(e,t.verify);return new om(s,n)}return Vd()}function eg(e,t){return{documents:[Km(e,t.path)]}}function tg(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=Km(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Km(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length)return cg(Tv.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map((function(e){return function(e){return{field:ug(e.field),direction:ig(e.dir)}}(e)}))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,u=function(e,t){return e.wt||zp(t)?t:{value:t}}(e,t.limit);return null!==u&&(n.structuredQuery.limit=u),t.startAt&&(n.structuredQuery.startAt={before:(o=t.startAt).inclusive,values:o.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function ng(e){var t=Hm(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){qd(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o=[];n.where&&(o=function(e){var t=rg(e);return t instanceof Tv&&Nv(t)?t.getFilters():[t]}(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(e){return function(e){return new zv(sg(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)})));var s=null;n.limit&&(s=function(e){var t;return zp(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c=null;n.startAt&&(c=function(e){var t=!!e.before,n=e.values||[];return new wv(n,t)}(n.startAt));var l=null;return n.endAt&&(l=function(e){var t=!e.before,n=e.values||[];return new wv(n,t)}(n.endAt)),ly(t,i,u,o,s,"F",c,l)}function rg(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":var t=sg(e.unaryFilter.field);return Sv.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=sg(e.unaryFilter.field);return Sv.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=sg(e.unaryFilter.field);return Sv.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=sg(e.unaryFilter.field);return Sv.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Vd()}}(e):void 0!==e.fieldFilter?function(e){return Sv.create(sg(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Vd()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Tv.create(e.compositeFilter.filters.map((function(e){return rg(e)})),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Vd()}}(e.compositeFilter.op))}(e):Vd()}function ig(e){return Dm[e]}function ag(e){return Om[e]}function og(e){return Lm[e]}function ug(e){return{fieldPath:e.canonicalString()}}function sg(e){return lp.fromServerFormat(e.fieldPath)}function cg(e){return e instanceof Sv?function(e){if("=="===e.op){if(dv(e.value))return{unaryFilter:{field:ug(e.field),op:"IS_NAN"}};if(hv(e.value))return{unaryFilter:{field:ug(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(dv(e.value))return{unaryFilter:{field:ug(e.field),op:"IS_NOT_NAN"}};if(hv(e.value))return{unaryFilter:{field:ug(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ug(e.field),op:ag(e.op),value:e.value}}}(e):e instanceof Tv?function(e){var t=e.getFilters().map((function(e){return cg(e)}));return 1===t.length?t[0]:{compositeFilter:{op:og(e.op),filters:t}}}(e):Vd()}function lg(e){var t=[];return e.fields.forEach((function(e){return t.push(e.canonicalString())})),{fieldPaths:t}}function fg(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function hg(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=pg(t)),t=dg(e.get(n),t);return pg(t)}function dg(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var a=e.charAt(i);switch(a){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=a}}return n}function pg(e){return e+"\x01\x01"}function vg(e){var t=e.length;if(qd(t>=2),2===t)return qd("\x01"===e.charAt(0)&&"\x01"===e.charAt(1)),sp.emptyPath();for(var n=t-2,r=[],i="",a=0;a<t;){var o=e.indexOf("\x01",a);switch((o<0||o>n)&&Vd(),e.charAt(o+1)){case"\x01":var u=e.substring(a,o),s=void 0;0===i.length?s=u:(s=i+=u,i=""),r.push(s);break;case"\x10":i+=e.substring(a,o),i+="\0";break;case"\x11":i+=e.substring(a,o+1);break;default:Vd()}a=o+2}return new sp(r)}var yg=["userId","batchId"];function mg(e,t){return[e,hg(t)]}function gg(e,t,n){return[e,hg(t),n]}var kg={},bg=["prefixPath","collectionGroup","readTime","documentId"],wg=["prefixPath","collectionGroup","documentId"],_g=["collectionGroup","readTime","prefixPath","documentId"],xg=["canonicalId","targetId"],Ig=["targetId","path"],Sg=["path","targetId"],Tg=["collectionId","parent"],Eg=["indexId","uid"],Cg=["uid","sequenceNumber"],Ng=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Rg=["indexId","uid","orderedDocumentKey"],Ag=["userId","collectionPath","documentId"],Pg=["userId","collectionPath","largestBatchId"],Dg=["userId","collectionGroup","largestBatchId"],Og=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments"].concat(["clientMetadata"]).concat(["remoteDocumentGlobal"]).concat(["collectionParents"]).concat(["bundles","namedQueries"]),Lg=[].concat(Te(Og),["documentOverlays"]),Mg=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Fg=Mg,Ug=[].concat(Fg,["indexConfiguration","indexState","indexEntries"]),jg=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this)).se=e,i.currentSequenceNumber=r,i}return l(n)}(_p);function Vg(e,t){var n=Bd(e);return Ep.M(n.se,t)}var qg=function(){function e(t,n,r,i){u(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return l(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&Qy(i,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n,r=y(this.baseMutations);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.key.isEqual(e.key)&&(t=$y(i,e,t,this.localWriteTime))}}catch(s){r.e(s)}finally{r.f()}var a,o=y(this.mutations);try{for(o.s();!(a=o.n()).done;){var u=a.value;u.key.isEqual(e.key)&&(t=$y(u,e,t,this.localWriteTime))}}catch(s){o.e(s)}finally{o.f()}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=mm();return this.mutations.forEach((function(i){var a=e.get(i.key),o=a.overlayedDocument,u=n.applyToLocalView(o,a.mutatedFields),s=Gy(o,u=t.has(i.key)?null:u);null!==s&&r.set(i.key,s),o.isValidDocument()||o.convertToNoDocument(op.min())})),r}},{key:"keys",value:function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),wm())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&rp(this.mutations,e.mutations,(function(e,t){return Xy(e,t)}))&&rp(this.baseMutations,e.baseMutations,(function(e,t){return Xy(e,t)}))}}]),e}(),Bg=function(){function e(t,n,r,i){u(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return l(e,null,[{key:"from",value:function(t,n,r){qd(t.mutations.length===r.length);for(var i=km,a=t.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new e(t,n,r,i)}}]),e}(),zg=function(){function e(t,n){u(this,e),this.largestBatchId=t,this.mutation=n}return l(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),Wg=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:op.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:op.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Hp.EMPTY_BYTE_STRING;u(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return l(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}]),e}(),Kg=l((function e(t){u(this,e),this.ie=t}));function Hg(e,t){var n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Gg(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:zm(e,t.key),fields:t.data.value.mapValue.fields,updateTime:Fm(e,t.version.toTimestamp()),createTime:Fm(e,t.createTime.toTimestamp())}}(e.ie,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Qg(t.version)};else{if(!t.isUnknownDocument())return Vd();r.unknownDocument={path:n.path.toArray(),version:Qg(t.version)}}return r}function Gg(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function Qg(e){var t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function $g(e){var t=new ap(e.seconds,e.nanoseconds);return op.fromTimestamp(t)}function Yg(e,t){for(var n=(t.baseMutations||[]).map((function(t){return Zm(e.ie,t)})),r=0;r<t.mutations.length-1;++r){var i=t.mutations[r];if(r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform){var a=t.mutations[r+1];i.updateTransforms=a.transform.fieldTransforms,t.mutations.splice(r+1,1),++r}}var o=t.mutations.map((function(t){return Zm(e.ie,t)})),u=ap.fromMillis(t.localWriteTimeMs);return new qg(t.batchId,u,n,o)}function Xg(e){var t,n,r=$g(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?$g(e.lastLimboFreeSnapshotVersion):op.min();return void 0!==e.query.documents?(qd(1===(n=e.query).documents.length),t=my(fy(Hm(n.documents[0])))):t=function(e){return my(ng(e))}(e.query),new Wg(t,e.targetId,0,e.lastListenSequenceNumber,r,i,Hp.fromBase64String(e.resumeToken))}function Jg(e,t){var n,r=Qg(t.snapshotVersion),i=Qg(t.lastLimboFreeSnapshotVersion);n=ay(t.target)?eg(e.ie,t.target):tg(e.ie,t.target);var a=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:ry(t.target),readTime:r,resumeToken:a,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:n}}function Zg(e){var t=ng({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?ky(t,t.limit,"L"):t}function ek(e,t){return new zg(t.largestBatchId,Zm(e.ie,t.overlayMutation))}function tk(e,t){var n=t.path.lastSegment();return[e,hg(t.path.popLast()),n]}function nk(e,t,n,r){return{indexId:e,uid:t.uid||"",sequenceNumber:n,readTime:Qg(r.readTime),documentKey:hg(r.documentKey.path),largestBatchId:r.largestBatchId}}var rk=function(){function e(){u(this,e)}return l(e,[{key:"getBundleMetadata",value:function(e,t){return ik(e).get(t).next((function(e){if(e)return{id:(t=e).bundleId,createTime:$g(t.createTime),version:t.version};var t}))}},{key:"saveBundleMetadata",value:function(e,t){return ik(e).put({bundleId:(n=t).id,createTime:Qg(Vm(n.createTime)),version:n.version});var n}},{key:"getNamedQuery",value:function(e,t){return ak(e).get(t).next((function(e){if(e)return{name:(t=e).name,query:Zg(t.bundledQuery),readTime:$g(t.readTime)};var t}))}},{key:"saveNamedQuery",value:function(e,t){return ak(e).put(function(e){return{name:e.name,readTime:Qg(Vm(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}]),e}();function ik(e){return Vg(e,"bundles")}function ak(e){return Vg(e,"namedQueries")}var ok=function(){function e(t,n){u(this,e),this.yt=t,this.userId=n}return l(e,[{key:"getOverlay",value:function(e,t){var n=this;return uk(e).get(tk(this.userId,t)).next((function(e){return e?ek(n.yt,e):null}))}},{key:"getOverlays",value:function(e,t){var n=this,r=ym();return Sp.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this,i=[];return n.forEach((function(n,a){var o=new zg(t,a);i.push(r.oe(e,o))})),Sp.waitFor(i)}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=new Set;t.forEach((function(e){return i.add(hg(e.getCollectionPath()))}));var a=[];return i.forEach((function(t){var i=IDBKeyRange.bound([r.userId,t,n],[r.userId,t,n+1],!1,!0);a.push(uk(e).Y("collectionPathOverlayIndex",i))})),Sp.waitFor(a)}},{key:"getOverlaysForCollection",value:function(e,t,n){var r=this,i=ym(),a=hg(t),o=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return uk(e).W("collectionPathOverlayIndex",o).next((function(e){var t,n=y(e);try{for(n.s();!(t=n.n()).done;){var a=t.value,o=ek(r.yt,a);i.set(o.getKey(),o)}}catch(u){n.e(u)}finally{n.f()}return i}))}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){var i,a=this,o=ym(),u=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return uk(e).Z({index:"collectionGroupOverlayIndex",range:u},(function(e,t,n){var u=ek(a.yt,t);o.size()<r||u.largestBatchId===i?(o.set(u.getKey(),u),i=u.largestBatchId):n.done()})).next((function(){return o}))}},{key:"oe",value:function(e,t){return uk(e).put(function(e,t,n){var r=k(tk(t,n.mutation.key),3);r[0];return{userId:t,collectionPath:r[1],documentId:r[2],collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:Jm(e.ie,n.mutation)}}(this.yt,this.userId,t))}}],[{key:"re",value:function(t,n){return new e(t,n.uid||"")}}]),e}();function uk(e){return Vg(e,"documentOverlays")}var sk=function(){function e(){u(this,e)}return l(e,[{key:"ue",value:function(e,t){this.ce(e,t),t.ae()}},{key:"ce",value:function(e,t){if("nullValue"in e)this.he(t,5);else if("booleanValue"in e)this.he(t,10),t.le(e.booleanValue?1:0);else if("integerValue"in e)this.he(t,15),t.le($p(e.integerValue));else if("doubleValue"in e){var n=$p(e.doubleValue);isNaN(n)?this.he(t,13):(this.he(t,15),Wp(n)?t.le(0):t.le(n))}else if("timestampValue"in e){var r=e.timestampValue;this.he(t,20),"string"==typeof r?t.fe(r):(t.fe("".concat(r.seconds||"")),t.le(r.nanos||0))}else if("stringValue"in e)this.de(e.stringValue,t),this._e(t);else if("bytesValue"in e)this.he(t,30),t.we(Yp(e.bytesValue)),this._e(t);else if("referenceValue"in e)this.me(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.he(t,45),t.le(i.latitude||0),t.le(i.longitude||0)}else"mapValue"in e?yv(e)?this.he(t,Number.MAX_SAFE_INTEGER):(this.ge(e.mapValue,t),this._e(t)):"arrayValue"in e?(this.ye(e.arrayValue,t),this._e(t)):Vd()}},{key:"de",value:function(e,t){this.he(t,25),this.pe(e,t)}},{key:"pe",value:function(e,t){t.fe(e)}},{key:"ge",value:function(e,t){var n=e.fields||{};this.he(t,55);for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r];this.de(a,t),this.ce(n[a],t)}}},{key:"ye",value:function(e,t){var n=e.values||[];this.he(t,50);var r,i=y(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.ce(a,t)}}catch(o){i.e(o)}finally{i.f()}}},{key:"me",value:function(e,t){var n=this;this.he(t,37),fp.fromName(e).path.forEach((function(e){n.he(t,60),n.pe(e,t)}))}},{key:"he",value:function(e,t){e.le(t)}},{key:"_e",value:function(e){e.le(2)}}]),e}();function ck(e){if(0===e)return 8;var t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function lk(e){var t=64-function(e){for(var t=0,n=0;n<8;++n){var r=ck(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}sk.Ie=new sk;var fk=function(){function e(){u(this,e),this.buffer=new Uint8Array(1024),this.position=0}return l(e,[{key:"Te",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.Ee(n.value),n=t.next();this.Ae()}},{key:"Re",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.be(n.value),n=t.next();this.Pe()}},{key:"ve",value:function(e){var t,n=y(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.charCodeAt(0);if(i<128)this.Ee(i);else if(i<2048)this.Ee(960|i>>>6),this.Ee(128|63&i);else if(r<"\ud800"||"\udbff"<r)this.Ee(480|i>>>12),this.Ee(128|63&i>>>6),this.Ee(128|63&i);else{var a=r.codePointAt(0);this.Ee(240|a>>>18),this.Ee(128|63&a>>>12),this.Ee(128|63&a>>>6),this.Ee(128|63&a)}}}catch(o){n.e(o)}finally{n.f()}this.Ae()}},{key:"Ve",value:function(e){var t,n=y(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.charCodeAt(0);if(i<128)this.be(i);else if(i<2048)this.be(960|i>>>6),this.be(128|63&i);else if(r<"\ud800"||"\udbff"<r)this.be(480|i>>>12),this.be(128|63&i>>>6),this.be(128|63&i);else{var a=r.codePointAt(0);this.be(240|a>>>18),this.be(128|63&a>>>12),this.be(128|63&a>>>6),this.be(128|63&a)}}}catch(o){n.e(o)}finally{n.f()}this.Pe()}},{key:"Se",value:function(e){var t=this.De(e),n=lk(t);this.Ce(1+n),this.buffer[this.position++]=255&n;for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}},{key:"xe",value:function(e){var t=this.De(e),n=lk(t);this.Ce(1+n),this.buffer[this.position++]=~(255&n);for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}},{key:"Ne",value:function(){this.ke(255),this.ke(255)}},{key:"Oe",value:function(){this.Me(255),this.Me(255)}},{key:"reset",value:function(){this.position=0}},{key:"seed",value:function(e){this.Ce(e.length),this.buffer.set(e,this.position),this.position+=e.length}},{key:"Fe",value:function(){return this.buffer.slice(0,this.position)}},{key:"De",value:function(e){var t=function(e){var t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(var r=1;r<t.length;++r)t[r]^=n?255:0;return t}},{key:"Ee",value:function(e){var t=255&e;0===t?(this.ke(0),this.ke(255)):255===t?(this.ke(255),this.ke(0)):this.ke(t)}},{key:"be",value:function(e){var t=255&e;0===t?(this.Me(0),this.Me(255)):255===t?(this.Me(255),this.Me(0)):this.Me(e)}},{key:"Ae",value:function(){this.ke(0),this.ke(1)}},{key:"Pe",value:function(){this.Me(0),this.Me(1)}},{key:"ke",value:function(e){this.Ce(1),this.buffer[this.position++]=e}},{key:"Me",value:function(e){this.Ce(1),this.buffer[this.position++]=~e}},{key:"Ce",value:function(e){var t=e+this.position;if(!(t<=this.buffer.length)){var n=2*this.buffer.length;n<t&&(n=t);var r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}}]),e}(),hk=function(){function e(t){u(this,e),this.$e=t}return l(e,[{key:"we",value:function(e){this.$e.Te(e)}},{key:"fe",value:function(e){this.$e.ve(e)}},{key:"le",value:function(e){this.$e.Se(e)}},{key:"ae",value:function(){this.$e.Ne()}}]),e}(),dk=function(){function e(t){u(this,e),this.$e=t}return l(e,[{key:"we",value:function(e){this.$e.Re(e)}},{key:"fe",value:function(e){this.$e.Ve(e)}},{key:"le",value:function(e){this.$e.xe(e)}},{key:"ae",value:function(){this.$e.Oe()}}]),e}(),pk=function(){function e(){u(this,e),this.$e=new fk,this.Be=new hk(this.$e),this.Le=new dk(this.$e)}return l(e,[{key:"seed",value:function(e){this.$e.seed(e)}},{key:"qe",value:function(e){return 0===e?this.Be:this.Le}},{key:"Fe",value:function(){return this.$e.Fe()}},{key:"reset",value:function(){this.$e.reset()}}]),e}(),vk=function(){function e(t,n,r,i){u(this,e),this.indexId=t,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}return l(e,[{key:"Ue",value:function(){var t=this.directionalValue.length,n=0===t||255===this.directionalValue[t-1]?t+1:t,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==t?r.set([0],this.directionalValue.length):++r[r.length-1],new e(this.indexId,this.documentKey,this.arrayValue,r)}}]),e}();function yk(e,t){var n=e.indexId-t.indexId;return 0!==n?n:0!==(n=mk(e.arrayValue,t.arrayValue))?n:0!==(n=mk(e.directionalValue,t.directionalValue))?n:fp.comparator(e.documentKey,t.documentKey)}function mk(e,t){for(var n=0;n<e.length&&n<t.length;++n){var r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}var gk=function(){function e(t){u(this,e),this.collectionId=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment(),this.Ke=t.orderBy,this.Ge=[];var n,r=y(t.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.isInequality()?this.Qe=i:this.Ge.push(i)}}catch(a){r.e(a)}finally{r.f()}}return l(e,[{key:"je",value:function(e){qd(e.collectionGroup===this.collectionId);var t=dp(e);if(void 0!==t&&!this.We(t))return!1;for(var n=pp(e),r=0,i=0;r<n.length&&this.We(n[r]);++r);if(r===n.length)return!0;if(void 0!==this.Qe){var a=n[r];if(!this.ze(this.Qe,a)||!this.He(this.Ke[i++],a))return!1;++r}for(;r<n.length;++r){var o=n[r];if(i>=this.Ke.length||!this.He(this.Ke[i++],o))return!1}return!0}},{key:"We",value:function(e){var t,n=y(this.Ge);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.ze(r,e))return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"ze",value:function(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;var n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}},{key:"He",value:function(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}]),e}();function kk(e){var t,n;if(qd(e instanceof Sv||e instanceof Tv),e instanceof Sv){if(e instanceof Vv){var r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((function(t){return Sv.create(e.field,"==",t)})))||[];return Tv.create(r,"or")}return e}var i=e.filters.map((function(e){return kk(e)}));return Tv.create(i,e.op)}function bk(e){if(0===e.getFilters().length)return[];var t=Ik(kk(e));return qd(xk(t)),wk(t)||_k(t)?[t]:t.getFilters()}function wk(e){return e instanceof Sv}function _k(e){return e instanceof Tv&&Nv(e)}function xk(e){return wk(e)||_k(e)||function(e){if(e instanceof Tv&&Cv(e)){var t,n=y(e.getFilters());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!wk(r)&&!_k(r))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}return!1}(e)}function Ik(e){if(qd(e instanceof Sv||e instanceof Tv),e instanceof Sv)return e;if(1===e.filters.length)return Ik(e.filters[0]);var t=e.filters.map((function(e){return Ik(e)})),n=Tv.create(t,e.op);return xk(n=Ek(n))?n:(qd(n instanceof Tv),qd(Ev(n)),qd(n.filters.length>1),n.filters.reduce((function(e,t){return Sk(e,t)})))}function Sk(e,t){var n;return qd(e instanceof Sv||e instanceof Tv),qd(t instanceof Sv||t instanceof Tv),n=e instanceof Sv?t instanceof Sv?function(e,t){return Tv.create([e,t],"and")}(e,t):Tk(e,t):t instanceof Sv?Tk(t,e):function(e,t){if(qd(e.filters.length>0&&t.filters.length>0),Ev(e)&&Ev(t))return Dv(e,t.getFilters());var n=Cv(e)?e:t,r=Cv(e)?t:e,i=n.filters.map((function(e){return Sk(e,r)}));return Tv.create(i,"or")}(e,t),Ek(n)}function Tk(e,t){if(Ev(t))return Dv(t,e.getFilters());var n=t.filters.map((function(t){return Sk(e,t)}));return Tv.create(n,"or")}function Ek(e){if(qd(e instanceof Sv||e instanceof Tv),e instanceof Sv)return e;var t=e.getFilters();if(1===t.length)return Ek(t[0]);if(Rv(e))return e;var n=t.map((function(e){return Ek(e)})),r=[];return n.forEach((function(t){t instanceof Sv?r.push(t):t instanceof Tv&&(t.op===e.op?r.push.apply(r,Te(t.filters)):r.push(t))})),1===r.length?r[0]:Tv.create(r,e.op)}var Ck=function(){function e(){u(this,e),this.Je=new Nk}return l(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.Je.add(t),Sp.resolve()}},{key:"getCollectionParents",value:function(e,t){return Sp.resolve(this.Je.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return Sp.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return Sp.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return Sp.resolve(null)}},{key:"getIndexType",value:function(e,t){return Sp.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return Sp.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return Sp.resolve(null)}},{key:"getMinOffset",value:function(e,t){return Sp.resolve(kp.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return Sp.resolve(kp.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return Sp.resolve()}},{key:"updateIndexEntries",value:function(e,t){return Sp.resolve()}}]),e}(),Nk=function(){function e(){u(this,e),this.index={}}return l(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Qv(sp.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new Qv(sp.comparator)).toArray()}}]),e}(),Rk=new Uint8Array(0),Ak=function(){function e(t,n){u(this,e),this.user=t,this.databaseId=n,this.Ye=new Nk,this.Xe=new lm((function(e){return ry(e)}),(function(e,t){return iy(e,t)})),this.uid=t.uid||""}return l(e,[{key:"addToCollectionParentIndex",value:function(e,t){var n=this;if(!this.Ye.has(t)){var r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((function(){n.Ye.add(t)}));var a={collectionId:r,parent:hg(i)};return Pk(e).put(a)}return Sp.resolve()}},{key:"getCollectionParents",value:function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[ip(t),""],!1,!0);return Pk(e).W(r).next((function(e){var r,i=y(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.collectionId!==t)break;n.push(vg(a.parent))}}catch(o){i.e(o)}finally{i.f()}return n}))}},{key:"addFieldIndex",value:function(e,t){var n=this,r=Ok(e),i=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((function(e){return[e.fieldPath.canonicalString(),e.kind]}))}}(t);delete i.indexId;var a=r.add(i);if(t.indexState){var o=Lk(e);return a.next((function(e){o.put(nk(e,n.user,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}},{key:"deleteFieldIndex",value:function(e,t){var n=Ok(e),r=Lk(e),i=Dk(e);return n.delete(t.indexId).next((function(){return r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))})).next((function(){return i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))}))}},{key:"getDocumentsMatchingTarget",value:function(e,t){var n=this,r=Dk(e),i=!0,a=new Map;return Sp.forEach(this.Ze(t),(function(t){return n.tn(e,t).next((function(e){i&&(i=!!e),a.set(t,e)}))})).next((function(){if(i){var e=wm(),o=[];return Sp.forEach(a,(function(i,a){var u;Md("IndexedDbIndexManager","Using index ".concat((u=i,"id=".concat(u.indexId,"|cg=").concat(u.collectionGroup,"|f=").concat(u.fields.map((function(e){return"".concat(e.fieldPath,":").concat(e.kind)})).join(",")))," to execute ").concat(ry(t)));var s=function(e,t){var n=dp(t);if(void 0===n)return null;var r,i=y(oy(e,n.fieldPath));try{for(i.s();!(r=i.n()).done;){var a=r.value;switch(a.op){case"array-contains-any":return a.value.arrayValue.values||[];case"array-contains":return[a.value]}}}catch(o){i.e(o)}finally{i.f()}return null}(a,i),c=function(e,t){var n,r=new Map,i=y(pp(t));try{for(i.s();!(n=i.n()).done;){var a,o=n.value,u=y(oy(e,o.fieldPath));try{for(u.s();!(a=u.n()).done;){var s=a.value;switch(s.op){case"==":case"in":r.set(o.fieldPath.canonicalString(),s.value);break;case"not-in":case"!=":return r.set(o.fieldPath.canonicalString(),s.value),Array.from(r.values())}}}catch(c){u.e(c)}finally{u.f()}}}catch(c){i.e(c)}finally{i.f()}return null}(a,i),l=function(e,t){var n,r=[],i=!0,a=y(pp(t));try{for(a.s();!(n=a.n()).done;){var o=n.value,u=0===o.kind?uy(e,o.fieldPath,e.startAt):sy(e,o.fieldPath,e.startAt);r.push(u.value),i&&(i=u.inclusive)}}catch(s){a.e(s)}finally{a.f()}return new wv(r,i)}(a,i),f=function(e,t){var n,r=[],i=!0,a=y(pp(t));try{for(a.s();!(n=a.n()).done;){var o=n.value,u=0===o.kind?sy(e,o.fieldPath,e.endAt):uy(e,o.fieldPath,e.endAt);r.push(u.value),i&&(i=u.inclusive)}}catch(s){a.e(s)}finally{a.f()}return new wv(r,i)}(a,i),h=n.en(i,a,l),d=n.en(i,a,f),p=n.nn(i,a,c),v=n.sn(i.indexId,s,h,l.inclusive,d,f.inclusive,p);return Sp.forEach(v,(function(n){return r.J(n,t.limit).next((function(t){t.forEach((function(t){var n=fp.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),o.push(n))}))}))}))})).next((function(){return o}))}return Sp.resolve(null)}))}},{key:"Ze",value:function(e){var t=this.Xe.get(e);return t||(t=0===e.filters.length?[e]:bk(Tv.create(e.filters,"and")).map((function(t){return ny(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)})),this.Xe.set(e,t),t)}},{key:"sn",value:function(e,t,n,r,i,a,o){for(var u=this,s=(null!=t?t.length:1)*Math.max(n.length,i.length),c=s/(null!=t?t.length:1),l=[],f=function(){var s=t?u.rn(t[h/c]):Rk,f=u.on(e,s,n[h%c],r),d=u.un(e,s,i[h%c],a),p=o.map((function(t){return u.on(e,s,t,!0)}));l.push.apply(l,Te(u.createRange(f,d,p)))},h=0;h<s;++h)f();return l}},{key:"on",value:function(e,t,n,r){var i=new vk(e,fp.empty(),t,n);return r?i:i.Ue()}},{key:"un",value:function(e,t,n,r){var i=new vk(e,fp.empty(),t,n);return r?i.Ue():i}},{key:"tn",value:function(e,t){var n=new gk(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((function(e){var t,r=null,i=y(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;n.je(a)&&(!r||a.fields.length>r.fields.length)&&(r=a)}}catch(o){i.e(o)}finally{i.f()}return r}))}},{key:"getIndexType",value:function(e,t){var n=this,r=2,i=this.Ze(t);return Sp.forEach(i,(function(t){return n.tn(e,t).next((function(e){e?0!==r&&e.fields.length<function(e){var t,n=new Qv(lp.comparator),r=!1,i=y(e.filters);try{for(i.s();!(t=i.n()).done;){var a,o=y(t.value.getFlattenedFilters());try{for(o.s();!(a=o.n()).done;){var u=a.value;u.field.isKeyField()||("array-contains"===u.op||"array-contains-any"===u.op?r=!0:n=n.add(u.field))}}catch(f){o.e(f)}finally{o.f()}}}catch(f){i.e(f)}finally{i.f()}var s,c=y(e.orderBy);try{for(c.s();!(s=c.n()).done;){var l=s.value;l.field.isKeyField()||(n=n.add(l.field))}}catch(f){c.e(f)}finally{c.f()}return n.size+(r?1:0)}(t)&&(r=1):r=0}))})).next((function(){return function(e){return null!==e.limit}(t)&&i.length>1&&2===r?1:r}))}},{key:"cn",value:function(e,t){var n,r=new pk,i=y(pp(e));try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.fieldPath);if(null==o)return null;var u=r.qe(a.kind);sk.Ie.ue(o,u)}}catch(s){i.e(s)}finally{i.f()}return r.Fe()}},{key:"rn",value:function(e){var t=new pk;return sk.Ie.ue(e,t.qe(0)),t.Fe()}},{key:"an",value:function(e,t){var n=new pk;return sk.Ie.ue(cv(this.databaseId,t),n.qe(function(e){var t=pp(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Fe()}},{key:"nn",value:function(e,t,n){if(null===n)return[];var r=[];r.push(new pk);var i,a=0,o=y(pp(e));try{for(o.s();!(i=o.n()).done;){var u,s=i.value,c=n[a++],l=y(r);try{for(l.s();!(u=l.n()).done;){var f=u.value;if(this.hn(t,s.fieldPath)&&fv(c))r=this.ln(r,s,c);else{var h=f.qe(s.kind);sk.Ie.ue(c,h)}}}catch(d){l.e(d)}finally{l.f()}}}catch(d){o.e(d)}finally{o.f()}return this.fn(r)}},{key:"en",value:function(e,t,n){return this.nn(e,t,n.position)}},{key:"fn",value:function(e){for(var t=[],n=0;n<e.length;++n)t[n]=e[n].Fe();return t}},{key:"ln",value:function(e,t,n){var r,i=Te(e),a=[],o=y(n.arrayValue.values||[]);try{for(o.s();!(r=o.n()).done;){var u,s=r.value,c=y(i);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=new pk;f.seed(l.Fe()),sk.Ie.ue(s,f.qe(t.kind)),a.push(f)}}catch(h){c.e(h)}finally{c.f()}}}catch(h){o.e(h)}finally{o.f()}return a}},{key:"hn",value:function(e,t){return!!e.filters.find((function(e){return e instanceof Sv&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)}))}},{key:"getFieldIndexes",value:function(e,t){var n=this,r=Ok(e),i=Lk(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next((function(e){var t=[];return Sp.forEach(e,(function(e){return i.get([e.indexId,n.uid]).next((function(n){t.push(function(e,t){var n=t?new yp(t.sequenceNumber,new kp($g(t.readTime),new fp(vg(t.documentKey)),t.largestBatchId)):yp.empty(),r=e.fields.map((function(e){var t=k(e,2),n=t[0],r=t[1];return new vp(lp.fromServerFormat(n),r)}));return new hp(e.indexId,e.collectionGroup,r,n)}(e,n))}))})).next((function(){return t}))}))}},{key:"getNextCollectionGroupToUpdate",value:function(e){return this.getFieldIndexes(e).next((function(e){return 0===e.length?null:(e.sort((function(e,t){var n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:np(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)}))}},{key:"updateCollectionGroup",value:function(e,t,n){var r=this,i=Ok(e),a=Lk(e);return this.dn(e).next((function(e){return i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((function(t){return Sp.forEach(t,(function(t){return a.put(nk(t.indexId,r.user,e,n))}))}))}))}},{key:"updateIndexEntries",value:function(e,t){var n=this,r=new Map;return Sp.forEach(t,(function(t,i){var a=r.get(t.collectionGroup);return(a?Sp.resolve(a):n.getFieldIndexes(e,t.collectionGroup)).next((function(a){return r.set(t.collectionGroup,a),Sp.forEach(a,(function(r){return n._n(e,t,r).next((function(t){var a=n.wn(i,r);return t.isEqual(a)?Sp.resolve():n.mn(e,i,r,t,a)}))}))}))}))}},{key:"gn",value:function(e,t,n,r){return Dk(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.an(n,t.key),documentKey:t.key.path.toArray()})}},{key:"yn",value:function(e,t,n,r){return Dk(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.an(n,t.key),t.key.path.toArray()])}},{key:"_n",value:function(e,t,n){var r=Dk(e),i=new Qv(yk);return r.Z({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.an(n,t)])},(function(e,r){i=i.add(new vk(n.indexId,t,r.arrayValue,r.directionalValue))})).next((function(){return i}))}},{key:"wn",value:function(e,t){var n=new Qv(yk),r=this.cn(t,e);if(null==r)return n;var i=dp(t);if(null!=i){var a=e.data.field(i.fieldPath);if(fv(a)){var o,u=y(a.arrayValue.values||[]);try{for(u.s();!(o=u.n()).done;){var s=o.value;n=n.add(new vk(t.indexId,e.key,this.rn(s),r))}}catch(c){u.e(c)}finally{u.f()}}}else n=n.add(new vk(t.indexId,e.key,Rk,r));return n}},{key:"mn",value:function(e,t,n,r,i){var a=this;Md("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);var o=[];return function(e,t,n,r,i){for(var a=e.getIterator(),o=t.getIterator(),u=Yv(a),s=Yv(o);u||s;){var c=!1,l=!1;if(u&&s){var f=n(u,s);f<0?l=!0:f>0&&(c=!0)}else null!=u?l=!0:c=!0;c?(r(s),s=Yv(o)):l?(i(u),u=Yv(a)):(u=Yv(a),s=Yv(o))}}(r,i,yk,(function(r){o.push(a.gn(e,t,n,r))}),(function(r){o.push(a.yn(e,t,n,r))})),Sp.waitFor(o)}},{key:"dn",value:function(e){var t=1;return Lk(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(function(e,n,r){r.done(),t=n.sequenceNumber+1})).next((function(){return t}))}},{key:"createRange",value:function(e,t,n){n=n.sort((function(e,t){return yk(e,t)})).filter((function(e,t,n){return!t||0!==yk(e,n[t-1])}));var r=[];r.push(e);var i,a=y(n);try{for(a.s();!(i=a.n()).done;){var o=i.value,u=yk(o,e),s=yk(o,t);if(0===u)r[0]=e.Ue();else if(u>0&&s<0)r.push(o),r.push(o.Ue());else if(s>0)break}}catch(d){a.e(d)}finally{a.f()}r.push(t);for(var c=[],l=0;l<r.length;l+=2){if(this.pn(r[l],r[l+1]))return[];var f=[r[l].indexId,this.uid,r[l].arrayValue,r[l].directionalValue,Rk,[]],h=[r[l+1].indexId,this.uid,r[l+1].arrayValue,r[l+1].directionalValue,Rk,[]];c.push(IDBKeyRange.bound(f,h))}return c}},{key:"pn",value:function(e,t){return yk(e,t)>0}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return this.getFieldIndexes(e,t).next(Mk)}},{key:"getMinOffset",value:function(e,t){var n=this;return Sp.mapArray(this.Ze(t),(function(t){return n.tn(e,t).next((function(e){return e||Vd()}))})).next(Mk)}}]),e}();function Pk(e){return Vg(e,"collectionParents")}function Dk(e){return Vg(e,"indexEntries")}function Ok(e){return Vg(e,"indexConfiguration")}function Lk(e){return Vg(e,"indexState")}function Mk(e){qd(0!==e.length);for(var t=e[0].indexState.offset,n=t.largestBatchId,r=1;r<e.length;r++){var i=e[r].indexState.offset;bp(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new kp(t.readTime,t.documentKey,n)}var Fk={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Uk=function(){function e(t,n,r){u(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return l(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();function jk(e,t,n){var r=e.store("mutations"),i=e.store("documentMutations"),a=[],o=IDBKeyRange.only(n.batchId),u=0,s=r.Z({range:o},(function(e,t,n){return u++,n.delete()}));a.push(s.next((function(){qd(1===u)})));var c,l=[],f=y(n.mutations);try{for(f.s();!(c=f.n()).done;){var h=c.value,d=gg(t,h.key.path,n.batchId);a.push(i.delete(d)),l.push(h.key)}}catch(p){f.e(p)}finally{f.f()}return Sp.waitFor(a).next((function(){return l}))}function Vk(e){if(!e)return 0;var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw Vd();t=e.noDocument}return JSON.stringify(t).length}Uk.DEFAULT_COLLECTION_PERCENTILE=10,Uk.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Uk.DEFAULT=new Uk(41943040,Uk.DEFAULT_COLLECTION_PERCENTILE,Uk.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Uk.DISABLED=new Uk(-1,0,0);var qk=function(){function e(t,n,r,i){u(this,e),this.userId=t,this.yt=n,this.indexManager=r,this.referenceDelegate=i,this.In={}}return l(e,[{key:"checkEmpty",value:function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return zk(e).Z({index:"userMutationsIndex",range:n},(function(e,n,r){t=!1,r.done()})).next((function(){return t}))}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this,a=Wk(e),o=zk(e);return o.add({}).next((function(u){qd("number"==typeof u);var s,c=new qg(u,t,n,r),l=function(e,t,n){var r=n.baseMutations.map((function(t){return Jm(e.ie,t)})),i=n.mutations.map((function(t){return Jm(e.ie,t)}));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(i.yt,i.userId,c),f=[],h=new Qv((function(e,t){return np(e.canonicalString(),t.canonicalString())})),d=y(r);try{for(d.s();!(s=d.n()).done;){var p=s.value,v=gg(i.userId,p.key.path,u);h=h.add(p.key.path.popLast()),f.push(o.put(l)),f.push(a.put(v,kg))}}catch(m){d.e(m)}finally{d.f()}return h.forEach((function(t){f.push(i.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((function(){i.In[u]=c.keys()})),Sp.waitFor(f).next((function(){return c}))}))}},{key:"lookupMutationBatch",value:function(e,t){var n=this;return zk(e).get(t).next((function(e){return e?(qd(e.userId===n.userId),Yg(n.yt,e)):null}))}},{key:"Tn",value:function(e,t){var n=this;return this.In[t]?Sp.resolve(this.In[t]):this.lookupMutationBatch(e,t).next((function(e){if(e){var r=e.keys();return n.In[t]=r,r}return null}))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),a=null;return zk(e).Z({index:"userMutationsIndex",range:i},(function(e,t,i){t.userId===n.userId&&(qd(t.batchId>=r),a=Yg(n.yt,t)),i.done()})).next((function(){return a}))}},{key:"getHighestUnacknowledgedBatchId",value:function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return zk(e).Z({index:"userMutationsIndex",range:t,reverse:!0},(function(e,t,r){n=t.batchId,r.done()})).next((function(){return n}))}},{key:"getAllMutationBatches",value:function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return zk(e).W("userMutationsIndex",n).next((function(e){return e.map((function(e){return Yg(t.yt,e)}))}))}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=mg(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return Wk(e).Z({range:i},(function(r,i,o){var u=k(r,3),s=u[0],c=u[1],l=u[2],f=vg(c);if(s===n.userId&&t.path.isEqual(f))return zk(e).get(l).next((function(e){if(!e)throw Vd();qd(e.userId===n.userId),a.push(Yg(n.yt,e))}));o.done()})).next((function(){return a}))}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new Qv(np),i=[];return t.forEach((function(t){var a=mg(n.userId,t.path),o=IDBKeyRange.lowerBound(a),u=Wk(e).Z({range:o},(function(e,i,a){var o=k(e,3),u=o[0],s=o[1],c=o[2],l=vg(s);u===n.userId&&t.path.isEqual(l)?r=r.add(c):a.done()}));i.push(u)})),Sp.waitFor(i).next((function(){return n.En(e,r)}))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=this,r=t.path,i=r.length+1,a=mg(this.userId,r),o=IDBKeyRange.lowerBound(a),u=new Qv(np);return Wk(e).Z({range:o},(function(e,t,a){var o=k(e,3),s=o[0],c=o[1],l=o[2],f=vg(c);s===n.userId&&r.isPrefixOf(f)?f.length===i&&(u=u.add(l)):a.done()})).next((function(){return n.En(e,u)}))}},{key:"En",value:function(e,t){var n=this,r=[],i=[];return t.forEach((function(t){i.push(zk(e).get(t).next((function(e){if(null===e)throw Vd();qd(e.userId===n.userId),r.push(Yg(n.yt,e))})))})),Sp.waitFor(i).next((function(){return r}))}},{key:"removeMutationBatch",value:function(e,t){var n=this;return jk(e.se,this.userId,t).next((function(r){return e.addOnCommittedListener((function(){n.An(t.batchId)})),Sp.forEach(r,(function(t){return n.referenceDelegate.markPotentiallyOrphaned(e,t)}))}))}},{key:"An",value:function(e){delete this.In[e]}},{key:"performConsistencyCheck",value:function(e){var t=this;return this.checkEmpty(e).next((function(n){if(!n)return Sp.resolve();var r=IDBKeyRange.lowerBound([t.userId]),i=[];return Wk(e).Z({range:r},(function(e,n,r){if(e[0]===t.userId){var a=vg(e[1]);i.push(a)}else r.done()})).next((function(){qd(0===i.length)}))}))}},{key:"containsKey",value:function(e,t){return Bk(e,this.userId,t)}},{key:"Rn",value:function(e){var t=this;return Kk(e).get(this.userId).next((function(e){return e||{userId:t.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}}))}}],[{key:"re",value:function(t,n,r,i){return qd(""!==t.uid),new e(t.isAuthenticated()?t.uid:"",n,r,i)}}]),e}();function Bk(e,t,n){var r=mg(t,n.path),i=r[1],a=IDBKeyRange.lowerBound(r),o=!1;return Wk(e).Z({range:a,X:!0},(function(e,n,r){var a=k(e,3),u=a[0],s=a[1];a[2];u===t&&s===i&&(o=!0),r.done()})).next((function(){return o}))}function zk(e){return Vg(e,"mutations")}function Wk(e){return Vg(e,"documentMutations")}function Kk(e){return Vg(e,"mutationQueues")}var Hk=function(){function e(t){u(this,e),this.bn=t}return l(e,[{key:"next",value:function(){return this.bn+=2,this.bn}}],[{key:"Pn",value:function(){return new e(0)}},{key:"vn",value:function(){return new e(-1)}}]),e}(),Gk=function(){function e(t,n){u(this,e),this.referenceDelegate=t,this.yt=n}return l(e,[{key:"allocateTargetId",value:function(e){var t=this;return this.Vn(e).next((function(n){var r=new Hk(n.highestTargetId);return n.highestTargetId=r.next(),t.Sn(e,n).next((function(){return n.highestTargetId}))}))}},{key:"getLastRemoteSnapshotVersion",value:function(e){return this.Vn(e).next((function(e){return op.fromTimestamp(new ap(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))}))}},{key:"getHighestSequenceNumber",value:function(e){return this.Vn(e).next((function(e){return e.highestListenSequenceNumber}))}},{key:"setTargetsMetadata",value:function(e,t,n){var r=this;return this.Vn(e).next((function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.Sn(e,i)}))}},{key:"addTargetData",value:function(e,t){var n=this;return this.Dn(e,t).next((function(){return n.Vn(e).next((function(r){return r.targetCount+=1,n.Cn(t,r),n.Sn(e,r)}))}))}},{key:"updateTargetData",value:function(e,t){return this.Dn(e,t)}},{key:"removeTargetData",value:function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next((function(){return Qk(e).delete(t.targetId)})).next((function(){return n.Vn(e)})).next((function(t){return qd(t.targetCount>0),t.targetCount-=1,n.Sn(e,t)}))}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return Qk(e).Z((function(o,u){var s=Xg(u);s.sequenceNumber<=t&&null===n.get(s.targetId)&&(i++,a.push(r.removeTargetData(e,s)))})).next((function(){return Sp.waitFor(a)})).next((function(){return i}))}},{key:"forEachTarget",value:function(e,t){return Qk(e).Z((function(e,n){var r=Xg(n);t(r)}))}},{key:"Vn",value:function(e){return $k(e).get("targetGlobalKey").next((function(e){return qd(null!==e),e}))}},{key:"Sn",value:function(e,t){return $k(e).put("targetGlobalKey",t)}},{key:"Dn",value:function(e,t){return Qk(e).put(Jg(this.yt,t))}},{key:"Cn",value:function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}},{key:"getTargetCount",value:function(e){return this.Vn(e).next((function(e){return e.targetCount}))}},{key:"getTargetData",value:function(e,t){var n=ry(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Qk(e).Z({range:r,index:"queryTargetsIndex"},(function(e,n,r){var a=Xg(n);iy(t,a.target)&&(i=a,r.done())})).next((function(){return i}))}},{key:"addMatchingKeys",value:function(e,t,n){var r=this,i=[],a=Yk(e);return t.forEach((function(t){var o=hg(t.path);i.push(a.put({targetId:n,path:o})),i.push(r.referenceDelegate.addReference(e,n,t))})),Sp.waitFor(i)}},{key:"removeMatchingKeys",value:function(e,t,n){var r=this,i=Yk(e);return Sp.forEach(t,(function(t){var a=hg(t.path);return Sp.waitFor([i.delete([n,a]),r.referenceDelegate.removeReference(e,n,t)])}))}},{key:"removeMatchingKeysForTargetId",value:function(e,t){var n=Yk(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=Yk(e),i=wm();return r.Z({range:n,X:!0},(function(e,t,n){var r=vg(e[1]),a=new fp(r);i=i.add(a)})).next((function(){return i}))}},{key:"containsKey",value:function(e,t){var n=hg(t.path),r=IDBKeyRange.bound([n],[ip(n)],!1,!0),i=0;return Yk(e).Z({index:"documentTargetsIndex",X:!0,range:r},(function(e,t,n){var r=k(e,2),a=r[0];r[1];0!==a&&(i++,n.done())})).next((function(){return i>0}))}},{key:"ne",value:function(e,t){return Qk(e).get(t).next((function(e){return e?Xg(e):null}))}}]),e}();function Qk(e){return Vg(e,"targets")}function $k(e){return Vg(e,"targetGlobal")}function Yk(e){return Vg(e,"targetDocuments")}function Xk(e,t){var n=k(e,2),r=n[0],i=n[1],a=k(t,2),o=a[0],u=a[1],s=np(r,o);return 0===s?np(i,u):s}var Jk=function(){function e(t){u(this,e),this.xn=t,this.buffer=new Qv(Xk),this.Nn=0}return l(e,[{key:"kn",value:function(){return++this.Nn}},{key:"On",value:function(e){var t=[e,this.kn()];if(this.buffer.size<this.xn)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();Xk(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}},{key:"maxValue",get:function(){return this.buffer.last()[0]}}]),e}(),Zk=function(){function e(t,n,r){u(this,e),this.garbageCollector=t,this.asyncQueue=n,this.localStore=r,this.Mn=null}return l(e,[{key:"start",value:function(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Fn(6e4)}},{key:"stop",value:function(){this.Mn&&(this.Mn.cancel(),this.Mn=null)}},{key:"started",get:function(){return null!==this.Mn}},{key:"Fn",value:function(e){var t=this;Md("LruGarbageCollector","Garbage collection scheduled in ".concat(e,"ms")),this.Mn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.Mn=null,e.prev=1,e.next=4,t.localStore.collectGarbage(t.garbageCollector);case 4:e.next=14;break;case 6:if(e.prev=6,e.t0=e.catch(1),!Rp(e.t0)){e.next=12;break}Md("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e.t0),e.next=14;break;case 12:return e.next=14,xp(e.t0);case 14:return e.next=16,t.Fn(3e5);case 16:case"end":return e.stop()}}),e,null,[[1,6]])}))))}}]),e}(),eb=function(){function e(t,n){u(this,e),this.$n=t,this.params=n}return l(e,[{key:"calculateTargetCount",value:function(e,t){return this.$n.Bn(e).next((function(e){return Math.floor(t/100*e)}))}},{key:"nthSequenceNumber",value:function(e,t){var n=this;if(0===t)return Sp.resolve(Fp.at);var r=new Jk(t);return this.$n.forEachTarget(e,(function(e){return r.On(e.sequenceNumber)})).next((function(){return n.$n.Ln(e,(function(e){return r.On(e)}))})).next((function(){return r.maxValue}))}},{key:"removeTargets",value:function(e,t,n){return this.$n.removeTargets(e,t,n)}},{key:"removeOrphanedDocuments",value:function(e,t){return this.$n.removeOrphanedDocuments(e,t)}},{key:"collect",value:function(e,t){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Md("LruGarbageCollector","Garbage collection skipped; disabled"),Sp.resolve(Fk)):this.getCacheSize(e).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Md("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(r," is lower than threshold ").concat(n.params.cacheSizeCollectionThreshold)),Fk):n.qn(e,t)}))}},{key:"getCacheSize",value:function(e){return this.$n.getCacheSize(e)}},{key:"qn",value:function(e,t){var n,r,i,a,o,u,s,c=this,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((function(t){return t>c.params.maximumSequenceNumbersToCollect?(Md("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(c.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=c.params.maximumSequenceNumbersToCollect):r=t,a=Date.now(),c.nthSequenceNumber(e,r)})).next((function(r){return n=r,o=Date.now(),c.removeTargets(e,n,t)})).next((function(t){return i=t,u=Date.now(),c.removeOrphanedDocuments(e,n)})).next((function(e){return s=Date.now(),Ld()<=Ae.DEBUG&&Md("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(a-l,"ms\n\tDetermined least recently used ").concat(r," in ")+(o-a)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(u-o)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(s-u)+"ms\n"+"Total Duration: ".concat(s-l,"ms")),Sp.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})}))}}]),e}(),tb=function(){function e(t,n){u(this,e),this.db=t,this.garbageCollector=function(e,t){return new eb(e,t)}(this,n)}return l(e,[{key:"Bn",value:function(e){var t=this.Un(e);return this.db.getTargetCache().getTargetCount(e).next((function(e){return t.next((function(t){return e+t}))}))}},{key:"Un",value:function(e){var t=0;return this.Ln(e,(function(e){t++})).next((function(){return t}))}},{key:"forEachTarget",value:function(e,t){return this.db.getTargetCache().forEachTarget(e,t)}},{key:"Ln",value:function(e,t){return this.Kn(e,(function(e,n){return t(n)}))}},{key:"addReference",value:function(e,t,n){return nb(e,n)}},{key:"removeReference",value:function(e,t,n){return nb(e,n)}},{key:"removeTargets",value:function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}},{key:"markPotentiallyOrphaned",value:function(e,t){return nb(e,t)}},{key:"Gn",value:function(e,t){return function(e,t){var n=!1;return Kk(e).tt((function(r){return Bk(e,r,t).next((function(e){return e&&(n=!0),Sp.resolve(!e)}))})).next((function(){return n}))}(e,t)}},{key:"removeOrphanedDocuments",value:function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],a=0;return this.Kn(e,(function(o,u){if(u<=t){var s=n.Gn(e,o).next((function(t){if(!t)return a++,r.getEntry(e,o).next((function(){return r.removeEntry(o,op.min()),Yk(e).delete([0,hg(o.path)])}))}));i.push(s)}})).next((function(){return Sp.waitFor(i)})).next((function(){return r.apply(e)})).next((function(){return a}))}},{key:"removeTarget",value:function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}},{key:"updateLimboDocument",value:function(e,t){return nb(e,t)}},{key:"Kn",value:function(e,t){var n,r=Yk(e),i=Fp.at;return r.Z({index:"documentTargetsIndex"},(function(e,r){var a=k(e,2),o=a[0],u=(a[1],r.path),s=r.sequenceNumber;0===o?(i!==Fp.at&&t(new fp(vg(n)),i),i=s,n=u):i=Fp.at})).next((function(){i!==Fp.at&&t(new fp(vg(n)),i)}))}},{key:"getCacheSize",value:function(e){return this.db.getRemoteDocumentCache().getSize(e)}}]),e}();function nb(e,t){return Yk(e).put(function(e,t){return{targetId:0,path:hg(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}var rb=function(){function e(){u(this,e),this.changes=new lm((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),this.changesApplied=!1}return l(e,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,ey.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?Sp.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}(),ib=function(){function e(t){u(this,e),this.yt=t}return l(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t,n){return sb(e).put(n)}},{key:"removeEntry",value:function(e,t,n){return sb(e).delete(function(e,t){var n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],Gg(t),n[n.length-1]]}(t,n))}},{key:"updateMetadata",value:function(e,t){var n=this;return this.getMetadata(e).next((function(r){return r.byteSize+=t,n.Qn(e,r)}))}},{key:"getEntry",value:function(e,t){var n=this,r=ey.newInvalidDocument(t);return sb(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(cb(t))},(function(e,i){r=n.jn(t,i)})).next((function(){return r}))}},{key:"Wn",value:function(e,t){var n=this,r={size:0,document:ey.newInvalidDocument(t)};return sb(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(cb(t))},(function(e,i){r={document:n.jn(t,i),size:Vk(i)}})).next((function(){return r}))}},{key:"getEntries",value:function(e,t){var n=this,r=hm();return this.zn(e,t,(function(e,t){var i=n.jn(e,t);r=r.insert(e,i)})).next((function(){return r}))}},{key:"Hn",value:function(e,t){var n=this,r=hm(),i=new Kv(fp.comparator);return this.zn(e,t,(function(e,t){var a=n.jn(e,t);r=r.insert(e,a),i=i.insert(e,Vk(t))})).next((function(){return{documents:r,Jn:i}}))}},{key:"zn",value:function(e,t,n){if(t.isEmpty())return Sp.resolve();var r=new Qv(fb);t.forEach((function(e){return r=r.add(e)}));var i=IDBKeyRange.bound(cb(r.first()),cb(r.last())),a=r.getIterator(),o=a.getNext();return sb(e).Z({index:"documentKeyIndex",range:i},(function(e,t,r){for(var i=fp.fromSegments([].concat(Te(t.prefixPath),[t.collectionGroup,t.documentId]));o&&fb(o,i)<0;)n(o,null),o=a.getNext();o&&o.isEqual(i)&&(n(o,t),o=a.hasNext()?a.getNext():null),o?r.j(cb(o)):r.done()})).next((function(){for(;o;)n(o,null),o=a.hasNext()?a.getNext():null}))}},{key:"getAllFromCollection",value:function(e,t,n){var r=this,i=[t.popLast().toArray(),t.lastSegment(),Gg(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return sb(e).W(IDBKeyRange.bound(i,a,!0)).next((function(e){var t,n=hm(),i=y(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=r.jn(fp.fromSegments(a.prefixPath.concat(a.collectionGroup,a.documentId)),a);n=n.insert(o.key,o)}}catch(u){i.e(u)}finally{i.f()}return n}))}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){var i=this,a=hm(),o=lb(t,n),u=lb(t,kp.max());return sb(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,u,!0)},(function(e,t,n){var o=i.jn(fp.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(a=a.insert(o.key,o)).size===r&&n.done()})).next((function(){return a}))}},{key:"newChangeBuffer",value:function(e){return new ob(this,!!e&&e.trackRemovals)}},{key:"getSize",value:function(e){return this.getMetadata(e).next((function(e){return e.byteSize}))}},{key:"getMetadata",value:function(e){return ub(e).get("remoteDocumentGlobalKey").next((function(e){return qd(!!e),e}))}},{key:"Qn",value:function(e,t){return ub(e).put("remoteDocumentGlobalKey",t)}},{key:"jn",value:function(e,t){if(t){var n=function(e,t){var n;if(t.document)n=Ym(e.ie,t.document,!!t.hasCommittedMutations);else if(t.noDocument){var r=fp.fromSegments(t.noDocument.path),i=$g(t.noDocument.readTime);n=ey.newNoDocument(r,i),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return Vd();var a=fp.fromSegments(t.unknownDocument.path),o=$g(t.unknownDocument.version);n=ey.newUnknownDocument(a,o)}return t.readTime&&n.setReadTime(function(e){var t=new ap(e[0],e[1]);return op.fromTimestamp(t)}(t.readTime)),n}(this.yt,t);if(!n.isNoDocument()||!n.version.isEqual(op.min()))return n}return ey.newInvalidDocument(e)}}]),e}();function ab(e){return new ib(e)}var ob=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this)).Yn=e,i.trackRemovals=r,i.Xn=new lm((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),i}return l(n,[{key:"applyChanges",value:function(e){var t=this,n=[],r=0,i=new Qv((function(e,t){return np(e.canonicalString(),t.canonicalString())}));return this.changes.forEach((function(a,o){var u=t.Xn.get(a);if(n.push(t.Yn.removeEntry(e,a,u.readTime)),o.isValidDocument()){var s=Hg(t.Yn.yt,o);i=i.add(a.path.popLast());var c=Vk(s);r+=c-u.size,n.push(t.Yn.addEntry(e,a,s))}else if(r-=u.size,t.trackRemovals){var l=Hg(t.Yn.yt,o.convertToNoDocument(op.min()));n.push(t.Yn.addEntry(e,a,l))}})),i.forEach((function(r){n.push(t.Yn.indexManager.addToCollectionParentIndex(e,r))})),n.push(this.Yn.updateMetadata(e,r)),Sp.waitFor(n)}},{key:"getFromCache",value:function(e,t){var n=this;return this.Yn.Wn(e,t).next((function(e){return n.Xn.set(t,{size:e.size,readTime:e.document.readTime}),e.document}))}},{key:"getAllFromCache",value:function(e,t){var n=this;return this.Yn.Hn(e,t).next((function(e){var t=e.documents;return e.Jn.forEach((function(e,r){n.Xn.set(e,{size:r,readTime:t.get(e).readTime})})),t}))}}]),n}(rb);function ub(e){return Vg(e,"remoteDocumentGlobal")}function sb(e){return Vg(e,"remoteDocumentsV14")}function cb(e){var t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function lb(e,t){var n=t.documentKey.path.toArray();return[e,Gg(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function fb(e,t){for(var n=e.path.toArray(),r=t.path.toArray(),i=0,a=0;a<n.length-2&&a<r.length-2;++a)if(i=np(n[a],r[a]))return i;return(i=np(n.length,r.length))||((i=np(n[n.length-2],r[r.length-2]))||np(n[n.length-1],r[r.length-1]))}var hb=l((function e(t,n){u(this,e),this.overlayedDocument=t,this.mutatedFields=n})),db=function(){function e(t,n,r,i){u(this,e),this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}return l(e,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next((function(i){return r=i,n.remoteDocumentCache.getEntry(e,t)})).next((function(e){return null!==r&&$y(r.mutation,e,Xv.empty(),ap.now()),e}))}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.getLocalViewOfDocuments(e,t,wm()).next((function(){return t}))}))}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wm(),i=ym();return this.populateOverlays(e,i,t).next((function(){return n.computeViews(e,t,i,r).next((function(e){var t=pm();return e.forEach((function(e,n){t=t.insert(e,n.overlayedDocument)})),t}))}))}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=ym();return this.populateOverlays(e,r,t).next((function(){return n.computeViews(e,t,r,wm())}))}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach((function(e){t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((function(e){e.forEach((function(e,n){t.set(e,n)}))}))}},{key:"computeViews",value:function(e,t,n,r){var i=hm(),a=gm(),o=gm();return t.forEach((function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Zy)?i=i.insert(t.key,t):void 0!==o&&(a.set(t.key,o.mutation.getFieldMask()),$y(o.mutation,t,o.mutation.getFieldMask(),ap.now()))})),this.recalculateAndSaveOverlays(e,i).next((function(e){return e.forEach((function(e,t){return a.set(e,t)})),t.forEach((function(e,t){var n;return o.set(e,new hb(t,null!==(n=a.get(e))&&void 0!==n?n:null))})),o}))}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=gm(),i=new Kv((function(e,t){return e-t})),a=wm();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(e){var n,a=y(e);try{var o=function(){var e=n.value;e.keys().forEach((function(n){var a=t.get(n);if(null!==a){var o=r.get(n)||Xv.empty();o=e.applyToLocalView(a,o),r.set(n,o);var u=(i.get(e.batchId)||wm()).add(n);i=i.insert(e.batchId,u)}}))};for(a.s();!(n=a.n()).done;)o()}catch(u){a.e(u)}finally{a.f()}})).next((function(){for(var o=[],u=i.getReverseIterator(),s=function(){var i=u.getNext(),s=i.key,c=i.value,l=mm();c.forEach((function(e){if(!a.has(e)){var n=Gy(t.get(e),r.get(e));null!==n&&l.set(e,n),a=a.add(e)}})),o.push(n.documentOverlayCache.saveOverlays(e,s,l))};u.hasNext();)s();return Sp.waitFor(o)})).next((function(){return r}))}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.recalculateAndSaveOverlays(e,t)}))}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return function(e){return fp.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):vy(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}},{key:"getNextDocuments",value:function(e,t,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((function(a){var o=r-a.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):Sp.resolve(ym()),u=-1,s=a;return o.next((function(t){return Sp.forEach(t,(function(t,n){return u<n.largestBatchId&&(u=n.largestBatchId),a.get(t)?Sp.resolve():i.remoteDocumentCache.getEntry(e,t).next((function(e){s=s.insert(t,e)}))})).next((function(){return i.populateOverlays(e,t,a)})).next((function(){return i.computeViews(e,s,t,wm())})).next((function(e){return{batchId:u,changes:vm(e)}}))}))}))}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new fp(t)).next((function(e){var t=pm();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,i=t.collectionGroup,a=pm();return this.indexManager.getCollectionParents(e,i).next((function(o){return Sp.forEach(o,(function(o){var u=function(e,t){return new cy(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return r.getDocumentsMatchingCollectionQuery(e,u,n).next((function(e){e.forEach((function(e,t){a=a.insert(e,t)}))}))})).next((function(){return a}))}))}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,i=this;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next((function(a){return r=a,i.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId)})).next((function(e){e.forEach((function(e,t){var n=t.getKey();null===r.get(n)&&(r=r.insert(n,ey.newInvalidDocument(n)))}));var n=pm();return r.forEach((function(r,i){var a=e.get(r);void 0!==a&&$y(a.mutation,i,Xv.empty(),ap.now()),xy(t,i)&&(n=n.insert(r,i))})),n}))}}]),e}(),pb=function(){function e(t){u(this,e),this.yt=t,this.Zn=new Map,this.ts=new Map}return l(e,[{key:"getBundleMetadata",value:function(e,t){return Sp.resolve(this.Zn.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.Zn.set(t.id,{id:(n=t).id,version:n.version,createTime:Vm(n.createTime)}),Sp.resolve()}},{key:"getNamedQuery",value:function(e,t){return Sp.resolve(this.ts.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.ts.set(t.name,function(e){return{name:e.name,query:Zg(e.bundledQuery),readTime:Vm(e.readTime)}}(t)),Sp.resolve()}}]),e}(),vb=function(){function e(){u(this,e),this.overlays=new Kv(fp.comparator),this.es=new Map}return l(e,[{key:"getOverlay",value:function(e,t){return Sp.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=ym();return Sp.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach((function(n,i){r.oe(e,t,i)})),Sp.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.es.get(n);return void 0!==i&&(i.forEach((function(e){return r.overlays=r.overlays.remove(e)})),this.es.delete(n)),Sp.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=ym(),i=t.length+1,a=new fp(t.child("")),o=this.overlays.getIteratorFrom(a);o.hasNext();){var u=o.getNext().value,s=u.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&u.largestBatchId>n&&r.set(u.getKey(),u)}return Sp.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new Kv((function(e,t){return e-t})),a=this.overlays.getIterator();a.hasNext();){var o=a.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var u=i.get(o.largestBatchId);null===u&&(u=ym(),i=i.insert(o.largestBatchId,u)),u.set(o.getKey(),o)}}for(var s=ym(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach((function(e,t){return s.set(e,t)})),!(s.size()>=r)););return Sp.resolve(s)}},{key:"oe",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.es.get(r.largestBatchId).delete(n.key);this.es.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new zg(t,n));var a=this.es.get(t);void 0===a&&(a=wm(),this.es.set(t,a)),this.es.set(t,a.add(n.key))}}]),e}(),yb=function(){function e(){u(this,e),this.ns=new Qv(mb.ss),this.rs=new Qv(mb.os)}return l(e,[{key:"isEmpty",value:function(){return this.ns.isEmpty()}},{key:"addReference",value:function(e,t){var n=new mb(e,t);this.ns=this.ns.add(n),this.rs=this.rs.add(n)}},{key:"us",value:function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))}},{key:"removeReference",value:function(e,t){this.cs(new mb(e,t))}},{key:"hs",value:function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))}},{key:"ls",value:function(e){var t=this,n=new fp(new sp([])),r=new mb(n,e),i=new mb(n,e+1),a=[];return this.rs.forEachInRange([r,i],(function(e){t.cs(e),a.push(e.key)})),a}},{key:"fs",value:function(){var e=this;this.ns.forEach((function(t){return e.cs(t)}))}},{key:"cs",value:function(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}},{key:"ds",value:function(e){var t=new fp(new sp([])),n=new mb(t,e),r=new mb(t,e+1),i=wm();return this.rs.forEachInRange([n,r],(function(e){i=i.add(e.key)})),i}},{key:"containsKey",value:function(e){var t=new mb(e,0),n=this.ns.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),mb=function(){function e(t,n){u(this,e),this.key=t,this._s=n}return l(e,null,[{key:"ss",value:function(e,t){return fp.comparator(e.key,t.key)||np(e._s,t._s)}},{key:"os",value:function(e,t){return np(e._s,t._s)||fp.comparator(e.key,t.key)}}]),e}(),gb=function(){function e(t,n){u(this,e),this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.ws=1,this.gs=new Qv(mb.ss)}return l(e,[{key:"checkEmpty",value:function(e){return Sp.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];var a=new qg(i,t,n,r);this.mutationQueue.push(a);var o,u=y(r);try{for(u.s();!(o=u.n()).done;){var s=o.value;this.gs=this.gs.add(new mb(s.key,i)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast())}}catch(c){u.e(c)}finally{u.f()}return Sp.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return Sp.resolve(this.ys(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=t+1,r=this.ps(n),i=r<0?0:r;return Sp.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return Sp.resolve(0===this.mutationQueue.length?-1:this.ws-1)}},{key:"getAllMutationBatches",value:function(e){return Sp.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new mb(t,0),i=new mb(t,Number.POSITIVE_INFINITY),a=[];return this.gs.forEachInRange([r,i],(function(e){var t=n.ys(e._s);a.push(t)})),Sp.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new Qv(np);return t.forEach((function(e){var t=new mb(e,0),i=new mb(e,Number.POSITIVE_INFINITY);n.gs.forEachInRange([t,i],(function(e){r=r.add(e._s)}))})),Sp.resolve(this.Is(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;fp.isDocumentKey(i)||(i=i.child(""));var a=new mb(new fp(i),0),o=new Qv(np);return this.gs.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e._s)),!0)}),a),Sp.resolve(this.Is(o))}},{key:"Is",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=t.ys(e);null!==r&&n.push(r)})),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;qd(0===this.Ts(t.batchId,"removed")),this.mutationQueue.shift();var r=this.gs;return Sp.forEach(t.mutations,(function(i){var a=new mb(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((function(){n.gs=r}))}},{key:"An",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new mb(t,0),r=this.gs.firstAfterOrEqual(n);return Sp.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return this.mutationQueue.length,Sp.resolve()}},{key:"Ts",value:function(e,t){return this.ps(e)}},{key:"ps",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"ys",value:function(e){var t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),e}(),kb=function(){function e(t){u(this,e),this.Es=t,this.docs=new Kv(fp.comparator),this.size=0}return l(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.Es(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return Sp.resolve(n?n.document.mutableCopy():ey.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=hm();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():ey.newInvalidDocument(e))})),Sp.resolve(r)}},{key:"getAllFromCollection",value:function(e,t,n){for(var r=hm(),i=new fp(t.child("")),a=this.docs.getIteratorFrom(i);a.hasNext();){var o=a.getNext(),u=o.key,s=o.value.document;if(!t.isPrefixOf(u.path))break;u.path.length>t.length+1||bp(gp(s),n)<=0||(r=r.insert(s.key,s.mutableCopy()))}return Sp.resolve(r)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){Vd()}},{key:"As",value:function(e,t){return Sp.forEach(this.docs,(function(e){return t(e)}))}},{key:"newChangeBuffer",value:function(e){return new bb(this)}},{key:"getSize",value:function(e){return Sp.resolve(this.size)}}]),e}(),bb=function(e){_(n,e);var t=T(n);function n(e){var r;return u(this,n),(r=t.call(this)).Yn=e,r}return l(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach((function(r,i){i.isValidDocument()?n.push(t.Yn.addEntry(e,i)):t.Yn.removeEntry(r)})),Sp.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.Yn.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.Yn.getEntries(e,t)}}]),n}(rb),wb=function(){function e(t){u(this,e),this.persistence=t,this.Rs=new lm((function(e){return ry(e)}),iy),this.lastRemoteSnapshotVersion=op.min(),this.highestTargetId=0,this.bs=0,this.Ps=new yb,this.targetCount=0,this.vs=Hk.Pn()}return l(e,[{key:"forEachTarget",value:function(e,t){return this.Rs.forEach((function(e,n){return t(n)})),Sp.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return Sp.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return Sp.resolve(this.bs)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.vs.next(),Sp.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.bs&&(this.bs=t),Sp.resolve()}},{key:"Dn",value:function(e){this.Rs.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.vs=new Hk(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.Dn(t),this.targetCount+=1,Sp.resolve()}},{key:"updateTargetData",value:function(e,t){return this.Dn(t),Sp.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,Sp.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Rs.forEach((function(o,u){u.sequenceNumber<=t&&null===n.get(u.targetId)&&(r.Rs.delete(o),a.push(r.removeMatchingKeysForTargetId(e,u.targetId)),i++)})),Sp.waitFor(a).next((function(){return i}))}},{key:"getTargetCount",value:function(e){return Sp.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Rs.get(t)||null;return Sp.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.Ps.us(t,n),Sp.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.Ps.hs(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((function(t){i.push(r.markPotentiallyOrphaned(e,t))})),Sp.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.Ps.ls(t),Sp.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.Ps.ds(t);return Sp.resolve(n)}},{key:"containsKey",value:function(e,t){return Sp.resolve(this.Ps.containsKey(t))}}]),e}(),_b=function(){function e(t,n){var r=this;u(this,e),this.Vs={},this.overlays={},this.Ss=new Fp(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=t(this),this.Cs=new wb(this),this.indexManager=new Ck,this.remoteDocumentCache=new kb((function(e){return r.referenceDelegate.xs(e)})),this.yt=new Kg(n),this.Ns=new pb(this.yt)}return l(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.Ds=!1,Promise.resolve()}},{key:"started",get:function(){return this.Ds}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new vb,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.Vs[e.toKey()];return n||(n=new gb(t,this.referenceDelegate),this.Vs[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Cs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.Ns}},{key:"runTransaction",value:function(e,t,n){var r=this;Md("MemoryPersistence","Starting transaction:",e);var i=new xb(this.Ss.next());return this.referenceDelegate.ks(),n(i).next((function(e){return r.referenceDelegate.Os(i).next((function(){return e}))})).toPromise().then((function(e){return i.raiseOnCommittedEvent(),e}))}},{key:"Ms",value:function(e,t){return Sp.or(Object.values(this.Vs).map((function(n){return function(){return n.containsKey(e,t)}})))}}]),e}(),xb=function(e){_(n,e);var t=T(n);function n(e){var r;return u(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return l(n)}(_p),Ib=function(){function e(t){u(this,e),this.persistence=t,this.Fs=new yb,this.$s=null}return l(e,[{key:"Ls",get:function(){if(this.$s)return this.$s;throw Vd()}},{key:"addReference",value:function(e,t,n){return this.Fs.addReference(n,t),this.Ls.delete(n.toString()),Sp.resolve()}},{key:"removeReference",value:function(e,t,n){return this.Fs.removeReference(n,t),this.Ls.add(n.toString()),Sp.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Ls.add(t.toString()),Sp.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.Fs.ls(t.targetId).forEach((function(e){return n.Ls.add(e.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){e.forEach((function(e){return n.Ls.add(e.toString())}))})).next((function(){return r.removeTargetData(e,t)}))}},{key:"ks",value:function(){this.$s=new Set}},{key:"Os",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Sp.forEach(this.Ls,(function(r){var i=fp.fromPath(r);return t.qs(e,i).next((function(e){e||n.removeEntry(i,op.min())}))})).next((function(){return t.$s=null,n.apply(e)}))}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.qs(e,t).next((function(e){e?n.Ls.delete(t.toString()):n.Ls.add(t.toString())}))}},{key:"xs",value:function(e){return 0}},{key:"qs",value:function(e,t){var n=this;return Sp.or([function(){return Sp.resolve(n.Fs.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Ms(e,t)}])}}],[{key:"Bs",value:function(t){return new e(t)}}]),e}(),Sb=function(){function e(t){u(this,e),this.yt=t}return l(e,[{key:"$",value:function(e,t,n,r){var i=this,a=new Tp("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",yg,{unique:!0}),e.createObjectStore("documentMutations")}(e),Tb(e),function(e){e.createObjectStore("remoteDocuments")}(e));var o=Sp.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),Tb(e)),o=o.next((function(){return function(e){var t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:op.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(a)}))),n<4&&r>=4&&(0!==n&&(o=o.next((function(){return function(e,t){return t.store("mutations").W().next((function(n){e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",yg,{unique:!0});var r=t.store("mutations"),i=n.map((function(e){return r.put(e)}));return Sp.waitFor(i)}))}(e,a)}))),o=o.next((function(){!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(o=o.next((function(){return i.Us(a)}))),n<6&&r>=6&&(o=o.next((function(){return function(e){e.createObjectStore("remoteDocumentGlobal")}(e),i.Ks(a)}))),n<7&&r>=7&&(o=o.next((function(){return i.Gs(a)}))),n<8&&r>=8&&(o=o.next((function(){return i.Qs(e,a)}))),n<9&&r>=9&&(o=o.next((function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(o=o.next((function(){return i.js(a)}))),n<11&&r>=11&&(o=o.next((function(){!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(o=o.next((function(){!function(e){var t=e.createObjectStore("documentOverlays",{keyPath:Ag});t.createIndex("collectionPathOverlayIndex",Pg,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",Dg,{unique:!1})}(e)}))),n<13&&r>=13&&(o=o.next((function(){return function(e){var t=e.createObjectStore("remoteDocumentsV14",{keyPath:bg});t.createIndex("documentKeyIndex",wg),t.createIndex("collectionGroupIndex",_g)}(e)})).next((function(){return i.Ws(e,a)})).next((function(){return e.deleteObjectStore("remoteDocuments")}))),n<14&&r>=14&&(o=o.next((function(){return i.zs(e,a)}))),n<15&&r>=15&&(o=o.next((function(){return function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:Eg}).createIndex("sequenceNumberIndex",Cg,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:Ng}).createIndex("documentKeyIndex",Rg,{unique:!1})}(e)}))),o}},{key:"Ks",value:function(e){var t=0;return e.store("remoteDocuments").Z((function(e,n){t+=Vk(n)})).next((function(){var n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}},{key:"Us",value:function(e){var t=this,n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next((function(n){return Sp.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",i).next((function(r){return Sp.forEach(r,(function(r){qd(r.userId===n.userId);var i=Yg(t.yt,r);return jk(e,n.userId,i).next((function(){}))}))}))}))}))}},{key:"Gs",value:function(e){var t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((function(e){var r=[];return n.Z((function(n,i){var a=new sp(n),o=function(e){return[0,hg(e)]}(a);r.push(t.get(o).next((function(n){return n?Sp.resolve():function(n){return t.put({targetId:0,path:hg(n),sequenceNumber:e.highestListenSequenceNumber})}(a)})))})).next((function(){return Sp.waitFor(r)}))}))}},{key:"Qs",value:function(e,t){e.createObjectStore("collectionParents",{keyPath:Tg});var n=t.store("collectionParents"),r=new Nk,i=function(e){if(r.add(e)){var t=e.lastSegment(),i=e.popLast();return n.put({collectionId:t,parent:hg(i)})}};return t.store("remoteDocuments").Z({X:!0},(function(e,t){var n=new sp(e);return i(n.popLast())})).next((function(){return t.store("documentMutations").Z({X:!0},(function(e,t){var n=k(e,3),r=(n[0],n[1]),a=(n[2],vg(r));return i(a.popLast())}))}))}},{key:"js",value:function(e){var t=this,n=e.store("targets");return n.Z((function(e,r){var i=Xg(r),a=Jg(t.yt,i);return n.put(a)}))}},{key:"Ws",value:function(e,t){var n=t.store("remoteDocuments"),r=[];return n.Z((function(e,n){var i,a=t.store("remoteDocumentsV14"),o=(i=n,i.document?new fp(sp.fromString(i.document.name).popFirst(5)):i.noDocument?fp.fromSegments(i.noDocument.path):i.unknownDocument?fp.fromSegments(i.unknownDocument.path):Vd()).path.toArray(),u={prefixPath:o.slice(0,o.length-2),collectionGroup:o[o.length-2],documentId:o[o.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(a.put(u))})).next((function(){return Sp.waitFor(r)}))}},{key:"zs",value:function(e,t){var n=this,r=t.store("mutations"),i=ab(this.yt),a=new _b(Ib.Bs,this.yt.ie);return r.W().next((function(e){var r=new Map;return e.forEach((function(e){var t,i=null!==(t=r.get(e.userId))&&void 0!==t?t:wm();Yg(n.yt,e).keys().forEach((function(e){return i=i.add(e)})),r.set(e.userId,i)})),Sp.forEach(r,(function(e,r){var o=new Pd(r),u=ok.re(n.yt,o),s=a.getIndexManager(o),c=qk.re(o,n.yt,s,a.referenceDelegate);return new db(i,c,u,s).recalculateAndSaveOverlaysForDocumentKeys(new jg(t,Fp.at),e).next()}))}))}}]),e}();function Tb(e){e.createObjectStore("targetDocuments",{keyPath:Ig}).createIndex("documentTargetsIndex",Sg,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",xg,{unique:!0}),e.createObjectStore("targetGlobal")}var Eb="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Cb=function(){function e(t,n,r,i,a,o,s,c,l,f){var h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:15;if(u(this,e),this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.Hs=a,this.window=o,this.document=s,this.Js=l,this.Ys=f,this.Xs=h,this.Ss=null,this.Ds=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.ti=null,this.ei=null,this.ni=Number.NEGATIVE_INFINITY,this.si=function(e){return Promise.resolve()},!e.C())throw new Wd(zd.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new tb(this,i),this.ii=n+"main",this.yt=new Kg(c),this.ri=new Ep(this.ii,this.Xs,new Sb(this.yt)),this.Cs=new Gk(this.referenceDelegate,this.yt),this.remoteDocumentCache=ab(this.yt),this.Ns=new rk,this.window&&this.window.localStorage?this.oi=this.window.localStorage:(this.oi=null,!1===f&&Fd("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return l(e,[{key:"start",value:function(){var e=this;return this.ui().then((function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Wd(zd.FAILED_PRECONDITION,Eb);return e.ci(),e.ai(),e.hi(),e.runTransaction("getHighestListenSequenceNumber","readonly",(function(t){return e.Cs.getHighestSequenceNumber(t)}))})).then((function(t){e.Ss=new Fp(t,e.Js)})).then((function(){e.Ds=!0})).catch((function(t){return e.ri&&e.ri.close(),Promise.reject(t)}))}},{key:"li",value:function(e){var t=this;return this.si=function(){var n=h(o().mark((function n(r){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.started){n.next=2;break}return n.abrupt("return",e(r));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e(this.isPrimary)}},{key:"setDatabaseDeletedListener",value:function(e){this.ri.L(function(){var t=h(o().mark((function t(n){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null===n.newVersion,!t.t0){t.next=4;break}return t.next=4,e();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"setNetworkEnabled",value:function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Hs.enqueueAndForget(h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.started,!e.t0){e.next=4;break}return e.next=4,t.ui();case 4:case"end":return e.stop()}}),e)})))))}},{key:"ui",value:function(){var e=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(t){return Rb(t).put({clientId:e.clientId,updateTimeMs:Date.now(),networkEnabled:e.networkEnabled,inForeground:e.inForeground}).next((function(){if(e.isPrimary)return e.fi(t).next((function(t){t||(e.isPrimary=!1,e.Hs.enqueueRetryable((function(){return e.si(!1)})))}))})).next((function(){return e.di(t)})).next((function(n){return e.isPrimary&&!n?e._i(t).next((function(){return!1})):!!n&&e.wi(t).next((function(){return!0}))}))})).catch((function(t){if(Rp(t))return Md("IndexedDbPersistence","Failed to extend owner lease: ",t),e.isPrimary;if(!e.allowTabSynchronization)throw t;return Md("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1})).then((function(t){e.isPrimary!==t&&e.Hs.enqueueRetryable((function(){return e.si(t)})),e.isPrimary=t}))}},{key:"fi",value:function(e){var t=this;return Nb(e).get("owner").next((function(e){return Sp.resolve(t.mi(e))}))}},{key:"gi",value:function(e){return Rb(e).delete(this.clientId)}},{key:"yi",value:function(){var e=h(o().mark((function e(){var t,n,r,i,a=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPrimary||this.pi(this.ni,18e5)){e.next=6;break}return this.ni=Date.now(),e.next=4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var t=Vg(e,"clientMetadata");return t.W().next((function(e){var n=a.Ii(e,18e5),r=e.filter((function(e){return-1===n.indexOf(e)}));return Sp.forEach(r,(function(e){return t.delete(e.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}));case 4:if(t=e.sent,this.oi){n=y(t);try{for(n.s();!(r=n.n()).done;)i=r.value,this.oi.removeItem(this.Ti(i.clientId))}catch(o){n.e(o)}finally{n.f()}}case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"hi",value:function(){var e=this;this.ei=this.Hs.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return e.ui().then((function(){return e.yi()})).then((function(){return e.hi()}))}))}},{key:"mi",value:function(e){return!!e&&e.ownerId===this.clientId}},{key:"di",value:function(e){var t=this;return this.Ys?Sp.resolve(!0):Nb(e).get("owner").next((function(n){if(null!==n&&t.pi(n.leaseTimestampMs,5e3)&&!t.Ei(n.ownerId)){if(t.mi(n)&&t.networkEnabled)return!0;if(!t.mi(n)){if(!n.allowTabSynchronization)throw new Wd(zd.FAILED_PRECONDITION,Eb);return!1}}return!(!t.networkEnabled||!t.inForeground)||Rb(e).W().next((function(e){return void 0===t.Ii(e,5e3).find((function(e){if(t.clientId!==e.clientId){var n=!t.networkEnabled&&e.networkEnabled,r=!t.inForeground&&e.inForeground,i=t.networkEnabled===e.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(e){return t.isPrimary!==e&&Md("IndexedDbPersistence","Client ".concat(e?"is":"is not"," eligible for a primary lease.")),e}))}},{key:"shutdown",value:function(){var e=h(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.Ds=!1,this.Ai(),this.ei&&(this.ei.cancel(),this.ei=null),this.Ri(),this.bi(),e.next=7,this.ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(function(e){var n=new jg(e,Fp.at);return t._i(n).next((function(){return t.gi(n)}))}));case 7:this.ri.close(),this.Pi();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Ii",value:function(e,t){var n=this;return e.filter((function(e){return n.pi(e.updateTimeMs,t)&&!n.Ei(e.clientId)}))}},{key:"vi",value:function(){var e=this;return this.runTransaction("getActiveClients","readonly",(function(t){return Rb(t).W().next((function(t){return e.Ii(t,18e5).map((function(e){return e.clientId}))}))}))}},{key:"started",get:function(){return this.Ds}},{key:"getMutationQueue",value:function(e,t){return qk.re(e,this.yt,t,this.referenceDelegate)}},{key:"getTargetCache",value:function(){return this.Cs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getIndexManager",value:function(e){return new Ak(e,this.yt.ie.databaseId)}},{key:"getDocumentOverlayCache",value:function(e){return ok.re(this.yt,e)}},{key:"getBundleCache",value:function(){return this.Ns}},{key:"runTransaction",value:function(e,t,n){var r=this;Md("IndexedDbPersistence","Starting transaction:",e);var i,a,o="readonly"===t?"readonly":"readwrite",u=15===(i=this.Xs)?Ug:14===i?Fg:13===i?Mg:12===i?Lg:11===i?Og:void Vd();return this.ri.runTransaction(e,o,u,(function(i){return a=new jg(i,r.Ss?r.Ss.next():Fp.at),"readwrite-primary"===t?r.fi(a).next((function(e){return!!e||r.di(a)})).next((function(t){if(!t)throw Fd("Failed to obtain primary lease for action '".concat(e,"'.")),r.isPrimary=!1,r.Hs.enqueueRetryable((function(){return r.si(!1)})),new Wd(zd.FAILED_PRECONDITION,wp);return n(a)})).next((function(e){return r.wi(a).next((function(){return e}))})):r.Vi(a).next((function(){return n(a)}))})).then((function(e){return a.raiseOnCommittedEvent(),e}))}},{key:"Vi",value:function(e){var t=this;return Nb(e).get("owner").next((function(e){if(null!==e&&t.pi(e.leaseTimestampMs,5e3)&&!t.Ei(e.ownerId)&&!t.mi(e)&&!(t.Ys||t.allowTabSynchronization&&e.allowTabSynchronization))throw new Wd(zd.FAILED_PRECONDITION,Eb)}))}},{key:"wi",value:function(e){var t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Nb(e).put("owner",t)}},{key:"_i",value:function(e){var t=this,n=Nb(e);return n.get("owner").next((function(e){return t.mi(e)?(Md("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):Sp.resolve()}))}},{key:"pi",value:function(e,t){var n=Date.now();return!(e<n-t)&&(!(e>n)||(Fd("Detected an update time that is in the future: ".concat(e," > ").concat(n)),!1))}},{key:"ci",value:function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ti=function(){e.Hs.enqueueAndForget((function(){return e.inForeground="visible"===e.document.visibilityState,e.ui()}))},this.document.addEventListener("visibilitychange",this.ti),this.inForeground="visible"===this.document.visibilityState)}},{key:"Ri",value:function(){this.ti&&(this.document.removeEventListener("visibilitychange",this.ti),this.ti=null)}},{key:"ai",value:function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Zs=function(){t.Ai(),!B()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&navigator.appVersion.match(/Version\/1[45]/)&&t.Hs.enterRestrictedMode(!0),t.Hs.enqueueAndForget((function(){return t.shutdown()}))},this.window.addEventListener("pagehide",this.Zs))}},{key:"bi",value:function(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}},{key:"Ei",value:function(e){var t;try{var n=null!==(null===(t=this.oi)||void 0===t?void 0:t.getItem(this.Ti(e)));return Md("IndexedDbPersistence","Client '".concat(e,"' ").concat(n?"is":"is not"," zombied in LocalStorage")),n}catch(e){return Fd("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}},{key:"Ai",value:function(){if(this.oi)try{this.oi.setItem(this.Ti(this.clientId),String(Date.now()))}catch(qc){Fd("Failed to set zombie client id.",qc)}}},{key:"Pi",value:function(){if(this.oi)try{this.oi.removeItem(this.Ti(this.clientId))}catch(qc){}}},{key:"Ti",value:function(e){return"firestore_zombie_".concat(this.persistenceKey,"_").concat(e)}}],[{key:"C",value:function(){return Ep.C()}}]),e}();function Nb(e){return Vg(e,"owner")}function Rb(e){return Vg(e,"clientMetadata")}function Ab(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}var Pb=function(){function e(t,n,r,i){u(this,e),this.targetId=t,this.fromCache=n,this.Si=r,this.Di=i}return l(e,null,[{key:"Ci",value:function(t,n){var r,i=wm(),a=wm(),o=y(n.docChanges);try{for(o.s();!(r=o.n()).done;){var u=r.value;switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:a=a.add(u.doc.key)}}}catch(s){o.e(s)}finally{o.f()}return new e(t,n.fromCache,i,a)}}]),e}(),Db=function(){function e(){u(this,e),this.xi=!1}return l(e,[{key:"initialize",value:function(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this;return this.ki(e,t).next((function(a){return a||i.Oi(e,t,r,n)})).next((function(n){return n||i.Mi(e,t)}))}},{key:"ki",value:function(e,t){var n=this;if(hy(t))return Sp.resolve(null);var r=my(t);return this.indexManager.getIndexType(e,r).next((function(i){return 0===i?null:(null!==t.limit&&1===i&&(t=ky(t,null,"F"),r=my(t)),n.indexManager.getDocumentsMatchingTarget(e,r).next((function(i){var a=wm.apply(void 0,Te(i));return n.Ni.getDocuments(e,a).next((function(i){return n.indexManager.getMinOffset(e,r).next((function(r){var o=n.Fi(t,i);return n.$i(t,o,a,r.readTime)?n.ki(e,ky(t,null,"F")):n.Bi(e,o,t,r)}))}))})))}))}},{key:"Oi",value:function(e,t,n,r){var i=this;return hy(t)||r.isEqual(op.min())?this.Mi(e,t):this.Ni.getDocuments(e,n).next((function(a){var o=i.Fi(t,a);return i.$i(t,o,n,r)?i.Mi(e,t):(Ld()<=Ae.DEBUG&&Md("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),_y(t)),i.Bi(e,o,t,mp(r,-1)))}))}},{key:"Fi",value:function(e,t){var n=new Qv(Sy(e));return t.forEach((function(t,r){xy(e,r)&&(n=n.add(r))})),n}},{key:"$i",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Mi",value:function(e,t){return Ld()<=Ae.DEBUG&&Md("QueryEngine","Using full collection scan to execute query:",_y(t)),this.Ni.getDocumentsMatchingQuery(e,t,kp.min())}},{key:"Bi",value:function(e,t,n,r){return this.Ni.getDocumentsMatchingQuery(e,n,r).next((function(e){return t.forEach((function(t){e=e.insert(t.key,t)})),e}))}}]),e}(),Ob=function(){function e(t,n,r,i){u(this,e),this.persistence=t,this.Li=n,this.yt=i,this.qi=new Kv(np),this.Ui=new lm((function(e){return ry(e)}),iy),this.Ki=new Map,this.Gi=t.getRemoteDocumentCache(),this.Cs=t.getTargetCache(),this.Ns=t.getBundleCache(),this.Qi(r)}return l(e,[{key:"Qi",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new db(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return e.collect(n,t.qi)}))}}]),e}();function Lb(e,t,n,r){return new Ob(e,t,n,r)}function Mb(e,t){return Fb.apply(this,arguments)}function Fb(){return Fb=h(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Bd(t),e.next=3,r.persistence.runTransaction("Handle user change","readonly",(function(e){var t;return r.mutationQueue.getAllMutationBatches(e).next((function(i){return t=i,r.Qi(n),r.mutationQueue.getAllMutationBatches(e)})).next((function(n){var i,a=[],o=[],u=wm(),s=y(t);try{for(s.s();!(i=s.n()).done;){var c=i.value;a.push(c.batchId);var l,f=y(c.mutations);try{for(f.s();!(l=f.n()).done;){var h=l.value;u=u.add(h.key)}}catch(b){f.e(b)}finally{f.f()}}}catch(b){s.e(b)}finally{s.f()}var d,p=y(n);try{for(p.s();!(d=p.n()).done;){var v=d.value;o.push(v.batchId);var m,g=y(v.mutations);try{for(g.s();!(m=g.n()).done;){var k=m.value;u=u.add(k.key)}}catch(b){g.e(b)}finally{g.f()}}}catch(b){p.e(b)}finally{p.f()}return r.localDocuments.getDocuments(e,u).next((function(e){return{ji:e,removedBatchIds:a,addedBatchIds:o}}))}))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),Fb.apply(this,arguments)}function Ub(e,t){var n=Bd(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(e){var r=t.batch.keys(),i=n.Gi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var i=n.batch,a=i.keys(),o=Sp.resolve();return a.forEach((function(e){o=o.next((function(){return r.getEntry(t,e)})).next((function(t){var a=n.docVersions.get(e);qd(null!==a),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((function(){return e.mutationQueue.removeMutationBatch(t,i)}))}(n,e,t,i).next((function(){return i.apply(e)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=wm(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}function jb(e){var t=Bd(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.Cs.getLastRemoteSnapshotVersion(e)}))}function Vb(e,t){var n=Bd(e),r=t.snapshotVersion,i=n.qi;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(e){var a=n.Gi.newChangeBuffer({trackRemovals:!0});i=n.qi;var o=[];t.targetChanges.forEach((function(a,u){var s=i.get(u);if(s){o.push(n.Cs.removeMatchingKeys(e,a.removedDocuments,u).next((function(){return n.Cs.addMatchingKeys(e,a.addedDocuments,u)})));var c=s.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(u)?c=c.withResumeToken(Hp.EMPTY_BYTE_STRING,op.min()).withLastLimboFreeSnapshotVersion(op.min()):a.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(a.resumeToken,r)),i=i.insert(u,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(s,c,a)&&o.push(n.Cs.updateTargetData(e,c))}}));var u=hm(),s=wm();if(t.documentUpdates.forEach((function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(qb(e,a,t.documentUpdates).next((function(e){u=e.Wi,s=e.zi}))),!r.isEqual(op.min())){var c=n.Cs.getLastRemoteSnapshotVersion(e).next((function(t){return n.Cs.setTargetsMetadata(e,e.currentSequenceNumber,r)}));o.push(c)}return Sp.waitFor(o).next((function(){return a.apply(e)})).next((function(){return n.localDocuments.getLocalViewOfDocuments(e,u,s)})).next((function(){return u}))})).then((function(e){return n.qi=i,e}))}function qb(e,t,n){var r=wm(),i=wm();return n.forEach((function(e){return r=r.add(e)})),t.getEntries(e,r).next((function(e){var r=hm();return n.forEach((function(n,a){var o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(op.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):Md("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)})),{Wi:r,zi:i}}))}function Bb(e,t){var n=Bd(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)}))}function zb(e,t){var n=Bd(e);return n.persistence.runTransaction("Allocate target","readwrite",(function(e){var r;return n.Cs.getTargetData(e,t).next((function(i){return i?(r=i,Sp.resolve(r)):n.Cs.allocateTargetId(e).next((function(i){return r=new Wg(t,i,0,e.currentSequenceNumber),n.Cs.addTargetData(e,r).next((function(){return r}))}))}))})).then((function(e){var r=n.qi.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.qi=n.qi.insert(e.targetId,e),n.Ui.set(t,e.targetId)),e}))}function Wb(e,t,n){return Kb.apply(this,arguments)}function Kb(){return Kb=h(o().mark((function e(t,n,r){var i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Bd(t),a=i.qi.get(n),u=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,i.persistence.runTransaction("Release target",u,(function(e){return i.persistence.referenceDelegate.removeTarget(e,a)}));case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),Rp(e.t1)){e.next=12;break}throw e.t1;case 12:Md("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:i.qi=i.qi.remove(n),i.Ui.delete(a.target);case 14:case"end":return e.stop()}}),e,null,[[1,8]])}))),Kb.apply(this,arguments)}function Hb(e,t,n){var r=Bd(e),i=op.min(),a=wm();return r.persistence.runTransaction("Execute query","readonly",(function(e){return function(e,t,n){var r=Bd(e),i=r.Ui.get(n);return void 0!==i?Sp.resolve(r.qi.get(i)):r.Cs.getTargetData(t,n)}(r,e,my(t)).next((function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(e,t.targetId).next((function(e){a=e}))})).next((function(){return r.Li.getDocumentsMatchingQuery(e,t,n?i:op.min(),n?a:wm())})).next((function(e){return $b(r,Iy(t),e),{documents:e,Hi:a}}))}))}function Gb(e,t){var n=Bd(e),r=Bd(n.Cs),i=n.qi.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(e){return r.ne(e,t).next((function(e){return e?e.target:null}))}))}function Qb(e,t){var n=Bd(e),r=n.Ki.get(t)||op.min();return n.persistence.runTransaction("Get new document changes","readonly",(function(e){return n.Gi.getAllFromCollectionGroup(e,t,mp(r,-1),Number.MAX_SAFE_INTEGER)})).then((function(e){return $b(n,t,e),e}))}function $b(e,t,n){var r=e.Ki.get(t)||op.min();n.forEach((function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Ki.set(t,r)}function Yb(e,t,n,r){return Xb.apply(this,arguments)}function Xb(){return Xb=h(o().mark((function e(t,n,r,i){var a,u,s,c,l,f,h,d,p,v;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Bd(t),u=wm(),s=hm(),c=y(r);try{for(c.s();!(l=c.n()).done;)f=l.value,h=n.Ji(f.metadata.name),f.document&&(u=u.add(h)),(d=n.Yi(f)).setReadTime(n.Xi(f.metadata.readTime)),s=s.insert(h,d)}catch(o){c.e(o)}finally{c.f()}return p=a.Gi.newChangeBuffer({trackRemovals:!0}),e.next=7,zb(a,function(e){return my(fy(sp.fromString("__bundle__/docs/".concat(e))))}(i));case 7:return v=e.sent,e.abrupt("return",a.persistence.runTransaction("Apply bundle documents","readwrite",(function(e){return qb(e,p,s).next((function(t){return p.apply(e),t})).next((function(t){return a.Cs.removeMatchingKeysForTargetId(e,v.targetId).next((function(){return a.Cs.addMatchingKeys(e,u,v.targetId)})).next((function(){return a.localDocuments.getLocalViewOfDocuments(e,t.Wi,t.zi)})).next((function(){return t.Wi}))}))})));case 9:case"end":return e.stop()}}),e)}))),Xb.apply(this,arguments)}function Jb(e,t){return Zb.apply(this,arguments)}function Zb(){return Zb=h(o().mark((function e(t,n){var r,i,a,u=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>2&&void 0!==u[2]?u[2]:wm(),e.next=3,zb(t,my(Zg(n.bundledQuery)));case 3:return i=e.sent,a=Bd(t),e.abrupt("return",a.persistence.runTransaction("Save named query","readwrite",(function(e){var t=Vm(n.readTime);if(i.snapshotVersion.compareTo(t)>=0)return a.Ns.saveNamedQuery(e,n);var o=i.withResumeToken(Hp.EMPTY_BYTE_STRING,t);return a.qi=a.qi.insert(o.targetId,o),a.Cs.updateTargetData(e,o).next((function(){return a.Cs.removeMatchingKeysForTargetId(e,i.targetId)})).next((function(){return a.Cs.addMatchingKeys(e,r,i.targetId)})).next((function(){return a.Ns.saveNamedQuery(e,n)}))})));case 6:case"end":return e.stop()}}),e)}))),Zb.apply(this,arguments)}function ew(e,t){return"firestore_clients_".concat(e,"_").concat(t)}function tw(e,t,n){var r="firestore_mutations_".concat(e,"_").concat(n);return t.isAuthenticated()&&(r+="_".concat(t.uid)),r}function nw(e,t){return"firestore_targets_".concat(e,"_").concat(t)}var rw=function(){function e(t,n,r,i){u(this,e),this.user=t,this.batchId=n,this.state=r,this.error=i}return l(e,[{key:"tr",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"Zi",value:function(t,n,r){var i,a=JSON.parse(r),o="object"==typeof a&&-1!==["pending","acknowledged","rejected"].indexOf(a.state)&&(void 0===a.error||"object"==typeof a.error);return o&&a.error&&((o="string"==typeof a.error.message&&"string"==typeof a.error.code)&&(i=new Wd(a.error.code,a.error.message))),o?new e(t,n,a.state,i):(Fd("SharedClientState","Failed to parse mutation state for ID '".concat(n,"': ").concat(r)),null)}}]),e}(),iw=function(){function e(t,n,r){u(this,e),this.targetId=t,this.state=n,this.error=r}return l(e,[{key:"tr",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"Zi",value:function(t,n){var r,i=JSON.parse(n),a="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return a&&i.error&&((a="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Wd(i.error.code,i.error.message))),a?new e(t,i.state,r):(Fd("SharedClientState","Failed to parse target state for ID '".concat(t,"': ").concat(n)),null)}}]),e}(),aw=function(){function e(t,n){u(this,e),this.clientId=t,this.activeTargetIds=n}return l(e,null,[{key:"Zi",value:function(t,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,a=xm(),o=0;i&&o<r.activeTargetIds.length;++o)i=Kp(r.activeTargetIds[o]),a=a.add(r.activeTargetIds[o]);return i?new e(t,a):(Fd("SharedClientState","Failed to parse client data for instance '".concat(t,"': ").concat(n)),null)}}]),e}(),ow=function(){function e(t,n){u(this,e),this.clientId=t,this.onlineState=n}return l(e,null,[{key:"Zi",value:function(t){var n=JSON.parse(t);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new e(n.clientId,n.onlineState):(Fd("SharedClientState","Failed to parse online state: ".concat(t)),null)}}]),e}(),uw=function(){function e(){u(this,e),this.activeTargetIds=xm()}return l(e,[{key:"er",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"nr",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"tr",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),sw=function(){function e(t,n,r,i,a){u(this,e),this.window=t,this.Hs=n,this.persistenceKey=r,this.sr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ir=this.rr.bind(this),this.ur=new Kv(np),this.started=!1,this.cr=[];var o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.ar=ew(this.persistenceKey,this.sr),this.hr=function(e){return"firestore_sequence_number_".concat(e)}(this.persistenceKey),this.ur=this.ur.insert(this.sr,new uw),this.lr=new RegExp("^firestore_clients_".concat(o,"_([^_]*)$")),this.dr=new RegExp("^firestore_mutations_".concat(o,"_(\\d+)(?:_(.*))?$")),this._r=new RegExp("^firestore_targets_".concat(o,"_(\\d+)$")),this.wr=function(e){return"firestore_online_state_".concat(e)}(this.persistenceKey),this.mr=function(e){return"firestore_bundle_loaded_v2_".concat(e)}(this.persistenceKey),this.window.addEventListener("storage",this.ir)}return l(e,[{key:"start",value:function(){var e=h(o().mark((function e(){var t,n,r,i,a,u,s,c,l,f,h,d=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.syncEngine.vi();case 2:t=e.sent,n=y(t),e.prev=4,n.s();case 6:if((r=n.n()).done){e.next=14;break}if((i=r.value)!==this.sr){e.next=10;break}return e.abrupt("continue",12);case 10:(a=this.getItem(ew(this.persistenceKey,i)))&&(u=aw.Zi(i,a))&&(this.ur=this.ur.insert(u.clientId,u));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),n.e(e.t0);case 19:return e.prev=19,n.f(),e.finish(19);case 22:this.gr(),(s=this.storage.getItem(this.wr))&&(c=this.yr(s))&&this.pr(c),l=y(this.cr);try{for(l.s();!(f=l.n()).done;)h=f.value,this.rr(h)}catch(o){l.e(o)}finally{l.f()}this.cr=[],this.window.addEventListener("pagehide",(function(){return d.shutdown()})),this.started=!0;case 28:case"end":return e.stop()}}),e,this,[[4,16,19,22]])})));return function(){return e.apply(this,arguments)}}()},{key:"writeSequenceNumber",value:function(e){this.setItem(this.hr,JSON.stringify(e))}},{key:"getAllActiveQueryTargets",value:function(){return this.Ir(this.ur)}},{key:"isActiveQueryTarget",value:function(e){var t=!1;return this.ur.forEach((function(n,r){r.activeTargetIds.has(e)&&(t=!0)})),t}},{key:"addPendingMutation",value:function(e){this.Tr(e,"pending")}},{key:"updateMutationState",value:function(e,t,n){this.Tr(e,t,n),this.Er(e)}},{key:"addLocalQueryTarget",value:function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(nw(this.persistenceKey,e));if(n){var r=iw.Zi(e,n);r&&(t=r.state)}}return this.Ar.er(e),this.gr(),t}},{key:"removeLocalQueryTarget",value:function(e){this.Ar.nr(e),this.gr()}},{key:"isLocalQueryTarget",value:function(e){return this.Ar.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){this.removeItem(nw(this.persistenceKey,e))}},{key:"updateQueryState",value:function(e,t,n){this.Rr(e,t,n)}},{key:"handleUserChange",value:function(e,t,n){var r=this;t.forEach((function(e){r.Er(e)})),this.currentUser=e,n.forEach((function(e){r.addPendingMutation(e)}))}},{key:"setOnlineState",value:function(e){this.br(e)}},{key:"notifyBundleLoaded",value:function(e){this.Pr(e)}},{key:"shutdown",value:function(){this.started&&(this.window.removeEventListener("storage",this.ir),this.removeItem(this.ar),this.started=!1)}},{key:"getItem",value:function(e){var t=this.storage.getItem(e);return Md("SharedClientState","READ",e,t),t}},{key:"setItem",value:function(e,t){Md("SharedClientState","SET",e,t),this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){Md("SharedClientState","REMOVE",e),this.storage.removeItem(e)}},{key:"rr",value:function(e){var t=this,n=e;if(n.storageArea===this.storage){if(Md("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ar)return void Fd("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Hs.enqueueRetryable(h(o().mark((function e(){var r,i,a,u,s,c,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.started){e.next=43;break}if(null===n.key){e.next=41;break}if(!t.lr.test(n.key)){e.next=11;break}if(null!=n.newValue){e.next=6;break}return r=t.vr(n.key),e.abrupt("return",t.Vr(r,null));case 6:if(!(i=t.Sr(n.key,n.newValue))){e.next=9;break}return e.abrupt("return",t.Vr(i.clientId,i));case 9:e.next=41;break;case 11:if(!t.dr.test(n.key)){e.next=18;break}if(null===n.newValue){e.next=16;break}if(!(a=t.Dr(n.key,n.newValue))){e.next=16;break}return e.abrupt("return",t.Cr(a));case 16:e.next=41;break;case 18:if(!t._r.test(n.key)){e.next=25;break}if(null===n.newValue){e.next=23;break}if(!(u=t.Nr(n.key,n.newValue))){e.next=23;break}return e.abrupt("return",t.kr(u));case 23:e.next=41;break;case 25:if(n.key!==t.wr){e.next=32;break}if(null===n.newValue){e.next=30;break}if(!(s=t.yr(n.newValue))){e.next=30;break}return e.abrupt("return",t.pr(s));case 30:e.next=41;break;case 32:if(n.key!==t.hr){e.next=37;break}c=function(e){var t=Fp.at;if(null!=e)try{var n=JSON.parse(e);qd("number"==typeof n),t=n}catch(e){Fd("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(n.newValue),c!==Fp.at&&t.sequenceNumberHandler(c),e.next=41;break;case 37:if(n.key!==t.mr){e.next=41;break}return l=t.Or(n.newValue),e.next=41,Promise.all(l.map((function(e){return t.syncEngine.Mr(e)})));case 41:e.next=44;break;case 43:t.cr.push(n);case 44:case"end":return e.stop()}}),e)}))))}}},{key:"Ar",get:function(){return this.ur.get(this.sr)}},{key:"gr",value:function(){this.setItem(this.ar,this.Ar.tr())}},{key:"Tr",value:function(e,t,n){var r=new rw(this.currentUser,e,t,n),i=tw(this.persistenceKey,this.currentUser,e);this.setItem(i,r.tr())}},{key:"Er",value:function(e){var t=tw(this.persistenceKey,this.currentUser,e);this.removeItem(t)}},{key:"br",value:function(e){var t={clientId:this.sr,onlineState:e};this.storage.setItem(this.wr,JSON.stringify(t))}},{key:"Rr",value:function(e,t,n){var r=nw(this.persistenceKey,e),i=new iw(e,t,n);this.setItem(r,i.tr())}},{key:"Pr",value:function(e){var t=JSON.stringify(Array.from(e));this.setItem(this.mr,t)}},{key:"vr",value:function(e){var t=this.lr.exec(e);return t?t[1]:null}},{key:"Sr",value:function(e,t){var n=this.vr(e);return aw.Zi(n,t)}},{key:"Dr",value:function(e,t){var n=this.dr.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return rw.Zi(new Pd(i),r,t)}},{key:"Nr",value:function(e,t){var n=this._r.exec(e),r=Number(n[1]);return iw.Zi(r,t)}},{key:"yr",value:function(e){return ow.Zi(e)}},{key:"Or",value:function(e){return JSON.parse(e)}},{key:"Cr",value:function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.user.uid!==this.currentUser.uid){e.next=2;break}return e.abrupt("return",this.syncEngine.Fr(t.batchId,t.state,t.error));case 2:Md("SharedClientState","Ignoring mutation for non-active user ".concat(t.user.uid));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"kr",value:function(e){return this.syncEngine.$r(e.targetId,e.state,e.error)}},{key:"Vr",value:function(e,t){var n=this,r=t?this.ur.insert(e,t):this.ur.remove(e),i=this.Ir(this.ur),a=this.Ir(r),o=[],u=[];return a.forEach((function(e){i.has(e)||o.push(e)})),i.forEach((function(e){a.has(e)||u.push(e)})),this.syncEngine.Br(o,u).then((function(){n.ur=r}))}},{key:"pr",value:function(e){this.ur.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}},{key:"Ir",value:function(e){var t=xm();return e.forEach((function(e,n){t=t.unionWith(n.activeTargetIds)})),t}}],[{key:"C",value:function(e){return!(!e||!e.localStorage)}}]),e}(),cw=function(){function e(){u(this,e),this.Lr=new uw,this.qr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return l(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Lr.er(e),this.qr[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.qr[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Lr.nr(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Lr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.qr[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Lr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Lr.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Lr=new uw,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),e}(),lw=function(){function e(){u(this,e)}return l(e,[{key:"Ur",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),fw=function(){function e(){var t=this;u(this,e),this.Kr=function(){return t.Gr()},this.Qr=function(){return t.jr()},this.Wr=[],this.zr()}return l(e,[{key:"Ur",value:function(e){this.Wr.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}},{key:"zr",value:function(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}},{key:"Gr",value:function(){Md("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=y(this.Wr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"jr",value:function(){Md("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=y(this.Wr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"C",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),hw={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},dw=function(){function e(t){u(this,e),this.Hr=t.Hr,this.Jr=t.Jr}return l(e,[{key:"Yr",value:function(e){this.Xr=e}},{key:"Zr",value:function(e){this.eo=e}},{key:"onMessage",value:function(e){this.no=e}},{key:"close",value:function(){this.Jr()}},{key:"send",value:function(e){this.Hr(e)}},{key:"so",value:function(){this.Xr()}},{key:"io",value:function(e){this.eo(e)}},{key:"ro",value:function(e){this.no(e)}}]),e}(),pw=function(e){_(n,e);var t=T(n);function n(e){var r;return u(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r}return l(n,[{key:"fo",value:function(e,t,n,r){return new Promise((function(i,a){var o=new Rd;o.setWithCredentials(!0),o.listenOnce(Sd.COMPLETE,(function(){try{switch(o.getLastErrorCode()){case Id.NO_ERROR:var t=o.getResponseJson();Md("Connection","XHR received:",JSON.stringify(t)),i(t);break;case Id.TIMEOUT:Md("Connection",'RPC "'+e+'" timed out'),a(new Wd(zd.DEADLINE_EXCEEDED,"Request time out"));break;case Id.HTTP_ERROR:var n=o.getStatus();if(Md("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson();Array.isArray(r)&&(r=r[0]);var u=null==r?void 0:r.error;if(u&&u.status&&u.message){var s=function(e){var t=e.toLowerCase().replace(/_/g,"-");return Object.values(zd).indexOf(t)>=0?t:zd.UNKNOWN}(u.status);a(new Wd(s,u.message))}else a(new Wd(zd.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new Wd(zd.UNAVAILABLE,"Connection failed."));break;default:Vd()}}finally{Md("Connection",'RPC "'+e+'" completed.')}}));var u=JSON.stringify(r);o.send(t,"POST",u,n,15)}))}},{key:"wo",value:function(e,t,n){var r=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=_d(),a=xd(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new Cd({})),this.lo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;var u=r.join("");Md("Connection","Creating WebChannel: "+u,o);var s=i.createWebChannel(u,o),c=!1,l=!1,f=new dw({Hr:function(e){l?Md("Connection","Not sending because WebChannel is closed:",e):(c||(Md("Connection","Opening WebChannel transport."),s.open(),c=!0),Md("Connection","WebChannel sending:",e),s.send(e))},Jr:function(){return s.close()}}),h=function(e,t,n){e.listen(t,(function(e){try{n(e)}catch(e){setTimeout((function(){throw e}),0)}}))};return h(s,Nd.EventType.OPEN,(function(){l||Md("Connection","WebChannel transport opened.")})),h(s,Nd.EventType.CLOSE,(function(){l||(l=!0,Md("Connection","WebChannel transport closed"),f.io())})),h(s,Nd.EventType.ERROR,(function(e){l||(l=!0,Ud("Connection","WebChannel transport errored:",e),f.io(new Wd(zd.UNAVAILABLE,"The operation could not be completed")))})),h(s,Nd.EventType.MESSAGE,(function(e){var t;if(!l){var n=e.data[0];qd(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){Md("Connection","WebChannel received error:",i);var a=i.status,o=function(e){var t=rm[e];if(void 0!==t)return cm(t)}(a),u=i.message;void 0===o&&(o=zd.INTERNAL,u="Unknown error status: "+a+" with message "+i.message),l=!0,f.io(new Wd(o,u)),s.close()}else Md("Connection","WebChannel received:",n),f.ro(n)}})),h(a,Td.STAT_EVENT,(function(e){e.stat===Ed.PROXY?Md("Connection","Detected buffering proxy"):e.stat===Ed.NOPROXY&&Md("Connection","Detected no buffering proxy")})),setTimeout((function(){f.so()}),0),f}}]),n}(function(){function e(t){u(this,e),this.databaseInfo=t,this.databaseId=t.databaseId;var n=t.ssl?"https":"http";this.oo=n+"://"+t.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return l(e,[{key:"co",get:function(){return!1}},{key:"ao",value:function(e,t,n,r,i){var a=this.ho(e,t);Md("RestConnection","Sending: ",a,n);var o={};return this.lo(o,r,i),this.fo(e,a,o,n).then((function(e){return Md("RestConnection","Received: ",e),e}),(function(t){throw Ud("RestConnection","".concat(e," failed with error: "),t,"url: ",a,"request:",n),t}))}},{key:"_o",value:function(e,t,n,r,i,a){return this.ao(e,t,n,r,i)}},{key:"lo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Dd,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((function(t,n){return e[n]=t})),n&&n.headers.forEach((function(t,n){return e[n]=t}))}},{key:"ho",value:function(e,t){var n=hw[e];return"".concat(this.oo,"/v1/").concat(t,":").concat(n)}}]),e}());function vw(){return"undefined"!=typeof window?window:null}function yw(){return"undefined"!=typeof document?document:null}function mw(e){return new Mm(e,!0)}var gw=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;u(this,e),this.Hs=t,this.timerId=n,this.mo=r,this.yo=i,this.po=a,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}return l(e,[{key:"reset",value:function(){this.Io=0}},{key:"Ao",value:function(){this.Io=this.po}},{key:"Ro",value:function(e){var t=this;this.cancel();var n=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),i=Math.max(0,n-r);i>0&&Md("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.Io," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.To=this.Hs.enqueueAfterDelay(this.timerId,i,(function(){return t.Eo=Date.now(),e()})),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}},{key:"Po",value:function(){null!==this.To&&(this.To.skipDelay(),this.To=null)}},{key:"cancel",value:function(){null!==this.To&&(this.To.cancel(),this.To=null)}},{key:"bo",value:function(){return(Math.random()-.5)*this.Io}}]),e}(),kw=function(){function e(t,n,r,i,a,o,s,c){u(this,e),this.Hs=t,this.vo=r,this.Vo=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=c,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new gw(t,n)}return l(e,[{key:"No",value:function(){return 1===this.state||5===this.state||this.ko()}},{key:"ko",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.Oo()}},{key:"stop",value:function(){var e=h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.No(),!e.t0){e.next=4;break}return e.next=4,this.close(0);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Mo",value:function(){this.state=0,this.xo.reset()}},{key:"Fo",value:function(){var e=this;this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,(function(){return e.$o()})))}},{key:"Bo",value:function(e){this.Lo(),this.stream.send(e)}},{key:"$o",value:function(){var e=h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.ko()){e.next=2;break}return e.abrupt("return",this.close(0));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Lo",value:function(){this.Do&&(this.Do.cancel(),this.Do=null)}},{key:"qo",value:function(){this.Co&&(this.Co.cancel(),this.Co=null)}},{key:"close",value:function(){var e=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.Lo(),this.qo(),this.xo.cancel(),this.So++,4!==t?this.xo.reset():n&&n.code===zd.RESOURCE_EXHAUSTED?(Fd(n.toString()),Fd("Using maximum backoff delay to prevent overloading the backend."),this.xo.Ao()):n&&n.code===zd.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Uo(),this.stream.close(),this.stream=null),this.state=t,e.next=9,this.listener.Zr(n);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"Uo",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Ko(this.So),n=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((function(t){var r=k(t,2),i=r[0],a=r[1];e.So===n&&e.Go(i,a)}),(function(n){t((function(){var t=new Wd(zd.UNKNOWN,"Fetching auth token failed: "+n.message);return e.Qo(t)}))}))}},{key:"Go",value:function(e,t){var n=this,r=this.Ko(this.So);this.stream=this.jo(e,t),this.stream.Yr((function(){r((function(){return n.state=2,n.Co=n.Hs.enqueueAfterDelay(n.Vo,1e4,(function(){return n.ko()&&(n.state=3),Promise.resolve()})),n.listener.Yr()}))})),this.stream.Zr((function(e){r((function(){return n.Qo(e)}))})),this.stream.onMessage((function(e){r((function(){return n.onMessage(e)}))}))}},{key:"Oo",value:function(){var e=this;this.state=5,this.xo.Ro(h(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}}),t)}))))}},{key:"Qo",value:function(e){return Md("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Ko",value:function(e){var t=this;return function(n){t.Hs.enqueueAndForget((function(){return t.So===e?n():(Md("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}}}]),e}(),bw=function(e){_(n,e);var t=T(n);function n(e,r,i,a,o,s){var c;return u(this,n),(c=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,a,s)).yt=o,c}return l(n,[{key:"jo",value:function(e,t){return this.connection.wo("Listen",e,t)}},{key:"onMessage",value:function(e){this.xo.reset();var t=function(e,t){var n;if("targetChange"in t){t.targetChange;var r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Vd()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],a=function(e,t){return e.wt?(qd(void 0===t||"string"==typeof t),Hp.fromBase64String(t||"")):(qd(void 0===t||t instanceof Uint8Array),Hp.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,u=o&&function(e){var t=void 0===e.code?zd.UNKNOWN:cm(e.code);return new Wd(t,e.message||"")}(o);n=new Cm(r,i,a,u||null)}else if("documentChange"in t){t.documentChange;var s=t.documentChange;s.document,s.document.name,s.document.updateTime;var c=Wm(e,s.document.name),l=Vm(s.document.updateTime),f=s.document.createTime?Vm(s.document.createTime):op.min(),h=new Jv({mapValue:{fields:s.document.fields}}),d=ey.newFoundDocument(c,l,f,h),p=s.targetIds||[],v=s.removedTargetIds||[];n=new Tm(p,v,d.key,d)}else if("documentDelete"in t){t.documentDelete;var y=t.documentDelete;y.document;var m=Wm(e,y.document),g=y.readTime?Vm(y.readTime):op.min(),k=ey.newNoDocument(m,g),b=y.removedTargetIds||[];n=new Tm([],b,k.key,k)}else if("documentRemove"in t){t.documentRemove;var w=t.documentRemove;w.document;var _=Wm(e,w.document),x=w.removedTargetIds||[];n=new Tm([],x,_,null)}else{if(!("filter"in t))return Vd();t.filter;var I=t.filter;I.targetId;var S=I.count||0,T=new um(S),E=I.targetId;n=new Em(E,T)}return n}(this.yt,e),n=function(e){if(!("targetChange"in e))return op.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?op.min():t.readTime?Vm(t.readTime):op.min()}(e);return this.listener.Wo(t,n)}},{key:"zo",value:function(e){var t={};t.database=Gm(this.yt),t.addTarget=function(e,t){var n,r=t.target;return(n=ay(r)?{documents:eg(e,r)}:{query:tg(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=Um(e,t.resumeToken):t.snapshotVersion.compareTo(op.min())>0&&(n.readTime=Fm(e,t.snapshotVersion.toTimestamp())),n}(this.yt,e);var n=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Vd()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.yt,e);n&&(t.labels=n),this.Bo(t)}},{key:"Ho",value:function(e){var t={};t.database=Gm(this.yt),t.removeTarget=e,this.Bo(t)}}]),n}(kw),ww=function(e){_(n,e);var t=T(n);function n(e,r,i,a,o,s){var c;return u(this,n),(c=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,a,s)).yt=o,c.Jo=!1,c}return l(n,[{key:"Yo",get:function(){return this.Jo}},{key:"start",value:function(){this.Jo=!1,this.lastStreamToken=void 0,tn(x(n.prototype),"start",this).call(this)}},{key:"Uo",value:function(){this.Jo&&this.Xo([])}},{key:"jo",value:function(e,t){return this.connection.wo("Write",e,t)}},{key:"onMessage",value:function(e){if(qd(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();var t=function(e,t){return e&&e.length>0?(qd(void 0!==t),e.map((function(e){return function(e,t){var n=e.updateTime?Vm(e.updateTime):Vm(t);return n.isEqual(op.min())&&(n=Vm(t)),new zy(n,e.transformResults||[])}(e,t)}))):[]}(e.writeResults,e.commitTime),n=Vm(e.commitTime);return this.listener.Zo(n,t)}return qd(!e.writeResults||0===e.writeResults.length),this.Jo=!0,this.listener.tu()}},{key:"eu",value:function(){var e={};e.database=Gm(this.yt),this.Bo(e)}},{key:"Xo",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map((function(e){return Jm(t.yt,e)}))};this.Bo(n)}}]),n}(kw),_w=function(e){_(n,e);var t=T(n);function n(e,r,i,a){var o;return u(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.connection=i,o.yt=a,o.nu=!1,o}return l(n,[{key:"su",value:function(){if(this.nu)throw new Wd(zd.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"ao",value:function(e,t,n){var r=this;return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(i){var a=k(i,2),o=a[0],u=a[1];return r.connection.ao(e,t,n,o,u)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===zd.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new Wd(zd.UNKNOWN,e.toString())}))}},{key:"_o",value:function(e,t,n,r){var i=this;return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(a){var o=k(a,2),u=o[0],s=o[1];return i.connection._o(e,t,n,u,s,r)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===zd.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),e):new Wd(zd.UNKNOWN,e.toString())}))}},{key:"terminate",value:function(){this.nu=!0}}]),n}(function(){return l((function e(){u(this,e)}))}());var xw=function(){function e(t,n){u(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}return l(e,[{key:"uu",value:function(){var e=this;0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return e.ru=null,e.au("Backend didn't respond within 10 seconds."),e.cu("Offline"),Promise.resolve()})))}},{key:"hu",value:function(e){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.cu("Offline")))}},{key:"set",value:function(e){this.lu(),this.iu=0,"Online"===e&&(this.ou=!1),this.cu(e)}},{key:"cu",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"au",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.ou?(Fd(t),this.ou=!1):Md("OnlineStateTracker",t)}},{key:"lu",value:function(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}]),e}(),Iw=l((function e(t,n,r,i,a){var s=this;u(this,e),this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=a,this.mu.Ur((function(e){r.enqueueAndForget(h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=Lw(s),!e.t0){e.next=5;break}return Md("RemoteStore","Restarting streams for network reachability change."),e.next=5,function(){var e=h(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Bd(t))._u.add(4),e.next=4,Ew(n);case 4:return n.gu.set("Unknown"),n._u.delete(4),e.next=8,Sw(n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(s);case 5:case"end":return e.stop()}}),e)}))))})),this.gu=new xw(r,i)}));function Sw(e){return Tw.apply(this,arguments)}function Tw(){return Tw=h(o().mark((function e(t){var n,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Lw(t)){e.next=18;break}n=y(t.wu),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[2,12,15,18]])}))),Tw.apply(this,arguments)}function Ew(e){return Cw.apply(this,arguments)}function Cw(){return Cw=h(o().mark((function e(t){var n,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=y(t.wu),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,i(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])}))),Cw.apply(this,arguments)}function Nw(e,t){var n=Bd(e);n.du.has(t.targetId)||(n.du.set(t.targetId,t),Ow(n)?Dw(n):l_(n).ko()&&Aw(n,t))}function Rw(e,t){var n=Bd(e),r=l_(n);n.du.delete(t),r.ko()&&Pw(n,t),0===n.du.size&&(r.ko()?r.Fo():Lw(n)&&n.gu.set("Unknown"))}function Aw(e,t){e.yu.Ot(t.targetId),l_(e).zo(t)}function Pw(e,t){e.yu.Ot(t),l_(e).Ho(t)}function Dw(e){e.yu=new Rm({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},ne:function(t){return e.du.get(t)||null}}),l_(e).start(),e.gu.uu()}function Ow(e){return Lw(e)&&!l_(e).No()&&e.du.size>0}function Lw(e){return 0===Bd(e)._u.size}function Mw(e){e.yu=void 0}function Fw(e){return Uw.apply(this,arguments)}function Uw(){return Uw=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.du.forEach((function(e,n){Aw(t,e)}));case 1:case"end":return e.stop()}}),e)}))),Uw.apply(this,arguments)}function jw(e,t){return Vw.apply(this,arguments)}function Vw(){return Vw=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Mw(t),Ow(t)?(t.gu.hu(n),Dw(t)):t.gu.set("Unknown");case 1:case"end":return e.stop()}}),e)}))),Vw.apply(this,arguments)}function qw(e,t,n){return Bw.apply(this,arguments)}function Bw(){return Bw=h(o().mark((function e(t,n,r){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.gu.set("Online"),!(n instanceof Cm&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,function(){var e=h(o().mark((function e(t,n){var r,i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,i=y(n.targetIds),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=14;break}if(u=a.value,e.t0=t.du.has(u),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(u,r);case 10:t.du.delete(u),t.yu.removeTarget(u);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[2,16,19,22]])})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),Md("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,zw(t,e.t0);case 11:case 22:e.next=29;break;case 13:if(n instanceof Tm?t.yu.Kt(n):n instanceof Em?t.yu.Jt(n):t.yu.jt(n),r.isEqual(op.min())){e.next=29;break}return e.prev=14,e.next=17,jb(t.localStore);case 17:if(i=e.sent,e.t1=r.compareTo(i)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.yu.Zt(t);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.du.get(r);i&&e.du.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((function(t){var n=e.du.get(t);if(n){e.du.set(t,n.withResumeToken(Hp.EMPTY_BYTE_STRING,n.snapshotVersion)),Pw(e,t);var r=new Wg(n.target,t,1,n.sequenceNumber);Aw(e,r)}})),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 24:return e.prev=24,e.t2=e.catch(14),Md("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,zw(t,e.t2);case 29:case"end":return e.stop()}}),e,null,[[1,6],[14,24]])}))),Bw.apply(this,arguments)}function zw(e,t,n){return Ww.apply(this,arguments)}function Ww(){return Ww=h(o().mark((function e(t,n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Rp(n)){e.next=2;break}throw n;case 2:return t._u.add(1),e.next=5,Ew(t);case 5:t.gu.set("Offline"),r||(r=function(){return jb(t.localStore)}),t.asyncQueue.enqueueRetryable(h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Md("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t._u.delete(1),e.next=6,Sw(t);case 6:case"end":return e.stop()}}),e)}))));case 8:case"end":return e.stop()}}),e)}))),Ww.apply(this,arguments)}function Kw(e,t){return t().catch((function(n){return zw(e,n,t)}))}function Hw(e){return Gw.apply(this,arguments)}function Gw(){return Gw=h(o().mark((function e(t){var n,r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Bd(t),r=f_(n),i=n.fu.length>0?n.fu[n.fu.length-1].batchId:-1;case 2:if(!Qw(n)){e.next=19;break}return e.prev=3,e.next=6,Bb(n.localStore,i);case 6:if(null!==(a=e.sent)){e.next=10;break}return 0===n.fu.length&&r.Fo(),e.abrupt("break",19);case 10:i=a.batchId,$w(n,a),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,zw(n,e.t0);case 17:e.next=2;break;case 19:Yw(n)&&Xw(n);case 20:case"end":return e.stop()}}),e,null,[[3,13]])}))),Gw.apply(this,arguments)}function Qw(e){return Lw(e)&&e.fu.length<10}function $w(e,t){e.fu.push(t);var n=f_(e);n.ko()&&n.Yo&&n.Xo(t.mutations)}function Yw(e){return Lw(e)&&!f_(e).No()&&e.fu.length>0}function Xw(e){f_(e).start()}function Jw(e){return Zw.apply(this,arguments)}function Zw(){return Zw=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f_(t).eu();case 1:case"end":return e.stop()}}),e)}))),Zw.apply(this,arguments)}function e_(e){return t_.apply(this,arguments)}function t_(){return t_=h(o().mark((function e(t){var n,r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=f_(t),r=y(t.fu);try{for(r.s();!(i=r.n()).done;)a=i.value,n.Xo(a.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}}),e)}))),t_.apply(this,arguments)}function n_(e,t,n){return r_.apply(this,arguments)}function r_(){return r_=h(o().mark((function e(t,n,r){var i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.fu.shift(),a=Bg.from(i,n,r),e.next=3,Kw(t,(function(){return t.remoteSyncer.applySuccessfulWrite(a)}));case 3:return e.next=5,Hw(t);case 5:case"end":return e.stop()}}),e)}))),r_.apply(this,arguments)}function i_(e,t){return a_.apply(this,arguments)}function a_(){return a_=h(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&f_(t).Yo,!e.t0){e.next=4;break}return e.next=4,function(){var e=h(o().mark((function e(t,n){var r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!sm(i=n.code)||i===zd.ABORTED){e.next=7;break}return r=t.fu.shift(),f_(t).Mo(),e.next=5,Kw(t,(function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)}));case 5:return e.next=7,Hw(t);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:Yw(t)&&Xw(t);case 5:case"end":return e.stop()}}),e)}))),a_.apply(this,arguments)}function o_(e,t){return u_.apply(this,arguments)}function u_(){return u_=h(o().mark((function e(t,n){var r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Bd(t)).asyncQueue.verifyOperationInProgress(),Md("RemoteStore","RemoteStore received new credentials"),i=Lw(r),r._u.add(3),e.next=6,Ew(r);case 6:return i&&r.gu.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r._u.delete(3),e.next=12,Sw(r);case 12:case"end":return e.stop()}}),e)}))),u_.apply(this,arguments)}function s_(e,t){return c_.apply(this,arguments)}function c_(){return c_=h(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Bd(t),!n){e.next=7;break}return r._u.delete(2),e.next=5,Sw(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r._u.add(2),e.next=12,Ew(r);case 12:r.gu.set("Unknown");case 13:case"end":return e.stop()}}),e)}))),c_.apply(this,arguments)}function l_(e){return e.pu||(e.pu=function(e,t,n){var r=Bd(e);return r.su(),new bw(t,r.connection,r.authCredentials,r.appCheckCredentials,r.yt,n)}(e.datastore,e.asyncQueue,{Yr:Fw.bind(null,e),Zr:jw.bind(null,e),Wo:qw.bind(null,e)}),e.wu.push(function(){var t=h(o().mark((function t(n){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.pu.Mo(),Ow(e)?Dw(e):e.gu.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.pu.stop();case 6:Mw(e);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.pu}function f_(e){return e.Iu||(e.Iu=function(e,t,n){var r=Bd(e);return r.su(),new ww(t,r.connection,r.authCredentials,r.appCheckCredentials,r.yt,n)}(e.datastore,e.asyncQueue,{Yr:Jw.bind(null,e),Zr:i_.bind(null,e),tu:e_.bind(null,e),Zo:n_.bind(null,e)}),e.wu.push(function(){var t=h(o().mark((function t(n){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.Iu.Mo(),t.next=4,Hw(e);case 4:t.next=9;break;case 6:return t.next=8,e.Iu.stop();case 8:e.fu.length>0&&(Md("RemoteStore","Stopping write stream with ".concat(e.fu.length," pending writes")),e.fu=[]);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.Iu}var h_=function(){function e(t,n,r,i,a){u(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Kd,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}return l(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Wd(zd.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}))}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}}]),e}();function d_(e,t){if(Fd("AsyncQueue","".concat(t,": ").concat(e)),Rp(e))return new Wd(zd.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var p_=function(){function e(t){u(this,e),this.comparator=t?function(e,n){return t(e,n)||fp.comparator(e.key,n.key)}:function(e,t){return fp.comparator(e.key,t.key)},this.keyedMap=pm(),this.sortedSet=new Kv(this.comparator)}return l(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),v_=function(){function e(){u(this,e),this.Tu=new Kv(fp.comparator)}return l(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.Tu.get(t);n?0!==e.type&&3===n.type?this.Tu=this.Tu.insert(t,e):3===e.type&&1!==n.type?this.Tu=this.Tu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Tu=this.Tu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Tu=this.Tu.remove(t):1===e.type&&2===n.type?this.Tu=this.Tu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):Vd():this.Tu=this.Tu.insert(t,e)}},{key:"Eu",value:function(){var e=[];return this.Tu.inorderTraversal((function(t,n){e.push(n)})),e}}]),e}(),y_=function(){function e(t,n,r,i,a,o,s,c,l){u(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=c,this.hasCachedResults=l}return l(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&by(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i,a){var o=[];return n.forEach((function(e){o.push({type:0,doc:e})})),new e(t,n,p_.emptySet(n),o,r,i,!0,!1,a)}}]),e}(),m_=l((function e(){u(this,e),this.Au=void 0,this.listeners=[]})),g_=l((function e(){u(this,e),this.queries=new lm((function(e){return wy(e)}),by),this.onlineState="Unknown",this.Ru=new Set}));function k_(e,t){return b_.apply(this,arguments)}function b_(){return b_=h(o().mark((function e(t,n){var r,i,a,u,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Bd(t),i=n.query,a=!1,(u=r.queries.get(i))||(a=!0,u=new m_),!a){e.next=13;break}return e.prev=3,e.next=6,r.onListen(i);case 6:u.Au=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),s=d_(e.t0,"Initialization of query '".concat(_y(n.query),"' failed")),e.abrupt("return",void n.onError(s));case 13:r.queries.set(i,u),u.listeners.push(n),n.bu(r.onlineState),u.Au&&n.Pu(u.Au)&&S_(r);case 14:case"end":return e.stop()}}),e,null,[[3,9]])}))),b_.apply(this,arguments)}function w_(e,t){return __.apply(this,arguments)}function __(){return __=h(o().mark((function e(t,n){var r,i,a,u,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Bd(t),i=n.query,a=!1,(u=r.queries.get(i))&&(s=u.listeners.indexOf(n))>=0&&(u.listeners.splice(s,1),a=0===u.listeners.length),!a){e.next=6;break}return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return e.stop()}}),e)}))),__.apply(this,arguments)}function x_(e,t){var n,r=Bd(e),i=!1,a=y(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,u=o.query,s=r.queries.get(u);if(s){var c,l=y(s.listeners);try{for(l.s();!(c=l.n()).done;){c.value.Pu(o)&&(i=!0)}}catch(f){l.e(f)}finally{l.f()}s.Au=o}}}catch(f){a.e(f)}finally{a.f()}i&&S_(r)}function I_(e,t,n){var r=Bd(e),i=r.queries.get(t);if(i){var a,o=y(i.listeners);try{for(o.s();!(a=o.n()).done;){a.value.onError(n)}}catch(u){o.e(u)}finally{o.f()}}r.queries.delete(t)}function S_(e){e.Ru.forEach((function(e){e.next()}))}var T_=function(){function e(t,n,r){u(this,e),this.query=t,this.vu=n,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=r||{}}return l(e,[{key:"Pu",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=y(e.docChanges);try{for(r.s();!(t=r.n()).done;){var i=t.value;3!==i.type&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}e=new y_(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}var a=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),a=!0):this.Cu(e,this.onlineState)&&(this.xu(e),a=!0),this.Su=e,a}},{key:"onError",value:function(e){this.vu.error(e)}},{key:"bu",value:function(e){this.onlineState=e;var t=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),t=!0),t}},{key:"Cu",value:function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return(!this.options.Nu||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}},{key:"Du",value:function(e){if(e.docChanges.length>0)return!0;var t=this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}},{key:"xu",value:function(e){e=y_.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Vu=!0,this.vu.next(e)}}]),e}(),E_=function(){function e(t,n){u(this,e),this.ku=t,this.byteLength=n}return l(e,[{key:"Ou",value:function(){return"metadata"in this.ku}}]),e}(),C_=function(){function e(t){u(this,e),this.yt=t}return l(e,[{key:"Ji",value:function(e){return Wm(this.yt,e)}},{key:"Yi",value:function(e){return e.metadata.exists?Ym(this.yt,e.document,!1):ey.newNoDocument(this.Ji(e.metadata.name),this.Xi(e.metadata.readTime))}},{key:"Xi",value:function(e){return Vm(e)}}]),e}(),N_=function(){function e(t,n,r){u(this,e),this.Mu=t,this.localStore=n,this.yt=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=R_(t)}return l(e,[{key:"Fu",value:function(e){this.progress.bytesLoaded+=e.byteLength;var t=this.progress.documentsLoaded;if(e.ku.namedQuery)this.queries.push(e.ku.namedQuery);else if(e.ku.documentMetadata){this.documents.push({metadata:e.ku.documentMetadata}),e.ku.documentMetadata.exists||++t;var n=sp.fromString(e.ku.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.ku.document&&(this.documents[this.documents.length-1].document=e.ku.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}},{key:"$u",value:function(e){var t,n=new Map,r=new C_(this.yt),i=y(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a.metadata.queries){var o,u=r.Ji(a.metadata.name),s=y(a.metadata.queries);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=(n.get(c)||wm()).add(u);n.set(c,l)}}catch(f){s.e(f)}finally{s.f()}}}}catch(f){i.e(f)}finally{i.f()}return n}},{key:"complete",value:function(){var e=h(o().mark((function e(){var t,n,r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Yb(this.localStore,new C_(this.yt),this.documents,this.Mu.id);case 2:t=e.sent,n=this.$u(this.documents),r=y(this.queries),e.prev=5,r.s();case 7:if((i=r.n()).done){e.next=13;break}return a=i.value,e.next=11,Jb(this.localStore,a,n.get(a.name));case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",(this.progress.taskState="Success",{progress:this.progress,Bu:this.collectionGroups,Lu:t}));case 22:case"end":return e.stop()}}),e,this,[[5,15,18,21]])})));return function(){return e.apply(this,arguments)}}()}]),e}();function R_(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}var A_=l((function e(t){u(this,e),this.key=t})),P_=l((function e(t){u(this,e),this.key=t})),D_=function(){function e(t,n){u(this,e),this.query=t,this.qu=n,this.Uu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=wm(),this.mutatedKeys=wm(),this.Gu=Sy(t),this.Qu=new p_(this.Gu)}return l(e,[{key:"ju",get:function(){return this.qu}},{key:"Wu",value:function(e,t){var n=this,r=t?t.zu:new v_,i=t?t.Qu:this.Qu,a=t?t.mutatedKeys:this.mutatedKeys,o=i,u=!1,s="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((function(e,t){var l=i.get(e),f=xy(n.query,t)?t:null,h=!!l&&n.mutatedKeys.has(l.key),d=!!f&&(f.hasLocalMutations||n.mutatedKeys.has(f.key)&&f.hasCommittedMutations),p=!1;l&&f?l.data.isEqual(f.data)?h!==d&&(r.track({type:3,doc:f}),p=!0):n.Hu(l,f)||(r.track({type:2,doc:f}),p=!0,(s&&n.Gu(f,s)>0||c&&n.Gu(f,c)<0)&&(u=!0)):!l&&f?(r.track({type:0,doc:f}),p=!0):l&&!f&&(r.track({type:1,doc:l}),p=!0,(s||c)&&(u=!0)),p&&(f?(o=o.add(f),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))})),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Qu:o,zu:r,$i:u,mutatedKeys:a}}},{key:"Hu",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;var a=e.zu.Eu();a.sort((function(e,t){return function(e,t){var n=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Vd()}};return n(e)-n(t)}(e.type,t.type)||r.Gu(e.doc,t.doc)})),this.Ju(n);var o=t?this.Yu():[],u=0===this.Ku.size&&this.current?1:0,s=u!==this.Uu;return this.Uu=u,0!==a.length||s?{snapshot:new y_(this.query,e.Qu,i,a,e.mutatedKeys,0===u,s,!1,!!n&&n.resumeToken.approximateByteSize()>0),Xu:o}:{Xu:o}}},{key:"bu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new v_,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}},{key:"Zu",value:function(e){return!this.qu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}},{key:"Ju",value:function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t.qu=t.qu.add(e)})),e.modifiedDocuments.forEach((function(e){})),e.removedDocuments.forEach((function(e){return t.qu=t.qu.delete(e)})),this.current=e.current)}},{key:"Yu",value:function(){var e=this;if(!this.current)return[];var t=this.Ku;this.Ku=wm(),this.Qu.forEach((function(t){e.Zu(t.key)&&(e.Ku=e.Ku.add(t.key))}));var n=[];return t.forEach((function(t){e.Ku.has(t)||n.push(new P_(t))})),this.Ku.forEach((function(e){t.has(e)||n.push(new A_(e))})),n}},{key:"tc",value:function(e){this.qu=e.Hi,this.Ku=wm();var t=this.Wu(e.documents);return this.applyChanges(t,!0)}},{key:"ec",value:function(){return y_.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.Uu,this.hasCachedResults)}}]),e}(),O_=l((function e(t,n,r){u(this,e),this.query=t,this.targetId=n,this.view=r})),L_=l((function e(t){u(this,e),this.key=t,this.nc=!1})),M_=function(){function e(t,n,r,i,a,o){u(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.sc={},this.ic=new lm((function(e){return wy(e)}),by),this.rc=new Map,this.oc=new Set,this.uc=new Kv(fp.comparator),this.cc=new Map,this.ac=new yb,this.hc={},this.lc=new Map,this.fc=Hk.vn(),this.onlineState="Unknown",this.dc=void 0}return l(e,[{key:"isPrimaryClient",get:function(){return!0===this.dc}}]),e}();function F_(e,t){return U_.apply(this,arguments)}function U_(){return U_=h(o().mark((function e(t,n){var r,i,a,u,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Rx(t),!(u=r.ic.get(n))){e.next=6;break}i=u.targetId,r.sharedClientState.addLocalQueryTarget(i),a=u.view.ec(),e.next=15;break;case 6:return e.next=8,zb(r.localStore,my(n));case 8:return s=e.sent,r.isPrimaryClient&&Nw(r.remoteStore,s),c=r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.targetId,e.next=14,j_(r,n,i,"current"===c,s.resumeToken);case 14:a=e.sent;case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}}),e)}))),U_.apply(this,arguments)}function j_(e,t,n,r,i){return V_.apply(this,arguments)}function V_(){return V_=h(o().mark((function e(t,n,r,i,a){var u,s,c,l,f,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._c=function(e,n,r){return function(){var e=h(o().mark((function e(t,n,r,i){var a,u,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.view.Wu(r),e.t0=a.$i,!e.t0){e.next=6;break}return e.next=5,Hb(t.localStore,n.query,!1).then((function(e){var t=e.documents;return n.view.Wu(t,a)}));case 5:a=e.sent;case 6:return u=i&&i.targetChanges.get(n.targetId),s=n.view.applyChanges(a,t.isPrimaryClient,u),e.abrupt("return",(ox(t,n.targetId,s.Xu),s.snapshot));case 8:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}()(t,e,n,r)},e.next=3,Hb(t.localStore,n,!0);case 3:return u=e.sent,s=new D_(n,u.Hi),c=s.Wu(u.documents),l=Sm.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==t.onlineState,a),f=s.applyChanges(c,t.isPrimaryClient,l),ox(t,r,f.Xu),d=new O_(n,r,s),e.abrupt("return",(t.ic.set(n,d),t.rc.has(r)?t.rc.get(r).push(n):t.rc.set(r,[n]),f.snapshot));case 11:case"end":return e.stop()}}),e)}))),V_.apply(this,arguments)}function q_(e,t){return B_.apply(this,arguments)}function B_(){return B_=h(o().mark((function e(t,n){var r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Bd(t),i=r.ic.get(n),!((a=r.rc.get(i.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r.rc.set(i.targetId,a.filter((function(e){return!by(e,n)}))),void r.ic.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),e.t0){e.next=9;break}return e.next=9,Wb(r.localStore,i.targetId,!1).then((function(){r.sharedClientState.clearQueryState(i.targetId),Rw(r.remoteStore,i.targetId),ix(r,i.targetId)})).catch(xp);case 9:e.next=14;break;case 11:return ix(r,i.targetId),e.next=14,Wb(r.localStore,i.targetId,!0);case 14:case"end":return e.stop()}}),e)}))),B_.apply(this,arguments)}function z_(e,t,n){return W_.apply(this,arguments)}function W_(){return W_=h(o().mark((function e(t,n,r){var i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Ax(t),e.prev=1,e.next=4,function(e,t){var n,r,i=Bd(e),a=ap.now(),o=t.reduce((function(e,t){return e.add(t.key)}),wm());return i.persistence.runTransaction("Locally write mutations","readwrite",(function(e){var u=hm(),s=wm();return i.Gi.getEntries(e,o).next((function(e){(u=e).forEach((function(e,t){t.isValidDocument()||(s=s.add(e))}))})).next((function(){return i.localDocuments.getOverlayedDocuments(e,u)})).next((function(r){n=r;var o,u=[],s=y(t);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=Yy(c,n.get(c.key).overlayedDocument);null!=l&&u.push(new Zy(c.key,l,Zv(l.value.mapValue),Wy.exists(!0)))}}catch(f){s.e(f)}finally{s.f()}return i.mutationQueue.addMutationBatch(e,a,u,t)})).next((function(t){r=t;var a=t.applyToLocalDocumentSet(n,s);return i.documentOverlayCache.saveOverlays(e,t.batchId,a)}))})).then((function(){return{batchId:r.batchId,changes:vm(n)}}))}(i.localStore,n);case 4:return a=e.sent,i.sharedClientState.addPendingMutation(a.batchId),function(e,t,n){var r=e.hc[e.currentUser.toKey()];r||(r=new Kv(np)),r=r.insert(t,n),e.hc[e.currentUser.toKey()]=r}(i,a.batchId,r),e.next=9,cx(i,a.changes);case 9:return e.next=11,Hw(i.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),u=d_(e.t0,"Failed to persist write"),r.reject(u);case 17:case"end":return e.stop()}}),e,null,[[1,13]])}))),W_.apply(this,arguments)}function K_(e,t){return H_.apply(this,arguments)}function H_(){return H_=h(o().mark((function e(t,n){var r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Bd(t),e.prev=1,e.next=4,Vb(r.localStore,n);case 4:return i=e.sent,n.targetChanges.forEach((function(e,t){var n=r.cc.get(t);n&&(qd(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.nc=!0:e.modifiedDocuments.size>0?qd(n.nc):e.removedDocuments.size>0&&(qd(n.nc),n.nc=!1))})),e.next=8,cx(r,i,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,xp(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,10]])}))),H_.apply(this,arguments)}function G_(e,t,n){var r=Bd(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.ic.forEach((function(e,n){var r=n.view.bu(t);r.snapshot&&i.push(r.snapshot)})),function(e,t){var n=Bd(e);n.onlineState=t;var r=!1;n.queries.forEach((function(e,n){var i,a=y(n.listeners);try{for(a.s();!(i=a.n()).done;){i.value.bu(t)&&(r=!0)}}catch(o){a.e(o)}finally{a.f()}})),r&&S_(n)}(r.eventManager,t),i.length&&r.sc.Wo(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function Q_(e,t,n){return $_.apply(this,arguments)}function $_(){return $_=h(o().mark((function e(t,n,r){var i,a,u,s,c,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=Bd(t)).sharedClientState.updateQueryState(n,"rejected",r),a=i.cc.get(n),!(u=a&&a.key)){e.next=14;break}return s=(s=new Kv(fp.comparator)).insert(u,ey.newNoDocument(u,op.min())),c=wm().add(u),l=new Im(op.min(),new Map,new Qv(np),s,c),e.next=9,K_(i,l);case 9:i.uc=i.uc.remove(u),i.cc.delete(n),sx(i),e.next=16;break;case 14:return e.next=16,Wb(i.localStore,n,!1).then((function(){return ix(i,n,r)})).catch(xp);case 16:case"end":return e.stop()}}),e)}))),$_.apply(this,arguments)}function Y_(e,t){return X_.apply(this,arguments)}function X_(){return X_=h(o().mark((function e(t,n){var r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Bd(t),i=n.batch.batchId,e.prev=1,e.next=4,Ub(r.localStore,n);case 4:return a=e.sent,rx(r,i,null),nx(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),e.next=10,cx(r,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,xp(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])}))),X_.apply(this,arguments)}function J_(e,t,n){return Z_.apply(this,arguments)}function Z_(){return Z_=h(o().mark((function e(t,n,r){var i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Bd(t),e.prev=1,e.next=4,function(e,t){var n=Bd(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next((function(t){return qd(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}(i.localStore,n);case 4:return a=e.sent,rx(i,n,r),nx(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,cx(i,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,xp(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])}))),Z_.apply(this,arguments)}function ex(e,t){return tx.apply(this,arguments)}function tx(){return tx=h(o().mark((function e(t,n){var r,i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Lw((r=Bd(t)).remoteStore)||Md("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),e.prev=2,e.next=5,function(e){var t=Bd(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(e){return t.mutationQueue.getHighestUnacknowledgedBatchId(e)}))}(r.localStore);case 5:if(-1!==(i=e.sent)){e.next=8;break}return e.abrupt("return",void n.resolve());case 8:(a=r.lc.get(i)||[]).push(n),r.lc.set(i,a),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),u=d_(e.t0,"Initialization of waitForPendingWrites() operation failed"),n.reject(u);case 16:case"end":return e.stop()}}),e,null,[[2,12]])}))),tx.apply(this,arguments)}function nx(e,t){(e.lc.get(t)||[]).forEach((function(e){e.resolve()})),e.lc.delete(t)}function rx(e,t,n){var r=Bd(e),i=r.hc[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.hc[r.currentUser.toKey()]=i}}function ix(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,i=y(e.rc.get(t));try{for(i.s();!(r=i.n()).done;){var a=r.value;e.ic.delete(a),n&&e.sc.wc(a,n)}}catch(o){i.e(o)}finally{i.f()}e.rc.delete(t),e.isPrimaryClient&&e.ac.ls(t).forEach((function(t){e.ac.containsKey(t)||ax(e,t)}))}function ax(e,t){e.oc.delete(t.path.canonicalString());var n=e.uc.get(t);null!==n&&(Rw(e.remoteStore,n),e.uc=e.uc.remove(t),e.cc.delete(n),sx(e))}function ox(e,t,n){var r,i=y(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof A_?(e.ac.addReference(a.key,t),ux(e,a)):a instanceof P_?(Md("SyncEngine","Document no longer in limbo: "+a.key),e.ac.removeReference(a.key,t),e.ac.containsKey(a.key)||ax(e,a.key)):Vd()}}catch(o){i.e(o)}finally{i.f()}}function ux(e,t){var n=t.key,r=n.path.canonicalString();e.uc.get(n)||e.oc.has(r)||(Md("SyncEngine","New document in limbo: "+n),e.oc.add(r),sx(e))}function sx(e){for(;e.oc.size>0&&e.uc.size<e.maxConcurrentLimboResolutions;){var t=e.oc.values().next().value;e.oc.delete(t);var n=new fp(sp.fromString(t)),r=e.fc.next();e.cc.set(r,new L_(n)),e.uc=e.uc.insert(n,r),Nw(e.remoteStore,new Wg(my(fy(n.path)),r,2,Fp.at))}}function cx(e,t,n){return lx.apply(this,arguments)}function lx(){return lx=h(o().mark((function e(t,n,r){var i,a,u,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Bd(t),a=[],u=[],s=[],e.t0=i.ic.isEmpty(),e.t0){e.next=9;break}return i.ic.forEach((function(e,t){s.push(i._c(t,n,r).then((function(e){if((e||r)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(t.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){a.push(e);var n=Pb.Ci(t.targetId,e);u.push(n)}})))})),e.next=6,Promise.all(s);case 6:return i.sc.Wo(a),e.next=9,function(){var e=h(o().mark((function e(t,n){var r,i,a,u,s,c,l,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Bd(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(e){return Sp.forEach(n,(function(t){return Sp.forEach(t.Si,(function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)})).next((function(){return Sp.forEach(t.Di,(function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)}))}))}))}));case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),Rp(e.t0)){e.next=10;break}throw e.t0;case 10:Md("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:i=y(n);try{for(i.s();!(a=i.n()).done;)u=a.value,s=u.targetId,u.fromCache||(c=r.qi.get(s),l=c.snapshotVersion,f=c.withLastLimboFreeSnapshotVersion(l),r.qi=r.qi.insert(s,f))}catch(o){i.e(o)}finally{i.f()}case 13:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}()(i.localStore,u);case 9:case"end":return e.stop()}}),e)}))),lx.apply(this,arguments)}function fx(e,t){return hx.apply(this,arguments)}function hx(){return hx=h(o().mark((function e(t,n){var r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=Bd(t)).currentUser.isEqual(n)){e.next=11;break}return Md("SyncEngine","User change. New user:",n.toKey()),e.next=5,Mb(r.localStore,n);case 5:return i=e.sent,r.currentUser=n,function(e,t){e.lc.forEach((function(e){e.forEach((function(e){e.reject(new Wd(zd.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.lc.clear()}(r),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),e.next=11,cx(r,i.ji);case 11:case"end":return e.stop()}}),e)}))),hx.apply(this,arguments)}function dx(e,t){var n=Bd(e),r=n.cc.get(t);if(r&&r.nc)return wm().add(r.key);var i=wm(),a=n.rc.get(t);if(!a)return i;var o,u=y(a);try{for(u.s();!(o=u.n()).done;){var s=o.value,c=n.ic.get(s);i=i.unionWith(c.view.ju)}}catch(l){u.e(l)}finally{u.f()}return i}function px(e,t){return vx.apply(this,arguments)}function vx(){return vx=h(o().mark((function e(t,n){var r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Bd(t),e.next=3,Hb(r.localStore,n.query,!0);case 3:return i=e.sent,a=n.view.tc(i),e.abrupt("return",(r.isPrimaryClient&&ox(r,n.targetId,a.Xu),a));case 6:case"end":return e.stop()}}),e)}))),vx.apply(this,arguments)}function yx(e,t){return mx.apply(this,arguments)}function mx(){return mx=h(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Bd(t),e.abrupt("return",Qb(r.localStore,n).then((function(e){return cx(r,e)})));case 2:case"end":return e.stop()}}),e)}))),mx.apply(this,arguments)}function gx(e,t,n,r){return kx.apply(this,arguments)}function kx(){return kx=h(o().mark((function e(t,n,r,i){var a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Bd(t),e.next=3,function(e,t){var n=Bd(e),r=Bd(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(e){return r.Tn(e,t).next((function(t){return t?n.localDocuments.getDocuments(e,t):Sp.resolve(null)}))}))}(a.localStore,n);case 3:if(null===(u=e.sent)){e.next=15;break}if("pending"!==r){e.next=10;break}return e.next=8,Hw(a.remoteStore);case 8:e.next=11;break;case 10:"acknowledged"===r||"rejected"===r?(rx(a,n,i||null),nx(a,n),function(e,t){Bd(Bd(e).mutationQueue).An(t)}(a.localStore,n)):Vd();case 11:return e.next=13,cx(a,u);case 13:e.next=16;break;case 15:Md("SyncEngine","Cannot apply mutation batch with id: "+n);case 16:case"end":return e.stop()}}),e)}))),kx.apply(this,arguments)}function bx(e,t){return wx.apply(this,arguments)}function wx(){return wx=h(o().mark((function e(t,n){var r,i,a,u,s,c,l,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Rx(r=Bd(t)),Ax(r),!0!==n||!0===r.dc){e.next=13;break}return i=r.sharedClientState.getAllActiveQueryTargets(),e.next=5,_x(r,i.toArray());case 5:return a=e.sent,r.dc=!0,e.next=9,s_(r.remoteStore,!0);case 9:u=y(a);try{for(u.s();!(s=u.n()).done;)c=s.value,Nw(r.remoteStore,c)}catch(o){u.e(o)}finally{u.f()}e.next=25;break;case 13:if(!1!==n||!1===r.dc){e.next=25;break}return l=[],f=Promise.resolve(),r.rc.forEach((function(e,t){r.sharedClientState.isLocalQueryTarget(t)?l.push(t):f=f.then((function(){return ix(r,t),Wb(r.localStore,t,!0)})),Rw(r.remoteStore,t)})),e.next=19,f;case 19:return e.next=21,_x(r,l);case 21:return function(e){var t=Bd(e);t.cc.forEach((function(e,n){Rw(t.remoteStore,n)})),t.ac.fs(),t.cc=new Map,t.uc=new Kv(fp.comparator)}(r),r.dc=!1,e.next=25,s_(r.remoteStore,!1);case 25:case"end":return e.stop()}}),e)}))),wx.apply(this,arguments)}function _x(e,t,n){return xx.apply(this,arguments)}function xx(){return xx=h(o().mark((function e(t,n,r){var i,a,u,s,c,l,f,h,d,p,v,m,g,k;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=Bd(t),a=[],u=[],s=y(n),e.prev=2,s.s();case 4:if((c=s.n()).done){e.next=45;break}if(l=c.value,f=void 0,!(h=i.rc.get(l))||0===h.length){e.next=34;break}return e.next=11,zb(i.localStore,my(h[0]));case 11:f=e.sent,d=y(h),e.prev=13,d.s();case 15:if((p=d.n()).done){e.next=24;break}return v=p.value,m=i.ic.get(v),e.next=20,px(i,m);case 20:(g=e.sent).snapshot&&u.push(g.snapshot);case 22:e.next=15;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(13),d.e(e.t0);case 29:return e.prev=29,d.f(),e.finish(29);case 32:e.next=42;break;case 34:return e.next=36,Gb(i.localStore,l);case 36:return k=e.sent,e.next=39,zb(i.localStore,k);case 39:return f=e.sent,e.next=42,j_(i,Ix(k),l,!1,f.resumeToken);case 42:a.push(f);case 43:e.next=4;break;case 45:e.next=50;break;case 47:e.prev=47,e.t1=e.catch(2),s.e(e.t1);case 50:return e.prev=50,s.f(),e.finish(50);case 53:return e.abrupt("return",(i.sc.Wo(u),a));case 54:case"end":return e.stop()}}),e,null,[[2,47,50,53],[13,26,29,32]])}))),xx.apply(this,arguments)}function Ix(e){return ly(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Sx(e){var t=Bd(e);return Bd(Bd(t.localStore).persistence).vi()}function Tx(e,t,n,r){return Ex.apply(this,arguments)}function Ex(){return Ex=h(o().mark((function e(t,n,r,i){var a,u,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=Bd(t)).dc){e.next=3;break}return e.abrupt("return",void Md("SyncEngine","Ignoring unexpected query state notification."));case 3:if(!((u=a.rc.get(n))&&u.length>0)){e.next=20;break}e.t0=r,e.next="current"===e.t0||"not-current"===e.t0?8:"rejected"===e.t0?15:19;break;case 8:return e.next=10,Qb(a.localStore,Iy(u[0]));case 10:return s=e.sent,c=Im.createSynthesizedRemoteEventForCurrentChange(n,"current"===r,Hp.EMPTY_BYTE_STRING),e.next=14,cx(a,s,c);case 14:return e.abrupt("break",20);case 15:return e.next=17,Wb(a.localStore,n,!0);case 17:return ix(a,n,i),e.abrupt("break",20);case 19:Vd();case 20:case"end":return e.stop()}}),e)}))),Ex.apply(this,arguments)}function Cx(e,t,n){return Nx.apply(this,arguments)}function Nx(){return Nx=h(o().mark((function e(t,n,r){var i,a,u,s,c,l,f,h,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=Rx(t)).dc){e.next=45;break}a=y(n),e.prev=3,a.s();case 5:if((u=a.n()).done){e.next=21;break}if(s=u.value,!i.rc.has(s)){e.next=10;break}return Md("SyncEngine","Adding an already active target "+s),e.abrupt("continue",19);case 10:return e.next=12,Gb(i.localStore,s);case 12:return c=e.sent,e.next=15,zb(i.localStore,c);case 15:return l=e.sent,e.next=18,j_(i,Ix(c),l.targetId,!1,l.resumeToken);case 18:Nw(i.remoteStore,l);case 19:e.next=5;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(3),a.e(e.t0);case 26:return e.prev=26,a.f(),e.finish(26);case 29:f=y(r),e.prev=30,d=o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.value,e.t0=i.rc.has(t),!e.t0){e.next=5;break}return e.next=5,Wb(i.localStore,t,!1).then((function(){Rw(i.remoteStore,t),ix(i,t)})).catch(xp);case 5:case"end":return e.stop()}}),e)})),f.s();case 33:if((h=f.n()).done){e.next=37;break}return e.delegateYield(d(),"t1",35);case 35:e.next=33;break;case 37:e.next=42;break;case 39:e.prev=39,e.t2=e.catch(30),f.e(e.t2);case 42:return e.prev=42,f.f(),e.finish(42);case 45:case"end":return e.stop()}}),e,null,[[3,23,26,29],[30,39,42,45]])}))),Nx.apply(this,arguments)}function Rx(e){var t=Bd(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=K_.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=dx.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Q_.bind(null,t),t.sc.Wo=x_.bind(null,t.eventManager),t.sc.wc=I_.bind(null,t.eventManager),t}function Ax(e){var t=Bd(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Y_.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=J_.bind(null,t),t}function Px(e,t,n){var r=Bd(e);(function(){var e=h(o().mark((function e(t,n,r){var i,a,u,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.getMetadata();case 3:return i=e.sent,e.next=6,function(e,t){var n=Bd(e),r=Vm(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(e){return n.Ns.getBundleMetadata(e,t.id)})).then((function(e){return!!e&&e.createTime.compareTo(r)>=0}))}(t.localStore,i);case 6:if(!e.sent){e.next=11;break}return e.next=9,n.close();case 9:return r._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(i)),e.abrupt("return",Promise.resolve(new Set));case 11:return r._updateProgress(R_(i)),a=new N_(i,t.localStore,n.yt),e.next=15,n.mc();case 15:u=e.sent;case 16:if(!u){e.next=26;break}return e.next=19,a.Fu(u);case 19:return(s=e.sent)&&r._updateProgress(s),e.next=23,n.mc();case 23:u=e.sent;case 24:e.next=16;break;case 26:return e.next=28,a.complete();case 28:return c=e.sent,e.next=31,cx(t,c.Lu,void 0);case 31:return e.next=33,function(e,t){var n=Bd(e);return n.persistence.runTransaction("Save bundle","readwrite",(function(e){return n.Ns.saveBundleMetadata(e,t)}))}(t.localStore,i);case 33:return r._completeWith(c.progress),e.abrupt("return",Promise.resolve(c.Bu));case 37:return e.prev=37,e.t0=e.catch(0),e.abrupt("return",(Ud("SyncEngine","Loading bundle failed with ".concat(e.t0)),r._failWith(e.t0),Promise.resolve(new Set)));case 40:case"end":return e.stop()}}),e,null,[[0,37]])})));return function(t,n,r){return e.apply(this,arguments)}})()(r,t,n).then((function(e){r.sharedClientState.notifyBundleLoaded(e)}))}var Dx=function(){function e(){u(this,e),this.synchronizeTabs=!1}return l(e,[{key:"initialize",value:function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.yt=mw(t.databaseInfo.databaseId),this.sharedClientState=this.gc(t),this.persistence=this.yc(t),e.next=5,this.persistence.start();case 5:this.localStore=this.Ic(t),this.gcScheduler=this.Tc(t,this.localStore),this.indexBackfillerScheduler=this.Ec(t,this.localStore);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"Tc",value:function(e,t){return null}},{key:"Ec",value:function(e,t){return null}},{key:"Ic",value:function(e){return Lb(this.persistence,new Db,e.initialUser,this.yt)}},{key:"yc",value:function(e){return new _b(Ib.Bs,this.yt)}},{key:"gc",value:function(e){return new cw}},{key:"terminate",value:function(){var e=h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.gcScheduler&&this.gcScheduler.stop(),e.next=3,this.sharedClientState.shutdown();case 3:return e.next=5,this.persistence.shutdown();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Ox=function(e){_(n,e);var t=T(n);function n(e,r,i){var a;return u(this,n),(a=t.call(this)).Ac=e,a.cacheSizeBytes=r,a.forceOwnership=i,a.synchronizeTabs=!1,a}return l(n,[{key:"initialize",value:function(){var e=h(o().mark((function e(t){var r=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tn(x(n.prototype),"initialize",this).call(this,t);case 2:return e.next=4,this.Ac.initialize(this,t);case 4:return e.next=6,Ax(this.Ac.syncEngine);case 6:return e.next=8,Hw(this.Ac.remoteStore);case 8:return e.next=10,this.persistence.li((function(){return r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()}));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"Ic",value:function(e){return Lb(this.persistence,new Db,e.initialUser,this.yt)}},{key:"Tc",value:function(e,t){var n=this.persistence.referenceDelegate.garbageCollector;return new Zk(n,e.asyncQueue,t)}},{key:"Ec",value:function(e,t){var n=new Mp(t,this.persistence);return new Lp(e.asyncQueue,n)}},{key:"yc",value:function(e){var t=Ab(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Uk.withCacheSize(this.cacheSizeBytes):Uk.DEFAULT;return new Cb(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,vw(),yw(),this.yt,this.sharedClientState,!!this.forceOwnership)}},{key:"gc",value:function(e){return new cw}}]),n}(Dx),Lx=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this,e,r,!1)).Ac=e,i.cacheSizeBytes=r,i.synchronizeTabs=!0,i}return l(n,[{key:"initialize",value:function(){var e=h(o().mark((function e(t){var r,i=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tn(x(n.prototype),"initialize",this).call(this,t);case 2:if(r=this.Ac.syncEngine,e.t0=this.sharedClientState instanceof sw,!e.t0){e.next=8;break}return this.sharedClientState.syncEngine={Fr:gx.bind(null,r),$r:Tx.bind(null,r),Br:Cx.bind(null,r),vi:Sx.bind(null,r),Mr:yx.bind(null,r)},e.next=8,this.sharedClientState.start();case 8:return e.next=10,this.persistence.li(function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,bx(i.Ac.syncEngine,t);case 2:i.gcScheduler&&(t&&!i.gcScheduler.started?i.gcScheduler.start():t||i.gcScheduler.stop()),i.indexBackfillerScheduler&&(t&&!i.indexBackfillerScheduler.started?i.indexBackfillerScheduler.start():t||i.indexBackfillerScheduler.stop());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"gc",value:function(e){var t=vw();if(!sw.C(t))throw new Wd(zd.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Ab(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new sw(t,e.asyncQueue,n,e.clientId,e.initialUser)}}]),n}(Ox),Mx=function(){function e(){u(this,e)}return l(e,[{key:"initialize",value:function(){var e=h(o().mark((function e(t,n){var r=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.localStore,e.t0){e.next=12;break}return this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(e){return G_(r.syncEngine,e,1)},this.remoteStore.remoteSyncer.handleCredentialChange=fx.bind(null,this.syncEngine),e.next=12,s_(this.remoteStore,this.syncEngine.isPrimaryClient);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createEventManager",value:function(e){return new g_}},{key:"createDatastore",value:function(e){var t,n=mw(e.databaseInfo.databaseId),r=(t=e.databaseInfo,new pw(t));return function(e,t,n,r){return new _w(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,r,n)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return G_(o.syncEngine,e,0)},a=fw.C()?new fw:new lw,new Iw(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return function(e,t,n,r,i,a,o){var u=new M_(e,t,n,r,i,a);return o&&(u.dc=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}},{key:"terminate",value:function(){return function(){var e=h(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Bd(t),Md("RemoteStore","RemoteStore shutting down."),n._u.add(5),e.next=5,Ew(n);case 5:n.mu.shutdown(),n.gu.set("Unknown");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(this.remoteStore)}}]),e}();function Fx(e,t,n){if(!n)throw new Wd(zd.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function Ux(e,t,n,r){if(!0===t&&!0===r)throw new Wd(zd.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}function jx(e){if(!fp.isDocumentKey(e))throw new Wd(zd.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function Vx(e){if(fp.isDocumentKey(e))throw new Wd(zd.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function qx(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}return"function"==typeof e?"a function":Vd()}function Bx(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Wd(zd.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=qx(e);throw new Wd(zd.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}function zx(e,t){if(t<=0)throw new Wd(zd.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}var Wx=new Map,Kx=function(){function e(t){var n;if(u(this,e),void 0===t.host){if(void 0!==t.ssl)throw new Wd(zd.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Wd(zd.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,Ux("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return l(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),Hx=function(){function e(t,n,r,i){u(this,e),this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Kx({}),this._settingsFrozen=!1}return l(e,[{key:"app",get:function(){if(!this._app)throw new Wd(zd.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new Wd(zd.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Kx(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Gd;switch(e.type){case"gapi":var t=e.client;return new Xd(t,e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Wd(zd.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return function(e){var t=Wx.get(e);t&&(Md("ComponentProvider","Removing Datastore"),Wx.delete(e),t.terminate())}(this),Promise.resolve()}}]),e}();function Gx(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=(e=Bx(e,Hx))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==t&&Ud("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},a),{host:"".concat(t,":").concat(n),ssl:!1})),i.mockUserToken){var o,u;if("string"==typeof i.mockUserToken)o=i.mockUserToken,u=Pd.MOCK_USER;else{o=te(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new Wd(zd.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Pd(s)}e._authCredentials=new Qd(new Hd(o,u))}}var Qx=function(){function e(t,n,r){u(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return l(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new Yx(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),$x=function(){function e(t,n,r){u(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return l(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),Yx=function(e){_(n,e);var t=T(n);function n(e,r,i){var a;return u(this,n),(a=t.call(this,e,r,fy(i)))._path=i,a.type="collection",a}return l(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new Qx(this.firestore,null,new fp(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}($x);function Xx(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=Ie(e),Fx("collection","path",t),e instanceof Hx){var a=sp.fromString.apply(sp,[t].concat(r));return Vx(a),new Yx(e,null,a)}if(!(e instanceof Qx||e instanceof Yx))throw new Wd(zd.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(sp.fromString.apply(sp,[t].concat(r)));return Vx(o),new Yx(e.firestore,null,o)}function Jx(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=Ie(e),1===arguments.length&&(t=tp.R()),Fx("doc","path",t),e instanceof Hx){var a=sp.fromString.apply(sp,[t].concat(r));return jx(a),new Qx(e,null,new fp(a))}if(!(e instanceof Qx||e instanceof Yx))throw new Wd(zd.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(sp.fromString.apply(sp,[t].concat(r)));return jx(o),new Qx(e.firestore,e instanceof Yx?e.converter:null,new fp(o))}function Zx(e,t){return e=Ie(e),t=Ie(t),(e instanceof Qx||e instanceof Yx)&&(t instanceof Qx||t instanceof Yx)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function eI(e,t){return e=Ie(e),t=Ie(t),e instanceof $x&&t instanceof $x&&e.firestore===t.firestore&&by(e._query,t._query)&&e.converter===t.converter}function tI(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,n=0;return{read:function(){return h(o().mark((function r(){var i;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(n<e.byteLength)){r.next=3;break}return i={value:e.slice(n,n+t),done:!1},r.abrupt("return",(n+=t,i));case 3:return r.abrupt("return",{done:!0});case 4:case"end":return r.stop()}}),r)})))()},cancel:function(){return h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var nI=function(){function e(t){u(this,e),this.observer=t,this.muted=!1}return l(e,[{key:"next",value:function(e){this.observer.next&&this.Rc(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Rc(this.observer.error,e):Fd("Uncaught Error in snapshot listener:",e.toString())}},{key:"bc",value:function(){this.muted=!0}},{key:"Rc",value:function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)}}]),e}(),rI=function(){function e(t,n){var r=this;u(this,e),this.Pc=t,this.yt=n,this.metadata=new Kd,this.buffer=new Uint8Array,this.vc=new TextDecoder("utf-8"),this.Vc().then((function(e){e&&e.Ou()?r.metadata.resolve(e.ku.metadata):r.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             ".concat(JSON.stringify(null==e?void 0:e.ku))))}),(function(e){return r.metadata.reject(e)}))}return l(e,[{key:"close",value:function(){return this.Pc.cancel()}},{key:"getMetadata",value:function(){var e=h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.metadata.promise);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"mc",value:function(){var e=h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMetadata();case 2:return e.abrupt("return",this.Vc());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Vc",value:function(){var e=h(o().mark((function e(){var t,n,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Sc();case 2:if(null!==(t=e.sent)){e.next=5;break}return e.abrupt("return",null);case 5:return n=this.vc.decode(t),r=Number(n),isNaN(r)&&this.Dc("length string (".concat(n,") is not valid number")),e.next=9,this.Cc(r);case 9:return i=e.sent,e.abrupt("return",new E_(JSON.parse(i),t.length+r));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"xc",value:function(){return this.buffer.findIndex((function(e){return e==="{".charCodeAt(0)}))}},{key:"Sc",value:function(){var e=h(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.xc()<0)){e.next=7;break}return e.next=3,this.Nc();case 3:if(!e.sent){e.next=5;break}return e.abrupt("break",7);case 5:e.next=0;break;case 7:if(0!==this.buffer.length){e.next=9;break}return e.abrupt("return",null);case 9:return(t=this.xc())<0&&this.Dc("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,t),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Cc",value:function(){var e=h(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.buffer.length<t)){e.next=8;break}return e.next=3,this.Nc();case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.Dc("Reached the end of bundle when more is expected.");case 6:e.next=0;break;case 8:return n=this.vc.decode(this.buffer.slice(0,t)),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"Dc",value:function(e){throw this.Pc.cancel(),new Error("Invalid bundle format: ".concat(e))}},{key:"Nc",value:function(){var e=h(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Pc.read();case 2:return(t=e.sent).done||((n=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),n.set(t.value,this.buffer.length),this.buffer=n),e.abrupt("return",t.done);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),iI=function(){function e(t){u(this,e),this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return l(e,[{key:"lookup",value:function(){var e=h(o().mark((function e(t){var n,r=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!(this.mutations.length>0)){e.next=2;break}throw new Wd(zd.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");case 2:return e.next=4,function(){var e=h(o().mark((function e(t,n){var r,i,a,u,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Bd(t),i=Gm(r.yt)+"/documents",a={documents:n.map((function(e){return zm(r.yt,e)}))},e.next=5,r._o("BatchGetDocuments",i,a,n.length);case 5:return u=e.sent,s=new Map,u.forEach((function(e){var t=Xm(r.yt,e);s.set(t.key.toString(),t)})),c=[],e.abrupt("return",(n.forEach((function(e){var t=s.get(e.toString());qd(!!t),c.push(t)})),c));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,t);case 4:return n=e.sent,e.abrupt("return",(n.forEach((function(e){return r.recordVersion(e)})),n));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"update",value:function(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}},{key:"delete",value:function(e){this.write(new am(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"commit",value:function(){var e=h(o().mark((function e(){var t,n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!this.lastWriteError){e.next=2;break}throw this.lastWriteError;case 2:return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(e,t){var r=fp.fromPath(t);n.mutations.push(new om(r,n.precondition(r)))})),e.next=7,function(){var e=h(o().mark((function e(t,n){var r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Bd(t),i=Gm(r.yt)+"/documents",a={writes:n.map((function(e){return Jm(r.yt,e)}))},e.next=3,r.ao("Commit",i,a);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,this.mutations);case 7:this.committed=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"recordVersion",value:function(e){var t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Vd();t=op.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new Wd(zd.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}},{key:"precondition",value:function(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(op.min())?Wy.exists(!1):Wy.updateTime(t):Wy.none()}},{key:"preconditionForUpdate",value:function(e){var t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(op.min()))throw new Wd(zd.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Wy.updateTime(t)}return Wy.exists(!0)}},{key:"write",value:function(e){this.ensureCommitNotCalled(),this.mutations.push(e)}},{key:"ensureCommitNotCalled",value:function(){}}]),e}(),aI=function(){function e(t,n,r,i,a){u(this,e),this.asyncQueue=t,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=a,this.kc=r.maxAttempts,this.xo=new gw(this.asyncQueue,"transaction_retry")}return l(e,[{key:"run",value:function(){this.kc-=1,this.Oc()}},{key:"Oc",value:function(){var e=this;this.xo.Ro(h(o().mark((function t(){var n,r;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new iI(e.datastore),(r=e.Mc(n))&&r.then((function(t){e.asyncQueue.enqueueAndForget((function(){return n.commit().then((function(){e.deferred.resolve(t)})).catch((function(t){e.Fc(t)}))}))})).catch((function(t){e.Fc(t)}));case 2:case"end":return t.stop()}}),t)}))))}},{key:"Mc",value:function(e){try{var t=this.updateFunction(e);return!zp(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}},{key:"Fc",value:function(e){var t=this;this.kc>0&&this.$c(e)?(this.kc-=1,this.asyncQueue.enqueueAndForget((function(){return t.Oc(),Promise.resolve()}))):this.deferred.reject(e)}},{key:"$c",value:function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!sm(t)}return!1}}]),e}(),oI=function(){function e(t,n,r,i){var a=this;u(this,e),this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Pd.UNAUTHENTICATED,this.clientId=tp.R(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Md("FirestoreClient","Received user=",t.uid),e.next=3,a.authCredentialListener(t);case 3:a.user=t;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.appCheckCredentials.start(r,(function(e){return Md("FirestoreClient","Received new app check token=",e),a.appCheckCredentialListener(e,a.user)}))}return l(e,[{key:"getConfiguration",value:function(){var e=h(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new Wd(zd.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new Kd;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(h(o().mark((function n(){var r;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e.onlineComponents,!n.t0){n.next=5;break}return n.next=5,e.onlineComponents.terminate();case 5:if(n.t1=e.offlineComponents,!n.t1){n.next=9;break}return n.next=9,e.offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=d_(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}}),n,null,[[0,14]])})))),t.promise}}]),e}();function uI(e,t){return sI.apply(this,arguments)}function sI(){return sI=h(o().mark((function e(t,n){var r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),Md("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:i=r.initialUser,t.setCredentialChangeListener(function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.isEqual(t),e.t0){e.next=5;break}return e.next=4,Mb(n.localStore,t);case 4:i=t;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=n;case 8:case"end":return e.stop()}}),e)}))),sI.apply(this,arguments)}function cI(e,t){return lI.apply(this,arguments)}function lI(){return lI=h(o().mark((function e(t,n){var r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,fI(t);case 3:return r=e.sent,Md("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return i=e.sent,e.next=10,n.initialize(r,i);case 10:t.setCredentialChangeListener((function(e){return o_(n.remoteStore,e)})),t.setAppCheckTokenChangeListener((function(e,t){return o_(n.remoteStore,t)})),t.onlineComponents=n;case 13:case"end":return e.stop()}}),e)}))),lI.apply(this,arguments)}function fI(e){return hI.apply(this,arguments)}function hI(){return hI=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.offlineComponents,e.t0){e.next=5;break}return Md("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,uI(t,new Dx);case 5:return e.abrupt("return",t.offlineComponents);case 6:case"end":return e.stop()}}),e)}))),hI.apply(this,arguments)}function dI(e){return pI.apply(this,arguments)}function pI(){return pI=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.onlineComponents,e.t0){e.next=5;break}return Md("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,cI(t,new Mx);case 5:return e.abrupt("return",t.onlineComponents);case 6:case"end":return e.stop()}}),e)}))),pI.apply(this,arguments)}function vI(e){return fI(e).then((function(e){return e.persistence}))}function yI(e){return fI(e).then((function(e){return e.localStore}))}function mI(e){return dI(e).then((function(e){return e.remoteStore}))}function gI(e){return dI(e).then((function(e){return e.syncEngine}))}function kI(e){return dI(e).then((function(e){return e.datastore}))}function bI(e){return wI.apply(this,arguments)}function wI(){return wI=h(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,dI(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=F_.bind(null,n.syncEngine),r.onUnlisten=q_.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}}),e)}))),wI.apply(this,arguments)}function _I(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Kd;return e.asyncQueue.enqueueAndForget(h(o().mark((function i(){return o().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new nI({next:function(a){t.enqueueAndForget((function(){return w_(e,o)}));var u=a.docs.has(n);!u&&a.fromCache?i.reject(new Wd(zd.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&a.fromCache&&r&&"server"===r.source?i.reject(new Wd(zd.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new T_(fy(n.path),a,{includeMetadataChanges:!0,Nu:!0});return k_(e,o)},i.next=3,bI(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}}),i)})))),r.promise}function xI(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Kd;return e.asyncQueue.enqueueAndForget(h(o().mark((function i(){return o().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new nI({next:function(n){t.enqueueAndForget((function(){return w_(e,o)})),n.fromCache&&"server"===r.source?i.reject(new Wd(zd.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new T_(n,a,{includeMetadataChanges:!0,Nu:!0});return k_(e,o)},i.next=3,bI(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}}),i)})))),r.promise}var II=function(){function e(){var t=this;u(this,e),this.Bc=Promise.resolve(),this.Lc=[],this.qc=!1,this.Uc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new gw(this,"async_queue_retry"),this.Wc=function(){var e=yw();e&&Md("AsyncQueue","Visibility state changed to "+e.visibilityState),t.xo.Po()};var n=yw();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Wc)}return l(e,[{key:"isShuttingDown",get:function(){return this.qc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.zc(),this.Hc(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.qc){this.qc=!0,this.Qc=e||!1;var t=yw();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Wc)}}},{key:"enqueue",value:function(e){var t=this;if(this.zc(),this.qc)return new Promise((function(){}));var n=new Kd;return this.Hc((function(){return t.qc&&t.Qc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget((function(){return t.Lc.push(e),t.Jc()}))}},{key:"Jc",value:function(){var e=h(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===this.Lc.length){e.next=14;break}return e.prev=1,e.next=4,this.Lc[0]();case 4:this.Lc.shift(),this.xo.reset(),e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(1),Rp(e.t0)){e.next=12;break}throw e.t0;case 12:Md("AsyncQueue","Operation failed with retryable error: "+e.t0);case 13:this.Lc.length>0&&this.xo.Ro((function(){return t.Jc()}));case 14:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"Hc",value:function(e){var t=this,n=this.Bc.then((function(){return t.Gc=!0,e().catch((function(e){t.Kc=e,t.Gc=!1;var n=function(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Fd("INTERNAL UNHANDLED ERROR: ",n),e})).then((function(e){return t.Gc=!1,e}))}));return this.Bc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.zc(),this.jc.indexOf(e)>-1&&(t=0);var i=h_.createAndSchedule(this,e,t,n,(function(e){return r.Yc(e)}));return this.Uc.push(i),i}},{key:"zc",value:function(){this.Kc&&Vd()}},{key:"verifyOperationInProgress",value:function(){}},{key:"Xc",value:function(){var e=h(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.Bc,e.next=3,t;case 3:if(t!==this.Bc){e.next=0;break}case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Zc",value:function(e){var t,n=y(this.Uc);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"ta",value:function(e){var t=this;return this.Xc().then((function(){t.Uc.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));var n,r=y(t.Uc);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==e&&i.timerId===e)break}}catch(a){r.e(a)}finally{r.f()}return t.Xc()}))}},{key:"ea",value:function(e){this.jc.push(e)}},{key:"Yc",value:function(e){var t=this.Uc.indexOf(e);this.Uc.splice(t,1)}}]),e}();function SI(e){return function(e,t){if("object"!=typeof e||null===e)return!1;var n,r=e,i=y(["next","error","complete"]);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a in r&&"function"==typeof r[a])return!0}}catch(o){i.e(o)}finally{i.f()}return!1}(e)}var TI=function(){function e(){u(this,e),this._progressObserver={},this._taskCompletionResolver=new Kd,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return l(e,[{key:"onProgress",value:function(e,t,n){this._progressObserver={next:e,error:t,complete:n}}},{key:"catch",value:function(e){return this._taskCompletionResolver.promise.catch(e)}},{key:"then",value:function(e,t){return this._taskCompletionResolver.promise.then(e,t)}},{key:"_completeWith",value:function(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}},{key:"_failWith",value:function(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}},{key:"_updateProgress",value:function(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}]),e}(),EI=function(e){_(n,e);var t=T(n);function n(e,r,i,a){var o;return u(this,n),(o=t.call(this,e,r,i,a)).type="firestore",o._queue=new II,o._persistenceKey=(null==a?void 0:a.name)||"[DEFAULT]",o}return l(n,[{key:"_terminate",value:function(){return this._firestoreClient||NI(this),this._firestoreClient.terminate()}}]),n}(Hx);function CI(e){return e._firestoreClient||NI(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function NI(e){var t,n=e._freezeSettings(),r=function(e,t,n,r){return new Up(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new oI(e._authCredentials,e._appCheckCredentials,e._queue,r)}function RI(e,t,n){var r=new Kd;return e.asyncQueue.enqueue(h(o().mark((function i(){var a;return o().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,uI(e,n);case 3:return i.next=5,cI(e,t);case 5:r.resolve(),i.next=14;break;case 8:if(i.prev=8,i.t0=i.catch(0),function(e){return"FirebaseError"===e.name?e.code===zd.FAILED_PRECONDITION||e.code===zd.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||(22===e.code||20===e.code||11===e.code)}(a=i.t0)){i.next=13;break}throw a;case 13:Ud("Error enabling offline persistence. Falling back to persistence disabled: "+a),r.reject(a);case 14:case"end":return i.stop()}}),i,null,[[0,8]])})))).then((function(){return r.promise}))}function AI(e){return function(e){return e.asyncQueue.enqueue(h(o().mark((function t(){var n,r;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,vI(e);case 2:return n=t.sent,t.next=5,mI(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!0),function(e){var t=Bd(e);return t._u.delete(0),Sw(t)}(r)));case 7:case"end":return t.stop()}}),t)}))))}(CI(e=Bx(e,EI)))}function PI(e){return function(e){return e.asyncQueue.enqueue(h(o().mark((function t(){var n,r;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,vI(e);case 2:return n=t.sent,t.next=5,mI(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!1),function(){var e=h(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Bd(t))._u.add(0),e.next=4,Ew(n);case 4:n.gu.set("Offline");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(r)));case 7:case"end":return t.stop()}}),t)}))))}(CI(e=Bx(e,EI)))}function DI(e,t){var n=CI(e=Bx(e,EI)),r=new TI;return function(e,t,n,r){var i=function(e,t){return function(e,t){return new rI(e,t)}(function(e,t){if(e instanceof Uint8Array)return tI(e,t);if(e instanceof ArrayBuffer)return tI(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),t)}(n,mw(t));e.asyncQueue.enqueueAndForget(h(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Px,t.next=3,gI(e);case 3:t.t1=t.sent,t.t2=i,t.t3=r,(0,t.t0)(t.t1,t.t2,t.t3);case 7:case"end":return t.stop()}}),t)}))))}(n,e._databaseId,t,r),r}function OI(e,t){return function(e,t){return e.asyncQueue.enqueue(h(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=function(e,t){var n=Bd(e);return n.persistence.runTransaction("Get named query","readonly",(function(e){return n.Ns.getNamedQuery(e,t)}))},n.next=3,yI(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}}),n)}))))}(CI(e=Bx(e,EI)),t).then((function(t){return t?new $x(e,null,t.query):null}))}function LI(e){if(e._initialized||e._terminated)throw new Wd(zd.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var MI=function(){function e(t){u(this,e),this._byteString=t}return l(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(Hp.fromBase64String(t))}catch(t){throw new Wd(zd.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}},{key:"fromUint8Array",value:function(t){return new e(Hp.fromUint8Array(t))}}]),e}(),FI=function(){function e(){u(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new Wd(zd.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new lp(n)}return l(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}();var UI=l((function e(t){u(this,e),this._methodName=t})),jI=function(){function e(t,n){if(u(this,e),!isFinite(t)||t<-90||t>90)throw new Wd(zd.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new Wd(zd.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return l(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return np(this._lat,e._lat)||np(this._long,e._long)}}]),e}(),VI=/^__.*__$/,qI=function(){function e(t,n,r){u(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return l(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new Zy(e,this.data,this.fieldMask,t,this.fieldTransforms):new Jy(e,this.data,t,this.fieldTransforms)}}]),e}(),BI=function(){function e(t,n,r){u(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return l(e,[{key:"toMutation",value:function(e,t){return new Zy(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function zI(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Vd()}}var WI=function(){function e(t,n,r,i,a,o){u(this,e),this.settings=t,this.databaseId=n,this.yt=r,this.ignoreUndefinedProperties=i,void 0===a&&this.na(),this.fieldTransforms=a||[],this.fieldMask=o||[]}return l(e,[{key:"path",get:function(){return this.settings.path}},{key:"sa",get:function(){return this.settings.sa}},{key:"ia",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.yt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ra",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ia({path:n,oa:!1});return r.ua(e),r}},{key:"ca",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ia({path:n,oa:!1});return r.na(),r}},{key:"aa",value:function(e){return this.ia({path:void 0,oa:!0})}},{key:"ha",value:function(e){return lS(e,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))}},{key:"na",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.ua(this.path.get(e))}},{key:"ua",value:function(e){if(0===e.length)throw this.ha("Document fields must not be empty");if(zI(this.sa)&&VI.test(e))throw this.ha('Document fields cannot begin and end with "__"')}}]),e}(),KI=function(){function e(t,n,r){u(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.yt=r||mw(t)}return l(e,[{key:"da",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new WI({sa:e,methodName:t,fa:n,path:lp.emptyPath(),oa:!1,la:r},this.databaseId,this.yt,this.ignoreUndefinedProperties)}}]),e}();function HI(e){var t=e._freezeSettings(),n=mw(e._databaseId);return new KI(e._databaseId,!!t.ignoreUndefinedProperties,n)}function GI(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.da(a.merge||a.mergeFields?2:0,t,n,i);oS("Data must be an object, but it was:",o,r);var u,s,c=iS(r,o);if(a.merge)u=new Xv(o.fieldMask),s=o.fieldTransforms;else if(a.mergeFields){var l,f=[],h=y(a.mergeFields);try{for(h.s();!(l=h.n()).done;){var d=l.value,p=uS(t,d,n);if(!o.contains(p))throw new Wd(zd.INVALID_ARGUMENT,"Field '".concat(p,"' is specified in your field mask but missing from your input data."));fS(f,p)||f.push(p)}}catch(v){h.e(v)}finally{h.f()}u=new Xv(f),s=o.fieldTransforms.filter((function(e){return u.covers(e.field)}))}else u=null,s=o.fieldTransforms;return new qI(new Jv(c),u,s)}var QI=function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.apply(this,arguments)}return l(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.sa)throw 1===e.sa?e.ha("".concat(this._methodName,"() can only appear at the top level of your update data")):e.ha("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(UI);function $I(e,t,n){return new WI({sa:3,fa:t.settings.fa,methodName:e._methodName,oa:n},t.databaseId,t.yt,t.ignoreUndefinedProperties)}var YI=function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.apply(this,arguments)}return l(n,[{key:"_toFieldTransform",value:function(e){return new By(e.path,new Oy)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(UI),XI=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this,e))._a=r,i}return l(n,[{key:"_toFieldTransform",value:function(e){var t=$I(this,e,!0),n=this._a.map((function(e){return rS(e,t)})),r=new Ly(n);return new By(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),n}(UI),JI=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this,e))._a=r,i}return l(n,[{key:"_toFieldTransform",value:function(e){var t=$I(this,e,!0),n=this._a.map((function(e){return rS(e,t)})),r=new Fy(n);return new By(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),n}(UI),ZI=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this,e)).wa=r,i}return l(n,[{key:"_toFieldTransform",value:function(e){var t=new jy(e.yt,Ny(e.yt,this.wa));return new By(e.path,t)}},{key:"isEqual",value:function(e){return this===e}}]),n}(UI);function eS(e,t,n,r){var i=e.da(1,t,n);oS("Data must be an object, but it was:",i,r);var a=[],o=Jv.empty();qp(r,(function(e,r){var u=cS(t,e,n);r=Ie(r);var s=i.ca(u);if(r instanceof QI)a.push(u);else{var c=rS(r,s);null!=c&&(a.push(u),o.set(u,c))}}));var u=new Xv(a);return new BI(o,u,i.fieldTransforms)}function tS(e,t,n,r,i,a){var o=e.da(1,t,n),u=[uS(t,r,n)],s=[i];if(a.length%2!=0)throw new Wd(zd.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)u.push(uS(t,a[c])),s.push(a[c+1]);for(var l=[],f=Jv.empty(),h=u.length-1;h>=0;--h)if(!fS(l,u[h])){var d=u[h],p=s[h];p=Ie(p);var v=o.ca(d);if(p instanceof QI)l.push(d);else{var y=rS(p,v);null!=y&&(l.push(d),f.set(d,y))}}var m=new Xv(l);return new BI(f,m,o.fieldTransforms)}function nS(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return rS(n,e.da(r?4:3,t))}function rS(e,t){if(aS(e=Ie(e)))return oS("Unsupported field value:",t,e),iS(e,t);if(e instanceof UI)return function(e,t){if(!zI(t.sa))throw t.ha("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.ha("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.oa&&4!==t.sa)throw t.ha("Nested arrays are not supported");return function(e,t){var n,r=[],i=0,a=y(e);try{for(a.s();!(n=a.n()).done;){var o=rS(n.value,t.aa(i));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),i++}}catch(u){a.e(u)}finally{a.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=Ie(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Ny(t.yt,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=ap.fromDate(e);return{timestampValue:Fm(t.yt,n)}}if(e instanceof ap){var r=new ap(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Fm(t.yt,r)}}if(e instanceof jI)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof MI)return{bytesValue:Um(t.yt,e._byteString)};if(e instanceof Qx){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.ha("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:qm(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.ha("Unsupported field value: ".concat(qx(e)))}(e,t)}function iS(e,t){var n={};return Bp(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):qp(e,(function(e,r){var i=rS(r,t.ra(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function aS(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof ap||e instanceof jI||e instanceof MI||e instanceof Qx||e instanceof UI)}function oS(e,t,n){if(!aS(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){var r=qx(n);throw"an object"===r?t.ha(e+" a custom object"):t.ha(e+" "+r)}}function uS(e,t,n){if((t=Ie(t))instanceof FI)return t._internalPath;if("string"==typeof t)return cS(e,t);throw lS("Field path arguments must be of type string or ",e,!1,void 0,n)}var sS=new RegExp("[~\\*/\\[\\]]");function cS(e,t,n){if(t.search(sS)>=0)throw lS("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return E(FI,Te(t.split(".")))._internalPath}catch(PC){throw lS("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function lS(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,u="Function ".concat(t,"() called with invalid data");n&&(u+=" (via `toFirestore()`)"),u+=". ";var s="";return(a||o)&&(s+=" (found",a&&(s+=" in field ".concat(r)),o&&(s+=" in document ".concat(i)),s+=")"),new Wd(zd.INVALID_ARGUMENT,u+e+s)}function fS(e,t){return e.some((function(e){return e.isEqual(t)}))}var hS=function(){function e(t,n,r,i,a){u(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return l(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new Qx(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new dS(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(pS("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),dS=function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.apply(this,arguments)}return l(n,[{key:"data",value:function(){return tn(x(n.prototype),"data",this).call(this)}}]),n}(hS);function pS(e,t){return"string"==typeof t?cS(e,t):t instanceof FI?t._internalPath:t._delegate._internalPath}function vS(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Wd(zd.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var yS=l((function e(){u(this,e)})),mS=function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.apply(this,arguments)}return l(n)}(yS);function gS(e,t){for(var n=[],r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];t instanceof yS&&n.push(t),function(e){var t=e.filter((function(e){return e instanceof wS})).length,n=e.filter((function(e){return e instanceof kS})).length;if(t>1||t>0&&n>0)throw new Wd(zd.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n=n.concat(i));var o,u=y(n);try{for(u.s();!(o=u.n()).done;){var s=o.value;e=s._apply(e)}}catch(c){u.e(c)}finally{u.f()}return e}var kS=function(e){_(n,e);var t=T(n);function n(e,r,i){var a;return u(this,n),(a=t.call(this))._field=e,a._op=r,a._value=i,a.type="where",a}return l(n,[{key:"_apply",value:function(e){var t=this._parse(e);return DS(e._query,t),new $x(e.firestore,e.converter,gy(e._query,t))}},{key:"_parse",value:function(e){var t=HI(e.firestore),n=function(e,t,n,r,i,a,o){var u;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new Wd(zd.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){PS(o,a);var s,c=[],l=y(o);try{for(l.s();!(s=l.n()).done;){var f=s.value;c.push(AS(r,e,f))}}catch(h){l.e(h)}finally{l.f()}u={arrayValue:{values:c}}}else u=AS(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||PS(o,a),u=nS(n,"where",o,"in"===a||"not-in"===a);return Sv.create(i,a,u)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(mS);function bS(e,t,n){var r=t,i=pS("where",e);return kS._create(i,r,n)}var wS=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this)).type=e,i._queryConstraints=r,i}return l(n,[{key:"_parse",value:function(e){var t=this._queryConstraints.map((function(t){return t._parse(e)})).filter((function(e){return e.getFilters().length>0}));return 1===t.length?t[0]:Tv.create(t,this._getOperator())}},{key:"_apply",value:function(e){var t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){var n,r=e,i=y(t.getFlattenedFilters());try{for(i.s();!(n=i.n()).done;){var a=n.value;DS(r,a),r=gy(r,a)}}catch(o){i.e(o)}finally{i.f()}}(e._query,t),new $x(e.firestore,e.converter,gy(e._query,t)))}},{key:"_getQueryConstraints",value:function(){return this._queryConstraints}},{key:"_getOperator",value:function(){return"and"===this.type?"and":"or"}}],[{key:"_create",value:function(e,t){return new n(e,t)}}]),n}(yS);var _S=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this))._field=e,i._direction=r,i.type="orderBy",i}return l(n,[{key:"_apply",value:function(e){var t=function(e,t,n){if(null!==e.startAt)throw new Wd(zd.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Wd(zd.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new zv(t,n);return function(e,t){if(null===dy(e)){var n=py(e);null!==n&&OS(e,n,t.field)}}(e,r),r}(e._query,this._field,this._direction);return new $x(e.firestore,e.converter,function(e,t){var n=e.explicitOrderBy.concat([t]);return new cy(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}],[{key:"_create",value:function(e,t){return new n(e,t)}}]),n}(mS);var xS=function(e){_(n,e);var t=T(n);function n(e,r,i){var a;return u(this,n),(a=t.call(this)).type=e,a._limit=r,a._limitType=i,a}return l(n,[{key:"_apply",value:function(e){return new $x(e.firestore,e.converter,ky(e._query,this._limit,this._limitType))}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(mS);var IS=function(e){_(n,e);var t=T(n);function n(e,r,i){var a;return u(this,n),(a=t.call(this)).type=e,a._docOrFields=r,a._inclusive=i,a}return l(n,[{key:"_apply",value:function(e){var t=RS(e,this.type,this._docOrFields,this._inclusive);return new $x(e.firestore,e.converter,function(e,t){return new cy(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(mS);function SS(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return IS._create("startAt",t,!0)}function TS(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return IS._create("startAfter",t,!1)}var ES=function(e){_(n,e);var t=T(n);function n(e,r,i){var a;return u(this,n),(a=t.call(this)).type=e,a._docOrFields=r,a._inclusive=i,a}return l(n,[{key:"_apply",value:function(e){var t=RS(e,this.type,this._docOrFields,this._inclusive);return new $x(e.firestore,e.converter,function(e,t){return new cy(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(mS);function CS(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ES._create("endBefore",t,!1)}function NS(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ES._create("endAt",t,!0)}function RS(e,t,n,r){if(n[0]=Ie(n[0]),n[0]instanceof hS)return function(e,t,n,r,i){if(!r)throw new Wd(zd.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));var a,o=[],u=y(yy(e));try{for(u.s();!(a=u.n()).done;){var s=a.value;if(s.field.isKeyField())o.push(cv(t,r.key));else{var c=r.data.field(s.field);if(Xp(c))throw new Wd(zd.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=s.field.canonicalString();throw new Wd(zd.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(l,"' (used as the orderBy) does not exist."))}o.push(c)}}}catch(f){u.e(f)}finally{u.f()}return new wv(o,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);var i=HI(e.firestore);return function(e,t,n,r,i,a){var o=e.explicitOrderBy;if(i.length>o.length)throw new Wd(zd.INVALID_ARGUMENT,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));for(var u=[],s=0;s<i.length;s++){var c=i[s];if(o[s].field.isKeyField()){if("string"!=typeof c)throw new Wd(zd.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(typeof c));if(!vy(e)&&-1!==c.indexOf("/"))throw new Wd(zd.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(c,"' contains a slash."));var l=e.path.child(sp.fromString(c));if(!fp.isDocumentKey(l))throw new Wd(zd.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(l,"' is not because it contains an odd number of segments."));var f=new fp(l);u.push(cv(t,f))}else{var h=nS(n,r,c);u.push(h)}}return new wv(u,a)}(e._query,e.firestore._databaseId,i,t,n,r)}function AS(e,t,n){if("string"==typeof(n=Ie(n))){if(""===n)throw new Wd(zd.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!vy(t)&&-1!==n.indexOf("/"))throw new Wd(zd.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(sp.fromString(n));if(!fp.isDocumentKey(r))throw new Wd(zd.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return cv(e,new fp(r))}if(n instanceof Qx)return cv(e,n._key);throw new Wd(zd.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(qx(n),"."))}function PS(e,t){if(!Array.isArray(e)||0===e.length)throw new Wd(zd.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new Wd(zd.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function DS(e,t){if(t.isInequality()){var n=py(e),r=t.field;if(null!==n&&!n.isEqual(r))throw new Wd(zd.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(r.toString(),"'"));var i=dy(e);null!==i&&OS(e,r,i)}var a=function(e,t){var n,r=y(e);try{for(r.s();!(n=r.n()).done;){var i,a=y(n.value.getFlattenedFilters());try{for(a.s();!(i=a.n()).done;){var o=i.value;if(t.indexOf(o.op)>=0)return o.op}}catch(u){a.e(u)}finally{a.f()}}}catch(u){r.e(u)}finally{r.f()}return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==a)throw a===t.op?new Wd(zd.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new Wd(zd.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(a.toString(),"' filters."))}function OS(e,t,n){if(!n.isEqual(t))throw new Wd(zd.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}var LS=function(){function e(){u(this,e)}return l(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(nv(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $p(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Yp(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Vd()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return qp(e.fields,(function(e,i){r[e]=n.convertValue(i,t)})),r}},{key:"convertGeoPoint",value:function(e){return new jI($p(e.latitude),$p(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map((function(e){return n.convertValue(e,t)}))}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=Jp(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Zp(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=Qp(e);return new ap(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=sp.fromString(e);qd(fg(n));var r=new jp(n.get(1),n.get(3)),i=new fp(n.popFirst(5));return r.isEqual(t)||Fd("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),e}();function MS(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var FS=function(e){_(n,e);var t=T(n);function n(e){var r;return u(this,n),(r=t.call(this)).firestore=e,r}return l(n,[{key:"convertBytes",value:function(e){return new MI(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new Qx(this.firestore,null,t)}}]),n}(LS),US=function(){function e(t,n){u(this,e),this.hasPendingWrites=t,this.fromCache=n}return l(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),jS=function(e){_(n,e);var t=T(n);function n(e,r,i,a,o,s){var c;return u(this,n),(c=t.call(this,e,r,i,a,s))._firestore=e,c._firestoreImpl=e,c.metadata=o,c}return l(n,[{key:"exists",value:function(){return tn(x(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new VS(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(pS("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(hS),VS=function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.apply(this,arguments)}return l(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return tn(x(n.prototype),"data",this).call(this,e)}}]),n}(jS),qS=function(){function e(t,n,r,i){u(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new US(i.hasPendingWrites,i.fromCache),this.query=r}return l(e,[{key:"docs",get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach((function(r){e.call(t,new VS(n._firestore,n._userDataWriter,r.key,r,new US(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Wd(zd.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map((function(t){var r=new VS(e._firestore,e._userDataWriter,t.doc.key,t.doc,new US(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);return t.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((function(e){return t||3!==e.type})).map((function(t){var n=new VS(e._firestore,e._userDataWriter,t.doc.key,t.doc,new US(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:BS(t.type),doc:n,oldIndex:i,newIndex:a}}))}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),e}();function BS(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Vd()}}function zS(e,t){return e instanceof jS&&t instanceof jS?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof qS&&t instanceof qS&&e._firestore===t._firestore&&eI(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}function WS(e){e=Bx(e,Qx);var t=Bx(e.firestore,EI);return _I(CI(t),e._key).then((function(n){return eT(t,e,n)}))}var KS=function(e){_(n,e);var t=T(n);function n(e){var r;return u(this,n),(r=t.call(this)).firestore=e,r}return l(n,[{key:"convertBytes",value:function(e){return new MI(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new Qx(this.firestore,null,t)}}]),n}(LS);function HS(e){e=Bx(e,Qx);var t=Bx(e.firestore,EI),n=CI(t),r=new KS(t);return function(e,t){var n=new Kd;return e.asyncQueue.enqueueAndForget(h(o().mark((function r(){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=h(o().mark((function e(t,n,r){var i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,function(e,t){var n=Bd(e);return n.persistence.runTransaction("read document","readonly",(function(e){return n.localDocuments.getDocument(e,t)}))}(t,n);case 3:(i=e.sent).isFoundDocument()?r.resolve(i):i.isNoDocument()?r.resolve(null):r.reject(new Wd(zd.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),a=d_(e.t0,"Failed to get document '".concat(n," from cache")),r.reject(a);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,yI(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(n,e._key).then((function(n){return new jS(t,r,e._key,n,new US(null!==n&&n.hasLocalMutations,!0),e.converter)}))}function GS(e){e=Bx(e,$x);var t=Bx(e.firestore,EI),n=CI(t),r=new KS(t);return vS(e._query),xI(n,e._query).then((function(n){return new qS(t,r,e,n)}))}function QS(e){e=Bx(e,$x);var t=Bx(e.firestore,EI),n=CI(t),r=new KS(t);return function(e,t){var n=new Kd;return e.asyncQueue.enqueueAndForget(h(o().mark((function r(){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=h(o().mark((function e(t,n,r){var i,a,u,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Hb(t,n,!0);case 3:i=e.sent,a=new D_(n,i.Hi),u=a.Wu(i.documents),s=a.applyChanges(u,!1),r.resolve(s.snapshot),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),c=d_(e.t0,"Failed to execute query '".concat(n," against cache")),r.reject(c);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,yI(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(n,e._query).then((function(n){return new qS(t,r,e,n)}))}function $S(e,t,n){e=Bx(e,Qx);var r=Bx(e.firestore,EI),i=MS(e.converter,t,n);return ZS(r,[GI(HI(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Wy.none())])}function YS(e,t,n){e=Bx(e,Qx);for(var r=Bx(e.firestore,EI),i=HI(r),a=arguments.length,o=new Array(a>3?a-3:0),u=3;u<a;u++)o[u-3]=arguments[u];return ZS(r,[("string"==typeof(t=Ie(t))||t instanceof FI?tS(i,"updateDoc",e._key,t,n,o):eS(i,"updateDoc",e._key,t)).toMutation(e._key,Wy.exists(!0))])}function XS(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,a,u;e=Ie(e);var s={includeMetadataChanges:!1},c=0;"object"!=typeof n[c]||SI(n[c])||(s=n[c],c++);var l,f,d,p={includeMetadataChanges:s.includeMetadataChanges};if(SI(n[c])){var v=n[c];n[c]=null===(i=v.next)||void 0===i?void 0:i.bind(v),n[c+1]=null===(a=v.error)||void 0===a?void 0:a.bind(v),n[c+2]=null===(u=v.complete)||void 0===u?void 0:u.bind(v)}if(e instanceof Qx)f=Bx(e.firestore,EI),d=fy(e._key.path),l={next:function(t){n[c]&&n[c](eT(f,e,t))},error:n[c+1],complete:n[c+2]};else{var y=Bx(e,$x);f=Bx(y.firestore,EI),d=y._query;var m=new KS(f);l={next:function(e){n[c]&&n[c](new qS(f,m,y,e))},error:n[c+1],complete:n[c+2]},vS(e._query)}return function(e,t,n,r){var i=new nI(r),a=new T_(t,i,n);return e.asyncQueue.enqueueAndForget(h(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=k_,t.next=3,bI(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)})))),function(){i.bc(),e.asyncQueue.enqueueAndForget(h(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=w_,t.next=3,bI(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)}))))}}(CI(f),d,p,l)}function JS(e,t){return function(e,t){var n=new nI(t);return e.asyncQueue.enqueueAndForget(h(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){Bd(e).Ru.add(t),t.next()},t.next=3,bI(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)})))),function(){n.bc(),e.asyncQueue.enqueueAndForget(h(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){Bd(e).Ru.delete(t)},t.next=3,bI(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)}))))}}(CI(e=Bx(e,EI)),SI(t)?t:{next:t})}function ZS(e,t){return function(e,t){var n=new Kd;return e.asyncQueue.enqueueAndForget(h(o().mark((function r(){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=z_,r.next=3,gI(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(CI(e),t)}function eT(e,t,n){var r=n.docs.get(t._key),i=new KS(e);return new jS(e,i,t._key,r,new US(n.hasPendingWrites,n.fromCache),t.converter)}var tT={maxAttempts:5},nT=function(){function e(t,n){u(this,e),this._firestore=t,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=HI(t)}return l(e,[{key:"set",value:function(e,t,n){this._verifyNotCommitted();var r=rT(e,this._firestore),i=MS(r.converter,t,n),a=GI(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(a.toMutation(r._key,Wy.none())),this}},{key:"update",value:function(e,t,n){this._verifyNotCommitted();for(var r,i=rT(e,this._firestore),a=arguments.length,o=new Array(a>3?a-3:0),u=3;u<a;u++)o[u-3]=arguments[u];return r="string"==typeof(t=Ie(t))||t instanceof FI?tS(this._dataReader,"WriteBatch.update",i._key,t,n,o):eS(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(r.toMutation(i._key,Wy.exists(!0))),this}},{key:"delete",value:function(e){this._verifyNotCommitted();var t=rT(e,this._firestore);return this._mutations=this._mutations.concat(new am(t._key,Wy.none())),this}},{key:"commit",value:function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}},{key:"_verifyNotCommitted",value:function(){if(this._committed)throw new Wd(zd.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}]),e}();function rT(e,t){if((e=Ie(e)).firestore!==t)throw new Wd(zd.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}var iT=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this,e,r))._firestore=e,i}return l(n,[{key:"get",value:function(e){var t=this,r=rT(e,this._firestore),i=new KS(this._firestore);return tn(x(n.prototype),"get",this).call(this,e).then((function(e){return new jS(t._firestore,i,r._key,e._document,new US(!1,!1),r.converter)}))}}]),n}(function(){function e(t,n){u(this,e),this._firestore=t,this._transaction=n,this._dataReader=HI(t)}return l(e,[{key:"get",value:function(e){var t=this,n=rT(e,this._firestore),r=new FS(this._firestore);return this._transaction.lookup([n._key]).then((function(e){if(!e||1!==e.length)return Vd();var i=e[0];if(i.isFoundDocument())return new hS(t._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new hS(t._firestore,r,n._key,null,n.converter);throw Vd()}))}},{key:"set",value:function(e,t,n){var r=rT(e,this._firestore),i=MS(r.converter,t,n),a=GI(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,a),this}},{key:"update",value:function(e,t,n){for(var r,i=rT(e,this._firestore),a=arguments.length,o=new Array(a>3?a-3:0),u=3;u<a;u++)o[u-3]=arguments[u];return r="string"==typeof(t=Ie(t))||t instanceof FI?tS(this._dataReader,"Transaction.update",i._key,t,n,o):eS(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,r),this}},{key:"delete",value:function(e){var t=rT(e,this._firestore);return this._transaction.delete(t._key),this}}]),e}());function aT(){return new YI("serverTimestamp")}function oT(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new XI("arrayUnion",t)}function uT(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new JI("arrayRemove",t)}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Dd=e}(_t),vt(new Ee("firestore",(function(e,n){var r=n.instanceIdentifier,i=n.options,a=e.getProvider("app").getImmediate(),o=new EI(new $d(e.getProvider("auth-internal")),new Zd(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Wd(zd.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new jp(e.options.projectId,t)}(a,r),a);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),Ct(Ad,"3.8.0",e),Ct(Ad,"3.8.0","esm2017")}();function sT(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new Wd("invalid-argument","Invalid options passed to function ".concat(e,"(): You cannot ")+'specify both "merge" and "mergeFields".');return t}function cT(){if("undefined"===typeof Uint8Array)throw new Wd("unimplemented","Uint8Arrays are not available in this environment.")}function lT(){if("undefined"==typeof atob)throw new Wd("unimplemented","Blobs are unavailable in Firestore in this environment.")}var fT=function(){function e(t){u(this,e),this._delegate=t}return l(e,[{key:"toBase64",value:function(){return lT(),this._delegate.toBase64()}},{key:"toUint8Array",value:function(){return cT(),this._delegate.toUint8Array()}},{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}},{key:"toString",value:function(){return"Blob(base64: "+this.toBase64()+")"}}],[{key:"fromBase64String",value:function(t){return lT(),new e(MI.fromBase64String(t))}},{key:"fromUint8Array",value:function(t){return cT(),new e(MI.fromUint8Array(t))}}]),e}();function hT(e){return function(e,t){if("object"!==typeof e||null===e)return!1;var n,r=e,i=y(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a in r&&"function"===typeof r[a])return!0}}catch(o){i.e(o)}finally{i.f()}return!1}(e,["next","error","complete"])}var dT=function(){function e(){u(this,e)}return l(e,[{key:"enableIndexedDbPersistence",value:function(e,t){return function(e,t){LI(e=Bx(e,EI));var n=CI(e),r=e._freezeSettings(),i=new Mx;return RI(n,i,new Ox(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})}},{key:"enableMultiTabIndexedDbPersistence",value:function(e){return function(e){LI(e=Bx(e,EI));var t=CI(e),n=e._freezeSettings(),r=new Mx;return RI(t,r,new Lx(r,n.cacheSizeBytes))}(e._delegate)}},{key:"clearIndexedDbPersistence",value:function(e){return function(e){if(e._initialized&&!e._terminated)throw new Wd(zd.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var t=new Kd;return e._queue.enqueueAndForgetEvenWhileRestricted(h(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,function(){var e=h(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ep.C()){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return n=t+"main",e.next=5,Ep.delete(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(Ab(e._databaseId,e._persistenceKey));case 3:t.resolve(),n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),t.reject(n.t0);case 9:case"end":return n.stop()}}),n,null,[[0,6]])})))),t.promise}(e._delegate)}}]),e}(),pT=function(){function e(t,n,r){var i=this;u(this,e),this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:function(){return i.terminate()}},t instanceof jp||(this._appCompat=t)}return l(e,[{key:"_databaseId",get:function(){return this._delegate._databaseId}},{key:"settings",value:function(e){var t=this._delegate._getSettings();e.merge||t.host===e.host||Ud("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}},{key:"useEmulator",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Gx(this._delegate,e,t,n)}},{key:"enableNetwork",value:function(){return AI(this._delegate)}},{key:"disableNetwork",value:function(){return PI(this._delegate)}},{key:"enablePersistence",value:function(e){var t=!1,n=!1;return e&&Ux("synchronizeTabs",t=!!e.synchronizeTabs,"experimentalForceOwningTab",n=!!e.experimentalForceOwningTab),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}},{key:"clearPersistence",value:function(){return this._persistenceProvider.clearIndexedDbPersistence(this)}},{key:"terminate",value:function(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}},{key:"waitForPendingWrites",value:function(){return function(e){return function(e){var t=new Kd;return e.asyncQueue.enqueueAndForget(h(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=ex,n.next=3,gI(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}}),n)})))),t.promise}(CI(e=Bx(e,EI)))}(this._delegate)}},{key:"onSnapshotsInSync",value:function(e){return JS(this._delegate,e)}},{key:"app",get:function(){if(!this._appCompat)throw new Wd("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}},{key:"collection",value:function(e){try{return new CT(this,Xx(this._delegate,e))}catch(t){throw bT(t,"collection()","Firestore.collection()")}}},{key:"doc",value:function(e){try{return new kT(this,Jx(this._delegate,e))}catch(t){throw bT(t,"doc()","Firestore.doc()")}}},{key:"collectionGroup",value:function(e){try{return new ST(this,function(e,t){if(e=Bx(e,Hx),Fx("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new Wd(zd.INVALID_ARGUMENT,"Invalid collection ID '".concat(t,"' passed to function collectionGroup(). Collection IDs must not contain '/'."));return new $x(e,null,function(e){return new cy(sp.emptyPath(),e)}(t))}(this._delegate,e))}catch(t){throw bT(t,"collectionGroup()","Firestore.collectionGroup()")}}},{key:"runTransaction",value:function(e){var t=this;return function(e,t,n){e=Bx(e,EI);var r=Object.assign(Object.assign({},tT),n);return function(e){if(e.maxAttempts<1)throw new Wd(zd.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){var r=new Kd;return e.asyncQueue.enqueueAndForget(h(o().mark((function i(){var a;return o().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,kI(e);case 2:a=i.sent,new aI(e.asyncQueue,a,n,t,r).run();case 4:case"end":return i.stop()}}),i)})))),r.promise}(CI(e),(function(n){return t(new iT(e,n))}),r)}(this._delegate,(function(n){return e(new yT(t,n))}))}},{key:"batch",value:function(){var e=this;return CI(this._delegate),new mT(new nT(this._delegate,(function(t){return ZS(e._delegate,t)})))}},{key:"loadBundle",value:function(e){return DI(this._delegate,e)}},{key:"namedQuery",value:function(e){var t=this;return OI(this._delegate,e).then((function(e){return e?new ST(t,e):null}))}}]),e}(),vT=function(e){_(n,e);var t=T(n);function n(e){var r;return u(this,n),(r=t.call(this)).firestore=e,r}return l(n,[{key:"convertBytes",value:function(e){return new fT(new MI(e))}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return kT.forKey(t,this.firestore,null)}}]),n}(LS);var yT=function(){function e(t,n){u(this,e),this._firestore=t,this._delegate=n,this._userDataWriter=new vT(t)}return l(e,[{key:"get",value:function(e){var t=this,n=NT(e);return this._delegate.get(n).then((function(e){return new xT(t._firestore,new jS(t._firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,n.converter))}))}},{key:"set",value:function(e,t,n){var r=NT(e);return n?(sT("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];var o,u=NT(e);2===arguments.length?this._delegate.update(u,t):(o=this._delegate).update.apply(o,[u,t,n].concat(i));return this}},{key:"delete",value:function(e){var t=NT(e);return this._delegate.delete(t),this}}]),e}(),mT=function(){function e(t){u(this,e),this._delegate=t}return l(e,[{key:"set",value:function(e,t,n){var r=NT(e);return n?(sT("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];var o,u=NT(e);2===arguments.length?this._delegate.update(u,t):(o=this._delegate).update.apply(o,[u,t,n].concat(i));return this}},{key:"delete",value:function(e){var t=NT(e);return this._delegate.delete(t),this}},{key:"commit",value:function(){return this._delegate.commit()}}]),e}(),gT=function(){function e(t,n,r){u(this,e),this._firestore=t,this._userDataWriter=n,this._delegate=r}return l(e,[{key:"fromFirestore",value:function(e,t){var n=new VS(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new IT(this._firestore,n),null!==t&&void 0!==t?t:{})}},{key:"toFirestore",value:function(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}}],[{key:"getInstance",value:function(t,n){var r=e.INSTANCES,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var a=i.get(n);return a||(a=new e(t,new vT(t),n),i.set(n,a)),a}}]),e}();gT.INSTANCES=new WeakMap;var kT=function(){function e(t,n){u(this,e),this.firestore=t,this._delegate=n,this._userDataWriter=new vT(t)}return l(e,[{key:"id",get:function(){return this._delegate.id}},{key:"parent",get:function(){return new CT(this.firestore,this._delegate.parent)}},{key:"path",get:function(){return this._delegate.path}},{key:"collection",value:function(e){try{return new CT(this.firestore,Xx(this._delegate,e))}catch(t){throw bT(t,"collection()","DocumentReference.collection()")}}},{key:"isEqual",value:function(e){return(e=Ie(e))instanceof Qx&&Zx(this._delegate,e)}},{key:"set",value:function(e,t){t=sT("DocumentReference.set",t);try{return t?$S(this._delegate,e,t):$S(this._delegate,e)}catch(n){throw bT(n,"setDoc()","DocumentReference.set()")}}},{key:"update",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];try{return 1===arguments.length?YS(this._delegate,e):YS.apply(void 0,[this._delegate,e,t].concat(r))}catch(a){throw bT(a,"updateDoc()","DocumentReference.update()")}}},{key:"delete",value:function(){return function(e){return ZS(Bx(e.firestore,EI),[new am(e._key,Wy.none())])}(this._delegate)}},{key:"onSnapshot",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=wT(n),a=_T(n,(function(t){return new xT(e.firestore,new jS(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}));return XS(this._delegate,i,a)}},{key:"get",value:function(e){var t,n=this;return t="cache"===(null===e||void 0===e?void 0:e.source)?HS(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=Bx(e,Qx);var t=Bx(e.firestore,EI);return _I(CI(t),e._key,{source:"server"}).then((function(n){return eT(t,e,n)}))}(this._delegate):WS(this._delegate),t.then((function(e){return new xT(n.firestore,new jS(n.firestore._delegate,n._userDataWriter,e._key,e._document,e.metadata,n._delegate.converter))}))}},{key:"withConverter",value:function(t){return new e(this.firestore,t?this._delegate.withConverter(gT.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}],[{key:"forPath",value:function(t,n,r){if(t.length%2!==0)throw new Wd("invalid-argument","Invalid document reference. Document references must have an even number of segments, but "+"".concat(t.canonicalString()," has ").concat(t.length));return new e(n,new Qx(n._delegate,r,new fp(t)))}},{key:"forKey",value:function(t,n,r){return new e(n,new Qx(n._delegate,r,t))}}]),e}();function bT(e,t,n){return e.message=e.message.replace(t,n),e}function wT(e){var t,n=y(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;if("object"===typeof r&&!hT(r))return r}}catch(i){n.e(i)}finally{n.f()}return{}}function _T(e,t){var n,r,i;return{next:function(e){i.next&&i.next(t(e))},error:null===(n=(i=hT(e[0])?e[0]:hT(e[1])?e[1]:"function"===typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var xT=function(){function e(t,n){u(this,e),this._firestore=t,this._delegate=n}return l(e,[{key:"ref",get:function(){return new kT(this._firestore,this._delegate.ref)}},{key:"id",get:function(){return this._delegate.id}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"exists",get:function(){return this._delegate.exists()}},{key:"data",value:function(e){return this._delegate.data(e)}},{key:"get",value:function(e,t){return this._delegate.get(e,t)}},{key:"isEqual",value:function(e){return zS(this._delegate,e._delegate)}}]),e}(),IT=function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.apply(this,arguments)}return l(n,[{key:"data",value:function(e){var t=this._delegate.data(e);return function(e,t){e||Vd()}(void 0!==t),t}}]),n}(xT),ST=function(){function e(t,n){u(this,e),this.firestore=t,this._delegate=n,this._userDataWriter=new vT(t)}return l(e,[{key:"where",value:function(t,n,r){try{return new e(this.firestore,gS(this._delegate,bS(t,n,r)))}catch(i){throw bT(i,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"orderBy",value:function(t,n){try{return new e(this.firestore,gS(this._delegate,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=t,r=pS("orderBy",e);return _S._create(r,n)}(t,n)))}catch(r){throw bT(r,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"limit",value:function(t){try{return new e(this.firestore,gS(this._delegate,function(e){return zx("limit",e),xS._create("limit",e,"F")}(t)))}catch(n){throw bT(n,"limit()","Query.limit()")}}},{key:"limitToLast",value:function(t){try{return new e(this.firestore,gS(this._delegate,function(e){return zx("limitToLast",e),xS._create("limitToLast",e,"L")}(t)))}catch(n){throw bT(n,"limitToLast()","Query.limitToLast()")}}},{key:"startAt",value:function(){try{return new e(this.firestore,gS(this._delegate,SS.apply(void 0,arguments)))}catch(t){throw bT(t,"startAt()","Query.startAt()")}}},{key:"startAfter",value:function(){try{return new e(this.firestore,gS(this._delegate,TS.apply(void 0,arguments)))}catch(t){throw bT(t,"startAfter()","Query.startAfter()")}}},{key:"endBefore",value:function(){try{return new e(this.firestore,gS(this._delegate,CS.apply(void 0,arguments)))}catch(t){throw bT(t,"endBefore()","Query.endBefore()")}}},{key:"endAt",value:function(){try{return new e(this.firestore,gS(this._delegate,NS.apply(void 0,arguments)))}catch(t){throw bT(t,"endAt()","Query.endAt()")}}},{key:"isEqual",value:function(e){return eI(this._delegate,e._delegate)}},{key:"get",value:function(e){var t,n=this;return t="cache"===(null===e||void 0===e?void 0:e.source)?QS(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=Bx(e,$x);var t=Bx(e.firestore,EI),n=CI(t),r=new KS(t);return xI(n,e._query,{source:"server"}).then((function(n){return new qS(t,r,e,n)}))}(this._delegate):GS(this._delegate),t.then((function(e){return new ET(n.firestore,new qS(n.firestore._delegate,n._userDataWriter,n._delegate,e._snapshot))}))}},{key:"onSnapshot",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=wT(n),a=_T(n,(function(t){return new ET(e.firestore,new qS(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}));return XS(this._delegate,i,a)}},{key:"withConverter",value:function(t){return new e(this.firestore,t?this._delegate.withConverter(gT.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}]),e}(),TT=function(){function e(t,n){u(this,e),this._firestore=t,this._delegate=n}return l(e,[{key:"type",get:function(){return this._delegate.type}},{key:"doc",get:function(){return new IT(this._firestore,this._delegate.doc)}},{key:"oldIndex",get:function(){return this._delegate.oldIndex}},{key:"newIndex",get:function(){return this._delegate.newIndex}}]),e}(),ET=function(){function e(t,n){u(this,e),this._firestore=t,this._delegate=n}return l(e,[{key:"query",get:function(){return new ST(this._firestore,this._delegate.query)}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"size",get:function(){return this._delegate.size}},{key:"empty",get:function(){return this._delegate.empty}},{key:"docs",get:function(){var e=this;return this._delegate.docs.map((function(t){return new IT(e._firestore,t)}))}},{key:"docChanges",value:function(e){var t=this;return this._delegate.docChanges(e).map((function(e){return new TT(t._firestore,e)}))}},{key:"forEach",value:function(e,t){var n=this;this._delegate.forEach((function(r){e.call(t,new IT(n._firestore,r))}))}},{key:"isEqual",value:function(e){return zS(this._delegate,e._delegate)}}]),e}(),CT=function(e){_(n,e);var t=T(n);function n(e,r){var i;return u(this,n),(i=t.call(this,e,r)).firestore=e,i._delegate=r,i}return l(n,[{key:"id",get:function(){return this._delegate.id}},{key:"path",get:function(){return this._delegate.path}},{key:"parent",get:function(){var e=this._delegate.parent;return e?new kT(this.firestore,e):null}},{key:"doc",value:function(e){try{return new kT(this.firestore,void 0===e?Jx(this._delegate):Jx(this._delegate,e))}catch(t){throw bT(t,"doc()","CollectionReference.doc()")}}},{key:"add",value:function(e){var t=this;return function(e,t){var n=Bx(e.firestore,EI),r=Jx(e),i=MS(e.converter,t);return ZS(n,[GI(HI(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Wy.exists(!1))]).then((function(){return r}))}(this._delegate,e).then((function(e){return new kT(t.firestore,e)}))}},{key:"isEqual",value:function(e){return Zx(this._delegate,e._delegate)}},{key:"withConverter",value:function(e){return new n(this.firestore,e?this._delegate.withConverter(gT.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}]),n}(ST);function NT(e){return Bx(e,Qx)}var RT,AT=function(){function e(){u(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._delegate=E(FI,n)}return l(e,[{key:"isEqual",value:function(e){return(e=Ie(e))instanceof FI&&this._delegate._internalPath.isEqual(e._internalPath)}}],[{key:"documentId",value:function(){return new e(lp.keyField().canonicalString())}}]),e}(),PT=function(){function e(t){u(this,e),this._delegate=t}return l(e,[{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}}],[{key:"serverTimestamp",value:function(){var t=aT();return t._methodName="FieldValue.serverTimestamp",new e(t)}},{key:"delete",value:function(){var t=new QI("deleteField");return t._methodName="FieldValue.delete",new e(t)}},{key:"arrayUnion",value:function(){var t=oT.apply(void 0,arguments);return t._methodName="FieldValue.arrayUnion",new e(t)}},{key:"arrayRemove",value:function(){var t=uT.apply(void 0,arguments);return t._methodName="FieldValue.arrayRemove",new e(t)}},{key:"increment",value:function(t){var n=function(e){return new ZI("increment",e)}(t);return n._methodName="FieldValue.increment",new e(n)}}]),e}(),DT={Firestore:pT,GeoPoint:jI,Timestamp:ap,Blob:fT,Transaction:yT,WriteBatch:mT,DocumentReference:kT,DocumentSnapshot:xT,Query:ST,QueryDocumentSnapshot:IT,QuerySnapshot:ET,CollectionReference:CT,FieldPath:AT,FieldValue:PT,setLogLevel:function(e){!function(e){Od.setLogLevel(e)}(e)},CACHE_SIZE_UNLIMITED:-1};function OT(){return OT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},OT.apply(this,arguments)}!function(e){!function(e,t){e.INTERNAL.registerComponent(new Ee("firestore-compat",(function(e){var n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(n,r)}),"PUBLIC").setServiceProps(Object.assign({},DT)))}(e,(function(e,t){return new pT(e,t,new dT)})),e.registerVersion("@firebase/firestore-compat","0.3.0")}(Jt),function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(RT||(RT={}));var LT,MT="popstate";function FT(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function UT(e){return{usr:e.state,key:e.key}}function jT(e,t,n,r){return void 0===n&&(n=null),OT({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?qT(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function VT(e){var t=e.pathname,n=void 0===t?"/":t,r=e.search,i=void 0===r?"":r,a=e.hash,o=void 0===a?"":a;return i&&"?"!==i&&(n+="?"===i.charAt(0)?i:"?"+i),o&&"#"!==o&&(n+="#"===o.charAt(0)?o:"#"+o),n}function qT(e){var t={};if(e){var n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));var r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function BT(e){var t="undefined"!==typeof window&&"undefined"!==typeof window.location&&"null"!==window.location.origin?window.location.origin:window.location.href,n="string"===typeof e?e:VT(e);return FT(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}function zT(e,t,n,r){void 0===r&&(r={});var i=r,a=i.window,o=void 0===a?document.defaultView:a,u=i.v5Compat,s=void 0!==u&&u,c=o.history,l=RT.Pop,f=null;function h(){l=RT.Pop,f&&f({action:l,location:d.location})}var d={get action(){return l},get location(){return e(o,c)},listen:function(e){if(f)throw new Error("A history only accepts one active listener");return o.addEventListener(MT,h),f=e,function(){o.removeEventListener(MT,h),f=null}},createHref:function(e){return t(o,e)},encodeLocation:function(e){var t=BT("string"===typeof e?e:VT(e));return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l=RT.Push;var r=jT(d.location,e,t);n&&n(r,e);var i=UT(r),a=d.createHref(r);try{c.pushState(i,"",a)}catch(VR){o.location.assign(a)}s&&f&&f({action:l,location:d.location})},replace:function(e,t){l=RT.Replace;var r=jT(d.location,e,t);n&&n(r,e);var i=UT(r),a=d.createHref(r);c.replaceState(i,"",a),s&&f&&f({action:l,location:d.location})},go:function(e){return c.go(e)}};return d}function WT(e,t,n){void 0===n&&(n="/");var r=ZT(("string"===typeof t?qT(t):t).pathname||"/",n);if(null==r)return null;var i=KT(e);!function(e){e.sort((function(e,t){return e.score!==t.score?t.score-e.score:function(e,t){var n=e.length===t.length&&e.slice(0,-1).every((function(e,n){return e===t[n]}));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((function(e){return e.childrenIndex})),t.routesMeta.map((function(e){return e.childrenIndex})))}))}(i);for(var a=null,o=0;null==a&&o<i.length;++o)a=YT(i[o],JT(r));return a}function KT(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");var i=function(e,i,a){var o={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};o.relativePath.startsWith("/")&&(FT(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(r.length));var u=iE([r,o.relativePath]),s=n.concat(o);e.children&&e.children.length>0&&(FT(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+u+'".'),KT(e.children,t,s,u)),(null!=e.path||e.index)&&t.push({path:u,score:$T(u,e.index),routesMeta:s})};return e.forEach((function(e,t){var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?")){var r,a=y(HT(e.path));try{for(a.s();!(r=a.n()).done;){var o=r.value;i(e,t,o)}}catch(u){a.e(u)}finally{a.f()}}else i(e,t)})),t}function HT(e){var t=e.split("/");if(0===t.length)return[];var n=Zt(t),r=n[0],i=n.slice(1),a=r.endsWith("?"),o=r.replace(/\?$/,"");if(0===i.length)return a?[o,""]:[o];var u=HT(i.join("/")),s=[];return s.push.apply(s,Te(u.map((function(e){return""===e?o:[o,e].join("/")})))),a&&s.push.apply(s,Te(u)),s.map((function(t){return e.startsWith("/")&&""===t?"/":t}))}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(LT||(LT={}));var GT=/^:\w+$/,QT=function(e){return"*"===e};function $T(e,t){var n=e.split("/"),r=n.length;return n.some(QT)&&(r+=-2),t&&(r+=2),n.filter((function(e){return!QT(e)})).reduce((function(e,t){return e+(GT.test(t)?3:""===t?1:10)}),r)}function YT(e,t){for(var n=e.routesMeta,r={},i="/",a=[],o=0;o<n.length;++o){var u=n[o],s=o===n.length-1,c="/"===i?t:t.slice(i.length)||"/",l=XT({path:u.relativePath,caseSensitive:u.caseSensitive,end:s},c);if(!l)return null;Object.assign(r,l.params);var f=u.route;a.push({params:r,pathname:iE([i,l.pathname]),pathnameBase:aE(iE([i,l.pathnameBase])),route:f}),"/"!==l.pathnameBase&&(i=iE([i,l.pathnameBase]))}return a}function XT(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});var n=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);eE("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');var r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(function(e,t){return r.push(t),"/([^\\/]+)"}));e.endsWith("*")?(r.push("*"),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");var a=new RegExp(i,t?void 0:"i");return[a,r]}(e.path,e.caseSensitive,e.end),r=k(n,2),i=r[0],a=r[1],o=t.match(i);if(!o)return null;var u=o[0],s=u.replace(/(.)\/+$/,"$1"),c=o.slice(1),l=a.reduce((function(e,t,n){if("*"===t){var r=c[n]||"";s=u.slice(0,u.length-r.length).replace(/(.)\/+$/,"$1")}return e[t]=function(e,t){try{return decodeURIComponent(e)}catch(VR){return eE(!1,'The value for the URL param "'+t+'" will not be decoded because the string "'+e+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+VR+")."),e}}(c[n]||"",t),e}),{});return{params:l,pathname:u,pathnameBase:s,pattern:e}}function JT(e){try{return decodeURI(e)}catch(VR){return eE(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+VR+")."),e}}function ZT(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;var n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function eE(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function tE(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function nE(e){return e.filter((function(e,t){return 0===t||e.route.path&&e.route.path.length>0}))}function rE(e,t,n,r){var i;void 0===r&&(r=!1),"string"===typeof e?i=qT(e):(FT(!(i=OT({},e)).pathname||!i.pathname.includes("?"),tE("?","pathname","search",i)),FT(!i.pathname||!i.pathname.includes("#"),tE("#","pathname","hash",i)),FT(!i.search||!i.search.includes("#"),tE("#","search","hash",i)));var a,o=""===e||""===i.pathname,u=o?"/":i.pathname;if(r||null==u)a=n;else{var s=t.length-1;if(u.startsWith("..")){for(var c=u.split("/");".."===c[0];)c.shift(),s-=1;i.pathname=c.join("/")}a=s>=0?t[s]:"/"}var l=function(e,t){void 0===t&&(t="/");var n="string"===typeof e?qT(e):e,r=n.pathname,i=n.search,a=void 0===i?"":i,o=n.hash,u=void 0===o?"":o,s=r?r.startsWith("/")?r:function(e,t){var n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((function(e){".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(r,t):t;return{pathname:s,search:oE(a),hash:uE(u)}}(i,a),f=u&&"/"!==u&&u.endsWith("/"),h=(o||"."===u)&&n.endsWith("/");return l.pathname.endsWith("/")||!f&&!h||(l.pathname+="/"),l}var iE=function(e){return e.join("/").replace(/\/\/+/g,"/")},aE=function(e){return e.replace(/\/+$/,"").replace(/^\/*/,"/")},oE=function(e){return e&&"?"!==e?e.startsWith("?")?e:"?"+e:""},uE=function(e){return e&&"#"!==e?e.startsWith("#")?e:"#"+e:""},sE=function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.apply(this,arguments)}return l(n)}(C(Error));var cE=l((function e(t,n,r,i){u(this,e),void 0===i&&(i=!1),this.status=t,this.statusText=n||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}));function lE(e){return e instanceof cE}var fE=["post","put","patch","delete"],hE=(new Set(fE),["get"].concat(fE));new Set(hE),new Set([301,302,303,307,308]),new Set([307,308]),"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;function dE(){return dE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},dE.apply(this,arguments)}var pE="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},vE=t.useState,yE=t.useEffect,mE=t.useLayoutEffect,gE=t.useDebugValue;function kE(e){var t=e.getSnapshot,n=e.value;try{var r=t();return!pE(n,r)}catch(VR){return!0}}"undefined"===typeof window||"undefined"===typeof window.document||window.document.createElement,r.useSyncExternalStore;var bE=t.createContext(null);var wE=t.createContext(null);var _E=t.createContext(null);var xE=t.createContext(null);var IE=t.createContext(null);var SE=t.createContext(null);var TE=t.createContext({outlet:null,matches:[]});var EE=t.createContext(null);function CE(){return null!=t.useContext(SE)}function NE(){return CE()||FT(!1),t.useContext(SE).location}function RE(){CE()||FT(!1);var e=t.useContext(IE),n=e.basename,r=e.navigator,i=t.useContext(TE).matches,a=NE().pathname,o=JSON.stringify(nE(i).map((function(e){return e.pathnameBase}))),u=t.useRef(!1);t.useEffect((function(){u.current=!0}));var s=t.useCallback((function(e,t){if(void 0===t&&(t={}),u.current)if("number"!==typeof e){var i=rE(e,JSON.parse(o),a,"path"===t.relative);"/"!==n&&(i.pathname="/"===i.pathname?n:iE([n,i.pathname])),(t.replace?r.replace:r.push)(i,t.state,t)}else r.go(e)}),[n,r,o,a]);return s}var AE=t.createContext(null);function PE(e,n){var r=(void 0===n?{}:n).relative,i=t.useContext(TE).matches,a=NE().pathname,o=JSON.stringify(nE(i).map((function(e){return e.pathnameBase})));return t.useMemo((function(){return rE(e,JSON.parse(o),a,"path"===r)}),[e,o,a,r])}function DE(){var e=function(){var e,n=t.useContext(EE),r=jE(LE.UseRouteError),i=VE(LE.UseRouteError);if(n)return n;return null==(e=r.errors)?void 0:e[i]}(),n=lE(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},o={padding:"2px 4px",backgroundColor:i};return t.createElement(t.Fragment,null,t.createElement("h2",null,"Unhandled Thrown Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},n),r?t.createElement("pre",{style:a},r):null,t.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),t.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own\xa0",t.createElement("code",{style:o},"errorElement")," props on\xa0",t.createElement("code",{style:o},"<Route>")))}var OE,LE,ME=function(e){_(r,e);var n=T(r);function r(e){var t;return u(this,r),(t=n.call(this,e)).state={location:e.location,error:e.error},t}return l(r,[{key:"componentDidCatch",value:function(e,t){console.error("React Router caught the following error during render",e,t)}},{key:"render",value:function(){return this.state.error?t.createElement(TE.Provider,{value:this.props.routeContext},t.createElement(EE.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}},{key:"getDerivedStateFromProps",value:function(e,t){return t.location!==e.location?{error:e.error,location:e.location}:{error:e.error||t.error,location:t.location}}}]),r}(t.Component);function FE(e){var n=e.routeContext,r=e.match,i=e.children,a=t.useContext(bE);return a&&r.route.errorElement&&(a._deepestRenderedBoundaryId=r.route.id),t.createElement(TE.Provider,{value:n},i)}function UE(e,n,r){if(void 0===n&&(n=[]),null==e){if(null==r||!r.errors)return null;e=r.matches}var i=e,a=null==r?void 0:r.errors;if(null!=a){var o=i.findIndex((function(e){return e.route.id&&(null==a?void 0:a[e.route.id])}));o>=0||FT(!1),i=i.slice(0,Math.min(i.length,o+1))}return i.reduceRight((function(e,o,u){var s=o.route.id?null==a?void 0:a[o.route.id]:null,c=r?o.route.errorElement||t.createElement(DE,null):null,l=n.concat(i.slice(0,u+1)),f=function(){return t.createElement(FE,{match:o,routeContext:{outlet:e,matches:l}},s?c:void 0!==o.route.element?o.route.element:e)};return r&&(o.route.errorElement||0===u)?t.createElement(ME,{location:r.location,component:c,error:s,children:f(),routeContext:{outlet:null,matches:l}}):f()}),null)}function jE(e){var n=t.useContext(_E);return n||FT(!1),n}function VE(e){var n=function(e){var n=t.useContext(TE);return n||FT(!1),n}(),r=n.matches[n.matches.length-1];return r.route.id||FT(!1),r.route.id}!function(e){e.UseRevalidator="useRevalidator"}(OE||(OE={})),function(e){e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator"}(LE||(LE={}));var qE;function BE(e){var n=e.to,r=e.replace,i=e.state,a=e.relative;CE()||FT(!1);var o=t.useContext(_E),u=RE();return t.useEffect((function(){o&&"idle"!==o.navigation.state||u(n,{replace:r,state:i,relative:a})})),null}function zE(e){return function(e){var n=t.useContext(TE).outlet;return n?t.createElement(AE.Provider,{value:e},n):n}(e.context)}function WE(e){FT(!1)}function KE(e){var n=e.basename,r=void 0===n?"/":n,i=e.children,a=void 0===i?null:i,o=e.location,u=e.navigationType,s=void 0===u?RT.Pop:u,c=e.navigator,l=e.static,f=void 0!==l&&l;CE()&&FT(!1);var h=r.replace(/^\/*/,"/"),d=t.useMemo((function(){return{basename:h,navigator:c,static:f}}),[h,c,f]);"string"===typeof o&&(o=qT(o));var p=o,v=p.pathname,y=void 0===v?"/":v,m=p.search,g=void 0===m?"":m,k=p.hash,b=void 0===k?"":k,w=p.state,_=void 0===w?null:w,x=p.key,I=void 0===x?"default":x,S=t.useMemo((function(){var e=ZT(y,h);return null==e?null:{pathname:e,search:g,hash:b,state:_,key:I}}),[h,y,g,b,_,I]);return null==S?null:t.createElement(IE.Provider,{value:d},t.createElement(SE.Provider,{children:a,value:{location:S,navigationType:s}}))}function HE(e){var n=e.children,r=e.location,i=t.useContext(wE);return function(e,n){CE()||FT(!1);var r,i=t.useContext(IE).navigator,a=t.useContext(_E),o=t.useContext(TE).matches,u=o[o.length-1],s=u?u.params:{},c=(u&&u.pathname,u?u.pathnameBase:"/"),l=(u&&u.route,NE());if(n){var f,h="string"===typeof n?qT(n):n;"/"===c||(null==(f=h.pathname)?void 0:f.startsWith(c))||FT(!1),r=h}else r=l;var d=r.pathname||"/",p=WT(e,{pathname:"/"===c?d:d.slice(c.length)||"/"}),v=UE(p&&p.map((function(e){return Object.assign({},e,{params:Object.assign({},s,e.params),pathname:iE([c,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?c:iE([c,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})})),o,a||void 0);return n&&v?t.createElement(SE.Provider,{value:{location:dE({pathname:"/",search:"",hash:"",state:null,key:"default"},r),navigationType:RT.Pop}},v):v}(i&&!n?i.router.routes:QE(n),r)}!function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"}(qE||(qE={}));var GE=new Promise((function(){}));t.Component;function QE(e,n){void 0===n&&(n=[]);var r=[];return t.Children.forEach(e,(function(e,i){if(t.isValidElement(e))if(e.type!==t.Fragment){e.type!==WE&&FT(!1),e.props.index&&e.props.children&&FT(!1);var a=[].concat(Te(n),[i]),o={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,hasErrorBoundary:null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle};e.props.children&&(o.children=QE(e.props.children,a)),r.push(o)}else r.push.apply(r,QE(e.props.children,n))})),r}function $E(){return $E=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$E.apply(this,arguments)}function YE(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}var XE=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function JE(e){var n,r=e.basename,i=e.children,a=e.window,o=t.useRef();null==o.current&&(o.current=(void 0===(n={window:a,v5Compat:!0})&&(n={}),zT((function(e,t){var n=e.location;return jT("",{pathname:n.pathname,search:n.search,hash:n.hash},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:VT(t)}),null,n)));var u=o.current,s=k(t.useState({action:u.action,location:u.location}),2),c=s[0],l=s[1];return t.useLayoutEffect((function(){return u.listen(l)}),[u]),t.createElement(KE,{basename:r,children:i,location:c.location,navigationType:c.action,navigator:u})}var ZE=t.forwardRef((function(e,n){var r=e.onClick,i=e.relative,a=e.reloadDocument,o=e.replace,u=e.state,s=e.target,c=e.to,l=e.preventScrollReset,f=YE(e,XE),h=function(e,n){var r=(void 0===n?{}:n).relative;CE()||FT(!1);var i=t.useContext(IE),a=i.basename,o=i.navigator,u=PE(e,{relative:r}),s=u.hash,c=u.pathname,l=u.search,f=c;return"/"!==a&&(f="/"===c?a:iE([a,c])),o.createHref({pathname:f,search:l,hash:s})}(c,{relative:i}),d=function(e,n){var r=void 0===n?{}:n,i=r.target,a=r.replace,o=r.state,u=r.preventScrollReset,s=r.relative,c=RE(),l=NE(),f=PE(e,{relative:s});return t.useCallback((function(t){if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,i)){t.preventDefault();var n=void 0!==a?a:VT(l)===VT(f);c(e,{replace:n,state:o,preventScrollReset:u,relative:s})}}),[l,c,f,a,o,i,e,u,s])}(c,{replace:o,state:u,target:s,preventScrollReset:l,relative:i});return t.createElement("a",$E({},f,{href:h,onClick:a?r:function(e){r&&r(e),e.defaultPrevented||d(e)},ref:n,target:s}))}));var eC,tC;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"})(eC||(eC={})),function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(tC||(tC={}));var nC=n(248),rC=n(327),iC=n(164);var aC=function(e){e()},oC=function(){return aC},uC=(0,t.createContext)(null);function sC(){return(0,t.useContext)(uC)}var cC=function(){throw new Error("uSES not initialized!")},lC=cC,fC=function(e,t){return e===t};function hC(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:uC,n=e===uC?sC:function(){return(0,t.useContext)(e)};return function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fC;var i=n(),a=i.store,o=i.subscription,u=i.getServerState,s=lC(o.addNestedSub,a.getState,u||a.getState,e,r);return(0,t.useDebugValue)(s),s}}var dC=hC();n(110),n(900);var pC={notify:function(){},get:function(){return[]}};function vC(e,t){var n,r=pC;function i(){o.onStateChange&&o.onStateChange()}function a(){n||(n=t?t.addNestedSub(i):e.subscribe(i),r=function(){var e=oC(),t=null,n=null;return{clear:function(){t=null,n=null},notify:function(){e((function(){for(var e=t;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],n=t;n;)e.push(n),n=n.next;return e},subscribe:function(e){var r=!0,i=n={callback:e,next:null,prev:n};return i.prev?i.prev.next=i:t=i,function(){r&&null!==t&&(r=!1,i.next?i.next.prev=i.prev:n=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}())}var o={addNestedSub:function(e){return a(),r.subscribe(e)},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:i,isSubscribed:function(){return Boolean(n)},trySubscribe:a,tryUnsubscribe:function(){n&&(n(),n=void 0,r.clear(),r=pC)},getListeners:function(){return r}};return o}var yC=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement)?t.useLayoutEffect:t.useEffect;var mC=function(e){var n=e.store,r=e.context,i=e.children,a=e.serverState,o=(0,t.useMemo)((function(){var e=vC(n);return{store:n,subscription:e,getServerState:a?function(){return a}:void 0}}),[n,a]),u=(0,t.useMemo)((function(){return n.getState()}),[n]);yC((function(){var e=o.subscription;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),u!==n.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=void 0}}),[o,u]);var s=r||uC;return t.createElement(s.Provider,{value:o},i)};function gC(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:uC,n=e===uC?sC:function(){return(0,t.useContext)(e)};return function(){return n().store}}var kC=gC();function bC(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:uC,t=e===uC?kC:gC(e);return function(){return t().dispatch}}var wC,_C=bC();function xC(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function IC(e){return!!e&&!!e[dN]}function SC(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===pN}(e)||Array.isArray(e)||!!e[hN]||!!(null===(t=e.constructor)||void 0===t?void 0:t[hN])||PC(e)||DC(e))}function TC(e,t,n){void 0===n&&(n=!1),0===EC(e)?(n?Object.keys:vN)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function EC(e){var t=e[dN];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:PC(e)?2:DC(e)?3:0}function CC(e,t){return 2===EC(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function NC(e,t){return 2===EC(e)?e.get(t):e[t]}function RC(e,t,n){var r=EC(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function AC(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function PC(e){return sN&&e instanceof Map}function DC(e){return cN&&e instanceof Set}function OC(e){return e.o||e.t}function LC(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=yN(e);delete t[dN];for(var n=vN(t),r=0;r<n.length;r++){var i=n[r],a=t[i];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[i]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function MC(e,t){return void 0===t&&(t=!1),UC(e)||IC(e)||!SC(e)||(EC(e)>1&&(e.set=e.add=e.clear=e.delete=FC),Object.freeze(e),t&&TC(e,(function(e,t){return MC(t,!0)}),!0)),e}function FC(){xC(2)}function UC(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function jC(e){var t=mN[e];return t||xC(18,e),t}function VC(e,t){mN[e]||(mN[e]=t)}function qC(){return oN}function BC(e,t){t&&(jC("Patches"),e.u=[],e.s=[],e.v=t)}function zC(e){WC(e),e.p.forEach(HC),e.p=null}function WC(e){e===oN&&(oN=e.l)}function KC(e){return oN={p:[],l:oN,h:e,m:!0,_:0}}function HC(e){var t=e[dN];0===t.i||1===t.i?t.j():t.O=!0}function GC(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.g||jC("ES5").S(t,e,r),r?(n[dN].P&&(zC(t),xC(4)),SC(e)&&(e=QC(t,e),t.l||YC(t,e)),t.u&&jC("Patches").M(n[dN].t,e,t.u,t.s)):e=QC(t,n,[]),zC(t),t.u&&t.v(t.u,t.s),e!==fN?e:void 0}function QC(e,t,n){if(UC(t))return t;var r=t[dN];if(!r)return TC(t,(function(i,a){return $C(e,r,t,i,a,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return YC(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var i=4===r.i||5===r.i?r.o=LC(r.k):r.o;TC(3===r.i?new Set(i):i,(function(t,a){return $C(e,r,i,t,a,n)})),YC(e,i,!1),n&&e.u&&jC("Patches").N(r,n,e.u,e.s)}return r.o}function $C(e,t,n,r,i,a){if(IC(i)){var o=QC(e,i,a&&t&&3!==t.i&&!CC(t.R,r)?a.concat(r):void 0);if(RC(n,r,o),!IC(o))return;e.m=!1}if(SC(i)&&!UC(i)){if(!e.h.D&&e._<1)return;QC(e,i),t&&t.A.l||YC(e,i)}}function YC(e,t,n){void 0===n&&(n=!1),e.h.D&&e.m&&MC(t,n)}function XC(e,t){var n=e[dN];return(n?OC(n):e)[t]}function JC(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function ZC(e){e.P||(e.P=!0,e.l&&ZC(e.l))}function eN(e){e.o||(e.o=LC(e.t))}function tN(e,t,n){var r=PC(t)?jC("MapSet").F(t,n):DC(t)?jC("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:qC(),P:!1,I:!1,R:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=r,a=gN;n&&(i=[r],a=kN);var o=Proxy.revocable(i,a),u=o.revoke,s=o.proxy;return r.k=s,r.j=u,s}(t,n):jC("ES5").J(t,n);return(n?n.A:qC()).p.push(r),r}function nN(e){return IC(e)||xC(22,e),function e(t){if(!SC(t))return t;var n,r=t[dN],i=EC(t);if(r){if(!r.P&&(r.i<4||!jC("ES5").K(r)))return r.t;r.I=!0,n=rN(t,i),r.I=!1}else n=rN(t,i);return TC(n,(function(t,i){r&&NC(r.t,t)===i||RC(n,t,e(i))})),3===i?new Set(n):n}(e)}function rN(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return LC(e)}function iN(){function e(e,t){var n=i[e];return n?n.enumerable=t:i[e]=n={configurable:!0,enumerable:t,get:function(){var t=this[dN];return gN.get(t,e)},set:function(t){var n=this[dN];gN.set(n,e,t)}},n}function t(e){for(var t=e.length-1;t>=0;t--){var i=e[t][dN];if(!i.P)switch(i.i){case 5:r(i)&&ZC(i);break;case 4:n(i)&&ZC(i)}}}function n(e){for(var t=e.t,n=e.k,r=vN(n),i=r.length-1;i>=0;i--){var a=r[i];if(a!==dN){var o=t[a];if(void 0===o&&!CC(t,a))return!0;var u=n[a],s=u&&u[dN];if(s?s.t!==o:!AC(u,o))return!0}}var c=!!t[dN];return r.length!==vN(t).length+(c?0:1)}function r(e){var t=e.k;if(t.length!==e.t.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);if(n&&!n.get)return!0;for(var r=0;r<t.length;r++)if(!t.hasOwnProperty(r))return!0;return!1}var i={};VC("ES5",{J:function(t,n){var r=Array.isArray(t),i=function(t,n){if(t){for(var r=Array(n.length),i=0;i<n.length;i++)Object.defineProperty(r,""+i,e(i,!0));return r}var a=yN(n);delete a[dN];for(var o=vN(a),u=0;u<o.length;u++){var s=o[u];a[s]=e(s,t||!!a[s].enumerable)}return Object.create(Object.getPrototypeOf(n),a)}(r,t),a={i:r?5:4,A:n?n.A:qC(),P:!1,I:!1,R:{},l:n,t:t,k:i,o:null,O:!1,C:!1};return Object.defineProperty(i,dN,{value:a,writable:!0}),i},S:function(e,n,i){i?IC(n)&&n[dN].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var n=t[dN];if(n){var i=n.t,a=n.k,o=n.R,u=n.i;if(4===u)TC(a,(function(t){t!==dN&&(void 0!==i[t]||CC(i,t)?o[t]||e(a[t]):(o[t]=!0,ZC(n)))})),TC(i,(function(e){void 0!==a[e]||CC(a,e)||(o[e]=!1,ZC(n))}));else if(5===u){if(r(n)&&(ZC(n),o.length=!0),a.length<i.length)for(var s=a.length;s<i.length;s++)o[s]=!1;else for(var c=i.length;c<a.length;c++)o[c]=!0;for(var l=Math.min(a.length,i.length),f=0;f<l;f++)a.hasOwnProperty(f)||(o[f]=!0),void 0===o[f]&&e(a[f])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):r(e)}})}!function(e){lC=e}(rC.useSyncExternalStoreWithSelector),function(e){e}(nC.useSyncExternalStore),wC=iC.unstable_batchedUpdates,aC=wC;var aN,oN,uN="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),sN="undefined"!=typeof Map,cN="undefined"!=typeof Set,lN="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,fN=uN?Symbol.for("immer-nothing"):((aN={})["immer-nothing"]=!0,aN),hN=uN?Symbol.for("immer-draftable"):"__$immer_draftable",dN=uN?Symbol.for("immer-state"):"__$immer_state",pN=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),vN="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,yN=Object.getOwnPropertyDescriptors||function(e){var t={};return vN(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},mN={},gN={get:function(e,t){if(t===dN)return e;var n=OC(e);if(!CC(n,t))return function(e,t,n){var r,i=JC(t,n);return i?"value"in i?i.value:null===(r=i.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!SC(r)?r:r===XC(e.t,t)?(eN(e),e.o[t]=tN(e.A.h,r,e)):r},has:function(e,t){return t in OC(e)},ownKeys:function(e){return Reflect.ownKeys(OC(e))},set:function(e,t,n){var r=JC(OC(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var i=XC(OC(e),t),a=null==i?void 0:i[dN];if(a&&a.t===n)return e.o[t]=n,e.R[t]=!1,!0;if(AC(n,i)&&(void 0!==n||CC(e.t,t)))return!0;eN(e),ZC(e)}return e.o[t]===n&&(void 0!==n||t in e.o)||Number.isNaN(n)&&Number.isNaN(e.o[t])||(e.o[t]=n,e.R[t]=!0),!0},deleteProperty:function(e,t){return void 0!==XC(e.t,t)||t in e.t?(e.R[t]=!1,eN(e),ZC(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=OC(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){xC(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){xC(12)}},kN={};TC(gN,(function(e,t){kN[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),kN.deleteProperty=function(e,t){return kN.set.call(this,e,t,void 0)},kN.set=function(e,t,n){return gN.set.call(this,e[0],t,n,e[0])};var bN=function(){function e(e){var t=this;this.g=lN,this.D=!0,this.produce=function(e,n,r){if("function"==typeof e&&"function"!=typeof n){var i=n;n=e;var a=t;return function(e){var t=this;void 0===e&&(e=i);for(var r=arguments.length,o=Array(r>1?r-1:0),u=1;u<r;u++)o[u-1]=arguments[u];return a.produce(e,(function(e){var r;return(r=n).call.apply(r,[t,e].concat(o))}))}}var o;if("function"!=typeof n&&xC(6),void 0!==r&&"function"!=typeof r&&xC(7),SC(e)){var u=KC(t),s=tN(t,e,void 0),c=!0;try{o=n(s),c=!1}finally{c?zC(u):WC(u)}return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return BC(u,r),GC(e,u)}),(function(e){throw zC(u),e})):(BC(u,r),GC(o,u))}if(!e||"object"!=typeof e){if(void 0===(o=n(e))&&(o=e),o===fN&&(o=void 0),t.D&&MC(o,!0),r){var l=[],f=[];jC("Patches").M(e,o,l,f),r(l,f)}return o}xC(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(i))}))};var r,i,a=t.produce(e,n,(function(e,t){r=e,i=t}));return"undefined"!=typeof Promise&&a instanceof Promise?a.then((function(e){return[e,r,i]})):[a,r,i]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){SC(e)||xC(8),IC(e)&&(e=nN(e));var t=KC(this),n=tN(this,e,void 0);return n[dN].C=!0,WC(t),n},t.finishDraft=function(e,t){var n=(e&&e[dN]).A;return BC(n,t),GC(void 0,n)},t.setAutoFreeze=function(e){this.D=e},t.setUseProxies=function(e){e&&!lN&&xC(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));var i=jC("Patches").$;return IC(e)?i(e,t):this.produce(e,(function(e){return i(e,t)}))},e}(),wN=new bN,_N=wN.produce,xN=(wN.produceWithPatches.bind(wN),wN.setAutoFreeze.bind(wN),wN.setUseProxies.bind(wN),wN.applyPatches.bind(wN),wN.createDraft.bind(wN),wN.finishDraft.bind(wN),_N);function IN(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var SN="function"===typeof Symbol&&Symbol.observable||"@@observable",TN=function(){return Math.random().toString(36).substring(7).split("").join(".")},EN={INIT:"@@redux/INIT"+TN(),REPLACE:"@@redux/REPLACE"+TN(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+TN()}};function CN(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function NN(e,t,n){var r;if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(IN(0));if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(IN(1));return n(NN)(e,t)}if("function"!==typeof e)throw new Error(IN(2));var i=e,a=t,o=[],u=o,s=!1;function c(){u===o&&(u=o.slice())}function l(){if(s)throw new Error(IN(3));return a}function f(e){if("function"!==typeof e)throw new Error(IN(4));if(s)throw new Error(IN(5));var t=!0;return c(),u.push(e),function(){if(t){if(s)throw new Error(IN(6));t=!1,c();var n=u.indexOf(e);u.splice(n,1),o=null}}}function h(e){if(!CN(e))throw new Error(IN(7));if("undefined"===typeof e.type)throw new Error(IN(8));if(s)throw new Error(IN(9));try{s=!0,a=i(a,e)}finally{s=!1}for(var t=o=u,n=0;n<t.length;n++){(0,t[n])()}return e}function d(e){if("function"!==typeof e)throw new Error(IN(10));i=e,h({type:EN.REPLACE})}function p(){var e,t=f;return(e={subscribe:function(e){if("object"!==typeof e||null===e)throw new Error(IN(11));function n(){e.next&&e.next(l())}return n(),{unsubscribe:t(n)}}})[SN]=function(){return this},e}return h({type:EN.INIT}),(r={dispatch:h,subscribe:f,getState:l,replaceReducer:d})[SN]=p,r}function RN(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var i=t[r];0,"function"===typeof e[i]&&(n[i]=e[i])}var a,o=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if("undefined"===typeof n(void 0,{type:EN.INIT}))throw new Error(IN(12));if("undefined"===typeof n(void 0,{type:EN.PROBE_UNKNOWN_ACTION()}))throw new Error(IN(13))}))}(n)}catch(u){a=u}return function(e,t){if(void 0===e&&(e={}),a)throw a;for(var r=!1,i={},u=0;u<o.length;u++){var s=o[u],c=n[s],l=e[s],f=c(l,t);if("undefined"===typeof f){t&&t.type;throw new Error(IN(14))}i[s]=f,r=r||f!==l}return(r=r||o.length!==Object.keys(e).length)?i:e}}function AN(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function PN(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error(IN(15))},i={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},a=t.map((function(e){return e(i)}));return r=AN.apply(void 0,a)(n.dispatch),Ve(Ve({},n),{},{dispatch:r})}}}function DN(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(i){return"function"===typeof i?i(n,r,e):t(i)}}}}var ON=DN();ON.withExtraArgument=DN;var LN=ON,MN=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),FN=function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(u){a=[6,u],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},UN=function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e},jN=Object.defineProperty,VN=Object.defineProperties,qN=Object.getOwnPropertyDescriptors,BN=Object.getOwnPropertySymbols,zN=Object.prototype.hasOwnProperty,WN=Object.prototype.propertyIsEnumerable,KN=function(e,t,n){return t in e?jN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},HN=function(e,t){for(var n in t||(t={}))zN.call(t,n)&&KN(e,n,t[n]);if(BN)for(var r=0,i=BN(t);r<i.length;r++){n=i[r];WN.call(t,n)&&KN(e,n,t[n])}return e},GN=function(e,t){return VN(e,qN(t))},QN=function(e,t,n){return new Promise((function(r,i){var a=function(e){try{u(n.next(e))}catch(t){i(t)}},o=function(e){try{u(n.throw(e))}catch(t){i(t)}},u=function(e){return e.done?r(e.value):Promise.resolve(e.value).then(a,o)};u((n=n.apply(e,t)).next())}))},$N="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"===typeof arguments[0]?AN:AN.apply(null,arguments)};"undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;function YN(e){if("object"!==typeof e||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var n=t;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return t===n}var XN=function(e){function t(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=e.apply(this,n)||this;return Object.setPrototypeOf(i,t.prototype),i}return MN(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,UN([void 0],e[0].concat(this)))):new(t.bind.apply(t,UN([void 0],e.concat(this))))},t}(Array);function JN(e){return SC(e)?xN(e,(function(){})):e}function ZN(){return function(e){return function(e){void 0===e&&(e={});var t=e.thunk,n=void 0===t||t,r=(e.immutableCheck,e.serializableCheck,new XN);n&&(!function(e){return"boolean"===typeof e}(n)?r.push(LN.withExtraArgument(n.extraArgument)):r.push(LN));0;return r}(e)}}function eR(e,t){function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(t){var i=t.apply(void 0,n);if(!i)throw new Error("prepareAction did not return an object");return HN(HN({type:e,payload:i.payload},"meta"in i&&{meta:i.meta}),"error"in i&&{error:i.error})}return{type:e,payload:n[0]}}return n.toString=function(){return""+e},n.type=e,n.match=function(t){return t.type===e},n}function tR(e){var t,n={},r=[],i={addCase:function(e,t){var r="string"===typeof e?e:e.type;if(r in n)throw new Error("addCase cannot be called with two reducers for the same action type");return n[r]=t,i},addMatcher:function(e,t){return r.push({matcher:e,reducer:t}),i},addDefaultCase:function(e){return t=e,i}};return e(i),[n,r,t]}function nR(e){var t=e.name;if(!t)throw new Error("`name` is a required option for createSlice");var n,r="function"==typeof e.initialState?e.initialState:JN(e.initialState),i=e.reducers||{},a=Object.keys(i),o={},u={},s={};function c(){var t="function"===typeof e.extraReducers?tR(e.extraReducers):[e.extraReducers],n=t[0],i=void 0===n?{}:n,a=t[1],o=void 0===a?[]:a,s=t[2],c=void 0===s?void 0:s,l=HN(HN({},i),u);return function(e,t,n,r){void 0===n&&(n=[]);var i,a="function"===typeof t?tR(t):[t,n,r],o=a[0],u=a[1],s=a[2];if(function(e){return"function"===typeof e}(e))i=function(){return JN(e())};else{var c=JN(e);i=function(){return c}}function l(e,t){void 0===e&&(e=i());var n=UN([o[t.type]],u.filter((function(e){return(0,e.matcher)(t)})).map((function(e){return e.reducer})));return 0===n.filter((function(e){return!!e})).length&&(n=[s]),n.reduce((function(e,n){if(n){var r;if(IC(e))return void 0===(r=n(e,t))?e:r;if(SC(e))return xN(e,(function(e){return n(e,t)}));if(void 0===(r=n(e,t))){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return r}return e}),e)}return l.getInitialState=i,l}(r,(function(e){for(var t in l)e.addCase(t,l[t]);for(var n=0,r=o;n<r.length;n++){var i=r[n];e.addMatcher(i.matcher,i.reducer)}c&&e.addDefaultCase(c)}))}return a.forEach((function(e){var n,r,a=i[e],c=t+"/"+e;"reducer"in a?(n=a.reducer,r=a.prepare):n=a,o[e]=n,u[c]=n,s[e]=r?eR(c,r):eR(c)})),{name:t,reducer:function(e,t){return n||(n=c()),n(e,t)},actions:s,caseReducers:o,getInitialState:function(){return n||(n=c()),n.getInitialState()}}}var rR=function(e){void 0===e&&(e=21);for(var t="",n=e;n--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t},iR=["name","message","stack","code"],aR=function(e,t){this.payload=e,this.meta=t},oR=function(e,t){this.payload=e,this.meta=t},uR=function(e){if("object"===typeof e&&null!==e){for(var t={},n=0,r=iR;n<r.length;n++){var i=r[n];"string"===typeof e[i]&&(t[i]=e[i])}return t}return{message:String(e)}};!function(){function e(e,t,n){var r=eR(e+"/fulfilled",(function(e,t,n,r){return{payload:e,meta:GN(HN({},r||{}),{arg:n,requestId:t,requestStatus:"fulfilled"})}})),i=eR(e+"/pending",(function(e,t,n){return{payload:void 0,meta:GN(HN({},n||{}),{arg:t,requestId:e,requestStatus:"pending"})}})),a=eR(e+"/rejected",(function(e,t,r,i,a){return{payload:i,error:(n&&n.serializeError||uR)(e||"Rejected"),meta:GN(HN({},a||{}),{arg:r,requestId:t,rejectedWithValue:!!i,requestStatus:"rejected",aborted:"AbortError"===(null==e?void 0:e.name),condition:"ConditionError"===(null==e?void 0:e.name)})}})),o="undefined"!==typeof AbortController?AbortController:function(){function e(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return e.prototype.abort=function(){0},e}();return Object.assign((function(e){return function(u,s,c){var l,f=(null==n?void 0:n.idGenerator)?n.idGenerator(e):rR(),h=new o;function d(e){l=e,h.abort()}var p=function(){return QN(this,null,(function(){var o,p,v,y,m,g;return FN(this,(function(k){switch(k.label){case 0:return k.trys.push([0,4,,5]),y=null==(o=null==n?void 0:n.condition)?void 0:o.call(n,e,{getState:s,extra:c}),null===(b=y)||"object"!==typeof b||"function"!==typeof b.then?[3,2]:[4,y];case 1:y=k.sent(),k.label=2;case 2:if(!1===y||h.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return!0,m=new Promise((function(e,t){return h.signal.addEventListener("abort",(function(){return t({name:"AbortError",message:l||"Aborted"})}))})),u(i(f,e,null==(p=null==n?void 0:n.getPendingMeta)?void 0:p.call(n,{requestId:f,arg:e},{getState:s,extra:c}))),[4,Promise.race([m,Promise.resolve(t(e,{dispatch:u,getState:s,extra:c,requestId:f,signal:h.signal,abort:d,rejectWithValue:function(e,t){return new aR(e,t)},fulfillWithValue:function(e,t){return new oR(e,t)}})).then((function(t){if(t instanceof aR)throw t;return t instanceof oR?r(t.payload,f,e,t.meta):r(t,f,e)}))])];case 3:return v=k.sent(),[3,5];case 4:return g=k.sent(),v=g instanceof aR?a(null,f,e,g.payload,g.meta):a(g,f,e),[3,5];case 5:return n&&!n.dispatchConditionRejection&&a.match(v)&&v.meta.condition||u(v),[2,v]}var b}))}))}();return Object.assign(p,{abort:d,requestId:f,arg:e,unwrap:function(){return p.then(sR)}})}}),{pending:i,rejected:a,fulfilled:r,typePrefix:e})}e.withTypes=function(){return e}}();function sR(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}Object.assign;var cR="listenerMiddleware";eR(cR+"/add"),eR(cR+"/removeAll"),eR(cR+"/remove");"function"===typeof queueMicrotask&&queueMicrotask.bind("undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:globalThis);var lR,fR=function(e){return function(t){setTimeout(t,e)}};"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:fR(10);iN();var hR=nR({name:"userData",initialState:{email:null,name:null,id:null,photoUrl:null},reducers:{setUser:function(e,t){e.email=t.payload.email,e.name=t.payload.name,e.id=t.payload.id,e.photoUrl=t.payload.photoUrl},removeUser:function(e){e.email=null,e.id=null,e.name=null,e.photoUrl=null}}}),dR=hR.actions,pR=dR.setUser,vR=dR.removeUser,yR=hR.reducer;var mR=n.p+"static/media/signout.3d9fb42626f083fdc4fc610d092b96d3.svg",gR=n(184);var kR=function(){var e=_C();return(0,gR.jsx)("button",{className:"sign-out-button",onClick:function(){return e(vR())},children:(0,gR.jsx)("img",{className:"sign-out-img-button",src:mR,alt:"signout"})})};var bR=function(){var e=dC((function(e){return e.userData}));return(0,gR.jsx)("div",{className:null===e.id?"navbar-d":"navbar",children:(0,gR.jsxs)("div",{className:"user-navbar",children:[(0,gR.jsx)("img",{className:"user-photo",src:e.photoUrl,alt:"userphoto"}),(0,gR.jsx)("div",{className:"user-name",children:e.name}),(0,gR.jsx)(kR,{})]})})};var wR=function(){return(0,gR.jsx)("div",{className:"sidebar",children:(0,gR.jsx)(bR,{})})};var _R=function(){var e=dC((function(e){return e.activateChat.activeChat}));return(0,gR.jsxs)("div",{className:"main-pages",children:[(0,gR.jsx)("div",{className:e?"navigation-menu-active":"navigation-menu",children:(0,gR.jsx)(wR,{})}),(0,gR.jsx)(zE,{})]})};Ct("firebase","9.15.0","app");var xR="@firebase/database",IR="0.14.0",SR="";var TR=function(){function e(t){u(this,e),this.domStorage_=t,this.prefix_="firebase:"}return l(e,[{key:"set",value:function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ue(t))}},{key:"get",value:function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:oe(t)}},{key:"remove",value:function(e){this.domStorage_.removeItem(this.prefixedName_(e))}},{key:"prefixedName_",value:function(e){return this.prefix_+e}},{key:"toString",value:function(){return this.domStorage_.toString()}}]),e}(),ER=function(){function e(){u(this,e),this.cache_={},this.isInMemoryStorage=!0}return l(e,[{key:"set",value:function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}},{key:"get",value:function(e){return ce(this.cache_,e)?this.cache_[e]:null}},{key:"remove",value:function(e){delete this.cache_[e]}}]),e}(),CR=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new TR(t)}}catch(n){}return new ER},NR=CR("localStorage"),RR=CR("sessionStorage"),AR=new Ue("@firebase/database"),PR=function(){var e=1;return function(){return e++}}(),DR=function(e){var t=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,P(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new ge;n.update(t);var r=n.digest();return L.encodeByteArray(r)},OR=function e(){for(var t="",n=0;n<arguments.length;n++){var r=n<0||arguments.length<=n?void 0:arguments[n];Array.isArray(r)||r&&"object"===typeof r&&"number"===typeof r.length?t+=e.apply(null,r):t+="object"===typeof r?ue(r):r,t+=" "}return t},LR=null,MR=!0,FR=function(e,t){P(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(AR.logLevel=Ae.VERBOSE,LR=AR.log.bind(AR),t&&RR.set("logging_enabled",!0)):"function"===typeof e?LR=e:(LR=null,RR.remove("logging_enabled"))},UR=function(){if(!0===MR&&(MR=!1,null===LR&&!0===RR.get("logging_enabled")&&FR(!0)),LR){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=OR.apply(null,t);LR(r)}},jR=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];UR.apply(void 0,[e].concat(n))}},VR=function(){var e="FIREBASE INTERNAL ERROR: "+OR.apply(void 0,arguments);AR.error(e)},qR=function(){var e="FIREBASE FATAL ERROR: ".concat(OR.apply(void 0,arguments));throw AR.error(e),new Error(e)},BR=function(){var e="FIREBASE WARNING: "+OR.apply(void 0,arguments);AR.warn(e)},zR=function(e){return"number"===typeof e&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},WR="[MIN_NAME]",KR="[MAX_NAME]",HR=function(e,t){if(e===t)return 0;if(e===WR||t===KR)return-1;if(t===WR||e===KR)return 1;var n=eA(e),r=eA(t);return null!==n?null!==r?n-r===0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},GR=function(e,t){return e===t?0:e<t?-1:1},QR=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+ue(t))},$R=function e(t){if("object"!==typeof t||null===t)return ue(t);var n=[];for(var r in t)n.push(r);n.sort();for(var i="{",a=0;a<n.length;a++)0!==a&&(i+=","),i+=ue(n[a]),i+=":",i+=e(t[n[a]]);return i+="}"},YR=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function XR(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var JR=function(e){P(!zR(e),"Invalid JSON number");var t,n,r,i,a,o=1023;0===e?(n=0,r=0,t=1/e===-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),o))+o,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));var u=[];for(a=52;a;a-=1)u.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)u.push(n%2?1:0),n=Math.floor(n/2);u.push(t?1:0),u.reverse();var s=u.join(""),c="";for(a=0;a<64;a+=8){var l=parseInt(s.substr(a,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()};var ZR=new RegExp("^-?(0*)\\d{1,10}$"),eA=function(e){if(ZR.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},tA=function(e){try{e()}catch(t){setTimeout((function(){var e=t.stack||"";throw BR("Exception was thrown by user callback.",e),t}),Math.floor(0))}},nA=function(e,t){var n=setTimeout(e,t);return"number"===typeof n&&"undefined"!==typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"===typeof n&&n.unref&&n.unref(),n},rA=function(){function e(t,n){var r=this;u(this,e),this.appName_=t,this.appCheckProvider=n,this.appCheck=null===n||void 0===n?void 0:n.getImmediate({optional:!0}),this.appCheck||null===n||void 0===n||n.get().then((function(e){return r.appCheck=e}))}return l(e,[{key:"getToken",value:function(e){var t=this;return this.appCheck?this.appCheck.getToken(e):new Promise((function(n,r){setTimeout((function(){t.appCheck?t.getToken(e).then(n,r):n(null)}),0)}))}},{key:"addTokenChangeListener",value:function(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((function(t){return t.addTokenListener(e)}))}},{key:"notifyForInvalidToken",value:function(){BR('Provided AppCheck credentials for the app named "'.concat(this.appName_,'" ')+"are invalid. This usually indicates your app was not initialized correctly.")}}]),e}(),iA=function(){function e(t,n,r){var i=this;u(this,e),this.appName_=t,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit((function(e){return i.auth_=e}))}return l(e,[{key:"getToken",value:function(e){var t=this;return this.auth_?this.auth_.getToken(e).catch((function(e){return e&&"auth/token-not-initialized"===e.code?(UR("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})):new Promise((function(n,r){setTimeout((function(){t.auth_?t.getToken(e).then(n,r):n(null)}),0)}))}},{key:"addTokenChangeListener",value:function(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((function(t){return t.addAuthTokenListener(e)}))}},{key:"removeTokenChangeListener",value:function(e){this.authProvider_.get().then((function(t){return t.removeAuthTokenListener(e)}))}},{key:"notifyForInvalidToken",value:function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',BR(e)}}]),e}(),aA=function(){function e(t){u(this,e),this.accessToken=t}return l(e,[{key:"getToken",value:function(e){return Promise.resolve({accessToken:this.accessToken})}},{key:"addTokenChangeListener",value:function(e){e(this.accessToken)}},{key:"removeTokenChangeListener",value:function(e){}},{key:"notifyForInvalidToken",value:function(){}}]),e}();aA.OWNER="owner";var oA="5",uA=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,sA="ac",cA="websocket",lA="long_polling",fA=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];u(this,e),this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=NR.get("host:"+t)||this._host}return l(e,[{key:"isCacheableHost",value:function(){return"s-"===this.internalHost.substr(0,2)}},{key:"isCustomHost",value:function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}},{key:"host",get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&NR.set("host:"+this._host,this.internalHost))}},{key:"toString",value:function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}},{key:"toURLString",value:function(){var e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"";return"".concat(e).concat(this.host,"/").concat(t)}}]),e}();function hA(e,t,n){var r;if(P("string"===typeof t,"typeof type must == string"),P("object"===typeof n,"typeof params must == object"),t===cA)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==lA)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);var i=[];return XR(n,(function(e,t){i.push(e+"="+t)})),r+i.join("&")}var dA=function(){function e(){u(this,e),this.counters_={}}return l(e,[{key:"incrementCounter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;ce(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}},{key:"get",value:function(){return j(void 0,this.counters_)}}]),e}(),pA={},vA={};function yA(e){var t=e.toString();return pA[t]||(pA[t]=new dA),pA[t]}var mA=function(){function e(t){u(this,e),this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return l(e,[{key:"closeAfter",value:function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}},{key:"handleResponse",value:function(e,t){var n=this;this.pendingResponses[e]=t;for(var r=function(){var e=n.pendingResponses[n.currentResponseNum];delete n.pendingResponses[n.currentResponseNum];for(var t=function(t){e[t]&&tA((function(){n.onMessage_(e[t])}))},r=0;r<e.length;++r)t(r);if(n.currentResponseNum===n.closeAfterResponse)return n.onClose&&(n.onClose(),n.onClose=null),"break";n.currentResponseNum++};this.pendingResponses[this.currentResponseNum];){if("break"===r())break}}}]),e}(),gA="start",kA="close",bA=function(){function e(t,n,r,i,a,o,s){var c=this;u(this,e),this.connId=t,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.transportSessionId=o,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=jR(t),this.stats_=yA(n),this.urlFn=function(e){return c.appCheckToken&&(e[sA]=c.appCheckToken),hA(n,lA,e)}}return l(e,[{key:"open",value:function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new mA(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if(H()||"complete"===document.readyState)e();else{var t=!1,n=function n(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new wA((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],a=t[1],o=t[2];t[3],t[4];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===gA)n.id=a,n.password=o;else{if(i!==kA)throw new Error("Unrecognized command received: "+i);a?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(a,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],a=t[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,a)}),(function(){n.onClosed_()}),n.urlFn);var e={};e[gA]="t",e.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=n.scriptTagHolder.uniqueCallbackIdentifier),e.v=oA,n.transportSessionId&&(e.s=n.transportSessionId),n.lastSessionId&&(e.ls=n.lastSessionId),n.applicationId&&(e.p=n.applicationId),n.appCheckToken&&(e[sA]=n.appCheckToken),"undefined"!==typeof location&&location.hostname&&uA.test(location.hostname)&&(e.r="f");var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,(function(){}))}}))}},{key:"start",value:function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}},{key:"markConnectionHealthy",value:function(){}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}},{key:"send",value:function(e){var t=ue(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=M(t),r=YR(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}},{key:"addDisconnectPingFrame",value:function(e,t){if(!H()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}}},{key:"incrementIncomingBytes_",value:function(e){var t=ue(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}],[{key:"forceAllow",value:function(){e.forceAllow_=!0}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){return!H()&&(!!e.forceAllow_||!e.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))}}]),e}(),wA=function(){function e(t,n,r,i){if(u(this,e),this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,H())this.commandCB=t,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=PR(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var a="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length))a='<script>document.domain="'+document.domain+'";<\/script>';var o="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(s){UR("frame writing exception"),s.stack&&UR(s.stack),UR(s)}}}return l(e,[{key:"close",value:function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)}),Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())}},{key:"startLongPoll",value:function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}},{key:"newRequest_",value:function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}},{key:"enqueueSegment",value:function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}},{key:"addLongPollTag_",value:function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,(function(){clearTimeout(i),r()}))}},{key:"addTag",value:function(e,t){var n=this;H()?this.doNodeLongPoll(e,t):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){UR("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}}),Math.floor(1))}}],[{key:"createIFrame_",value:function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||UR("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}}]),e}(),_A=null;"undefined"!==typeof MozWebSocket?_A=MozWebSocket:"undefined"!==typeof WebSocket&&(_A=WebSocket);var xA=function(){function e(t,n,r,i,a,o,s){u(this,e),this.connId=t,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=jR(this.connId),this.stats_=yA(n),this.connURL=e.connectionURL_(n,o,s,i,r),this.nodeAdmin=n.nodeAdmin}return l(e,[{key:"open",value:function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,NR.set("previous_websocket_failure",!0);try{var r;if(H()){var i=this.nodeAdmin?"AdminNode":"Node";r={headers:{"User-Agent":"Firebase/".concat(oA,"/").concat(SR,"/").concat(process.platform,"/").concat(i),"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization="Bearer ".concat(this.authToken)),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);var a={NODE_ENV:"production",PUBLIC_URL:"/messanger",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0},o=0===this.connURL.indexOf("wss://")?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;o&&(r.proxy={origin:o})}this.mySock=new _A(this.connURL,[],r)}catch(s){this.log_("Error instantiating WebSocket.");var u=s.message||s.data;return u&&this.log_(u),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}}},{key:"start",value:function(){}},{key:"markConnectionHealthy",value:function(){NR.remove("previous_websocket_failure")}},{key:"appendFrame_",value:function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=oe(t);this.onMessage(n)}}},{key:"handleNewFrameCount_",value:function(e){this.totalFrames=e,this.frames=[]}},{key:"extractFrameCount_",value:function(e){if(P(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}},{key:"handleIncomingFrame",value:function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}}},{key:"send",value:function(e){this.resetKeepAlive();var t=ue(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=YR(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}},{key:"resetKeepAlive",value:function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()}),Math.floor(45e3))}},{key:"sendString_",value:function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}],[{key:"connectionURL_",value:function(e,t,n,r,i){var a={};return a.v=oA,!H()&&"undefined"!==typeof location&&location.hostname&&uA.test(location.hostname)&&(a.r="f"),t&&(a.s=t),n&&(a.ls=n),r&&(a[sA]=r),i&&(a.p=i),hA(e,cA,a)}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){var t=!1;if("undefined"!==typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==_A&&!e.forceDisallow_}},{key:"previouslyFailed",value:function(){return NR.isInMemoryStorage||!0===NR.get("previous_websocket_failure")}}]),e}();xA.responsesRequiredToBeHealthy=2,xA.healthyTimeout=3e4;var IA=function(){function e(t){u(this,e),this.initTransports_(t)}return l(e,[{key:"initTransports_",value:function(t){var n=xA&&xA.isAvailable(),r=n&&!xA.previouslyFailed();if(t.webSocketOnly&&(n||BR("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[xA];else{var i,a=this.transports_=[],o=y(e.ALL_TRANSPORTS);try{for(o.s();!(i=o.n()).done;){var u=i.value;u&&u.isAvailable()&&a.push(u)}}catch(s){o.e(s)}finally{o.f()}e.globalTransportInitialized_=!0}}},{key:"initialTransport",value:function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}},{key:"upgradeTransport",value:function(){return this.transports_.length>1?this.transports_[1]:null}}],[{key:"ALL_TRANSPORTS",get:function(){return[bA,xA]}},{key:"IS_TRANSPORT_INITIALIZED",get:function(){return this.globalTransportInitialized_}}]),e}();IA.globalTransportInitialized_=!1;var SA=function(){function e(t,n,r,i,a,o,s,c,l,f){u(this,e),this.id=t,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=o,this.onReady_=s,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=f,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=jR("c:"+this.id+":"),this.transportManager_=new IA(n),this.log_("Connection created"),this.start_()}return l(e,[{key:"start_",value:function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){e.conn_&&e.conn_.open(n,r)}),Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=nA((function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))}),Math.floor(i)))}},{key:"nextTransportId_",value:function(){return"c:"+this.id+":"+this.connectionCount++}},{key:"disconnReceiver_",value:function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}}},{key:"connReceiver_",value:function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}}},{key:"sendRequest",value:function(e){var t={t:"d",d:e};this.sendData_(t)}},{key:"tryCleanupConnection",value:function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}},{key:"onSecondaryControl_",value:function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}},{key:"onSecondaryMessageReceived_",value:function(e){var t=QR("t",e),n=QR("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}},{key:"upgradeIfSecondaryHealthy_",value:function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}},{key:"proceedWithUpgrade_",value:function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}},{key:"onPrimaryMessageReceived_",value:function(e){var t=QR("t",e),n=QR("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}},{key:"onDataMessage_",value:function(e){this.onPrimaryResponse_(),this.onMessage_(e)}},{key:"onPrimaryResponse_",value:function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}},{key:"onControl_",value:function(e){var t=QR("t",e);if("d"in e){var n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?VR("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):VR("Unknown control packet command: "+t)}}},{key:"onHandshake_",value:function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),oA!==n&&BR("Protocol version mismatch detected"),this.tryStartUpgrade_())}},{key:"tryStartUpgrade_",value:function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}},{key:"startUpgrade_",value:function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),nA((function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())}),Math.floor(6e4))}},{key:"onReset_",value:function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}},{key:"onConnectionEstablished_",value:function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):nA((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}},{key:"sendPingOnPrimaryIfNecessary_",value:function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}},{key:"onSecondaryConnectionLost_",value:function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}},{key:"onConnectionLost_",value:function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(NR.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}},{key:"onConnectionShutdown_",value:function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}},{key:"sendData_",value:function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}},{key:"close",value:function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}},{key:"closeConnections_",value:function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}]),e}(),TA=function(){function e(){u(this,e)}return l(e,[{key:"put",value:function(e,t,n,r){}},{key:"merge",value:function(e,t,n,r){}},{key:"refreshAuthToken",value:function(e){}},{key:"refreshAppCheckToken",value:function(e){}},{key:"onDisconnectPut",value:function(e,t,n){}},{key:"onDisconnectMerge",value:function(e,t,n){}},{key:"onDisconnectCancel",value:function(e,t){}},{key:"reportStats",value:function(e){}}]),e}(),EA=function(){function e(t){u(this,e),this.allowedEvents_=t,this.listeners_={},P(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return l(e,[{key:"trigger",value:function(e){if(Array.isArray(this.listeners_[e])){for(var t=Te(this.listeners_[e]),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var a=0;a<t.length;a++)t[a].callback.apply(t[a].context,r)}}},{key:"on",value:function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)}},{key:"off",value:function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)}},{key:"validateEventType_",value:function(e){P(this.allowedEvents_.find((function(t){return t===e})),"Unknown event: "+e)}}]),e}(),CA=function(e){_(n,e);var t=T(n);function n(){var e;return u(this,n),(e=t.call(this,["online"])).online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||q()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return l(n,[{key:"getInitialEvent",value:function(e){return P("online"===e,"Unknown event type: "+e),[this.online_]}},{key:"currentlyOnline",value:function(){return this.online_}}],[{key:"getInstance",value:function(){return new n}}]),n}(EA),NA=function(){function e(t,n){if(u(this,e),void 0===n){this.pieces_=t.split("/");for(var r=0,i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=n}return l(e,[{key:"toString",value:function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}]),e}();function RA(){return new NA("")}function AA(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function PA(e){return e.pieces_.length-e.pieceNum_}function DA(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new NA(e.pieces_,t)}function OA(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function LA(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function MA(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new NA(t,0)}function FA(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof NA)for(var i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else for(var a=t.split("/"),o=0;o<a.length;o++)a[o].length>0&&n.push(a[o]);return new NA(n,0)}function UA(e){return e.pieceNum_>=e.pieces_.length}function jA(e,t){var n=AA(e),r=AA(t);if(null===n)return t;if(n===r)return jA(DA(e),DA(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function VA(e,t){if(PA(e)!==PA(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function qA(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(PA(e)>PA(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var BA=l((function e(t,n){u(this,e),this.errorPrefix_=n,this.parts_=LA(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var r=0;r<this.parts_.length;r++)this.byteLength_+=xe(this.parts_[r]);zA(this)}));function zA(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+WA(e))}function WA(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}var KA=function(e){_(n,e);var t=T(n);function n(){var e,r,i;return u(this,n),e=t.call(this,["visible"]),"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(i="visibilitychange",r="hidden"):"undefined"!==typeof document.mozHidden?(i="mozvisibilitychange",r="mozHidden"):"undefined"!==typeof document.msHidden?(i="msvisibilitychange",r="msHidden"):"undefined"!==typeof document.webkitHidden&&(i="webkitvisibilitychange",r="webkitHidden")),e.visible_=!0,i&&document.addEventListener(i,(function(){var t=!document[r];t!==e.visible_&&(e.visible_=t,e.trigger("visible",t))}),!1),e}return l(n,[{key:"getInitialEvent",value:function(e){return P("visible"===e,"Unknown event type: "+e),[this.visible_]}}],[{key:"getInstance",value:function(){return new n}}]),n}(EA),HA=1e3,GA=function(e){_(n,e);var t=T(n);function n(e,r,i,a,o,s,c,l){var f;if(u(this,n),(f=t.call(this)).repoInfo_=e,f.applicationId_=r,f.onDataUpdate_=i,f.onConnectStatus_=a,f.onServerInfoUpdate_=o,f.authTokenProvider_=s,f.appCheckTokenProvider_=c,f.authOverride_=l,f.id=n.nextPersistentConnectionId_++,f.log_=jR("p:"+f.id+":"),f.interruptReasons_={},f.listens=new Map,f.outstandingPuts_=[],f.outstandingGets_=[],f.outstandingPutCount_=0,f.outstandingGetCount_=0,f.onDisconnectRequestQueue_=[],f.connected_=!1,f.reconnectDelay_=HA,f.maxReconnectDelay_=3e5,f.securityDebugCallback_=null,f.lastSessionId=null,f.establishConnectionTimer_=null,f.visible_=!1,f.requestCBHash_={},f.requestNumber_=0,f.realtime_=null,f.authToken_=null,f.appCheckToken_=null,f.forceTokenRefresh_=!1,f.invalidAuthTokenCount_=0,f.invalidAppCheckTokenCount_=0,f.firstConnection_=!0,f.lastConnectionAttemptTime_=null,f.lastConnectionEstablishedTime_=null,l&&!H())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return KA.getInstance().on("visible",f.onVisible_,b(f)),-1===e.host.indexOf("fblocal")&&CA.getInstance().on("online",f.onOnline_,b(f)),f}return l(n,[{key:"sendRequest",value:function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(ue(i)),P(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}},{key:"get",value:function(e){this.initConnection_();var t=new ee,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:function(e){var n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;var r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}},{key:"listen",value:function(e,t,n,r){this.initConnection_();var i=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),P(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),P(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(a).set(i,o),this.connected_&&this.sendListen_(o)}},{key:"sendGet_",value:function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,(function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))}},{key:"sendListen_",value:function(e){var t=this,r=e.query,i=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+i+" for "+a);var o={p:i};e.tag&&(o.q=r._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest("q",o,(function(o){var u=o.d,s=o.s;n.warnOnListenWarnings_(u,r),(t.listens.get(i)&&t.listens.get(i).get(a))===e&&(t.log_("listen response",o),"ok"!==s&&t.removeListen_(i,a),e.onComplete&&e.onComplete(s,u))}))}},{key:"refreshAuthToken",value:function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(e)}},{key:"reduceReconnectDelayIfAdminCredential_",value:function(e){(e&&40===e.length||function(e){var t=se(e).claims;return"object"===typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}},{key:"refreshAppCheckToken",value:function(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))}},{key:"tryAuth",value:function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,n=function(e){var t=se(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")}(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"===typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))}))}}},{key:"tryAppCheck",value:function(){var e=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(t){var n=t.s,r=t.d||"error";"ok"===n?e.invalidAppCheckTokenCount_=0:e.onAppCheckRevoked_(n,r)}))}},{key:"unlisten",value:function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),P(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}},{key:"sendUnlisten_",value:function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}},{key:"onDisconnectPut",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}},{key:"onDisconnectMerge",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}},{key:"onDisconnectCancel",value:function(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}},{key:"sendOnDisconnect_",value:function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(function(e){r&&setTimeout((function(){r(e.s,e.d)}),Math.floor(0))}))}},{key:"put",value:function(e,t,n,r){this.putInternal("p",e,t,n,r)}},{key:"merge",value:function(e,t,n,r){this.putInternal("m",e,t,n,r)}},{key:"putInternal",value:function(e,t,n,r,i){this.initConnection_();var a={p:t,d:n};void 0!==i&&(a.h=i),this.outstandingPuts_.push({action:e,request:a,onComplete:r}),this.outstandingPutCount_++;var o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}},{key:"sendPut_",value:function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,(function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)}))}},{key:"reportStats",value:function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,(function(e){if("ok"!==e.s){var n=e.d;t.log_("reportStats","Error sending stats: "+n)}}))}}},{key:"onDataMessage_",value:function(e){if("r"in e){this.log_("from server: "+ue(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}},{key:"onDataPush_",value:function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):VR("Unrecognized action received from server: "+ue(e)+"\nAre you using the latest client?")}},{key:"onReady_",value:function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}},{key:"scheduleConnect_",value:function(e){var t=this;P(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){t.establishConnectionTimer_=null,t.establishConnection_()}),Math.floor(e))}},{key:"initConnection_",value:function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}},{key:"onVisible_",value:function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=HA,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}},{key:"onOnline_",value:function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=HA,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}},{key:"onRealtimeDisconnect_",value:function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=HA),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}},{key:"establishConnection_",value:function(){var e=h(o().mark((function e(){var t,r,i,a,u,s,c,l,f,h,d,p,v,y,m=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.shouldReconnect_()){e.next=30;break}return this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),a=this.id+":"+n.nextConnectionId_++,u=this.lastSessionId,s=!1,c=null,l=function(){c?c.close():(s=!0,i())},f=function(e){P(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(e)},this.realtime_={close:l,sendRequest:f},h=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,e.prev=16,e.next=19,Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);case 19:d=e.sent,p=k(d,2),v=p[0],y=p[1],s?UR("getToken() completed but was canceled"):(UR("getToken() completed. Creating connection."),this.authToken_=v&&v.accessToken,this.appCheckToken_=y&&y.token,c=new SA(a,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,(function(e){BR(e+" ("+m.repoInfo_.toString()+")"),m.interrupt("server_kill")}),u)),e.next=30;break;case 26:e.prev=26,e.t0=e.catch(16),this.log_("Failed to get token: "+e.t0),s||(this.repoInfo_.nodeAdmin&&BR(e.t0),l());case 30:case"end":return e.stop()}}),e,this,[[16,26]])})));return function(){return e.apply(this,arguments)}}()},{key:"interrupt",value:function(e){UR("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}},{key:"resume",value:function(e){UR("Resuming connection for reason: "+e),delete this.interruptReasons_[e],fe(this.interruptReasons_)&&(this.reconnectDelay_=HA,this.realtime_||this.scheduleConnect_(0))}},{key:"handleTimestamp_",value:function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}},{key:"cancelSentTransactions_",value:function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}},{key:"onListenRevoked_",value:function(e,t){var n;n=t?t.map((function(e){return $R(e)})).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}},{key:"removeListen_",value:function(e,t){var n,r=new NA(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n}},{key:"onAuthRevoked_",value:function(e,t){UR("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}},{key:"onAppCheckRevoked_",value:function(e,t){UR("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}},{key:"onSecurityDebugPacket_",value:function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}},{key:"restoreState_",value:function(){this.tryAuth(),this.tryAppCheck();var e,t=y(this.listens.values());try{for(t.s();!(e=t.n()).done;){var n,r=y(e.value.values());try{for(r.s();!(n=r.n()).done;){var i=n.value;this.sendListen_(i)}}catch(s){r.e(s)}finally{r.f()}}}catch(s){t.e(s)}finally{t.f()}for(var a=0;a<this.outstandingPuts_.length;a++)this.outstandingPuts_[a]&&this.sendPut_(a);for(;this.onDisconnectRequestQueue_.length;){var o=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(o.action,o.pathString,o.data,o.onComplete)}for(var u=0;u<this.outstandingGets_.length;u++)this.outstandingGets_[u]&&this.sendGet_(u)}},{key:"sendConnectStats_",value:function(){var e={},t="js";H()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+SR.replace(/\./g,"-")]=1,q()?e["framework.cordova"]=1:W()&&(e["framework.reactnative"]=1),this.reportStats(e)}},{key:"shouldReconnect_",value:function(){var e=CA.getInstance().currentlyOnline();return fe(this.interruptReasons_)&&e}}],[{key:"warnOnListenWarnings_",value:function(e,t){if(e&&"object"===typeof e&&ce(e,"w")){var n=le(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();BR("Using an unspecified index. Your data will be downloaded and "+"filtered on the client. Consider adding ".concat(r," at ")+"".concat(i," to your security rules for better performance."))}}}}]),n}(TA);GA.nextPersistentConnectionId_=0,GA.nextConnectionId_=0;var QA,$A=function(){function e(t,n){u(this,e),this.name=t,this.node=n}return l(e,null,[{key:"Wrap",value:function(t,n){return new e(t,n)}}]),e}(),YA=function(){function e(){u(this,e)}return l(e,[{key:"getCompare",value:function(){return this.compare.bind(this)}},{key:"indexedValueChanged",value:function(e,t){var n=new $A(WR,e),r=new $A(WR,t);return 0!==this.compare(n,r)}},{key:"minPost",value:function(){return $A.MIN}}]),e}(),XA=function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.apply(this,arguments)}return l(n,[{key:"compare",value:function(e,t){return HR(e.name,t.name)}},{key:"isDefinedOn",value:function(e){throw D("KeyIndex.isDefinedOn not expected to be called.")}},{key:"indexedValueChanged",value:function(e,t){return!1}},{key:"minPost",value:function(){return $A.MIN}},{key:"maxPost",value:function(){return new $A(KR,QA)}},{key:"makePost",value:function(e,t){return P("string"===typeof e,"KeyIndex indexValue must always be a string."),new $A(e,QA)}},{key:"toString",value:function(){return".key"}}],[{key:"__EMPTY_NODE",get:function(){return QA},set:function(e){QA=e}}]),n}(YA),JA=new XA,ZA=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;u(this,e),this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(o=n?r(t.key,n):1,i&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return l(e,[{key:"getNext",value:function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}},{key:"hasNext",value:function(){return this.nodeStack_.length>0}},{key:"peek",value:function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}]),e}(),eP=function(){function e(t,n,r,i,a){u(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:rP.EMPTY_NODE,this.right=null!=a?a:rP.EMPTY_NODE}return l(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"count",value:function(){return this.left.count()+1+this.right.count()}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min_",value:function(){return this.left.isEmpty()?this:this.left.min_()}},{key:"minKey",value:function(){return this.min_().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()}},{key:"removeMin_",value:function(){if(this.left.isEmpty())return rP.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()}},{key:"remove",value:function(e,t){var n,r;if(t(e,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return rP.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}},{key:"isRed_",value:function(){return this.color}},{key:"fixUp_",value:function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}},{key:"moveRedLeft_",value:function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e}},{key:"moveRedRight_",value:function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e}},{key:"rotateLeft_",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight_",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip_",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth_",value:function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1}},{key:"check_",value:function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}]),e}();eP.RED=!0,eP.BLACK=!1;var tP,nP=function(){function e(){u(this,e)}return l(e,[{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new eP(e,t,null)}},{key:"remove",value:function(e,t){return this}},{key:"count",value:function(){return 0}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"check_",value:function(){return 0}},{key:"isRed_",value:function(){return!1}}]),e}(),rP=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.EMPTY_NODE;u(this,e),this.comparator_=t,this.root_=n}return l(e,[{key:"insert",value:function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,eP.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,eP.BLACK,null,null))}},{key:"get",value:function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}},{key:"getPredecessorKey",value:function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}},{key:"isEmpty",value:function(){return this.root_.isEmpty()}},{key:"count",value:function(){return this.root_.count()}},{key:"minKey",value:function(){return this.root_.minKey()}},{key:"maxKey",value:function(){return this.root_.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root_.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.root_.reverseTraversal(e)}},{key:"getIterator",value:function(e){return new ZA(this.root_,null,this.comparator_,!1,e)}},{key:"getIteratorFrom",value:function(e,t){return new ZA(this.root_,e,this.comparator_,!1,t)}},{key:"getReverseIteratorFrom",value:function(e,t){return new ZA(this.root_,e,this.comparator_,!0,t)}},{key:"getReverseIterator",value:function(e){return new ZA(this.root_,null,this.comparator_,!0,e)}}]),e}();function iP(e,t){return HR(e.name,t.name)}function aP(e,t){return HR(e,t)}rP.EMPTY_NODE=new nP;var oP,uP,sP,cP=function(e){return"number"===typeof e?"number:"+JR(e):"string:"+e},lP=function(e){if(e.isLeafNode()){var t=e.val();P("string"===typeof t||"number"===typeof t||"object"===typeof t&&ce(t,".sv"),"Priority must be a string or number.")}else P(e===tP||e.isEmpty(),"priority of unexpected type.");P(e===tP||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},fP=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.__childrenNodeConstructor.EMPTY_NODE;u(this,e),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,P(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),lP(this.priorityNode_)}return l(e,[{key:"isLeafNode",value:function(){return!0}},{key:"getPriority",value:function(){return this.priorityNode_}},{key:"updatePriority",value:function(t){return new e(this.value_,t)}},{key:"getImmediateChild",value:function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"getChild",value:function(t){return UA(t)?this:".priority"===AA(t)?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"hasChild",value:function(){return!1}},{key:"getPredecessorChildName",value:function(e,t){return null}},{key:"updateImmediateChild",value:function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)}},{key:"updateChild",value:function(t,n){var r=AA(t);return null===r?n:n.isEmpty()&&".priority"!==r?this:(P(".priority"!==r||1===PA(t),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(DA(t),n)))}},{key:"isEmpty",value:function(){return!1}},{key:"numChildren",value:function(){return 0}},{key:"forEachChild",value:function(e,t){return!1}},{key:"val",value:function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+cP(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?JR(this.value_):this.value_,this.lazyHash_=DR(e)}return this.lazyHash_}},{key:"getValue",value:function(){return this.value_}},{key:"compareTo",value:function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(P(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}},{key:"compareToLeafNode_",value:function(t){var n=typeof t.value_,r=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(n),a=e.VALUE_TYPE_ORDER.indexOf(r);return P(i>=0,"Unknown leaf type: "+n),P(a>=0,"Unknown leaf type: "+r),i===a?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:a-i}},{key:"withIndex",value:function(){return this}},{key:"isIndexed",value:function(){return!0}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}],[{key:"__childrenNodeConstructor",get:function(){return oP},set:function(e){oP=e}}]),e}();fP.VALUE_TYPE_ORDER=["object","boolean","number","string"];var hP,dP,pP=function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.apply(this,arguments)}return l(n,[{key:"compare",value:function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?HR(e.name,t.name):i}},{key:"isDefinedOn",value:function(e){return!e.getPriority().isEmpty()}},{key:"indexedValueChanged",value:function(e,t){return!e.getPriority().equals(t.getPriority())}},{key:"minPost",value:function(){return $A.MIN}},{key:"maxPost",value:function(){return new $A(KR,new fP("[PRIORITY-POST]",sP))}},{key:"makePost",value:function(e,t){var n=uP(e);return new $A(t,new fP("[PRIORITY-POST]",n))}},{key:"toString",value:function(){return".priority"}}]),n}(YA),vP=new pP,yP=Math.log(2),mP=function(){function e(t){u(this,e);var n;this.count=(n=t+1,parseInt(Math.log(n)/yP,10)),this.current_=this.count-1;var r,i=(r=this.count,parseInt(Array(r+1).join("1"),2));this.bits_=t+1&i}return l(e,[{key:"nextBitIsOne",value:function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e}}]),e}(),gP=function(e,t,n,r){e.sort(t);var i=function t(r,i){var a,o,u=i-r;if(0===u)return null;if(1===u)return a=e[r],o=n?n(a):a,new eP(o,a.node,eP.BLACK,null,null);var s=parseInt(u/2,10)+r,c=t(r,s),l=t(s+1,i);return a=e[s],o=n?n(a):a,new eP(o,a.node,eP.BLACK,c,l)},a=function(t){for(var r=null,a=null,o=e.length,u=function(t,r){var a=o-t,u=o;o-=t;var c=i(a+1,u),l=e[a],f=n?n(l):l;s(new eP(f,l.node,r,null,c))},s=function(e){r?(r.left=e,r=e):(a=e,r=e)},c=0;c<t.count;++c){var l=t.nextBitIsOne(),f=Math.pow(2,t.count-(c+1));l?u(f,eP.BLACK):(u(f,eP.BLACK),u(f,eP.RED))}return a}(new mP(e.length));return new rP(r||t,a)},kP={},bP=function(){function e(t,n){u(this,e),this.indexes_=t,this.indexSet_=n}return l(e,[{key:"get",value:function(e){var t=le(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof rP?t:null}},{key:"hasIndex",value:function(e){return ce(this.indexSet_,e.toString())}},{key:"addIndex",value:function(t,n){P(t!==JA,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],a=!1,o=n.getIterator($A.Wrap),u=o.getNext();u;)a=a||t.isDefinedOn(u.node),i.push(u),u=o.getNext();r=a?gP(i,t.getCompare()):kP;var s=t.toString(),c=Object.assign({},this.indexSet_);c[s]=t;var l=Object.assign({},this.indexes_);return l[s]=r,new e(l,c)}},{key:"addToIndexes",value:function(t,n){var r=this;return new e(he(this.indexes_,(function(e,i){var a=le(r.indexSet_,i);if(P(a,"Missing index implementation for "+i),e===kP){if(a.isDefinedOn(t.node)){for(var o=[],u=n.getIterator($A.Wrap),s=u.getNext();s;)s.name!==t.name&&o.push(s),s=u.getNext();return o.push(t),gP(o,a.getCompare())}return kP}var c=n.get(t.name),l=e;return c&&(l=l.remove(new $A(t.name,c))),l.insert(t,t.node)})),this.indexSet_)}},{key:"removeFromIndexes",value:function(t,n){return new e(he(this.indexes_,(function(e){if(e===kP)return e;var r=n.get(t.name);return r?e.remove(new $A(t.name,r)):e})),this.indexSet_)}}],[{key:"Default",get:function(){return P(kP&&vP,"ChildrenNode.ts has not been loaded"),hP=hP||new e({".priority":kP},{".priority":vP})}}]),e}(),wP=function(){function e(t,n,r){u(this,e),this.children_=t,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&lP(this.priorityNode_),this.children_.isEmpty()&&P(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return l(e,[{key:"isLeafNode",value:function(){return!1}},{key:"getPriority",value:function(){return this.priorityNode_||dP}},{key:"updatePriority",value:function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)}},{key:"getImmediateChild",value:function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?dP:t}},{key:"getChild",value:function(e){var t=AA(e);return null===t?this:this.getImmediateChild(t).getChild(DA(e))}},{key:"hasChild",value:function(e){return null!==this.children_.get(e)}},{key:"updateImmediateChild",value:function(t,n){if(P(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r,i,a=new $A(t,n);n.isEmpty()?(r=this.children_.remove(t),i=this.indexMap_.removeFromIndexes(a,this.children_)):(r=this.children_.insert(t,n),i=this.indexMap_.addToIndexes(a,this.children_));var o=r.isEmpty()?dP:this.priorityNode_;return new e(r,o,i)}},{key:"updateChild",value:function(e,t){var n=AA(e);if(null===n)return t;P(".priority"!==AA(e)||1===PA(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(DA(e),t);return this.updateImmediateChild(n,r)}},{key:"isEmpty",value:function(){return this.children_.isEmpty()}},{key:"numChildren",value:function(){return this.children_.count()}},{key:"val",value:function(t){if(this.isEmpty())return null;var n={},r=0,i=0,a=!0;if(this.forEachChild(vP,(function(o,u){n[o]=u.val(t),r++,a&&e.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):a=!1})),!t&&a&&i<2*r){var o=[];for(var u in n)o[u]=n[u];return o}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+cP(this.getPriority().val())+":"),this.forEachChild(vP,(function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":DR(e)}return this.lazyHash_}},{key:"getPredecessorChildName",value:function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new $A(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)}},{key:"getFirstChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()}},{key:"getFirstChild",value:function(e){var t=this.getFirstChildName(e);return t?new $A(t,this.children_.get(t)):null}},{key:"getLastChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()}},{key:"getLastChild",value:function(e){var t=this.getLastChildName(e);return t?new $A(t,this.children_.get(t)):null}},{key:"forEachChild",value:function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal((function(e){return t(e.name,e.node)})):this.children_.inorderTraversal(t)}},{key:"getIterator",value:function(e){return this.getIteratorFrom(e.minPost(),e)}},{key:"getIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getIteratorFrom(e.name,$A.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r}},{key:"getReverseIterator",value:function(e){return this.getReverseIteratorFrom(e.maxPost(),e)}},{key:"getReverseIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getReverseIteratorFrom(e.name,$A.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r}},{key:"compareTo",value:function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===_P?-1:0}},{key:"withIndex",value:function(t){if(t===JA||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)}},{key:"isIndexed",value:function(e){return e===JA||this.indexMap_.hasIndex(e)}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(vP),r=t.getIterator(vP),i=n.getNext(),a=r.getNext();i&&a;){if(i.name!==a.name||!i.node.equals(a.node))return!1;i=n.getNext(),a=r.getNext()}return null===i&&null===a}return!1}return!1}},{key:"resolveIndex_",value:function(e){return e===JA?null:this.indexMap_.get(e.toString())}}],[{key:"EMPTY_NODE",get:function(){return dP||(dP=new e(new rP(aP),null,bP.Default))}}]),e}();wP.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;var _P=new(function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.call(this,new rP(aP),wP.EMPTY_NODE,bP.Default)}return l(n,[{key:"compareTo",value:function(e){return e===this?0:1}},{key:"equals",value:function(e){return e===this}},{key:"getPriority",value:function(){return this}},{key:"getImmediateChild",value:function(e){return wP.EMPTY_NODE}},{key:"isEmpty",value:function(){return!1}}]),n}(wP));Object.defineProperties($A,{MIN:{value:new $A(WR,wP.EMPTY_NODE)},MAX:{value:new $A(KR,_P)}}),XA.__EMPTY_NODE=wP.EMPTY_NODE,fP.__childrenNodeConstructor=wP,tP=_P,function(e){sP=e}(_P);function xP(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return wP.EMPTY_NODE;if("object"===typeof e&&".priority"in e&&(t=e[".priority"]),P(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==typeof e||".sv"in e){var n=e;return new fP(n,xP(t))}if(e instanceof Array){var r=wP.EMPTY_NODE;return XR(e,(function(t,n){if(ce(e,t)&&"."!==t.substring(0,1)){var i=xP(n);!i.isLeafNode()&&i.isEmpty()||(r=r.updateImmediateChild(t,i))}})),r.updatePriority(xP(t))}var i=[],a=!1,o=e;if(XR(o,(function(e,t){if("."!==e.substring(0,1)){var n=xP(t);n.isEmpty()||(a=a||!n.getPriority().isEmpty(),i.push(new $A(e,n)))}})),0===i.length)return wP.EMPTY_NODE;var u=gP(i,iP,(function(e){return e.name}),aP);if(a){var s=gP(i,vP.getCompare());return new wP(u,xP(t),new bP({".priority":s},{".priority":vP}))}return new wP(u,xP(t),bP.Default)}!function(e){uP=e}(xP);var IP=function(e){_(n,e);var t=T(n);function n(e){var r;return u(this,n),(r=t.call(this)).indexPath_=e,P(!UA(e)&&".priority"!==AA(e),"Can't create PathIndex with empty path or .priority key"),r}return l(n,[{key:"extractChild",value:function(e){return e.getChild(this.indexPath_)}},{key:"isDefinedOn",value:function(e){return!e.getChild(this.indexPath_).isEmpty()}},{key:"compare",value:function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?HR(e.name,t.name):i}},{key:"makePost",value:function(e,t){var n=xP(e),r=wP.EMPTY_NODE.updateChild(this.indexPath_,n);return new $A(t,r)}},{key:"maxPost",value:function(){var e=wP.EMPTY_NODE.updateChild(this.indexPath_,_P);return new $A(KR,e)}},{key:"toString",value:function(){return LA(this.indexPath_,0).join("/")}}]),n}(YA),SP=function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.apply(this,arguments)}return l(n,[{key:"compare",value:function(e,t){var n=e.node.compareTo(t.node);return 0===n?HR(e.name,t.name):n}},{key:"isDefinedOn",value:function(e){return!0}},{key:"indexedValueChanged",value:function(e,t){return!e.equals(t)}},{key:"minPost",value:function(){return $A.MIN}},{key:"maxPost",value:function(){return $A.MAX}},{key:"makePost",value:function(e,t){var n=xP(e);return new $A(t,n)}},{key:"toString",value:function(){return".value"}}]),n}(YA),TP=new SP;function EP(e){return{type:"value",snapshotNode:e}}function CP(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function NP(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function RP(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}var AP=function(){function e(){u(this,e),this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=vP}return l(e,[{key:"hasStart",value:function(){return this.startSet_}},{key:"isViewFromLeft",value:function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}},{key:"getIndexStartValue",value:function(){return P(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}},{key:"getIndexStartName",value:function(){return P(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:WR}},{key:"hasEnd",value:function(){return this.endSet_}},{key:"getIndexEndValue",value:function(){return P(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}},{key:"getIndexEndName",value:function(){return P(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:KR}},{key:"hasLimit",value:function(){return this.limitSet_}},{key:"hasAnchoredLimit",value:function(){return this.limitSet_&&""!==this.viewFrom_}},{key:"getLimit",value:function(){return P(this.limitSet_,"Only valid if limit has been set"),this.limit_}},{key:"getIndex",value:function(){return this.index_}},{key:"loadsAllData",value:function(){return!(this.startSet_||this.endSet_||this.limitSet_)}},{key:"isDefault",value:function(){return this.loadsAllData()&&this.index_===vP}},{key:"copy",value:function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}]),e}();function PP(e){var t,n={};if(e.isDefault())return n;if(e.index_===vP?t="$priority":e.index_===TP?t="$value":e.index_===JA?t="$key":(P(e.index_ instanceof IP,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=ue(t),e.startSet_){var r=e.startAfterSet_?"startAfter":"startAt";n[r]=ue(e.indexStartValue_),e.startNameSet_&&(n[r]+=","+ue(e.indexStartName_))}if(e.endSet_){var i=e.endBeforeSet_?"endBefore":"endAt";n[i]=ue(e.indexEndValue_),e.endNameSet_&&(n[i]+=","+ue(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_),n}function DP(e){var t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;var n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==vP&&(t.i=e.index_.toString()),t}var OP=function(e){_(n,e);var t=T(n);function n(e,r,i,a){var o;return u(this,n),(o=t.call(this)).repoInfo_=e,o.onDataUpdate_=r,o.authTokenProvider_=i,o.appCheckTokenProvider_=a,o.log_=jR("p:rest:"),o.listens_={},o}return l(n,[{key:"reportStats",value:function(e){throw new Error("Method not implemented.")}},{key:"listen",value:function(e,t,r,i){var a=this,o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);var u=n.getListenId_(e,r),s={};this.listens_[u]=s;var c=PP(e._queryParams);this.restRequest_(o+".json",c,(function(e,t){var n=t;(404===e&&(n=null,e=null),null===e&&a.onDataUpdate_(o,n,!1,r),le(a.listens_,u)===s)&&i(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)}))}},{key:"unlisten",value:function(e,t){var r=n.getListenId_(e,t);delete this.listens_[r]}},{key:"get",value:function(e){var t=this,n=PP(e._queryParams),r=e._path.toString(),i=new ee;return this.restRequest_(r+".json",n,(function(e,n){var a=n;404===e&&(a=null,e=null),null===e?(t.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))})),i.promise}},{key:"refreshAuthToken",value:function(e){}},{key:"restRequest_",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(i){var a=k(i,2),o=a[0],u=a[1];o&&o.accessToken&&(n.auth=o.accessToken),u&&u.token&&(n.ac=u.token);var s=(t.repoInfo_.secure?"https://":"http://")+t.repoInfo_.host+e+"?ns="+t.repoInfo_.namespace+ve(n);t.log_("Sending REST request for "+s);var c=new XMLHttpRequest;c.onreadystatechange=function(){if(r&&4===c.readyState){t.log_("REST Response for "+s+" received. status:",c.status,"response:",c.responseText);var e=null;if(c.status>=200&&c.status<300){try{e=oe(c.responseText)}catch(n){BR("Failed to parse JSON response for "+s+": "+c.responseText)}r(null,e)}else 401!==c.status&&404!==c.status&&BR("Got unsuccessful REST response for "+s+" Status: "+c.status),r(c.status);r=null}},c.open("GET",s,!0),c.send()}))}}],[{key:"getListenId_",value:function(e,t){return void 0!==t?"tag$"+t:(P(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}}]),n}(TA),LP=function(){function e(){u(this,e),this.rootNode_=wP.EMPTY_NODE}return l(e,[{key:"getNode",value:function(e){return this.rootNode_.getChild(e)}},{key:"updateSnapshot",value:function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}]),e}();function MP(){return{value:null,children:new Map}}function FP(e,t,n){if(UA(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{var r=AA(t);e.children.has(r)||e.children.set(r,MP()),FP(e.children.get(r),t=DA(t),n)}}function UP(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach((function(e,n){t(n,e)}))}(e,(function(e,r){UP(r,new NA(t.toString()+"/"+e),n)}))}var jP,VP=function(){function e(t){u(this,e),this.collection_=t,this.last_=null}return l(e,[{key:"get",value:function(){var e=this.collection_.get(),t=Object.assign({},e);return this.last_&&XR(this.last_,(function(e,n){t[e]=t[e]-n})),this.last_=e,t}}]),e}(),qP=function(){function e(t,n){u(this,e),this.server_=n,this.statsToReport_={},this.statsListener_=new VP(t);var r=1e4+2e4*Math.random();nA(this.reportStats_.bind(this),Math.floor(r))}return l(e,[{key:"reportStats_",value:function(){var e=this,t=this.statsListener_.get(),n={},r=!1;XR(t,(function(t,i){i>0&&ce(e.statsToReport_,t)&&(n[t]=i,r=!0)})),r&&this.server_.reportStats(n),nA(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}]),e}();function BP(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(jP||(jP={}));var zP,WP=function(){function e(t,n,r){u(this,e),this.path=t,this.affectedTree=n,this.revert=r,this.type=jP.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return l(e,[{key:"operationForChild",value:function(t){if(UA(this.path)){if(null!=this.affectedTree.value)return P(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new NA(t));return new e(RA(),n,this.revert)}return P(AA(this.path)===t,"operationForChild called for unrelated child."),new e(DA(this.path),this.affectedTree,this.revert)}}]),e}(),KP=function(){function e(t,n,r){u(this,e),this.source=t,this.path=n,this.snap=r,this.type=jP.OVERWRITE}return l(e,[{key:"operationForChild",value:function(t){return UA(this.path)?new e(this.source,RA(),this.snap.getImmediateChild(t)):new e(this.source,DA(this.path),this.snap)}}]),e}(),HP=function(){function e(t,n,r){u(this,e),this.source=t,this.path=n,this.children=r,this.type=jP.MERGE}return l(e,[{key:"operationForChild",value:function(t){if(UA(this.path)){var n=this.children.subtree(new NA(t));return n.isEmpty()?null:n.value?new KP(this.source,RA(),n.value):new e(this.source,RA(),n)}return P(AA(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,DA(this.path),this.children)}},{key:"toString",value:function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}]),e}(),GP=function(){function e(t,n,r){u(this,e),this.node_=t,this.fullyInitialized_=n,this.filtered_=r}return l(e,[{key:"isFullyInitialized",value:function(){return this.fullyInitialized_}},{key:"isFiltered",value:function(){return this.filtered_}},{key:"isCompleteForPath",value:function(e){if(UA(e))return this.isFullyInitialized()&&!this.filtered_;var t=AA(e);return this.isCompleteForChild(t)}},{key:"isCompleteForChild",value:function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}},{key:"getNode",value:function(){return this.node_}}]),e}();function QP(e,t,n,r,i,a){var o=r.filter((function(e){return e.type===n}));o.sort((function(t,n){return function(e,t,n){if(null==t.childName||null==n.childName)throw D("Should only compare child_ events.");var r=new $A(t.childName,t.snapshotNode),i=new $A(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n)})),o.forEach((function(n){var r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,a);i.forEach((function(i){i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function $P(e,t){return{eventCache:e,serverCache:t}}function YP(e,t,n,r){return $P(new GP(t,n,r),e.serverCache)}function XP(e,t,n,r){return $P(e.eventCache,new GP(t,n,r))}function JP(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function ZP(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}var eD=function(){return zP||(zP=new rP(GR)),zP},tD=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eD();u(this,e),this.value=t,this.children=n}return l(e,[{key:"isEmpty",value:function(){return null===this.value&&this.children.isEmpty()}},{key:"findRootMostMatchingPathAndValue",value:function(e,t){if(null!=this.value&&t(this.value))return{path:RA(),value:this.value};if(UA(e))return null;var n=AA(e),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(DA(e),t);return null!=i?{path:FA(new NA(n),i.path),value:i.value}:null}return null}},{key:"findRootMostValueAndPath",value:function(e){return this.findRootMostMatchingPathAndValue(e,(function(){return!0}))}},{key:"subtree",value:function(t){if(UA(t))return this;var n=AA(t),r=this.children.get(n);return null!==r?r.subtree(DA(t)):new e(null)}},{key:"set",value:function(t,n){if(UA(t))return new e(n,this.children);var r=AA(t),i=(this.children.get(r)||new e(null)).set(DA(t),n),a=this.children.insert(r,i);return new e(this.value,a)}},{key:"remove",value:function(t){if(UA(t))return this.children.isEmpty()?new e(null):new e(null,this.children);var n=AA(t),r=this.children.get(n);if(r){var i,a=r.remove(DA(t));return i=a.isEmpty()?this.children.remove(n):this.children.insert(n,a),null===this.value&&i.isEmpty()?new e(null):new e(this.value,i)}return this}},{key:"get",value:function(e){if(UA(e))return this.value;var t=AA(e),n=this.children.get(t);return n?n.get(DA(e)):null}},{key:"setTree",value:function(t,n){if(UA(t))return n;var r,i=AA(t),a=(this.children.get(i)||new e(null)).setTree(DA(t),n);return r=a.isEmpty()?this.children.remove(i):this.children.insert(i,a),new e(this.value,r)}},{key:"fold",value:function(e){return this.fold_(RA(),e)}},{key:"fold_",value:function(e,t){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(FA(e,r),t)})),t(e,this.value,n)}},{key:"findOnPath",value:function(e,t){return this.findOnPath_(e,RA(),t)}},{key:"findOnPath_",value:function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(UA(e))return null;var i=AA(e),a=this.children.get(i);return a?a.findOnPath_(DA(e),FA(t,i),n):null}},{key:"foreachOnPath",value:function(e,t){return this.foreachOnPath_(e,RA(),t)}},{key:"foreachOnPath_",value:function(t,n,r){if(UA(t))return this;this.value&&r(n,this.value);var i=AA(t),a=this.children.get(i);return a?a.foreachOnPath_(DA(t),FA(n,i),r):new e(null)}},{key:"foreach",value:function(e){this.foreach_(RA(),e)}},{key:"foreach_",value:function(e,t){this.children.inorderTraversal((function(n,r){r.foreach_(FA(e,n),t)})),this.value&&t(e,this.value)}},{key:"foreachChild",value:function(e){this.children.inorderTraversal((function(t,n){n.value&&e(t,n.value)}))}}],[{key:"fromObject",value:function(t){var n=new e(null);return XR(t,(function(e,t){n=n.set(new NA(e),t)})),n}}]),e}(),nD=function(){function e(t){u(this,e),this.writeTree_=t}return l(e,null,[{key:"empty",value:function(){return new e(new tD(null))}}]),e}();function rD(e,t,n){if(UA(t))return new nD(new tD(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,a=r.value,o=jA(i,t);return a=a.updateChild(o,n),new nD(e.writeTree_.set(i,a))}var u=new tD(n),s=e.writeTree_.setTree(t,u);return new nD(s)}function iD(e,t,n){var r=e;return XR(n,(function(e,n){r=rD(r,FA(t,e),n)})),r}function aD(e,t){if(UA(t))return nD.empty();var n=e.writeTree_.setTree(t,new tD(null));return new nD(n)}function oD(e,t){return null!=uD(e,t)}function uD(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(jA(n.path,t)):null}function sD(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(vP,(function(e,n){t.push(new $A(e,n))})):e.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new $A(e,n.value))})),t}function cD(e,t){if(UA(t))return e;var n=uD(e,t);return new nD(null!=n?new tD(n):e.writeTree_.subtree(t))}function lD(e){return e.writeTree_.isEmpty()}function fD(e,t){return hD(RA(),e.writeTree_,t)}function hD(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);var r=null;return t.children.inorderTraversal((function(t,i){".priority"===t?(P(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=hD(FA(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(FA(e,".priority"),r)),n}function dD(e,t){return ED(t,e)}function pD(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}function vD(e,t){var n=e.allWrites.findIndex((function(e){return e.writeId===t}));P(n>=0,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);for(var i=r.visible,a=!1,o=e.allWrites.length-1;i&&o>=0;){var u=e.allWrites[o];u.visible&&(o>=n&&yD(u,r.path)?i=!1:qA(r.path,u.path)&&(a=!0)),o--}if(i){if(a)return function(e){e.visibleWrites=gD(e.allWrites,mD,RA()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;r.snap?e.visibleWrites=aD(e.visibleWrites,r.path):XR(r.children,(function(t){e.visibleWrites=aD(e.visibleWrites,FA(r.path,t))}));return!0}return!1}function yD(e,t){if(e.snap)return qA(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&qA(FA(e.path,n),t))return!0;return!1}function mD(e){return e.visible}function gD(e,t,n){for(var r=nD.empty(),i=0;i<e.length;++i){var a=e[i];if(t(a)){var o=a.path,u=void 0;if(a.snap)qA(n,o)?r=rD(r,u=jA(n,o),a.snap):qA(o,n)&&(u=jA(o,n),r=rD(r,RA(),a.snap.getChild(u)));else{if(!a.children)throw D("WriteRecord should have .snap or .children");if(qA(n,o))r=iD(r,u=jA(n,o),a.children);else if(qA(o,n))if(UA(u=jA(o,n)))r=iD(r,RA(),a.children);else{var s=le(a.children,AA(u));if(s){var c=s.getChild(DA(u));r=rD(r,RA(),c)}}}}}return r}function kD(e,t,n,r,i){if(r||i){var a=cD(e.visibleWrites,t);if(!i&&lD(a))return n;if(i||null!=n||oD(a,RA())){return fD(gD(e.allWrites,(function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(qA(e.path,t)||qA(t,e.path))}),t),n||wP.EMPTY_NODE)}return null}var o=uD(e.visibleWrites,t);if(null!=o)return o;var u=cD(e.visibleWrites,t);return lD(u)?n:null!=n||oD(u,RA())?fD(u,n||wP.EMPTY_NODE):null}function bD(e,t,n,r){return kD(e.writeTree,e.treePath,t,n,r)}function wD(e,t){return function(e,t,n){var r=wP.EMPTY_NODE,i=uD(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(vP,(function(e,t){r=r.updateImmediateChild(e,t)})),r;if(n){var a=cD(e.visibleWrites,t);return n.forEachChild(vP,(function(e,t){var n=fD(cD(a,new NA(e)),t);r=r.updateImmediateChild(e,n)})),sD(a).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}return sD(cD(e.visibleWrites,t)).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function _D(e,t,n,r){return function(e,t,n,r,i){P(r||i,"Either existingEventSnap or existingServerSnap must exist");var a=FA(t,n);if(oD(e.visibleWrites,a))return null;var o=cD(e.visibleWrites,a);return lD(o)?i.getChild(n):fD(o,i.getChild(n))}(e.writeTree,e.treePath,t,n,r)}function xD(e,t){return function(e,t){return uD(e.visibleWrites,t)}(e.writeTree,FA(e.treePath,t))}function ID(e,t,n,r,i,a){return function(e,t,n,r,i,a,o){var u,s=cD(e.visibleWrites,t),c=uD(s,RA());if(null!=c)u=c;else{if(null==n)return[];u=fD(s,n)}if((u=u.withIndex(o)).isEmpty()||u.isLeafNode())return[];for(var l=[],f=o.getCompare(),h=a?u.getReverseIteratorFrom(r,o):u.getIteratorFrom(r,o),d=h.getNext();d&&l.length<i;)0!==f(d,r)&&l.push(d),d=h.getNext();return l}(e.writeTree,e.treePath,t,n,r,i,a)}function SD(e,t,n){return function(e,t,n,r){var i=FA(t,n),a=uD(e.visibleWrites,i);return null!=a?a:r.isCompleteForChild(n)?fD(cD(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function TD(e,t){return ED(FA(e.treePath,t),e.writeTree)}function ED(e,t){return{treePath:e,writeTree:t}}var CD=function(){function e(){u(this,e),this.changeMap=new Map}return l(e,[{key:"trackChildChange",value:function(e){var t=e.type,n=e.childName;P("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),P(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,RP(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,NP(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,CP(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw D("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,RP(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}},{key:"getChanges",value:function(){return Array.from(this.changeMap.values())}}]),e}(),ND=new(function(){function e(){u(this,e)}return l(e,[{key:"getCompleteChild",value:function(e){return null}},{key:"getChildAfterChild",value:function(e,t,n){return null}}]),e}()),RD=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;u(this,e),this.writes_=t,this.viewCache_=n,this.optCompleteServerCache_=r}return l(e,[{key:"getCompleteChild",value:function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new GP(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return SD(this.writes_,e,n)}},{key:"getChildAfterChild",value:function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:ZP(this.viewCache_),i=ID(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}]),e}();function AD(e,t,n,r,i){var a,o,u=new CD;if(n.type===jP.OVERWRITE){var s=n;s.source.fromUser?a=OD(e,t,s.path,s.snap,r,i,u):(P(s.source.fromServer,"Unknown source."),o=s.source.tagged||t.serverCache.isFiltered()&&!UA(s.path),a=DD(e,t,s.path,s.snap,r,i,o,u))}else if(n.type===jP.MERGE){var c=n;c.source.fromUser?a=function(e,t,n,r,i,a,o){var u=t;return r.foreach((function(r,s){var c=FA(n,r);LD(t,AA(c))&&(u=OD(e,u,c,s,i,a,o))})),r.foreach((function(r,s){var c=FA(n,r);LD(t,AA(c))||(u=OD(e,u,c,s,i,a,o))})),u}(e,t,c.path,c.children,r,i,u):(P(c.source.fromServer,"Unknown source."),o=c.source.tagged||t.serverCache.isFiltered(),a=FD(e,t,c.path,c.children,r,i,o,u))}else if(n.type===jP.ACK_USER_WRITE){var l=n;a=l.revert?function(e,t,n,r,i,a){var o;if(null!=xD(r,n))return t;var u,s=new RD(r,t,i),c=t.eventCache.getNode();if(UA(n)||".priority"===AA(n)){var l;if(t.serverCache.isFullyInitialized())l=bD(r,ZP(t));else{var f=t.serverCache.getNode();P(f instanceof wP,"serverChildren would be complete if leaf node"),l=wD(r,f)}u=e.filter.updateFullNode(c,l,a)}else{var h=AA(n),d=SD(r,h,t.serverCache);null==d&&t.serverCache.isCompleteForChild(h)&&(d=c.getImmediateChild(h)),(u=null!=d?e.filter.updateChild(c,h,d,DA(n),s,a):t.eventCache.getNode().hasChild(h)?e.filter.updateChild(c,h,wP.EMPTY_NODE,DA(n),s,a):c).isEmpty()&&t.serverCache.isFullyInitialized()&&(o=bD(r,ZP(t))).isLeafNode()&&(u=e.filter.updateFullNode(u,o,a))}return o=t.serverCache.isFullyInitialized()||null!=xD(r,RA()),YP(t,u,o,e.filter.filtersNodes())}(e,t,l.path,r,i,u):function(e,t,n,r,i,a,o){if(null!=xD(i,n))return t;var u=t.serverCache.isFiltered(),s=t.serverCache;if(null!=r.value){if(UA(n)&&s.isFullyInitialized()||s.isCompleteForPath(n))return DD(e,t,n,s.getNode().getChild(n),i,a,u,o);if(UA(n)){var c=new tD(null);return s.getNode().forEachChild(JA,(function(e,t){c=c.set(new NA(e),t)})),FD(e,t,n,c,i,a,u,o)}return t}var l=new tD(null);return r.foreach((function(e,t){var r=FA(n,e);s.isCompleteForPath(r)&&(l=l.set(e,s.getNode().getChild(r)))})),FD(e,t,n,l,i,a,u,o)}(e,t,l.path,l.affectedTree,r,i,u)}else{if(n.type!==jP.LISTEN_COMPLETE)throw D("Unknown operation type: "+n.type);a=function(e,t,n,r,i){var a=t.serverCache,o=XP(t,a.getNode(),a.isFullyInitialized()||UA(n),a.isFiltered());return PD(e,o,n,r,ND,i)}(e,t,n.path,r,u)}var f=u.getChanges();return function(e,t,n){var r=t.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=JP(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&n.push(EP(JP(t)))}}(t,a,f),{viewCache:a,changes:f}}function PD(e,t,n,r,i,a){var o,u,s=t.eventCache;if(null!=xD(r,n))return t;if(UA(n))if(P(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){var c=ZP(t),l=wD(r,c instanceof wP?c:wP.EMPTY_NODE);o=e.filter.updateFullNode(t.eventCache.getNode(),l,a)}else{var f=bD(r,ZP(t));o=e.filter.updateFullNode(t.eventCache.getNode(),f,a)}else{var h=AA(n);if(".priority"===h){P(1===PA(n),"Can't have a priority with additional path components");var d=s.getNode(),p=_D(r,n,d,u=t.serverCache.getNode());o=null!=p?e.filter.updatePriority(d,p):s.getNode()}else{var v,y=DA(n);if(s.isCompleteForChild(h)){u=t.serverCache.getNode();var m=_D(r,n,s.getNode(),u);v=null!=m?s.getNode().getImmediateChild(h).updateChild(y,m):s.getNode().getImmediateChild(h)}else v=SD(r,h,t.serverCache);o=null!=v?e.filter.updateChild(s.getNode(),h,v,y,i,a):s.getNode()}}return YP(t,o,s.isFullyInitialized()||UA(n),e.filter.filtersNodes())}function DD(e,t,n,r,i,a,o,u){var s,c=t.serverCache,l=o?e.filter:e.filter.getIndexedFilter();if(UA(n))s=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var f=c.getNode().updateChild(n,r);s=l.updateFullNode(c.getNode(),f,null)}else{var h=AA(n);if(!c.isCompleteForPath(n)&&PA(n)>1)return t;var d=DA(n),p=c.getNode().getImmediateChild(h).updateChild(d,r);s=".priority"===h?l.updatePriority(c.getNode(),p):l.updateChild(c.getNode(),h,p,d,ND,null)}var v=XP(t,s,c.isFullyInitialized()||UA(n),l.filtersNodes());return PD(e,v,n,i,new RD(i,v,a),u)}function OD(e,t,n,r,i,a,o){var u,s,c=t.eventCache,l=new RD(i,t,a);if(UA(n))s=e.filter.updateFullNode(t.eventCache.getNode(),r,o),u=YP(t,s,!0,e.filter.filtersNodes());else{var f=AA(n);if(".priority"===f)s=e.filter.updatePriority(t.eventCache.getNode(),r),u=YP(t,s,c.isFullyInitialized(),c.isFiltered());else{var h,d=DA(n),p=c.getNode().getImmediateChild(f);if(UA(d))h=r;else{var v=l.getCompleteChild(f);h=null!=v?".priority"===OA(d)&&v.getChild(MA(d)).isEmpty()?v:v.updateChild(d,r):wP.EMPTY_NODE}if(p.equals(h))u=t;else u=YP(t,e.filter.updateChild(c.getNode(),f,h,d,l,o),c.isFullyInitialized(),e.filter.filtersNodes())}}return u}function LD(e,t){return e.eventCache.isCompleteForChild(t)}function MD(e,t,n){return n.foreach((function(e,n){t=t.updateChild(e,n)})),t}function FD(e,t,n,r,i,a,o,u){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var s,c=t;s=UA(n)?r:new tD(null).setTree(n,r);var l=t.serverCache.getNode();return s.children.inorderTraversal((function(n,r){if(l.hasChild(n)){var s=MD(0,t.serverCache.getNode().getImmediateChild(n),r);c=DD(e,c,new NA(n),s,i,a,o,u)}})),s.children.inorderTraversal((function(n,r){var s=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!l.hasChild(n)&&!s){var f=MD(0,t.serverCache.getNode().getImmediateChild(n),r);c=DD(e,c,new NA(n),f,i,a,o,u)}})),c}var UD;function jD(e,t){var n=ZP(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!UA(t)&&!n.getImmediateChild(AA(t)).isEmpty())?n.getChild(t):null}function VD(e,t,n,r){t.type===jP.MERGE&&null!==t.source.queryId&&(P(ZP(e.viewCache_),"We should always have a full cache before handling merges"),P(JP(e.viewCache_),"Missing event cache, even though we have a server cache"));var i,a,o=e.viewCache_,u=AD(e.processor_,o,t,n,r);return i=e.processor_,a=u.viewCache,P(a.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),P(a.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),P(u.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=u.viewCache,qD(e,u.changes,u.viewCache.eventCache.getNode(),null)}function qD(e,t,n,r){var i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){var i=[],a=[];return t.forEach((function(t){var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&a.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),QP(e,i,"child_removed",t,r,n),QP(e,i,"child_added",t,r,n),QP(e,i,"child_moved",a,r,n),QP(e,i,"child_changed",t,r,n),QP(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}var BD;function zD(e,t,n,r){var i=t.source.queryId;if(null!==i){var a=e.views.get(i);return P(null!=a,"SyncTree gave us an op for an invalid query."),VD(a,t,n,r)}var o,u=[],s=y(e.views.values());try{for(s.s();!(o=s.n()).done;){var c=o.value;u=u.concat(VD(c,t,n,r))}}catch(l){s.e(l)}finally{s.f()}return u}function WD(e,t){var n,r=null,i=y(e.views.values());try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r||jD(a,t)}}catch(o){i.e(o)}finally{i.f()}return r}var KD=l((function e(t){u(this,e),this.listenProvider_=t,this.syncPointTree_=new tD(null),this.pendingWriteTree_={visibleWrites:nD.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}));function HD(e,t,n,r,i){return function(e,t,n,r,i){P(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=rD(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?XD(e,new KP({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function GD(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=pD(e.pendingWriteTree_,t),i=vD(e.pendingWriteTree_,t);if(i){var a=new tD(null);return null!=r.snap?a=a.set(RA(),!0):XR(r.children,(function(e){a=a.set(new NA(e),!0)})),XD(e,new WP(r.path,a,n))}return[]}function QD(e,t,n){return XD(e,new KP({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function $D(e,t,n,r){var i=eO(e,r);if(null!=i){var a=tO(i),o=a.path,u=a.queryId,s=jA(o,t);return nO(e,o,new KP(BP(u),s,n))}return[]}function YD(e,t,n){var r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,(function(e,n){var r=WD(n,jA(e,t));if(r)return r}));return kD(r,t,i,n,!0)}function XD(e,t){return JD(t,e.syncPointTree_,null,dD(e.pendingWriteTree_,RA()))}function JD(e,t,n,r){if(UA(e.path))return ZD(e,t,n,r);var i=t.get(RA());null==n&&null!=i&&(n=WD(i,RA()));var a=[],o=AA(e.path),u=e.operationForChild(o),s=t.children.get(o);if(s&&u){var c=n?n.getImmediateChild(o):null,l=TD(r,o);a=a.concat(JD(u,s,c,l))}return i&&(a=a.concat(zD(i,e,r,n))),a}function ZD(e,t,n,r){var i=t.get(RA());null==n&&null!=i&&(n=WD(i,RA()));var a=[];return t.children.inorderTraversal((function(t,i){var o=n?n.getImmediateChild(t):null,u=TD(r,t),s=e.operationForChild(t);s&&(a=a.concat(ZD(s,i,o,u)))})),i&&(a=a.concat(zD(i,e,r,n))),a}function eO(e,t){return e.tagToQueryMap.get(t)}function tO(e){var t=e.indexOf("$");return P(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new NA(e.substr(0,t))}}function nO(e,t,n){var r=e.syncPointTree_.get(t);return P(r,"Missing sync point for query tag that we're tracking"),zD(r,n,dD(e.pendingWriteTree_,t),null)}var rO=function(){function e(t){u(this,e),this.node_=t}return l(e,[{key:"getImmediateChild",value:function(t){return new e(this.node_.getImmediateChild(t))}},{key:"node",value:function(){return this.node_}}]),e}(),iO=function(){function e(t,n){u(this,e),this.syncTree_=t,this.path_=n}return l(e,[{key:"getImmediateChild",value:function(t){var n=FA(this.path_,t);return new e(this.syncTree_,n)}},{key:"node",value:function(){return YD(this.syncTree_,this.path_)}}]),e}(),aO=function(e,t,n){return e&&"object"===typeof e?(P(".sv"in e,"Unexpected leaf node or priority contents"),"string"===typeof e[".sv"]?oO(e[".sv"],t,n):"object"===typeof e[".sv"]?uO(e[".sv"],t):void P(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},oO=function(e,t,n){if("timestamp"===e)return n.timestamp;P(!1,"Unexpected server value: "+e)},uO=function(e,t,n){e.hasOwnProperty("increment")||P(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e.increment;"number"!==typeof r&&P(!1,"Unexpected increment value: "+r);var i=t.node();if(P(null!==i&&"undefined"!==typeof i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var a=i.getValue();return"number"!==typeof a?r:a+r},sO=function(e,t,n,r){return lO(t,new iO(n,e),r)},cO=function(e,t,n){return lO(e,new rO(t),n)};function lO(e,t,n){var r,i=e.getPriority().val(),a=aO(i,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var o=e,u=aO(o.getValue(),t,n);return u!==o.getValue()||a!==o.getPriority().val()?new fP(u,xP(a)):e}var s=e;return r=s,a!==s.getPriority().val()&&(r=r.updatePriority(new fP(a))),s.forEachChild(vP,(function(e,i){var a=lO(i,t.getImmediateChild(e),n);a!==i&&(r=r.updateImmediateChild(e,a))})),r}var fO=l((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};u(this,e),this.name=t,this.parent=n,this.node=r}));function hO(e,t){for(var n=t instanceof NA?t:new NA(t),r=e,i=AA(n);null!==i;){var a=le(r.node.children,i)||{children:{},childCount:0};r=new fO(i,r,a),i=AA(n=DA(n))}return r}function dO(e){return e.node.value}function pO(e,t){e.node.value=t,kO(e)}function vO(e){return e.node.childCount>0}function yO(e,t){XR(e.node.children,(function(n,r){t(new fO(n,e,r))}))}function mO(e,t,n,r){n&&!r&&t(e),yO(e,(function(e){mO(e,t,!0,r)})),n&&r&&t(e)}function gO(e){return new NA(null===e.parent?e.name:gO(e.parent)+"/"+e.name)}function kO(e){null!==e.parent&&function(e,t,n){var r=function(e){return void 0===dO(e)&&!vO(e)}(n),i=ce(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,kO(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,kO(e))}(e.parent,e.name,e)}var bO=/[\[\].#$\/\u0000-\u001F\u007F]/,wO=/[\[\].#$\u0000-\u001F\u007F]/,_O=10485760,xO=function(e){return"string"===typeof e&&0!==e.length&&!bO.test(e)},IO=function(e){return"string"===typeof e&&0!==e.length&&!wO.test(e)},SO=function e(t,n,r){var i=r instanceof NA?new BA(r,t):r;if(void 0===n)throw new Error(t+"contains undefined "+WA(i));if("function"===typeof n)throw new Error(t+"contains a function "+WA(i)+" with contents = "+n.toString());if(zR(n))throw new Error(t+"contains "+n.toString()+" "+WA(i));if("string"===typeof n&&n.length>_O/3&&xe(n)>_O)throw new Error(t+"contains a string greater than "+_O+" utf8 bytes "+WA(i)+" ('"+n.substring(0,50)+"...')");if(n&&"object"===typeof n){var a=!1,o=!1;if(XR(n,(function(n,r){if(".value"===n)a=!0;else if(".priority"!==n&&".sv"!==n&&(o=!0,!xO(n)))throw new Error(t+" contains an invalid key ("+n+") "+WA(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=xe(t),zA(e)}(i,n),e(t,r,i),function(e){var t=e.parts_.pop();e.byteLength_-=xe(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)})),a&&o)throw new Error(t+' contains ".value" child '+WA(i)+" in addition to actual children.")}},TO=function(e,t){var n=t.path.toString();if("string"!==typeof t.repoInfo.host||0===t.repoInfo.host.length||!xO(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),IO(e)}(n))throw new Error(_e(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},EO=l((function e(){u(this,e),this.eventLists_=[],this.recursionDepth_=0}));function CO(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],a=i.getPath();null===n||VA(a,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:a}),n.events.push(i)}n&&e.eventLists_.push(n)}function NO(e,t,n){CO(e,n),RO(e,(function(e){return qA(e,t)||qA(t,e)}))}function RO(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];if(i)t(i.path)?(AO(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}n&&(e.eventLists_=[]),e.recursionDepth_--}function AO(e){for(var t=0;t<e.events.length;t++){var n=e.events[t];if(null!==n){e.events[t]=null;var r=n.getEventRunner();LR&&UR("event: "+n.toString()),tA(r)}}}var PO="repo_interrupt",DO=function(){function e(t,n,r,i){u(this,e),this.repoInfo_=t,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new EO,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=MP(),this.transactionQueueTree_=new fO,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return l(e,[{key:"toString",value:function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}]),e}();function OO(e,t,n){if(e.stats_=yA(e.repoInfo_),e.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new OP(e.repoInfo_,(function(t,n,r,i){FO(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((function(){return UO(e,!0)}),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ue(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new GA(e.repoInfo_,t,(function(t,n,r,i){FO(e,t,n,r,i)}),(function(t){UO(e,t)}),(function(t){!function(e,t){XR(t,(function(t,n){jO(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((function(t){e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((function(t){e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){var n=e.toString();return vA[n]||(vA[n]=t()),vA[n]}(e.repoInfo_,(function(){return new qP(e.stats_,e.server_)})),e.infoData_=new LP,e.infoSyncTree_=new KD({startListening:function(t,n,r,i){var a=[],o=e.infoData_.getNode(t._path);return o.isEmpty()||(a=QD(e.infoSyncTree_,t._path,o),setTimeout((function(){i("ok")}),0)),a},stopListening:function(){}}),jO(e,"connected",!1),e.serverSyncTree_=new KD({startListening:function(t,n,r,i){return e.server_.listen(t,r,n,(function(n,r){var a=i(n,r);NO(e.eventQueue_,t._path,a)})),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}function LO(e){var t=e.infoData_.getNode(new NA(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function MO(e){return(t=(t={timestamp:LO(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function FO(e,t,n,r,i){e.dataUpdateCount++;var a=new NA(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var o=[];if(i)if(r){var u=he(n,(function(e){return xP(e)}));o=function(e,t,n,r){var i=eO(e,r);if(i){var a=tO(i),o=a.path,u=a.queryId,s=jA(o,t),c=tD.fromObject(n);return nO(e,o,new HP(BP(u),s,c))}return[]}(e.serverSyncTree_,a,u,i)}else{var s=xP(n);o=$D(e.serverSyncTree_,a,s,i)}else if(r){var c=he(n,(function(e){return xP(e)}));o=function(e,t,n){var r=tD.fromObject(n);return XD(e,new HP({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,a,c)}else{var l=xP(n);o=QD(e.serverSyncTree_,a,l)}var f=a;o.length>0&&(f=HO(e,a)),NO(e.eventQueue_,f,o)}function UO(e,t){jO(e,"connected",t),!1===t&&function(e){BO(e,"onDisconnectEvents");var t=MO(e),n=MP();UP(e.onDisconnect_,RA(),(function(r,i){var a=sO(r,i,e.serverSyncTree_,t);FP(n,r,a)}));var r=[];UP(n,RA(),(function(t,n){r=r.concat(QD(e.serverSyncTree_,t,n));var i=XO(e,t);HO(e,i)})),e.onDisconnect_=MP(),NO(e.eventQueue_,RA(),r)}(e)}function jO(e,t,n){var r=new NA("/.info/"+t),i=xP(n);e.infoData_.updateSnapshot(r,i);var a=QD(e.infoSyncTree_,r,i);NO(e.eventQueue_,r,a)}function VO(e){return e.nextWriteId_++}function qO(e){e.persistentConnection_&&e.persistentConnection_.interrupt(PO)}function BO(e){var t="";e.persistentConnection_&&(t=e.persistentConnection_.id+":");for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];UR.apply(void 0,[t].concat(r))}function zO(e,t,n){return YD(e.serverSyncTree_,t,n)||wP.EMPTY_NODE}function WO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||YO(e,t),dO(t)){var n=QO(e,t);P(n.length>0,"Sending zero length transaction queue");var r=n.every((function(e){return 0===e.status}));r&&KO(e,gO(t),n)}else vO(t)&&yO(t,(function(t){WO(e,t)}))}function KO(e,t,n){for(var r=n.map((function(e){return e.currentWriteId})),i=zO(e,t,r),a=i,o=i.hash(),u=0;u<n.length;u++){var s=n[u];P(0===s.status,"tryToSendTransactionQueue_: items in queue should all be run."),s.status=1,s.retryCount++;var c=jA(t,s.path);a=a.updateChild(c,s.currentOutputSnapshotRaw)}var l=a.val(!0),f=t;e.server_.put(f.toString(),l,(function(r){BO(e,"transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){for(var a=[],o=function(t){n[t].status=2,i=i.concat(GD(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&a.push((function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)})),n[t].unwatcher()},u=0;u<n.length;u++)o(u);YO(e,hO(e.transactionQueueTree_,t)),WO(e,e.transactionQueueTree_),NO(e.eventQueue_,t,i);for(var s=0;s<a.length;s++)tA(a[s])}else{if("datastale"===r)for(var c=0;c<n.length;c++)3===n[c].status?n[c].status=4:n[c].status=0;else{BR("transaction at "+f.toString()+" failed: "+r);for(var l=0;l<n.length;l++)n[l].status=4,n[l].abortReason=r}HO(e,t)}}),o)}function HO(e,t){var n=GO(e,t),r=gO(n);return function(e,t,n){if(0===t.length)return;for(var r=[],i=[],a=t.filter((function(e){return 0===e.status})),o=a.map((function(e){return e.currentWriteId})),u=function(a){var u,s,c=t[a],l=jA(n,c.path),f=!1;if(P(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)f=!0,u=c.abortReason,i=i.concat(GD(e.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=25)f=!0,u="maxretry",i=i.concat(GD(e.serverSyncTree_,c.currentWriteId,!0));else{var h=zO(e,c.path,o);c.currentInputSnapshot=h;var d=t[a].update(h.val());if(void 0!==d){SO("transaction failed: Data returned ",d,c.path);var p=xP(d);"object"===typeof d&&null!=d&&ce(d,".priority")||(p=p.updatePriority(h.getPriority()));var v=c.currentWriteId,y=MO(e),m=cO(p,h,y);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=m,c.currentWriteId=VO(e),o.splice(o.indexOf(v),1),i=(i=i.concat(HD(e.serverSyncTree_,c.path,m,c.currentWriteId,c.applyLocally))).concat(GD(e.serverSyncTree_,v,!0))}else f=!0,u="nodata",i=i.concat(GD(e.serverSyncTree_,c.currentWriteId,!0))}NO(e.eventQueue_,n,i),i=[],f&&(t[a].status=2,s=t[a].unwatcher,setTimeout(s,Math.floor(0)),t[a].onComplete&&("nodata"===u?r.push((function(){return t[a].onComplete(null,!1,t[a].currentInputSnapshot)})):r.push((function(){return t[a].onComplete(new Error(u),!1,null)}))))},s=0;s<t.length;s++)u(s);YO(e,e.transactionQueueTree_);for(var c=0;c<r.length;c++)tA(r[c]);WO(e,e.transactionQueueTree_)}(e,QO(e,n),r),r}function GO(e,t){var n,r=e.transactionQueueTree_;for(n=AA(t);null!==n&&void 0===dO(r);)r=hO(r,n),n=AA(t=DA(t));return r}function QO(e,t){var n=[];return $O(e,t,n),n.sort((function(e,t){return e.order-t.order})),n}function $O(e,t,n){var r=dO(t);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);yO(t,(function(t){$O(e,t,n)}))}function YO(e,t){var n=dO(t);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,pO(t,n.length>0?n:void 0)}yO(t,(function(t){YO(e,t)}))}function XO(e,t){var n=gO(GO(e,t)),r=hO(e.transactionQueueTree_,t);return function(e,t,n){for(var r=n?e:e.parent;null!==r;){if(t(r))return!0;r=r.parent}}(r,(function(t){JO(e,t)})),JO(e,r),mO(r,(function(t){JO(e,t)})),n}function JO(e,t){var n=dO(t);if(n){for(var r=[],i=[],a=-1,o=0;o<n.length;o++)3===n[o].status||(1===n[o].status?(P(a===o-1,"All SENT items should be at beginning of queue."),a=o,n[o].status=3,n[o].abortReason="set"):(P(0===n[o].status,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(GD(e.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));-1===a?pO(t,void 0):n.length=a+1,NO(e.eventQueue_,gO(t),i);for(var u=0;u<r.length;u++)tA(r[u])}}var ZO=function(e,t){var n=eL(e),r=n.namespace;"firebase.com"===n.domain&&qR(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||qR("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&BR("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new fA(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new NA(n.pathString)}},eL=function(e){var t="",n="",r="",i="",a="",o=!0,u="https",s=443;if("string"===typeof e){var c=e.indexOf("//");c>=0&&(u=e.substring(0,c-1),e=e.substring(c+2));var l=e.indexOf("/");-1===l&&(l=e.length);var f=e.indexOf("?");-1===f&&(f=e.length),t=e.substring(0,Math.min(l,f)),l<f&&(i=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(a){}t+="/"+i}return t}(e.substring(l,f)));var h=function(e){var t={};"?"===e.charAt(0)&&(e=e.substring(1));var n,r=y(e.split("&"));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(0!==i.length){var a=i.split("=");2===a.length?t[decodeURIComponent(a[0])]=decodeURIComponent(a[1]):BR("Invalid query segment '".concat(i,"' in query '").concat(e,"'"))}}}catch(o){r.e(o)}finally{r.f()}return t}(e.substring(Math.min(e.length,f)));(c=t.indexOf(":"))>=0?(o="https"===u||"wss"===u,s=parseInt(t.substring(c+1),10)):c=t.length;var d=t.slice(0,c);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{var p=t.indexOf(".");r=t.substring(0,p).toLowerCase(),n=t.substring(p+1),a=r}"ns"in h&&(a=h.ns)}return{host:t,port:s,domain:n,subdomain:r,secure:o,scheme:u,pathString:i,namespace:a}},tL="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",nL=(function(){var e=0,t=[]}(),function(){function e(t,n,r,i){u(this,e),this._repo=t,this._path=n,this._queryParams=r,this._orderByCalled=i}return l(e,[{key:"key",get:function(){return UA(this._path)?null:OA(this._path)}},{key:"ref",get:function(){return new rL(this._repo,this._path)}},{key:"_queryIdentifier",get:function(){var e=DP(this._queryParams),t=$R(e);return"{}"===t?"default":t}},{key:"_queryObject",get:function(){return DP(this._queryParams)}},{key:"isEqual",value:function(t){if(!((t=Ie(t))instanceof e))return!1;var n=this._repo===t._repo,r=VA(this._path,t._path),i=this._queryIdentifier===t._queryIdentifier;return n&&r&&i}},{key:"toJSON",value:function(){return this.toString()}},{key:"toString",value:function(){return this._repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}]),e}());var rL=function(e){_(n,e);var t=T(n);function n(e,r){return u(this,n),t.call(this,e,r,new AP,!1)}return l(n,[{key:"parent",get:function(){var e=MA(this._path);return null===e?null:new n(this._repo,e)}},{key:"root",get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}}]),n}(nL);!function(e){P(!UD,"__referenceConstructor has already been defined"),UD=e}(rL),function(e){P(!BD,"__referenceConstructor has already been defined"),BD=e}(rL);var iL={},aL=!1;function oL(e,t,n,r){e.repoInfo_=new fA("".concat(t,":").concat(n),!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),r&&(e.authTokenProvider_=r)}function uL(e,t,n,r,i){var a=r||e.options.databaseURL;void 0===a&&(e.options.projectId||qR("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),UR("Using default host for project ",e.options.projectId),a="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));var o,u=ZO(a,i),s=u.repoInfo,c=void 0;"undefined"!==typeof process&&(c={NODE_ENV:"production",PUBLIC_URL:"/messanger",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.FIREBASE_DATABASE_EMULATOR_HOST),c?(o=!0,a="http://".concat(c,"?ns=").concat(s.namespace),s=(u=ZO(a,i)).repoInfo):o=!u.repoInfo.secure;var l=i&&o?new aA(aA.OWNER):new iA(e.name,e.options,t);TO("Invalid Firebase Database URL",u),UA(u.path)||qR("Database URL must point to the root of a Firebase Database (not including a child path).");var f=function(e,t,n,r){var i=iL[t.name];i||(i={},iL[t.name]=i);var a=i[e.toURLString()];a&&qR("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return a=new DO(e,aL,n,r),i[e.toURLString()]=a,a}(s,e,l,new rA(e.name,n));return new sL(f,e)}var sL=function(){function e(t,n){u(this,e),this._repoInternal=t,this.app=n,this.type="database",this._instanceStarted=!1}return l(e,[{key:"_repo",get:function(){return this._instanceStarted||(OO(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}},{key:"_root",get:function(){return this._rootInternal||(this._rootInternal=new rL(this._repo,RA())),this._rootInternal}},{key:"_delete",value:function(){return null!==this._rootInternal&&(!function(e,t){var n=iL[t];n&&n[e.key]===e||qR("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),qO(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}},{key:"_checkNotDeleted",value:function(e){null===this._rootInternal&&qR("Cannot call "+e+" on a deleted database.")}}]),e}();function cL(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(e=Ie(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&qR("Cannot call useEmulator() after instance has already been initialized.");var i=e._repoInternal,a=void 0;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&qR('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new aA(aA.OWNER);else if(r.mockUserToken){var o="string"===typeof r.mockUserToken?r.mockUserToken:te(r.mockUserToken,e.app.options.projectId);a=new aA(o)}oL(i,t,n,a)}GA.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},GA.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};!function(e){!function(e){SR=e}(_t),vt(new Ee("database",(function(e,t){var n=t.instanceIdentifier;return uL(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)}),"PUBLIC").setMultipleInstances(!0)),Ct(xR,IR,e),Ct(xR,IR,"esm2017")}();!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:It(),t=arguments.length>1?arguments[1]:void 0,n=yt(e,"database").getImmediate({identifier:t}),r=X("database");r&&cL.apply(void 0,[n].concat(Te(r)))}(xt({apiKey:"AIzaSyD90QokTAxrKsVf9LZ5Df6HTDjDlwz5Pq4",authDomain:"example-1fc1b.firebaseapp.com",projectId:"example-1fc1b",storageBucket:"example-1fc1b.appspot.com",messagingSenderId:"638317544484",appId:"1:638317544484:web:f1a0b702d7693f2eab84b1"}));var lL=function(e,t){var n="string"==typeof e?e:t||"(default)",r=yt("object"==typeof e?e:It(),"firestore").getImmediate({identifier:n});if(!r._initialized){var i=X("firestore");i&&Gx.apply(void 0,[r].concat(Te(i)))}return r}(),fL=(ws(),"firebasestorage.googleapis.com"),hL="storageBucket",dL=function(e){_(n,e);var t=T(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return u(this,n),(i=t.call(this,pL(e),"Firebase Storage: ".concat(r," (").concat(pL(e),")"))).status_=a,i.customData={serverResponse:null},i._baseMessage=i.message,Object.setPrototypeOf(b(i),n.prototype),i}return l(n,[{key:"status",get:function(){return this.status_},set:function(e){this.status_=e}},{key:"_codeEquals",value:function(e){return pL(e)===this.code}},{key:"serverResponse",get:function(){return this.customData.serverResponse},set:function(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}]),n}(ne);function pL(e){return"storage/"+e}function vL(){return new dL("unknown","An unknown error occurred, please check the error payload for server response.")}function yL(){return new dL("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}function mL(){return new dL("canceled","User canceled the upload/download.")}function gL(){return new dL("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function kL(e){return new dL("invalid-argument",e)}function bL(){return new dL("app-deleted","The Firebase app was deleted.")}function wL(e,t){return new dL("invalid-format","String does not match format '"+e+"': "+t)}function _L(e){throw new dL("internal-error","Internal error: "+e)}var xL,IL=function(){function e(t,n){u(this,e),this.bucket=t,this.path_=n}return l(e,[{key:"path",get:function(){return this.path_}},{key:"isRoot",get:function(){return 0===this.path.length}},{key:"fullServerUrl",value:function(){var e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}},{key:"bucketOnlyServerUrl",value:function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}}],[{key:"makeFromBucketSpec",value:function(t,n){var r;try{r=e.makeFromUrl(t,n)}catch(i){return new e(t,"")}if(""===r.path)return r;throw new dL("invalid-default-bucket","Invalid default bucket '"+t+"'.")}},{key:"makeFromUrl",value:function(t,n){var r=null,i="([A-Za-z0-9.\\-_]+)";var a=new RegExp("^gs://"+i+"(/(.*))?$","i");function o(e){e.path_=decodeURIComponent(e.path)}for(var u=n.replace(/[.]/g,"\\."),s=[{regex:a,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(u,"/").concat("v[A-Za-z0-9_]+","/b/").concat(i,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:o},{regex:new RegExp("^https?://".concat(n===fL?"(?:storage.googleapis.com|storage.cloud.google.com)":n,"/").concat(i,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:o}],c=0;c<s.length;c++){var l=s[c],f=l.regex.exec(t);if(f){var h=f[l.indices.bucket],d=f[l.indices.path];d||(d=""),r=new e(h,d),l.postModify(r);break}}if(null==r)throw function(e){return new dL("invalid-url","Invalid URL '"+e+"'.")}(t);return r}}]),e}(),SL=function(){function e(t){u(this,e),this.promise_=Promise.reject(t)}return l(e,[{key:"getPromise",value:function(){return this.promise_}},{key:"cancel",value:function(){}}]),e}();function TL(e){return"string"===typeof e||e instanceof String}function EL(e){return CL()&&e instanceof Blob}function CL(){return"undefined"!==typeof Blob&&!B()}function NL(e,t,n,r){if(r<t)throw kL("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(r>n)throw kL("Invalid value for '".concat(e,"'. Expected ").concat(n," or less."))}function RL(e,t,n){var r=t;return null==n&&(r="https://".concat(t)),"".concat(n,"://").concat(r,"/v0").concat(e)}function AL(e){var t=encodeURIComponent,n="?";for(var r in e){if(e.hasOwnProperty(r))n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1)}function PL(e,t){var n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return n||r||i}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(xL||(xL={}));var DL=function(){function e(t,n,r,i,a,o,s,c,l,f,h){var d=this,p=!(arguments.length>11&&void 0!==arguments[11])||arguments[11];u(this,e),this.url_=t,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=o,this.callback_=s,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=f,this.connectionFactory_=h,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((function(e,t){d.resolve_=e,d.reject_=t,d.start_()}))}return l(e,[{key:"start_",value:function(){var e=this,t=function(t,n){var r=e.resolve_,i=e.reject_,a=n.connection;if(n.wasSuccessCode)try{var o=e.callback_(a,a.getResponse());!function(e){return void 0!==e}(o)?r():r(o)}catch(s){i(s)}else if(null!==a){var u=vL();u.serverResponse=a.getErrorText(),e.errorCallback_?i(e.errorCallback_(a,u)):i(u)}else{if(n.canceled)i(e.appDelete_?bL():mL());else i(yL())}};this.canceled_?t(0,new OL(!1,null,!0)):this.backoffId_=function(e,t,n){var r=1,i=null,a=null,o=!1,u=0;function s(){return 2===u}var c=!1;function l(){if(!c){c=!0;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(null,n)}}function f(t){i=setTimeout((function(){i=null,e(d,s())}),t)}function h(){a&&clearTimeout(a)}function d(e){if(c)h();else{for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(e)return h(),void l.call.apply(l,[null,e].concat(n));var a;if(s()||o)return h(),void l.call.apply(l,[null,e].concat(n));r<64&&(r*=2),1===u?(u=2,a=0):a=1e3*(r+Math.random()),f(a)}}var p=!1;function v(e){p||(p=!0,h(),c||(null!==i?(e||(u=2),clearTimeout(i),f(0)):e||(u=1)))}return f(0),a=setTimeout((function(){o=!0,v(!0)}),n),v}((function(t,n){if(n)t(!1,new OL(!1,null,!0));else{var r=e.connectionFactory_();e.pendingConnection_=r;var i=function(t){var n=t.loaded,r=t.lengthComputable?t.total:-1;null!==e.progressCallback_&&e.progressCallback_(n,r)};null!==e.progressCallback_&&r.addUploadProgressListener(i),r.send(e.url_,e.method_,e.body_,e.headers_).then((function(){null!==e.progressCallback_&&r.removeUploadProgressListener(i),e.pendingConnection_=null;var n=r.getErrorCode()===xL.NO_ERROR,a=r.getStatus();if(n&&!PL(a,e.additionalRetryCodes_)||!e.retry){var o=-1!==e.successCodes_.indexOf(a);t(!0,new OL(o,r))}else{var u=r.getErrorCode()===xL.ABORT;t(!1,new OL(!1,null,u))}}))}}),t,this.timeout_)}},{key:"getPromise",value:function(){return this.promise_}},{key:"cancel",value:function(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}]),e}(),OL=l((function e(t,n,r){u(this,e),this.wasSuccessCode=t,this.connection=n,this.canceled=!!r}));function LL(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}function ML(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}function FL(e,t){t&&(e["X-Firebase-GMPID"]=t)}function UL(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}function jL(e,t,n,r,i,a){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],u=AL(e.urlParams),s=e.url+u,c=Object.assign({},e.headers);return FL(c,t),LL(c,n),ML(c,a),UL(c,r),new DL(s,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,o)}function VL(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function qL(){for(var e=VL(),t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(void 0!==e){for(var i=new e,a=0;a<n.length;a++)i.append(n[a]);return i.getBlob()}if(CL())return new Blob(n);throw new dL("unsupported-environment","This browser doesn't seem to support creating Blobs")}function BL(e){if("undefined"===typeof atob)throw new dL("unsupported-environment","".concat("base-64"," is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information."));return atob(e)}var zL="raw",WL="base64",KL="base64url",HL="data_url",GL=l((function e(t,n){u(this,e),this.data=t,this.contentType=n||null}));function QL(e,t){switch(e){case zL:return new GL($L(t));case WL:case KL:return new GL(YL(e,t));case HL:return new GL(function(e){var t=new XL(e);return t.base64?YL(WL,t.rest):function(e){var t;try{t=decodeURIComponent(e)}catch(n){throw wL(HL,"Malformed data URL.")}return $L(t)}(t.rest)}(t),new XL(t).contentType)}throw vL()}function $L(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296===(64512&r))if(n<e.length-1&&56320===(64512&e.charCodeAt(n+1)))r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r);else t.push(239,191,189);else 56320===(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function YL(e,t){switch(e){case WL:var n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r)throw wL(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case KL:var i=-1!==t.indexOf("+"),a=-1!==t.indexOf("/");if(i||a)throw wL(e,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/")}var o;try{o=BL(t)}catch(c){if(c.message.includes("polyfill"))throw c;throw wL(e,"Invalid character found")}for(var u=new Uint8Array(o.length),s=0;s<o.length;s++)u[s]=o.charCodeAt(s);return u}var XL=l((function e(t){u(this,e),this.base64=!1,this.contentType=null;var n=t.match(/^data:([^,]+)?,/);if(null===n)throw wL(HL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var r=n[1]||null;null!=r&&(this.base64=function(e,t){var n=e.length>=t.length;if(!n)return!1;return e.substring(e.length-t.length)===t}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-";base64".length):r),this.rest=t.substring(t.indexOf(",")+1)}));var JL=function(){function e(t,n){u(this,e);var r=0,i="";EL(t)?(this.data_=t,r=t.size,i=t.type):t instanceof ArrayBuffer?(n?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),r=this.data_.length):t instanceof Uint8Array&&(n?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),r=t.length),this.size_=r,this.type_=i}return l(e,[{key:"size",value:function(){return this.size_}},{key:"type",value:function(){return this.type_}},{key:"slice",value:function(t,n){if(EL(this.data_)){var r=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,t,n);return null===r?null:new e(r)}var i=new Uint8Array(this.data_.buffer,t,n-t);return new e(i,!0)}},{key:"uploadData",value:function(){return this.data_}}],[{key:"getBlob",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(CL()){var i=n.map((function(t){return t instanceof e?t.data_:t}));return new e(qL.apply(null,i))}var a=n.map((function(e){return TL(e)?QL(zL,e).data:e.data_})),o=0;a.forEach((function(e){o+=e.byteLength}));var u=new Uint8Array(o),s=0;return a.forEach((function(e){for(var t=0;t<e.length;t++)u[s++]=e[t]})),new e(u,!0)}}]),e}();function ZL(e){var t;try{t=JSON.parse(e)}catch(n){return null}return function(e){return"object"===typeof e&&!Array.isArray(e)}(t)?t:null}function eM(e){var t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function tM(e,t){return t}var nM=l((function e(t,n,r,i){u(this,e),this.server=t,this.local=n||t,this.writable=!!r,this.xform=i||tM})),rM=null;function iM(){if(rM)return rM;var e=[];e.push(new nM("bucket")),e.push(new nM("generation")),e.push(new nM("metageneration")),e.push(new nM("name","fullPath",!0));var t=new nM("name");t.xform=function(e,t){return function(e){return!TL(e)||e.length<2?e:eM(e)}(t)},e.push(t);var n=new nM("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new nM("timeCreated")),e.push(new nM("updated")),e.push(new nM("md5Hash",null,!0)),e.push(new nM("cacheControl",null,!0)),e.push(new nM("contentDisposition",null,!0)),e.push(new nM("contentEncoding",null,!0)),e.push(new nM("contentLanguage",null,!0)),e.push(new nM("contentType",null,!0)),e.push(new nM("metadata","customMetadata",!0)),rM=e}function aM(e,t,n){for(var r={type:"file"},i=n.length,a=0;a<i;a++){var o=n[a];r[o.local]=o.xform(r,t[o.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){var n=e.bucket,r=e.fullPath,i=new IL(n,r);return t._makeStorageReference(i)}})}(r,e),r}function oM(e,t,n){var r=ZL(t);return null===r?null:aM(e,r,n)}function uM(e,t){for(var n={},r=t.length,i=0;i<r;i++){var a=t[i];a.writable&&(n[a.server]=e[a.local])}return JSON.stringify(n)}var sM=l((function e(t,n,r,i){u(this,e),this.url=t,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}));function cM(e){if(!e)throw vL()}function lM(e,t){return function(n,r){var i=oM(e,r,t);return cM(null!==i),i}}function fM(e,t){return function(n,r){var i=oM(e,r,t);return cM(null!==i),function(e,t,n,r){var i=ZL(t);if(null===i)return null;if(!TL(i.downloadTokens))return null;var a=i.downloadTokens;if(0===a.length)return null;var o=encodeURIComponent;return a.split(",").map((function(t){var i=e.bucket,a=e.fullPath;return RL("/b/"+o(i)+"/o/"+o(a),n,r)+AL({alt:"media",token:t})}))[0]}(i,r,e.host,e._protocol)}}function hM(e){return function(t,n){var r,i,a;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new dL("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new dL("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(a=e.bucket,r=new dL("quota-exceeded","Quota for bucket '"+a+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(i=e.path,r=new dL("unauthorized","User does not have permission to access '"+i+"'.")):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function dM(e){var t=hM(e);return function(n,r){var i,a=t(n,r);return 404===n.getStatus()&&(i=e.path,a=new dL("object-not-found","Object '"+i+"' does not exist.")),a.serverResponse=r.serverResponse,a}}function pM(e,t,n){var r=RL(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,a=new sM(r,"GET",lM(e,n),i);return a.errorHandler=dM(t),a}function vM(e,t,n){var r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}function yM(e,t,n,r,i){var a=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};var u=function(){for(var e="",t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+u;var s=vM(t,r,i),c="--"+u+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+uM(s,n)+"\r\n--"+u+"\r\nContent-Type: "+s.contentType+"\r\n\r\n",l="\r\n--"+u+"--",f=JL.getBlob(c,r,l);if(null===f)throw gL();var h={name:s.fullPath},d=RL(a,e.host,e._protocol),p=e.maxUploadRetryTime,v=new sM(d,"POST",lM(e,n),p);return v.urlParams=h,v.headers=o,v.body=f.uploadData(),v.errorHandler=hM(t),v}var mM=l((function e(t,n,r,i){u(this,e),this.current=t,this.total=n,this.finalized=!!r,this.metadata=i||null}));function gM(e,t){var n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(r){cM(!1)}return cM(!!n&&-1!==(t||["active"]).indexOf(n)),n}var kM=262144;function bM(e,t,n,r,i,a,o,u){var s=new mM(0,0);if(o?(s.current=o.current,s.total=o.total):(s.current=0,s.total=r.size()),r.size()!==s.total)throw new dL("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");var c=s.total-s.current,l=c;i>0&&(l=Math.min(l,i));var f=s.current,h=f+l,d={"X-Goog-Upload-Command":0===l?"finalize":c===l?"upload, finalize":"upload","X-Goog-Upload-Offset":"".concat(s.current)},p=r.slice(f,h);if(null===p)throw gL();var v=t.maxUploadRetryTime,y=new sM(n,"POST",(function(e,n){var i,o=gM(e,["active","final"]),u=s.current+l,c=r.size();return i="final"===o?lM(t,a)(e,n):null,new mM(u,c,"final"===o,i)}),v);return y.headers=d,y.body=p.uploadData(),y.progressCallback=u||null,y.errorHandler=hM(e),y}var wM="running",_M="paused",xM="success",IM="canceled",SM="error";function TM(e){switch(e){case"running":case"pausing":case"canceling":return wM;case"paused":return _M;case"success":return xM;case"canceled":return IM;default:return SM}}var EM=l((function e(t,n,r){u(this,e);var i=function(e){return"function"===typeof e}(t)||null!=n||null!=r;if(i)this.next=t,this.error=null!==n&&void 0!==n?n:void 0,this.complete=null!==r&&void 0!==r?r:void 0;else{var a=t;this.next=a.next,this.error=a.error,this.complete=a.complete}}));function CM(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Promise.resolve().then((function(){return e.apply(void 0,n)}))}}var NM=function(){function e(){var t=this;u(this,e),this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=xL.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=xL.ABORT,e()})),t.xhr_.addEventListener("error",(function(){t.errorCode_=xL.NETWORK_ERROR,e()})),t.xhr_.addEventListener("load",(function(){e()}))}))}return l(e,[{key:"send",value:function(e,t,n,r){if(this.sent_)throw _L("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}},{key:"getErrorCode",value:function(){if(!this.sent_)throw _L("cannot .getErrorCode() before sending");return this.errorCode_}},{key:"getStatus",value:function(){if(!this.sent_)throw _L("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}},{key:"getResponse",value:function(){if(!this.sent_)throw _L("cannot .getResponse() before sending");return this.xhr_.response}},{key:"getErrorText",value:function(){if(!this.sent_)throw _L("cannot .getErrorText() before sending");return this.xhr_.statusText}},{key:"abort",value:function(){this.xhr_.abort()}},{key:"getResponseHeader",value:function(e){return this.xhr_.getResponseHeader(e)}},{key:"addUploadProgressListener",value:function(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}},{key:"removeUploadProgressListener",value:function(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}]),e}(),RM=function(e){_(n,e);var t=T(n);function n(){return u(this,n),t.apply(this,arguments)}return l(n,[{key:"initXhr",value:function(){this.xhr_.responseType="text"}}]),n}(NM);function AM(){return new RM}var PM=function(){function e(t,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;u(this,e),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=n,this._metadata=i,this._mappings=iM(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=function(e){if(r._request=void 0,r._chunkMultiplier=1,e._codeEquals("canceled"))r._needToFetchStatus=!0,r.completeTransitions_();else{var t=r.isExponentialBackoffExpired();if(PL(e.status,[])){if(!t)return r.sleepTime=Math.max(2*r.sleepTime,1e3),r._needToFetchStatus=!0,void r.completeTransitions_();e=yL()}r._error=e,r._transition("error")}},this._metadataErrorHandler=function(e){r._request=void 0,e._codeEquals("canceled")?r.completeTransitions_():(r._error=e,r._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((function(e,t){r._resolve=e,r._reject=t,r._start()})),this._promise.then(null,(function(){}))}return l(e,[{key:"isExponentialBackoffExpired",value:function(){return this.sleepTime>this.maxSleepTime}},{key:"_makeProgressCallback",value:function(){var e=this,t=this._transferred;return function(n){return e._updateProgress(t+n)}}},{key:"_shouldDoResumable",value:function(e){return e.size()>262144}},{key:"_start",value:function(){var e=this;"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout((function(){e.pendingTimeout=void 0,e._continueUpload()}),this.sleepTime):this._oneShotUpload())}},{key:"_resolveToken",value:function(e){var t=this;Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((function(n){var r=k(n,2),i=r[0],a=r[1];switch(t._state){case"running":e(i,a);break;case"canceling":t._transition("canceled");break;case"pausing":t._transition("paused")}}))}},{key:"_createResumable",value:function(){var e=this;this._resolveToken((function(t,n){var r=function(e,t,n,r,i){var a=t.bucketOnlyServerUrl(),o=vM(t,r,i),u={name:o.fullPath},s=RL(a,e.host,e._protocol),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":"".concat(r.size()),"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},l=uM(o,n),f=e.maxUploadRetryTime,h=new sM(s,"POST",(function(e){var t;gM(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(n){cM(!1)}return cM(TL(t)),t}),f);return h.urlParams=u,h.headers=c,h.body=l,h.errorHandler=hM(t),h}(e._ref.storage,e._ref._location,e._mappings,e._blob,e._metadata),i=e._ref.storage._makeRequest(r,AM,t,n);e._request=i,i.getPromise().then((function(t){e._request=void 0,e._uploadUrl=t,e._needToFetchStatus=!1,e.completeTransitions_()}),e._errorHandler)}))}},{key:"_fetchStatus",value:function(){var e=this,t=this._uploadUrl;this._resolveToken((function(n,r){var i=function(e,t,n,r){var i=e.maxUploadRetryTime,a=new sM(n,"POST",(function(e){var t=gM(e,["active","final"]),n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(a){cM(!1)}n||cM(!1);var i=Number(n);return cM(!isNaN(i)),new mM(i,r.size(),"final"===t)}),i);return a.headers={"X-Goog-Upload-Command":"query"},a.errorHandler=hM(t),a}(e._ref.storage,e._ref._location,t,e._blob),a=e._ref.storage._makeRequest(i,AM,n,r);e._request=a,a.getPromise().then((function(t){e._request=void 0,e._updateProgress(t.current),e._needToFetchStatus=!1,t.finalized&&(e._needToFetchMetadata=!0),e.completeTransitions_()}),e._errorHandler)}))}},{key:"_continueUpload",value:function(){var e=this,t=kM*this._chunkMultiplier,n=new mM(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((function(i,a){var o;try{o=bM(e._ref._location,e._ref.storage,r,e._blob,t,e._mappings,n,e._makeProgressCallback())}catch(s){return e._error=s,void e._transition("error")}var u=e._ref.storage._makeRequest(o,AM,i,a,!1);e._request=u,u.getPromise().then((function(t){e._increaseMultiplier(),e._request=void 0,e._updateProgress(t.current),t.finalized?(e._metadata=t.metadata,e._transition("success")):e.completeTransitions_()}),e._errorHandler)}))}},{key:"_increaseMultiplier",value:function(){2*(kM*this._chunkMultiplier)<33554432&&(this._chunkMultiplier*=2)}},{key:"_fetchMetadata",value:function(){var e=this;this._resolveToken((function(t,n){var r=pM(e._ref.storage,e._ref._location,e._mappings),i=e._ref.storage._makeRequest(r,AM,t,n);e._request=i,i.getPromise().then((function(t){e._request=void 0,e._metadata=t,e._transition("success")}),e._metadataErrorHandler)}))}},{key:"_oneShotUpload",value:function(){var e=this;this._resolveToken((function(t,n){var r=yM(e._ref.storage,e._ref._location,e._mappings,e._blob,e._metadata),i=e._ref.storage._makeRequest(r,AM,t,n);e._request=i,i.getPromise().then((function(t){e._request=void 0,e._metadata=t,e._updateProgress(e._blob.size()),e._transition("success")}),e._errorHandler)}))}},{key:"_updateProgress",value:function(e){var t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}},{key:"_transition",value:function(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":var t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=mL(),this._state=e,this._notifyObservers()}}},{key:"completeTransitions_",value:function(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}},{key:"snapshot",get:function(){var e=TM(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}},{key:"on",value:function(e,t,n,r){var i=this,a=new EM(t||void 0,n||void 0,r||void 0);return this._addObserver(a),function(){i._removeObserver(a)}}},{key:"then",value:function(e,t){return this._promise.then(e,t)}},{key:"catch",value:function(e){return this.then(null,e)}},{key:"_addObserver",value:function(e){this._observers.push(e),this._notifyObserver(e)}},{key:"_removeObserver",value:function(e){var t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}},{key:"_notifyObservers",value:function(){var e=this;this._finishPromise(),this._observers.slice().forEach((function(t){e._notifyObserver(t)}))}},{key:"_finishPromise",value:function(){if(void 0!==this._resolve){var e=!0;switch(TM(this._state)){case xM:CM(this._resolve.bind(null,this.snapshot))();break;case IM:case SM:CM(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}},{key:"_notifyObserver",value:function(e){switch(TM(this._state)){case wM:case _M:e.next&&CM(e.next.bind(e,this.snapshot))();break;case xM:e.complete&&CM(e.complete.bind(e))();break;default:e.error&&CM(e.error.bind(e,this._error))()}}},{key:"resume",value:function(){var e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}},{key:"pause",value:function(){var e="running"===this._state;return e&&this._transition("pausing"),e}},{key:"cancel",value:function(){var e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}]),e}(),DM=function(){function e(t,n){u(this,e),this._service=t,this._location=n instanceof IL?n:IL.makeFromUrl(n,t.host)}return l(e,[{key:"toString",value:function(){return"gs://"+this._location.bucket+"/"+this._location.path}},{key:"_newRef",value:function(t,n){return new e(t,n)}},{key:"root",get:function(){var e=new IL(this._location.bucket,"");return this._newRef(this._service,e)}},{key:"bucket",get:function(){return this._location.bucket}},{key:"fullPath",get:function(){return this._location.path}},{key:"name",get:function(){return eM(this._location.path)}},{key:"storage",get:function(){return this._service}},{key:"parent",get:function(){var t=function(e){if(0===e.length)return null;var t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===t)return null;var n=new IL(this._location.bucket,t);return new e(this._service,n)}},{key:"_throwIfRoot",value:function(e){if(""===this._location.path)throw function(e){return new dL("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}]),e}();function OM(e){e._throwIfRoot("getDownloadURL");var t=function(e,t,n){var r=RL(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,a=new sM(r,"GET",fM(e,n),i);return a.errorHandler=dM(t),a}(e.storage,e._location,iM());return e.storage.makeRequestWithTokens(t,AM).then((function(e){if(null===e)throw new dL("no-download-url","The given file does not have any download URLs.");return e}))}function LM(e,t){var n=function(e,t){var n=t.split("/").filter((function(e){return e.length>0})).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new IL(e._location.bucket,n);return new DM(e.storage,r)}function MM(e,t){if(e instanceof VM){var n=e;if(null==n._bucket)throw new dL("no-default-bucket","No default bucket found. Did you set the '"+hL+"' property when initializing the app?");var r=new DM(n,n._bucket);return null!=t?MM(r,t):r}return void 0!==t?LM(e,t):e}function FM(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof VM)return new DM(e,t);throw kL("To use ref(service, url), the first argument must be a Storage instance.")}return MM(e,t)}function UM(e,t){var n=null===t||void 0===t?void 0:t[hL];return null==n?null:IL.makeFromBucketSpec(n,e)}function jM(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(n),e._protocol="http";var i=r.mockUserToken;i&&(e._overrideAuthToken="string"===typeof i?i:te(i,e.app.options.projectId))}var VM=function(){function e(t,n,r,i,a){u(this,e),this.app=t,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=a,this._bucket=null,this._host=fL,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?IL.makeFromBucketSpec(i,this._host):UM(this._host,this.app.options)}return l(e,[{key:"host",get:function(){return this._host},set:function(e){this._host=e,null!=this._url?this._bucket=IL.makeFromBucketSpec(this._url,e):this._bucket=UM(e,this.app.options)}},{key:"maxUploadRetryTime",get:function(){return this._maxUploadRetryTime},set:function(e){NL("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}},{key:"maxOperationRetryTime",get:function(){return this._maxOperationRetryTime},set:function(e){NL("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}},{key:"_getAuthToken",value:function(){var e=h(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._overrideAuthToken){e.next=2;break}return e.abrupt("return",this._overrideAuthToken);case 2:if(!(t=this._authProvider.getImmediate({optional:!0}))){e.next=9;break}return e.next=6,t.getToken();case 6:if(null===(n=e.sent)){e.next=9;break}return e.abrupt("return",n.accessToken);case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getAppCheckToken",value:function(){var e=h(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this._appCheckProvider.getImmediate({optional:!0}))){e.next=6;break}return e.next=4,t.getToken();case 4:return n=e.sent,e.abrupt("return",n.token);case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_delete",value:function(){return this._deleted||(this._deleted=!0,this._requests.forEach((function(e){return e.cancel()})),this._requests.clear()),Promise.resolve()}},{key:"_makeStorageReference",value:function(e){return new DM(this,e)}},{key:"_makeRequest",value:function(e,t,n,r){var i=this,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new SL(bL());var o=jL(e,this._appId,n,r,t,this._firebaseVersion,a);return this._requests.add(o),o.getPromise().then((function(){return i._requests.delete(o)}),(function(){return i._requests.delete(o)})),o}},{key:"makeRequestWithTokens",value:function(){var e=h(o().mark((function e(t,n){var r,i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this._getAuthToken(),this._getAppCheckToken()]);case 2:return r=e.sent,i=k(r,2),a=i[0],u=i[1],e.abrupt("return",this._makeRequest(t,n,a,u).getPromise());case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),qM="@firebase/storage",BM="0.10.0",zM="storage";function WM(e,t,n){return function(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new PM(e,new JL(t),n)}(e=Ie(e),t,n)}function KM(e){return OM(e=Ie(e))}function HM(e,t){return FM(e=Ie(e),t)}function GM(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:It(),t=arguments.length>1?arguments[1]:void 0,n=yt(e=Ie(e),zM),r=n.getImmediate({identifier:t}),i=X("storage");return i&&QM.apply(void 0,[r].concat(Te(i))),r}function QM(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};jM(e,t,n,r)}function $M(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),a=e.getProvider("app-check-internal");return new VM(r,i,a,n,_t)}vt(new Ee(zM,$M,"PUBLIC").setMultipleInstances(!0)),Ct(qM,BM,""),Ct(qM,BM,"esm2017");var YM,XM={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},JM=new Uint8Array(16);function ZM(){if(!YM&&!(YM="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return YM(JM)}for(var eF=[],tF=0;tF<256;++tF)eF.push((tF+256).toString(16).slice(1));function nF(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(eF[e[t+0]]+eF[e[t+1]]+eF[e[t+2]]+eF[e[t+3]]+"-"+eF[e[t+4]]+eF[e[t+5]]+"-"+eF[e[t+6]]+eF[e[t+7]]+"-"+eF[e[t+8]]+eF[e[t+9]]+"-"+eF[e[t+10]]+eF[e[t+11]]+eF[e[t+12]]+eF[e[t+13]]+eF[e[t+14]]+eF[e[t+15]]).toLowerCase()}var rF=function(e,t,n){if(XM.randomUUID&&!t&&!e)return XM.randomUUID();var r=(e=e||{}).random||(e.rng||ZM)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return nF(r)};var iF=n.p+"static/media/paperclip.50671f52e9c429deeb0df4bb14820248.svg";var aF=n.p+"static/media/message.060e6e87bbb69488e690e7f4ef142202.svg";var oF=function(){var e=GM(),n=k((0,t.useState)(""),2),r=n[0],i=n[1],a=k((0,t.useState)(null),2),u=a[0],s=a[1],c=dC((function(e){return e.userData})),l=dC((function(e){return e.chatData})),f=function(){var t=h(o().mark((function t(){var n,a,f,p;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!u){t.next=6;break}n=HM(e,rF()),(a=WM(n,u)).on((function(e){console.log(e)}),(function(){KM(a.snapshot.ref).then(function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,YS(Jx(lL,"chats",l.chatId),{messages:oT({id:rF(),text:r,senderId:c.id,date:ap.now(),img:t})});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})),t.next=12;break;case 6:return t.next=8,YS(Jx(lL,"chats",l.chatId),{messages:oT({id:rF(),text:r,senderId:c.id,date:ap.now()})});case 8:return t.next=10,YS(Jx(lL,"userChats",c.id),(d(f={},l.chatId+".lastMessage",{text:r}),d(f,l.chatId+".date",aT()),f));case 10:return t.next=12,YS(Jx(lL,"userChats",l.user.uid),(d(p={},l.chatId+".lastMessage",{text:r}),d(p,l.chatId+".date",aT()),p));case 12:i(""),s(null);case 14:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return(0,gR.jsxs)("div",{className:"input",children:[(0,gR.jsx)("input",{className:"message-input",type:"text",placeholder:"Type something...",onChange:function(e){return i(e.target.value)},value:r}),(0,gR.jsxs)("div",{className:"send",children:[(0,gR.jsx)("input",{type:"file",style:{display:"none"},id:"file",onChange:function(e){return s(e.target.files[0])}}),(0,gR.jsx)("label",{htmlFor:"file",children:(0,gR.jsx)("img",{className:"paperclipIcon",src:iF,alt:""})}),(0,gR.jsx)("button",{className:"send-button",onClick:f,children:(0,gR.jsx)("img",{className:"message-icon",src:aF,alt:"icon"})})]})]})};var uF=function(e){var n=e.message,r=dC((function(e){return e.userData})),i=dC((function(e){return e.chatData})),a=(0,t.useRef)();return(0,t.useEffect)((function(){var e;null===(e=a.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[n]),(0,gR.jsxs)("div",{ref:a,className:"message ".concat(n.senderId===r.id?"my-message":"owner-message"),children:[(0,gR.jsx)("div",{className:"messageInfo",children:(0,gR.jsx)("img",{className:"user-photo",src:n.senderId===r.id?r.photoUrl:i.user.photoURL,alt:""})}),(0,gR.jsxs)("div",{className:"messageContent",children:[n.img&&(0,gR.jsx)("img",{className:"down-user-photo",src:n.img,alt:""}),(0,gR.jsx)("div",{className:"message-text",children:n.text})]})]})};var sF=function(){var e=dC((function(e){return e.chatData})),n=k((0,t.useState)([]),2),r=n[0],i=n[1];return(0,t.useEffect)((function(){var t=XS(Jx(lL,"chats",e.chatId),(function(e){e.exists()&&i(e.data().messages)}));return function(){t()}}),[e.chatId]),console.log(r),(0,gR.jsx)("div",{className:"messages",children:r.map((function(e){return(0,gR.jsx)(uF,{message:e},e.id)}))})},cF=nR({name:"activateChatSlice",initialState:{activeChat:!1},reducers:{changeActivateChat:function(e,t){e.activeChat=t.payload}}}),lF=cF.actions.changeActivateChat,fF=cF.reducer;var hF=n.p+"static/media/arrow_left.91c5c9abb444ee385d571ca0150803ed.svg";var dF=function(){var e,t,n=_C(),r=dC((function(e){return e.chatData})),i=dC((function(e){return e.activateChat.activeChat}));return(0,gR.jsxs)("div",{className:i?"chat-active":"chat",children:[(0,gR.jsxs)("div",{className:"chat-info",children:[(0,gR.jsx)("button",{className:"back-button",onClick:function(){n(lF(!1))},children:(0,gR.jsx)("img",{className:"arrow-left",src:hF,alt:"arrow"})}),(0,gR.jsx)("div",{className:"select-user-photo",children:(0,gR.jsx)("img",{className:"user-photo",src:null===(e=r.user)||void 0===e?void 0:e.photoURL,alt:"userPhoto"})}),(0,gR.jsx)("div",{className:"select-user-name",children:null===(t=r.user)||void 0===t?void 0:t.displayName})]}),(0,gR.jsx)(sF,{}),(0,gR.jsx)(oF,{})]})},pF=nR({name:"chatData",initialState:{chatId:"null",user:{}},reducers:{changeUser:function(e,t){e.user=t.payload.user,e.chatId=t.payload.chatId}}}),vF=pF.actions.changeUser,yF=pF.reducer;var mF=function(){var e,n=k((0,t.useState)([]),2),r=n[0],i=n[1],a=_C(),o=dC((function(e){return e.userData})),u=dC((function(e){return e.activateChat.activeChat}));return console.log(u),(0,t.useEffect)((function(){o.id&&function(){var e=XS(Jx(lL,"userChats",o.id),(function(e){i(e.data())}))}()}),[o.id]),console.log(r),(0,gR.jsx)("div",{className:u?"chats":"chats-active",children:null===(e=Object.entries(r))||void 0===e?void 0:e.sort((function(e,t){return t[1].date-e[1].date})).map((function(e){var t;return(0,gR.jsxs)("div",{className:"userChat",onClick:function(){return function(e){a(vF({chatId:o.id>e.uid?o.id+e.uid:e.uid+o.id,user:e})),a(lF(!0))}(e[1].userInfo)},children:[(0,gR.jsx)("img",{className:"user-photo",src:e[1].userInfo.photoURL,alt:"userPhoto"}),(0,gR.jsxs)("div",{className:"userChatInfo",children:[(0,gR.jsx)("div",{className:"user-chat-name",children:e[1].userInfo.displayName}),(0,gR.jsx)("div",{className:"user-chat-text",children:null===(t=e[1].lastMessage)||void 0===t?void 0:t.text})]})]},e[0])}))})};var gF=n.p+"static/media/search.6c426ffa0449b2dfe06f2ac530abbcb0.svg",kF=function(){var e=k((0,t.useState)(""),2),n=e[0],r=e[1],i=k((0,t.useState)(null),2),a=i[0],u=i[1],s=k((0,t.useState)(!1),2),c=s[0],l=s[1],f=dC((function(e){return e.userData})),p=dC((function(e){return e.activateChat.activeChat})),v=function(){var e=h(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=gS(Xx(lL,"users"),bS("name","==",n)),e.prev=1,e.next=4,GS(t);case 4:e.sent.forEach((function(e){u(e.data())})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),l(!0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=h(o().mark((function e(){var t,n,i,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.id>a.id?f.id+a.id:a.id+f.id,e.prev=1,e.next=4,WS(Jx(lL,"chats",t));case 4:if(n=e.sent,console.log(n.exists()),console.log(a),!1!==n.exists()){e.next=14;break}return e.next=10,$S(Jx(lL,"chats",t),{messages:[]});case 10:return e.next=12,YS(Jx(lL,"userChats",f.id),(d(i={},t+".userInfo",{uid:a.id,displayName:a.name,photoURL:a.photoURL}),d(i,t+".date",aT()),i));case 12:return e.next=14,YS(Jx(lL,"userChats",a.id),(d(s={},t+".userInfo",{uid:f.id,displayName:f.name,photoURL:f.photoUrl}),d(s,t+".date",aT()),s));case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),console.log(e.t0);case 19:u(null),r("");case 21:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(){return e.apply(this,arguments)}}();return(0,gR.jsxs)("div",{className:p?"search":"search-active",children:[(0,gR.jsxs)("div",{className:"searchForm",children:[(0,gR.jsx)("img",{className:"searchIcon",src:gF,alt:"searchIcon"}),(0,gR.jsx)("input",{className:"find-user-input",type:"text",placeholder:"Find a user",onKeyDown:function(e){"Enter"===e.code&&v()},onChange:function(e){return r(e.target.value)},value:n})]}),c&&(0,gR.jsx)("span",{children:"User not found!"}),a&&(0,gR.jsxs)("div",{className:"userChat",onClick:y,children:[(0,gR.jsx)("img",{className:"user-photo",src:a.photoURL,alt:""}),(0,gR.jsx)("div",{className:"userChatInfo",children:(0,gR.jsx)("span",{children:a.name})})]})]})};var bF=function(){var e=function(){var e=dC((function(e){return e.userData})),t=e.email,n=e.name,r=e.id;return{isAuth:!!r,email:t,name:n,id:r}}(),t=e.isAuth,n=e.email,r=e.name;return console.log(t),console.log(n),console.log(r),t?(0,gR.jsx)("div",{className:"home",children:(0,gR.jsxs)("div",{className:"container",children:[(0,gR.jsx)(kF,{}),(0,gR.jsx)(mF,{}),(0,gR.jsx)(dF,{})]})}):(0,gR.jsx)(BE,{to:"/login"})};var wF=n.p+"static/media/icons_img.14d6b7a35576bb93033a63e01d336a89.svg";var _F=function(e){var n=e.title,r=e.hendleClick,i=k((0,t.useState)(""),2),a=i[0],o=i[1],u=k((0,t.useState)(""),2),s=u[0],c=u[1],l=k((0,t.useState)(""),2),f=l[0],h=l[1],d=k((0,t.useState)(""),2),p=d[0],v=d[1],y="login"===n?"\u0412\u043e\u0439\u0442\u0438":"\u0417\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f";return(0,gR.jsxs)("div",{className:"".concat(n,"-form"),children:[(0,gR.jsx)("div",{className:"form-title",children:y}),(0,gR.jsx)("input",{className:"input-form input-name",type:"text",value:f,onChange:function(e){return h(e.target.value)},placeholder:"User name",style:"login"===n?{display:"none"}:{display:"block"}}),(0,gR.jsx)("input",{className:"input-form input-email",type:"email",value:a,onChange:function(e){return o(e.target.value)},placeholder:"Email"}),(0,gR.jsx)("input",{className:"input-form input-password",type:"password",value:s,onChange:function(e){return c(e.target.value)},placeholder:"Password"}),(0,gR.jsx)("input",{required:!0,style:{display:"none"},type:"file",id:"file",onChange:function(e){return v(e.target.files)}}),(0,gR.jsxs)("label",{style:"login"===n?{display:"none"}:{display:"flex"},className:"label-add-avatar",htmlFor:"file",children:[(0,gR.jsx)("img",{className:"add-img-avatar",src:wF,alt:"add-avatar-img"}),(0,gR.jsx)("span",{className:"add-img-description",children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440"})]}),(0,gR.jsx)("button",{className:"button-form",onClick:function(){return r(f,a,s,p[0])},children:n})]})};var xF=function(){var e=_C(),t=RE();return(0,gR.jsx)("div",{className:"login-page-form",children:(0,gR.jsx)(_F,{title:"login",hendleClick:function(n,r,i){console.log(r,i),wa(ws(),r,i).then((function(n){var r=n.user;console.log(r),e(pR({email:r.email,id:r.uid,name:r.displayName,photoUrl:r.photoURL})),t("/home")})).catch(console.error)}})})};var IF=function(){return(0,gR.jsx)("div",{className:"login-page",children:(0,gR.jsxs)("div",{className:"log-reg-form",children:[(0,gR.jsx)("div",{className:"log-reg-page-title",children:"GrosChat"}),(0,gR.jsx)(xF,{}),(0,gR.jsxs)("div",{className:"log-reg-page-link",children:["\u0438\u043b\u0438",(0,gR.jsx)(ZE,{className:"link-register",to:"/register",children:"\u0417\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]})]})})},SF=ws();var TF=function(){var e=GM(),t=_C(),n=RE(),r=function(){var r=h(o().mark((function r(i,a,u,s){var c,l;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c=(new Date).getTime(),l=HM(e,"".concat(i+c)),r.next=4,ka(SF,a,u).then((function(e){var n=e.user;t(pR({name:i,email:n.email,id:n.uid}))})).catch(console.error);case 4:return r.next=6,WM(l,s).then((function(){KM(l).then(function(){var e=h(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Aa(SF.currentUser,{displayName:i,photoURL:t});case 3:return e.next=5,$S(Jx(lL,"users",SF.currentUser.uid),{id:SF.currentUser.uid,name:i,email:a,photoURL:t});case 5:return e.next=7,$S(Jx(lL,"userChats",SF.currentUser.uid),{});case 7:n("/login"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}())}));case 6:case"end":return r.stop()}}),r)})));return function(e,t,n,i){return r.apply(this,arguments)}}();return(0,gR.jsx)("div",{className:"login-page-form",children:(0,gR.jsx)(_F,{title:"register",hendleClick:r})})};var EF=function(){return(0,gR.jsx)("div",{className:"login-page",children:(0,gR.jsxs)("div",{className:"log-reg-form",children:[(0,gR.jsx)("div",{className:"log-reg-page-title",children:"GrosChat"}),(0,gR.jsx)(TF,{}),(0,gR.jsxs)("div",{className:"log-reg-page-link",children:["\u0438\u043b\u0438",(0,gR.jsx)(ZE,{className:"link-register",to:"/login",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})})};var CF=function(){return(0,gR.jsx)(gR.Fragment,{children:(0,gR.jsx)(HE,{children:(0,gR.jsxs)(WE,{path:"/",element:(0,gR.jsx)(_R,{}),children:[(0,gR.jsx)(WE,{index:!0,element:(0,gR.jsx)(bF,{})}),(0,gR.jsx)(WE,{path:"home",element:(0,gR.jsx)(bF,{})}),(0,gR.jsx)(WE,{path:"login",element:(0,gR.jsx)(IF,{})}),(0,gR.jsx)(WE,{path:"register",element:(0,gR.jsx)(EF,{})})]})})})},NF=function(e){var t,n=ZN(),r=e||{},i=r.reducer,a=void 0===i?void 0:i,o=r.middleware,u=void 0===o?n():o,s=r.devTools,c=void 0===s||s,l=r.preloadedState,f=void 0===l?void 0:l,h=r.enhancers,d=void 0===h?void 0:h;if("function"===typeof a)t=a;else{if(!YN(a))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');t=RN(a)}var p=u;"function"===typeof p&&(p=p(n));var v=PN.apply(void 0,p),y=AN;c&&(y=$N(HN({trace:!1},"object"===typeof c&&c)));var m=[v];return Array.isArray(d)?m=UN([v],d):"function"===typeof d&&(m=d(m)),NN(t,f,y.apply(void 0,m))}({reducer:{userData:yR,chatData:yF,activateChat:fF}});i.createRoot(document.getElementById("root")).render((0,gR.jsx)(t.StrictMode,{children:(0,gR.jsx)(mC,{store:NF,children:(0,gR.jsx)(JE,{children:(0,gR.jsx)(CF,{})})})}))}()}();
//# sourceMappingURL=main.f4fbbe55.js.map